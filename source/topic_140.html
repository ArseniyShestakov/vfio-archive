<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"> <html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en" dir="ltr"> <head> <meta http-equiv="Content-Type" content="text/html; charset=utf-8" /> <title>KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9 (Page 140) / Topics Going Nowhere / Arch Linux Forums</title> <link rel="stylesheet" type="text/css" href="style/ArchLinux.css" /> <link rel="canonical" href="viewtopic.php?id=162768&amp;p=140" title="Page 140" /> <link rel="prev" href="viewtopic.php?id=162768&amp;p=139" title="Page 139" /> <link rel="next" href="viewtopic.php?id=162768&amp;p=141" title="Page 141" /> <link rel="alternate" type="application/atom+xml" href="extern.php?action=feed&amp;tid=162768&amp;type=atom" title="Atom topic feed" /> <link rel="stylesheet" media="screen" href="style/ArchLinux/arch.css?v=3" /> <link rel="stylesheet" media="screen" href="style/ArchLinux/archnavbar.css?v=2" /> <link rel="shortcut icon" href="style/ArchLinux/favicon.ico" /> </head> <body> <div id="archnavbar" class="anb-forum"> <div id="archnavbarlogo"><h1><a href="http://www.archlinux.org/">Arch Linux</a></h1></div> <div id="archnavbarmenu"> <ul id="archnavbarlist"> <li id="anb-home"><a href="http://www.archlinux.org/">Home</a></li><li id="anb-packages"><a href="http://www.archlinux.org/packages/">Packages</a></li><li id="anb-forums" class="anb-selected"><a href="https://bbs.archlinux.org/">Forums</a></li><li id="anb-wiki"><a href="https://wiki.archlinux.org/">Wiki</a></li><li id="anb-bugs"><a href="https://bugs.archlinux.org/">Bugs</a></li><li id="anb-aur"><a href="https://aur.archlinux.org/">AUR</a></li><li id="anb-download"><a href="http://www.archlinux.org/download/">Download</a></li> </ul> </div> </div> <div id="punviewtopic" class="pun"> <div class="top-box"></div> <div class="punwrap"> <div id="brdheader" class="block"> <div class="box"> <div id="brdmenu" class="inbox"> <ul> <li id="navindex" class="isactive"><a href="index.php">Index</a></li> <li id="navuserlist"><a href="userlist.php">User list</a></li> <li id="navsearch"><a href="search.php">Search</a></li> <li id="navprofile"><a href="profile.php?id=80749">Profile</a></li> <li id="navlogout"><a href="login.php?action=out&amp;id=80749&amp;csrf_token=5c20501ec397bb45ef8ee8c84db232c8d8e421c6">Logout</a></li> </ul> </div> <div id="brdwelcome" class="inbox"> <ul class="conl"> <li><span>Logged in as <strong>SXX</strong></span></li> <li><span>Last visit: 2015-08-16 12:20:09</span></li> </ul> <ul class="conr"> <li><span>Topics: <a href="search.php?action=show_replies" title="Find topics you have posted to.">Posted</a> | <a href="search.php?action=show_new" title="Find topics with new posts since your last visit.">New</a> | <a href="search.php?action=show_recent" title="Find topics with recent posts.">Active</a> | <a href="search.php?action=show_unanswered" title="Find topics with no replies.">Unanswered</a></span></li> </ul> <div class="clearer"></div> </div> </div> </div> <div id="brdmain"> <div class="linkst"> <div class="inbox crumbsplus"> <ul class="crumbs"> <li><a href="index.php">Index</a></li> <li><span>»&#160;</span><a href="viewforum.php?id=48">Topics Going Nowhere</a></li> <li><span>»&#160;</span><strong><a href="viewtopic.php?id=162768">KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</a></strong></li> </ul> <div class="pagepost"> <p class="pagelink conl"><span class="pages-label">Pages: </span><a rel="prev" class="item1" href="viewtopic.php?id=162768&amp;p=139">Previous</a> <a href="viewtopic.php?id=162768">1</a> <span class="spacer">…</span> <a href="viewtopic.php?id=162768&amp;p=138">138</a> <a href="viewtopic.php?id=162768&amp;p=139">139</a> <strong>140</strong> <a href="viewtopic.php?id=162768&amp;p=141">141</a> <a href="viewtopic.php?id=162768&amp;p=142">142</a> <span class="spacer">…</span> <a href="viewtopic.php?id=162768&amp;p=234">234</a> <a rel="next" href="viewtopic.php?id=162768&amp;p=141">Next</a></p> <p class="postlink conr">Topic closed</p> </div> <div class="clearer"></div> </div> </div> <div id="p1480225" class="blockpost rowodd blockpost1"> <h2><span><span class="conr">#3476</span> <a href="viewtopic.php?pid=1480225#p1480225">2014-11-29 16:22:35</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=48315">TripleSpeeder</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2011-05-02</span></dd> <dd><span>Posts: 43</span></dd> <dd class="usercontacts"><span class="email"><a href="misc.php?email=48315">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>Flyser wrote:</cite><blockquote><div><div class="quotebox"><cite>TripleSpeeder wrote:</cite><blockquote><div><p>Thanks a lot Duelist! I found the root cause that stopped windows setup from continuing: It is the -cpu parameter. <br />This is the qemu command-line as provided by libvirt:</p><div class="codebox"><pre><code>-cpu qemu64,hv_time</code></pre></div><p>The moment I remove parameter hv_time, windows setup continues. And this problem only happens with smp=2 or higher. With only one core assigned to the VM it boots also with hv_time.</p><p>Any ideas out there what might be the root cause?</p><p>Edit: Note that this is still without any device pass-through, just using the default emulated vga. Trying to get setup running completely with passed-through NVidia card is the next step <img src="https://bbs.archlinux.org/img/smilies/smile.png" width="15" height="15" alt="smile" /></p></div></blockquote></div><p>I experienced crashes during the windows installation in a non-vfio setup as well. The root cause were missing kernel config options for libvirt, but I guess you are using the archlinux kernel, right?</p></div></blockquote></div><p>Yes, i tried both current Arch linux kernel and patched kernel from OP.</p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1480225">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1480577" class="blockpost roweven"> <h2><span><span class="conr">#3477</span> <a href="viewtopic.php?pid=1480577#p1480577">2014-12-01 03:06:44</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=59241">tritron4</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2012-04-14</span></dd> <dd><span>Posts: 146</span></dd> <dd class="usercontacts"><span class="email"><a href="misc.php?email=59241">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <p>Does anyone knows how convert xen disk image into kvm . I used dd of lvm to get img of partition. When I try to boot img under kvm I get error: file /grub/i386-pc/normal.mod not found<br />I tried to reinstall grub but I can get the error to go away</p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1480577">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1480693" class="blockpost rowodd"> <h2><span><span class="conr">#3478</span> <a href="viewtopic.php?pid=1480693#p1480693">2014-12-01 17:04:25</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=82238">sinny</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2014-05-24</span></dd> <dd><span>Posts: 75</span></dd> <dd class="usercontacts"><span class="email"><a href="misc.php?email=82238">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>tritron4 wrote:</cite><blockquote><div><p>Does anyone knows how convert xen disk image into kvm . I used dd of lvm to get img of partition. When I try to boot img under kvm I get error: file /grub/i386-pc/normal.mod not found<br />I tried to reinstall grub but I can get the error to go away</p></div></blockquote></div><p>how the hell is your question related to this thread&#039;s topic?</p><p>not to mention that judging by error message alone it&#039;s obvious that it may be architecture mismatch</p> <p class="postedit"><em>Last edited by sinny (2014-12-01 17:04:43)</em></p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1480693">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1480764" class="blockpost roweven"> <h2><span><span class="conr">#3479</span> <a href="viewtopic.php?pid=1480764#p1480764">2014-12-01 21:09:56</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=64462">mastersplinter777</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2012-10-09</span></dd> <dd><span>Posts: 8</span></dd> <dd class="usercontacts"><span class="email"><a href="misc.php?email=64462">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <p><a href="https://imageshack.com/i/p8J5tWtEp" rel="nofollow">https://imageshack.com/i/p8J5tWtEp</a><br /><a href="https://imageshack.com/i/ipmipYYxp" rel="nofollow">https://imageshack.com/i/ipmipYYxp</a><br />I finaly succeeded to launch OSX 10.9.5 Mavericks on my Arch + Qemu 2.1.2</p> <p class="postedit"><em>Last edited by mastersplinter777 (2014-12-01 21:10:37)</em></p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1480764">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1480767" class="blockpost rowodd"> <h2><span><span class="conr">#3480</span> <a href="viewtopic.php?pid=1480767#p1480767">2014-12-01 21:18:04</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=75590">aw</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2013-10-04</span></dd> <dd><span>Posts: 921</span></dd> <dd class="usercontacts"><span class="email"><a href="misc.php?email=75590">Email</a></span> <span class="website"><a href="http://vfio.blogspot.com/" rel="nofollow">Website</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>mastersplinter777 wrote:</cite><blockquote><div><p><a href="https://imageshack.com/i/p8J5tWtEp" rel="nofollow">https://imageshack.com/i/p8J5tWtEp</a><br /><a href="https://imageshack.com/i/ipmipYYxp" rel="nofollow">https://imageshack.com/i/ipmipYYxp</a><br />I finaly succeeded to launch OSX 10.9.5 Mavericks on my Arch + Qemu 2.1.2</p></div></blockquote></div><p>Cool.&#160; And since running a VM with GPU acceleration in a window always brings the newbies out, let&#039;s just point out right now that that&#039;s a VNC connection to the VM, guest-based VNC server.</p> </div> <div class="postsignature postmsg"><hr /><p><a href="http://vfio.blogspot.com" rel="nofollow">http://vfio.blogspot.com</a><br />Looking for a more open forum to discuss vfio related uses?&#160; Try <a href="https://www.redhat.com/mailman/listinfo/vfio-users" rel="nofollow">https://www.redhat.com/mailman/listinfo/vfio-users</a></p></div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1480767">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1480770" class="blockpost roweven"> <h2><span><span class="conr">#3481</span> <a href="viewtopic.php?pid=1480770#p1480770">2014-12-01 21:28:15</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=64462">mastersplinter777</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2012-10-09</span></dd> <dd><span>Posts: 8</span></dd> <dd class="usercontacts"><span class="email"><a href="misc.php?email=64462">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>aw wrote:</cite><blockquote><div><div class="quotebox"><cite>mastersplinter777 wrote:</cite><blockquote><div><p><a href="https://imageshack.com/i/p8J5tWtEp" rel="nofollow">https://imageshack.com/i/p8J5tWtEp</a><br /><a href="https://imageshack.com/i/ipmipYYxp" rel="nofollow">https://imageshack.com/i/ipmipYYxp</a><br />I finaly succeeded to launch OSX 10.9.5 Mavericks on my Arch + Qemu 2.1.2</p></div></blockquote></div><p>Cool.&#160; And since running a VM with GPU acceleration in a window always brings the newbies out, let&#039;s just point out right now that that&#039;s a VNC connection to the VM, guest-based VNC server.</p></div></blockquote></div><p>VNC connection is the only more or less comfotable way to connect graphically to VM if I have one physical display with different inputs... Besides I also use VNC connection with my Win8.1 VM and it is rather fast, so I can even play some 3d games or chat using my webcam in ooVoo</p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1480770">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1480771" class="blockpost rowodd"> <h2><span><span class="conr">#3482</span> <a href="viewtopic.php?pid=1480771#p1480771">2014-12-01 21:29:32</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=82730">sumpfmensch</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2014-06-13</span></dd> <dd><span>Posts: 2</span></dd> <dd class="usercontacts"><span class="email"><a href="misc.php?email=82730">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <p>Hello there,</p><p>after trying the whole passthrough journey with ubuntu, I finally gave up and tried to follow the guide in the first post with a new arch installation but I just can&#039;t get to pass through my VTX R9 280 3GB to a guest on my arch host. The mobo is the Gigabyte Z97 UD3H BK and the Processor the new 4690k (which supports VT-d).</p><p>Passing through an old 8800 GTX seems to work (i.e. gives me the seabios &quot;No boot device found&quot; output) using the same commands and setup. My R9 280 however does not want to output any signal at all (neither via HDMI, DVI nor DVI-&gt;VGA).</p><p>Since I&#039;m all out of ideas (reading and trying since 3 days almost fulltime now) I&#039;d like to ask for any further advice. The huge amount of posts I skimmed through in this thread usually seem to have get an error message when receiving no signal. I don&#039;t see anything problematic in dmesg and no output from qemu at all.</p><p>Here is my current setup which seems to work with the Nvidia card (removing the entries for 0000:01:00.1 in the vfio-bind script and the qemu call).</p><p>cat /proc/cmdline </p><div class="codebox"><pre><code>BOOT_IMAGE=/boot/vmlinuz-linux-mainline root=UUID=eed2a69c-c80f-4820-92bb-2b2afe2b7ad5 rw quiet pci-stub.ids=1002:679a,1002:aaa0 i915.enable_hd_vgaarb=1 intel_iommu=on pcie_acs_override=downstream</code></pre></div><p>Here i added pcie_acs_override=downstream later on although I think it should not be needed having both 0000:01:00.0 and 0000:01:00.0 on iommu group 13 (and no other devices there).</p><p>The script for vfio binding: cat vfio-bind</p><div class="codebox"><pre><code>DEVICES=&quot;0000:01:00.0 0000:01:00.1&quot; modprobe vfio-pci for dev in $DEVICES; do vendor=$(cat /sys/bus/pci/devices/$dev/vendor) device=$(cat /sys/bus/pci/devices/$dev/device) if [ -e /sys/bus/pci/devices/$dev/driver ]; then echo $dev &gt; /sys/bus/pci/devices/$dev/driver/unbind fi echo $vendor $device &gt; /sys/bus/pci/drivers/vfio-pci/new_id done</code></pre></div><p>ls /sys/bus/pci/drivers/vfio-pci/&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;</p><div class="codebox"><pre><code>0000:01:00.0 0000:01:00.1 bind module new_id remove_id uevent unbind</code></pre></div><p>The final command I use to start the machine:</p><div class="codebox"><pre><code>qemu-system-x86_64 -enable-kvm -M q35 -m 1024 -cpu host \ -smp 4,sockets=1,cores=4,threads=1 \ -bios /usr/share/qemu/bios.bin \ -vga none -nographic\ -device ioh3420,bus=pcie.0,addr=1c.0,multifunction=on,port=1,chassis=1,id=root.1 \ -device vfio-pci,host=01:00.0,bus=root.1,addr=00.0,multifunction=on,x-vga=on,romfile=/root/ati_r9_280.rom \ -device vfio-pci,host=01:00.1,bus=root.1,addr=00.1</code></pre></div><p> (I tried it with and without the romfile i got from /sys/.../rom - no difference - played around with the pc chipset - or should I continue trying to relocate the devices?)</p><p>cat /etc/modprobe.d/blacklist.conf </p><div class="codebox"><pre><code>blacklist radeon blacklist nouveau </code></pre></div><p>dmesg</p><div class="codebox"><pre><code>... [ 221.927937] VFIO - User Level meta-driver version: 0.3 [ 350.698684] vfio-pci 0000:01:00.0: enabling device (0000 -&gt; 0003) [ 350.722340] vfio_ecap_init: 0000:01:00.0 hiding ecap 0x19@0x270 [ 350.722345] vfio_ecap_init: 0000:01:00.0 hiding ecap 0x1b@0x2d0 [ 353.236170] kvm: zapping shadow pages for mmio generation wraparound</code></pre></div><p>Do you have any Ideas or pointers where I may continue my quest for passthrough? (I can&#039;t switch to OVMF since I got two windows 7 licences I want to run on VMs which I do not want to throw away.)</p><p>I would just love to see that bios screen - from that point on I already have Ideas how to proceed.</p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1480771">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1480776" class="blockpost roweven"> <h2><span><span class="conr">#3483</span> <a href="viewtopic.php?pid=1480776#p1480776">2014-12-01 21:52:06</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=75590">aw</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2013-10-04</span></dd> <dd><span>Posts: 921</span></dd> <dd class="usercontacts"><span class="email"><a href="misc.php?email=75590">Email</a></span> <span class="website"><a href="http://vfio.blogspot.com/" rel="nofollow">Website</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>sumpfmensch wrote:</cite><blockquote><div><p>Hello there,</p><p>after trying the whole passthrough journey with ubuntu, I finally gave up and tried to follow the guide in the first post with a new arch installation but I just can&#039;t get to pass through my VTX R9 280 3GB to a guest on my arch host. The mobo is the Gigabyte Z97 UD3H BK and the Processor the new 4690k (which supports VT-d).</p><p>Passing through an old 8800 GTX seems to work (i.e. gives me the seabios &quot;No boot device found&quot; output) using the same commands and setup. My R9 280 however does not want to output any signal at all (neither via HDMI, DVI nor DVI-&gt;VGA).</p><p>Since I&#039;m all out of ideas (reading and trying since 3 days almost fulltime now) I&#039;d like to ask for any further advice. The huge amount of posts I skimmed through in this thread usually seem to have get an error message when receiving no signal. I don&#039;t see anything problematic in dmesg and no output from qemu at all.</p><p>Here is my current setup which seems to work with the Nvidia card (removing the entries for 0000:01:00.1 in the vfio-bind script and the qemu call).</p></div></blockquote></div><p>When you switch from the Nvidia card to the Radeon, are you physically swapping them?&#160; If not I&#039;d suspect something with primary VGA or the nvidia driver getting in there and locking the VGA arbiter.&#160; If so, I dunno...</p> </div> <div class="postsignature postmsg"><hr /><p><a href="http://vfio.blogspot.com" rel="nofollow">http://vfio.blogspot.com</a><br />Looking for a more open forum to discuss vfio related uses?&#160; Try <a href="https://www.redhat.com/mailman/listinfo/vfio-users" rel="nofollow">https://www.redhat.com/mailman/listinfo/vfio-users</a></p></div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1480776">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1480782" class="blockpost rowodd"> <h2><span><span class="conr">#3484</span> <a href="viewtopic.php?pid=1480782#p1480782">2014-12-01 22:21:08</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=82730">sumpfmensch</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2014-06-13</span></dd> <dd><span>Posts: 2</span></dd> <dd class="usercontacts"><span class="email"><a href="misc.php?email=82730">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>aw wrote:</cite><blockquote><div><p>When you switch from the Nvidia card to the Radeon, are you physically swapping them?&#160; If not I&#039;d suspect something with primary VGA or the nvidia driver getting in there and locking the VGA arbiter.&#160; If so, I dunno...</p></div></blockquote></div><p>Yes, I shut down the machine, pull the card and the power connectors out and insert the other one. My Primary VGA is indeed the Intel card but I hoped I&#039;d have solved the arbiter problems with the kernel provided in post 1.</p><br /><p>Maybe the following is interesting, too:</p><p>When I boot the vm with an ubuntu live disk, the attached ATI card AND the default std ouput, lspci shows me that the ATI card is present ... While the radeon driver gets loaded assigned to the card, it is not activated by default. It does neither show up in the display settings not output anything. When I boot the linux image on bare metal, (with the Intel card set as primary) it was used for a second screen.</p><p>EDIT: I&#039;m using the -M pc currently since I have problems booting the image (&quot;no boot device&quot;) with q35<br />EDIT2: Ok - getting used to the different drive syntax for q35 - however i cannot get the radeon to output anything on the virtualized ubuntu. Already starting to consider switching to xen and starting all over again or even selling the card <img src="https://bbs.archlinux.org/img/smilies/hmm.png" width="15" height="15" alt="hmm" /> </p><p>Hope somebody can think of anything to try next.</p> <p class="postedit"><em>Last edited by sumpfmensch (2014-12-02 00:48:42)</em></p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1480782">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1480840" class="blockpost roweven"> <h2><span><span class="conr">#3485</span> <a href="viewtopic.php?pid=1480840#p1480840">2014-12-02 04:27:08</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=87052">consty</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2014-12-02</span></dd> <dd><span>Posts: 1</span></dd> <dd class="usercontacts"><span class="email"><a href="misc.php?email=87052">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>wikavalier wrote:</cite><blockquote><div><p>Hi all,</p><p>First of all, thank you a lot for the post. It is awesome and really well documented. 10/10.</p><p>Even me, with my rudimentary linux skills, I was able to make the passthrough to the KVM, after facing all kind of issues. Yes, I had all of them!.</p><p>- My box is a:<br />intel i7 <br />gigabyte mobo<br />nvidia gtx780<br />and the damn: <br />06:00.0 SATA controller: Marvell Technology Group Ltd. 88SE9230 PCIe SATA 6Gb/s Controller (rev 10)</p><p>- I am running:<br />Linux nexus2 3.17.2-1-mainline #1 SMP PREEMPT Mon Nov 24 17:50:40 CET 2014 x86_64 GNU/Linux</p><p>And when I activate intel_iommu=on, the raid6 which is partly held by the pcie-SATA marvell controller, stops working. So I have to decide whether I want vfio or my raid storage</p></div></blockquote></div><p>I was in the same boat as you with the marvell 9230. I found that booting with intel_iommu=on AND iommu=pt allowed me to passthrough hardware while still having access to my RAID controller.</p><p>I don&#039;t know if this causes any system instability or if I&#039;m just a special case where this works for only me.</p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1480840">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1480845" class="blockpost rowodd"> <h2><span><span class="conr">#3486</span> <a href="viewtopic.php?pid=1480845#p1480845">2014-12-02 06:08:25</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=86302">4kGamer</a></strong></dt> <dd class="usertitle"><strong>Banned</strong></dd> <dd><span>Registered: 2014-10-29</span></dd> <dd><span>Posts: 82</span></dd> <dd class="usercontacts"><span class="email"><a href="mailto:oktayaslantas@gmx.de">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <p>Hi, I&#160; wanna buy a new CPU and motherboard.</p><p>Bearing in mind, we get round about 15-20 % less performance in a VM, I&#039;d like to compensate that with stronger, better hardware. My guest OS is Windows 8.1 and I own a MSI GTX 980</p><p>I just bought the <strong>i7-4790k</strong> <a href="http://www.newegg.com/Product/Product.aspx?Item=N82E16819117369" rel="nofollow">http://www.newegg.com/Product/Product.a … 6819117369</a></p><p>But I am not 100 % sure I should stay with it (it&#039;s still sealed and I haven&#039;t decided on the motherboard yet)</p><p>There are two other interesting options:</p><p>the&#160; <strong>I7-5820K</strong> <a href="http://www.newegg.com/Product/Product.aspx?Item=N82E16819117402" rel="nofollow">http://www.newegg.com/Product/Product.a … 6819117402</a></p><p>and the <strong>I7-5930K</strong> <a href="http://www.newegg.com/Product/Product.aspx?Item=N82E16819117403" rel="nofollow">http://www.newegg.com/Product/Product.a … 6819117403</a></p><br /><p>I just don&#039;t know if it&#039;s worth going for the more expensive and more power hungry options. What would you guys do if we forget the cost for a moment? It&#039;s all about 4k gaming really</p> <p class="postedit"><em>Last edited by 4kGamer (2014-12-02 07:37:53)</em></p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1480845">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1480854" class="blockpost roweven"> <h2><span><span class="conr">#3487</span> <a href="viewtopic.php?pid=1480854#p1480854">2014-12-02 08:04:56</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=86321">thearcherblog</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2014-10-30</span></dd> <dd><span>Posts: 165</span></dd> <dd class="usercontacts"><span class="email"><a href="mailto:jjgarcianorway@gmail.com">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>4kGamer wrote:</cite><blockquote><div><p>Hi, I&#160; wanna buy a new CPU and motherboard.</p><p>Bearing in mind, we get round about 15-20 % less performance in a VM, I&#039;d like to compensate that with stronger, better hardware. My guest OS is Windows 8.1 and I own a MSI GTX 980</p><p>I just bought the <strong>i7-4790k</strong> <a href="http://www.newegg.com/Product/Product.aspx?Item=N82E16819117369" rel="nofollow">http://www.newegg.com/Product/Product.a … 6819117369</a></p><p>But I am not 100 % sure I should stay with it (it&#039;s still sealed and I haven&#039;t decided on the motherboard yet)</p><p>There are two other interesting options:</p><p>the&#160; <strong>I7-5820K</strong> <a href="http://www.newegg.com/Product/Product.aspx?Item=N82E16819117402" rel="nofollow">http://www.newegg.com/Product/Product.a … 6819117402</a></p><p>and the <strong>I7-5930K</strong> <a href="http://www.newegg.com/Product/Product.aspx?Item=N82E16819117403" rel="nofollow">http://www.newegg.com/Product/Product.a … 6819117403</a></p><br /><p>I just don&#039;t know if it&#039;s worth going for the more expensive and more power hungry options. What would you guys do if we forget the cost for a moment? It&#039;s all about 4k gaming really</p></div></blockquote></div><p>Hello,</p><p>To be honest I have a 4790k and the performance is really good. No problem at all.</p><p>I think the 4790k can be faster (and cheaper) for gaming and the other one probably is better for doing more multitasking (according to cores). Anyway, the clock is faster on 4790k.</p><p>About playing games with 4K resolution... is up to your graphic cards really and I&#039;m not expert on that <img src="https://bbs.archlinux.org/img/smilies/smile.png" width="15" height="15" alt="smile" /> But I guess that you probably need more than one if you really want it in Ultra mode <img src="https://bbs.archlinux.org/img/smilies/smile.png" width="15" height="15" alt="smile" /></p><p>So, my two cents... 4790K and a Z97 motherboard / X99 (check for vt-d support (I have the Extreme 6 Z97 with good results)) and use the internal IGP for host and two graphic cards for passthrough (two NVIDIA GTX 770 should be enough and I know for sure that works fine <img src="https://bbs.archlinux.org/img/smilies/smile.png" width="15" height="15" alt="smile" />).</p><p>I hope it helps <img src="https://bbs.archlinux.org/img/smilies/smile.png" width="15" height="15" alt="smile" /></p><p>Regards,</p><br /><p>TheArcher</p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1480854">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1480858" class="blockpost rowodd"> <h2><span><span class="conr">#3488</span> <a href="viewtopic.php?pid=1480858#p1480858">2014-12-02 08:50:14</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=86302">4kGamer</a></strong></dt> <dd class="usertitle"><strong>Banned</strong></dd> <dd><span>Registered: 2014-10-29</span></dd> <dd><span>Posts: 82</span></dd> <dd class="usercontacts"><span class="email"><a href="mailto:oktayaslantas@gmx.de">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <p>thanks a lot for your input! Really appreciated. Yeah, the i7-4790k is faster than the other ones. I think I will stick with it then. And thank you for suggesting a motherboard. I have seen so many that I don&#039;t know which one I should buy. But it&#039;s great to hear the ASRock Z97 EXTREME6 is doing a fine job in a VM. </p><p>One more question: what CPU cooler do you use? And are you happy with it?</p> <p class="postedit"><em>Last edited by 4kGamer (2014-12-02 08:50:26)</em></p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1480858">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1480867" class="blockpost roweven"> <h2><span><span class="conr">#3489</span> <a href="viewtopic.php?pid=1480867#p1480867">2014-12-02 09:56:55</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=86321">thearcherblog</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2014-10-30</span></dd> <dd><span>Posts: 165</span></dd> <dd class="usercontacts"><span class="email"><a href="mailto:jjgarcianorway@gmail.com">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>4kGamer wrote:</cite><blockquote><div><p>thanks a lot for your input! Really appreciated. Yeah, the i7-4790k is faster than the other ones. I think I will stick with it then. And thank you for suggesting a motherboard. I have seen so many that I don&#039;t know which one I should buy. But it&#039;s great to hear the ASRock Z97 EXTREME6 is doing a fine job in a VM. </p><p>One more question: what CPU cooler do you use? And are you happy with it?</p></div></blockquote></div><p>A pleasure if I helped you <img src="https://bbs.archlinux.org/img/smilies/smile.png" width="15" height="15" alt="smile" /></p><p>Is not the proper thread for this but, Noctua is a good brand for normal coolers. If you look for water cooling... H110 is a good one for non super geeks <img src="https://bbs.archlinux.org/img/smilies/smile.png" width="15" height="15" alt="smile" /></p><p>Anyway, it also depends of your case. In my case I chose a not too big one to have my computer at the living room. I have Noctua fans and I&#039;m happy about the noise but I think can be better results.</p><p>My idle temperatures are around 34C (room is near 20) and running the VM is around 37-38C.</p><p>When I play dragon age, graphic card goes to 80C and the computer is on 70-72C.</p><p>Can be better? yes. My though was to have the H110 but there was not enough room on my case for it.</p><p>I didn&#039;t notice any difference between running the VM or Windows as a baremetal to be honest.</p><p>I hope it helps <img src="https://bbs.archlinux.org/img/smilies/smile.png" width="15" height="15" alt="smile" /></p><p>Regards,</p><br /><p>TheArcher</p> <p class="postedit"><em>Last edited by thearcherblog (2014-12-02 10:05:17)</em></p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1480867">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1480870" class="blockpost rowodd"> <h2><span><span class="conr">#3490</span> <a href="viewtopic.php?pid=1480870#p1480870">2014-12-02 10:08:55</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=86302">4kGamer</a></strong></dt> <dd class="usertitle"><strong>Banned</strong></dd> <dd><span>Registered: 2014-10-29</span></dd> <dd><span>Posts: 82</span></dd> <dd class="usercontacts"><span class="email"><a href="mailto:oktayaslantas@gmx.de">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <p>I think I read somewhere about the h110. I will have a look into that. You have been really helpful. Now I can make some decisions <img src="https://bbs.archlinux.org/img/smilies/smile.png" width="15" height="15" alt="smile" /></p><p>thank you!</p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1480870">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1480871" class="blockpost roweven"> <h2><span><span class="conr">#3491</span> <a href="viewtopic.php?pid=1480871#p1480871">2014-12-02 10:36:38</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=86321">thearcherblog</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2014-10-30</span></dd> <dd><span>Posts: 165</span></dd> <dd class="usercontacts"><span class="email"><a href="mailto:jjgarcianorway@gmail.com">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>4kGamer wrote:</cite><blockquote><div><p>I think I read somewhere about the h110. I will have a look into that. You have been really helpful. Now I can make some decisions <img src="https://bbs.archlinux.org/img/smilies/smile.png" width="15" height="15" alt="smile" /></p><p>thank you!</p></div></blockquote></div><p>You welcome <img src="https://bbs.archlinux.org/img/smilies/smile.png" width="15" height="15" alt="smile" /></p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1480871">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1481008" class="blockpost rowodd"> <h2><span><span class="conr">#3492</span> <a href="viewtopic.php?pid=1481008#p1481008">2014-12-02 20:46:14</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=75590">aw</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2013-10-04</span></dd> <dd><span>Posts: 921</span></dd> <dd class="usercontacts"><span class="email"><a href="misc.php?email=75590">Email</a></span> <span class="website"><a href="http://vfio.blogspot.com/" rel="nofollow">Website</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>4kGamer wrote:</cite><blockquote><div><p>Hi, I&#160; wanna buy a new CPU and motherboard.</p></div></blockquote></div><p>Sounds like you&#039;re already committed to a pricey upgrade, but FWIW I decided to go a more mild route upgrading from the i5-3470T.&#160; I found my motherboard is compatible with a Xeon E3-1245v2, found a reasonable deal for one on ebay, and now I&#039;ve got 2x the cores and a 500MHz boost.&#160; Including a Cooler Master Hyper 212 Plus, I&#039;m in it for well below the price of an i7-4790k alone, and it seems to have enough juice to run Steam in-home-streaming with the GTX750 (4-cores for the VM, leaving 4 threads for the host).</p> </div> <div class="postsignature postmsg"><hr /><p><a href="http://vfio.blogspot.com" rel="nofollow">http://vfio.blogspot.com</a><br />Looking for a more open forum to discuss vfio related uses?&#160; Try <a href="https://www.redhat.com/mailman/listinfo/vfio-users" rel="nofollow">https://www.redhat.com/mailman/listinfo/vfio-users</a></p></div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1481008">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1481018" class="blockpost roweven"> <h2><span><span class="conr">#3493</span> <a href="viewtopic.php?pid=1481018#p1481018">2014-12-02 22:09:23</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=86302">4kGamer</a></strong></dt> <dd class="usertitle"><strong>Banned</strong></dd> <dd><span>Registered: 2014-10-29</span></dd> <dd><span>Posts: 82</span></dd> <dd class="usercontacts"><span class="email"><a href="mailto:oktayaslantas@gmx.de">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <p>yeah, but you know what you&#039;re doing <img src="https://bbs.archlinux.org/img/smilies/smile.png" width="15" height="15" alt="smile" /> I am just following guides without the knowledge <img src="https://bbs.archlinux.org/img/smilies/wink.png" width="15" height="15" alt="wink" /> Seriously, I am very grateful for your input and I am sure I will need it again once I get my new motherboard and run the new CPU. Hopefully towards the weekend <img src="https://bbs.archlinux.org/img/smilies/smile.png" width="15" height="15" alt="smile" /></p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1481018">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1481019" class="blockpost rowodd"> <h2><span><span class="conr">#3494</span> <a href="viewtopic.php?pid=1481019#p1481019">2014-12-02 22:30:23</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=87058">MatthiasArch</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2014-12-02</span></dd> <dd><span>Posts: 1</span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <p>Hi There!<br />I&#039;m very happy this thread exists as everything is working (more or less) out of the box <img src="https://bbs.archlinux.org/img/smilies/smile.png" width="15" height="15" alt="smile" /><br />I have an Intel i5 4670 on an ASRock B85M-ITX and a Gigabyte Nvidia GTX750TI.<br />Running Archlinux default</p><div class="codebox"><pre><code>Linux loewenbraeu 3.17.4-1-ARCH #1 SMP PREEMPT Fri Nov 21 21:14:42 CET 2014 x86_64 GNU/Linux</code></pre></div><p>with current arch qemu/kvm/libvirt with Windows 8.1 Pro as OVMF uefi booted guest and Nvidia card passed through. Everything works like a charm UNTIL I shut down the VM!</p><p>Then Hell kicks in:</p><div class="codebox"><pre class="vscroll"><code>[ 1164.246920] ------------[ cut here ]------------ [ 1164.246935] WARNING: CPU: 3 PID: 303 at drivers/gpu/drm/i915/i915_gem_gtt.c:1492 gen6_ggtt_insert_entries+0x146/0x150 [i915]() [ 1164.246936] Modules linked in: bluetooth msr cpufreq_stats tun fuse vfio_pci vfio_iommu_type1 vfio xt_CHECKSUM iptable_mangle ipt_MASQUERADE iptable_nat nf_nat_ipv4 nf_nat nf_conntrack_ipv4 nf_defrag_ipv4 xt_conntrack nf_conntrack ipt_REJECT xt_tcpudp iptable_filter ip_tables x_tables bridge stp llc nvram led_class joydev mousedev uas usb_storage snd_hda_codec_hdmi cfg80211 rfkill nct6775 hwmon_vid evdev iTCO_wdt mac_hid iTCO_vendor_support coretemp hwmon intel_rapl x86_pkg_temp_thermal intel_powerclamp snd_hda_codec_realtek kvm_intel snd_hda_codec_generic kvm crct10dif_pclmul crc32_pclmul ghash_clmulni_intel i915 aesni_intel aes_x86_64 lrw gf128mul glue_helper ablk_helper cryptd psmouse pcspkr drm_kms_helper serio_raw i2c_i801 alx drm snd_hda_intel mdio tpm_tis tpm snd_hda_controller snd_hda_codec [ 1164.246957] nuvoton_cir snd_hwdep intel_gtt rc_core snd_pcm video i2c_algo_bit battery button snd_timer mei_me i2c_core snd mei soundcore shpchp lpc_ich processor sch_fq_codel nfs lockd sunrpc fscache ext4 crc16 mbcache jbd2 hid_cherry hid_generic usbhid hid sd_mod crc_t10dif crct10dif_common ahci libahci atkbd libps2 ehci_pci xhci_hcd ehci_hcd crc32c_intel libata scsi_mod usbcore usb_common i8042 serio [ 1164.246975] CPU: 3 PID: 303 Comm: Xorg.bin Tainted: G O 3.17.4-1-ARCH #1 [ 1164.246976] Hardware name: To Be Filled By O.E.M. To Be Filled By O.E.M./B85M-ITX, BIOS P2.20 09/01/2014 [ 1164.246977] 0000000000000000 000000008bc678ec ffff8800a5cffc68 ffffffff81537b0e [ 1164.246978] 0000000000000000 ffff8800a5cffca0 ffffffff8107078d 00000000fc8c9000 [ 1164.246980] 00000000ffffffff ffffc9000598b424 ffff8800bb417a58 ffffc90005989100 [ 1164.246981] Call Trace: [ 1164.246985] [&lt;ffffffff81537b0e&gt;] dump_stack+0x4d/0x6f [ 1164.246988] [&lt;ffffffff8107078d&gt;] warn_slowpath_common+0x7d/0xa0 [ 1164.246989] [&lt;ffffffff810708ba&gt;] warn_slowpath_null+0x1a/0x20 [ 1164.246994] [&lt;ffffffffa0531786&gt;] gen6_ggtt_insert_entries+0x146/0x150 [i915] [ 1164.246999] [&lt;ffffffffa05309b9&gt;] ggtt_bind_vma+0xc9/0xf0 [i915] [ 1164.247005] [&lt;ffffffffa053b3cb&gt;] i915_gem_object_set_cache_level+0x29b/0x360 [i915] [ 1164.247009] [&lt;ffffffffa053b53d&gt;] i915_gem_set_caching_ioctl+0xad/0xf0 [i915] [ 1164.247015] [&lt;ffffffffa03affef&gt;] drm_ioctl+0x1df/0x680 [drm] [ 1164.247017] [&lt;ffffffff811da5f0&gt;] do_vfs_ioctl+0x2d0/0x4b0 [ 1164.247019] [&lt;ffffffff811e4cae&gt;] ? __fget+0x6e/0xb0 [ 1164.247021] [&lt;ffffffff811da851&gt;] SyS_ioctl+0x81/0xa0 [ 1164.247023] [&lt;ffffffff8153db29&gt;] system_call_fastpath+0x16/0x1b [ 1164.247024] ---[ end trace 59b5489690ced9e7 ]--- [ 1164.247025] ------------[ cut here ]------------ [ 1164.247030] WARNING: CPU: 3 PID: 303 at drivers/gpu/drm/i915/intel_uncore.c:47 assert_device_not_suspended.isra.7+0x43/0x50 [i915]() [ 1164.247031] Device suspended [ 1164.247032] Modules linked in: bluetooth msr cpufreq_stats tun fuse vfio_pci vfio_iommu_type1 vfio xt_CHECKSUM iptable_mangle ipt_MASQUERADE iptable_nat nf_nat_ipv4 nf_nat nf_conntrack_ipv4 nf_defrag_ipv4 xt_conntrack nf_conntrack ipt_REJECT xt_tcpudp iptable_filter ip_tables x_tables bridge stp llc nvram led_class joydev mousedev uas usb_storage snd_hda_codec_hdmi cfg80211 rfkill nct6775 hwmon_vid evdev iTCO_wdt mac_hid iTCO_vendor_support coretemp hwmon intel_rapl x86_pkg_temp_thermal intel_powerclamp snd_hda_codec_realtek kvm_intel snd_hda_codec_generic kvm crct10dif_pclmul crc32_pclmul ghash_clmulni_intel i915 aesni_intel aes_x86_64 lrw gf128mul glue_helper ablk_helper cryptd psmouse pcspkr drm_kms_helper serio_raw i2c_i801 alx drm snd_hda_intel mdio tpm_tis tpm snd_hda_controller snd_hda_codec [ 1164.247049] nuvoton_cir snd_hwdep intel_gtt rc_core snd_pcm video i2c_algo_bit battery button snd_timer mei_me i2c_core snd mei soundcore shpchp lpc_ich processor sch_fq_codel nfs lockd sunrpc fscache ext4 crc16 mbcache jbd2 hid_cherry hid_generic usbhid hid sd_mod crc_t10dif crct10dif_common ahci libahci atkbd libps2 ehci_pci xhci_hcd ehci_hcd crc32c_intel libata scsi_mod usbcore usb_common i8042 serio [ 1164.247061] CPU: 3 PID: 303 Comm: Xorg.bin Tainted: G W O 3.17.4-1-ARCH #1 [ 1164.247062] Hardware name: To Be Filled By O.E.M. To Be Filled By O.E.M./B85M-ITX, BIOS P2.20 09/01/2014 [ 1164.247062] 0000000000000000 000000008bc678ec ffff8800a5cffbc0 ffffffff81537b0e [ 1164.247064] ffff8800a5cffc08 ffff8800a5cffbf8 ffffffff8107078d ffff8800bb410000 [ 1164.247065] 0000000000101008 ffff8800bb410068 ffff8800bb417a58 0000000000000001 [ 1164.247067] Call Trace: [ 1164.247068] [&lt;ffffffff81537b0e&gt;] dump_stack+0x4d/0x6f [ 1164.247070] [&lt;ffffffff8107078d&gt;] warn_slowpath_common+0x7d/0xa0 [ 1164.247071] [&lt;ffffffff8107080c&gt;] warn_slowpath_fmt+0x5c/0x80 [ 1164.247077] [&lt;ffffffffa0556423&gt;] assert_device_not_suspended.isra.7+0x43/0x50 [i915] [ 1164.247082] [&lt;ffffffffa0559de7&gt;] hsw_write32+0x37/0x160 [i915] [ 1164.247086] [&lt;ffffffffa0531716&gt;] gen6_ggtt_insert_entries+0xd6/0x150 [i915] [ 1164.247091] [&lt;ffffffffa05309b9&gt;] ggtt_bind_vma+0xc9/0xf0 [i915] [ 1164.247096] [&lt;ffffffffa053b3cb&gt;] i915_gem_object_set_cache_level+0x29b/0x360 [i915] [ 1164.247100] [&lt;ffffffffa053b53d&gt;] i915_gem_set_caching_ioctl+0xad/0xf0 [i915] [ 1164.247104] [&lt;ffffffffa03affef&gt;] drm_ioctl+0x1df/0x680 [drm] [ 1164.247106] [&lt;ffffffff811da5f0&gt;] do_vfs_ioctl+0x2d0/0x4b0 [ 1164.247108] [&lt;ffffffff811e4cae&gt;] ? __fget+0x6e/0xb0 [ 1164.247109] [&lt;ffffffff811da851&gt;] SyS_ioctl+0x81/0xa0 [ 1164.247111] [&lt;ffffffff8153db29&gt;] system_call_fastpath+0x16/0x1b [ 1164.247112] ---[ end trace 59b5489690ced9e8 ]--- [ 1164.247114] [drm:hsw_unclaimed_reg_detect] *ERROR* Unclaimed register detected. Please use the i915.mmio_debug=1 to debug this problem. [ 1164.247115] ------------[ cut here ]------------ [ 1164.247120] WARNING: CPU: 3 PID: 303 at drivers/gpu/drm/i915/intel_uncore.c:47 assert_device_not_suspended.isra.7+0x43/0x50 [i915]() [ 1164.247120] Device suspended [ 1164.247121] Modules linked in: bluetooth msr cpufreq_stats tun fuse vfio_pci vfio_iommu_type1 vfio xt_CHECKSUM iptable_mangle ipt_MASQUERADE iptable_nat nf_nat_ipv4 nf_nat nf_conntrack_ipv4 nf_defrag_ipv4 xt_conntrack nf_conntrack ipt_REJECT xt_tcpudp iptable_filter ip_tables x_tables bridge stp llc nvram led_class joydev mousedev uas usb_storage snd_hda_codec_hdmi cfg80211 rfkill nct6775 hwmon_vid evdev iTCO_wdt mac_hid iTCO_vendor_support coretemp hwmon intel_rapl x86_pkg_temp_thermal intel_powerclamp snd_hda_codec_realtek kvm_intel snd_hda_codec_generic kvm crct10dif_pclmul crc32_pclmul ghash_clmulni_intel i915 aesni_intel aes_x86_64 lrw gf128mul glue_helper ablk_helper cryptd psmouse pcspkr drm_kms_helper serio_raw i2c_i801 alx drm snd_hda_intel mdio tpm_tis tpm snd_hda_controller snd_hda_codec [ 1164.247138] nuvoton_cir snd_hwdep intel_gtt rc_core snd_pcm video i2c_algo_bit battery button snd_timer mei_me i2c_core snd mei soundcore shpchp lpc_ich processor sch_fq_codel nfs lockd sunrpc fscache ext4 crc16 mbcache jbd2 hid_cherry hid_generic usbhid hid sd_mod crc_t10dif crct10dif_common ahci libahci atkbd libps2 ehci_pci xhci_hcd ehci_hcd crc32c_intel libata scsi_mod usbcore usb_common i8042 serio [ 1164.247150] CPU: 3 PID: 303 Comm: Xorg.bin Tainted: G W O 3.17.4-1-ARCH #1 [ 1164.247151] Hardware name: To Be Filled By O.E.M. To Be Filled By O.E.M./B85M-ITX, BIOS P2.20 09/01/2014 [ 1164.247151] 0000000000000000 000000008bc678ec ffff8800a5cffbb8 ffffffff81537b0e [ 1164.247153] ffff8800a5cffc00 ffff8800a5cffbf0 ffffffff8107078d ffff8800bb410068 [ 1164.247154] 0000000000101008 ffffc9000598b424 0000000000101008 ffff8800bb410000 [ 1164.247155] Call Trace: [ 1164.247157] [&lt;ffffffff81537b0e&gt;] dump_stack+0x4d/0x6f [ 1164.247158] [&lt;ffffffff8107078d&gt;] warn_slowpath_common+0x7d/0xa0 [ 1164.247160] [&lt;ffffffff8107080c&gt;] warn_slowpath_fmt+0x5c/0x80 [ 1164.247165] [&lt;ffffffffa0556423&gt;] assert_device_not_suspended.isra.7+0x43/0x50 [i915] [ 1164.247169] [&lt;ffffffffa05592d5&gt;] gen6_read32+0x35/0x150 [i915] [ 1164.247174] [&lt;ffffffffa0531729&gt;] gen6_ggtt_insert_entries+0xe9/0x150 [i915] [ 1164.247178] [&lt;ffffffffa05309b9&gt;] ggtt_bind_vma+0xc9/0xf0 [i915] [ 1164.247183] [&lt;ffffffffa053b3cb&gt;] i915_gem_object_set_cache_level+0x29b/0x360 [i915] [ 1164.247188] [&lt;ffffffffa053b53d&gt;] i915_gem_set_caching_ioctl+0xad/0xf0 [i915] [ 1164.247191] [&lt;ffffffffa03affef&gt;] drm_ioctl+0x1df/0x680 [drm] [ 1164.247193] [&lt;ffffffff811da5f0&gt;] do_vfs_ioctl+0x2d0/0x4b0 [ 1164.247195] [&lt;ffffffff811e4cae&gt;] ? __fget+0x6e/0xb0 [ 1164.247196] [&lt;ffffffff811da851&gt;] SyS_ioctl+0x81/0xa0 [ 1164.247198] [&lt;ffffffff8153db29&gt;] system_call_fastpath+0x16/0x1b [ 1164.247199] ---[ end trace 59b5489690ced9e9 ]--- [ 1164.248115] input: Logitech USB Gaming Mouse as /devices/pci0000:00/0000:00:14.0/usb3/3-3/3-3:1.0/0003:046D:C049.0007/input/input31 [ 1164.248166] hid-generic 0003:046D:C049.0007: input,hidraw2: USB HID v1.11 Mouse [Logitech USB Gaming Mouse] on usb-0000:00:14.0-3/input0 [ 1164.249614] hid-generic 0003:046D:C049.0008: hiddev0,hidraw3: USB HID v1.11 Device [Logitech USB Gaming Mouse] on usb-0000:00:14.0-3/input1 [ 1165.942981] kernel tried to execute NX-protected page - exploit attempt? (uid: 0) [ 1165.943032] BUG: unable to handle kernel paging request at ffff880045645000 [ 1165.943074] IP: [&lt;ffff880045645000&gt;] 0xffff880045645000 [ 1165.943108] PGD 2b2c067 PUD 80000000400001e3 [ 1165.943136] Oops: 0011 [#1] PREEMPT SMP [ 1165.943162] Modules linked in: bluetooth msr cpufreq_stats tun fuse vfio_pci vfio_iommu_type1 vfio xt_CHECKSUM iptable_mangle ipt_MASQUERADE iptable_nat nf_nat_ipv4 nf_nat nf_conntrack_ipv4 nf_defrag_ipv4 xt_conntrack nf_conntrack ipt_REJECT xt_tcpudp iptable_filter ip_tables x_tables bridge stp llc nvram led_class joydev mousedev uas usb_storage snd_hda_codec_hdmi cfg80211 rfkill nct6775 hwmon_vid evdev iTCO_wdt mac_hid iTCO_vendor_support coretemp hwmon intel_rapl x86_pkg_temp_thermal intel_powerclamp snd_hda_codec_realtek kvm_intel snd_hda_codec_generic kvm crct10dif_pclmul crc32_pclmul ghash_clmulni_intel i915 aesni_intel aes_x86_64 lrw gf128mul glue_helper ablk_helper cryptd psmouse pcspkr drm_kms_helper serio_raw i2c_i801 alx drm snd_hda_intel mdio tpm_tis tpm snd_hda_controller snd_hda_codec [ 1165.943620] nuvoton_cir snd_hwdep intel_gtt rc_core snd_pcm video i2c_algo_bit battery button snd_timer mei_me i2c_core snd mei soundcore shpchp lpc_ich processor sch_fq_codel nfs lockd sunrpc fscache ext4 crc16 mbcache jbd2 hid_cherry hid_generic usbhid hid sd_mod crc_t10dif crct10dif_common ahci libahci atkbd libps2 ehci_pci xhci_hcd ehci_hcd crc32c_intel libata scsi_mod usbcore usb_common i8042 serio [ 1165.943846] CPU: 0 PID: 464 Comm: libvirtd Tainted: G W O 3.17.4-1-ARCH #1 [ 1165.943894] Hardware name: To Be Filled By O.E.M. To Be Filled By O.E.M./B85M-ITX, BIOS P2.20 09/01/2014 [ 1165.943952] task: ffff88021acd4670 ti: ffff8802221e4000 task.ti: ffff8802221e4000 [ 1165.943998] RIP: 0010:[&lt;ffff880045645000&gt;] [&lt;ffff880045645000&gt;] 0xffff880045645000 [ 1165.944046] RSP: 0018:ffff8802221e7d70 EFLAGS: 00010286 [ 1165.944078] RAX: 0000000000000088 RBX: ffff880222b4d098 RCX: 0000000000000000 [ 1165.944121] RDX: ffff8802154dab88 RSI: ffff880222b4d098 RDI: ffff880222b4d098 [ 1165.944165] RBP: ffff8802221e7d90 R08: 0000000000000246 R09: ffffea00029e7c00 [ 1165.944208] R10: ffffffffa06c91b8 R11: 0000000000000000 R12: ffff880222b4d146 [ 1165.944251] R13: ffff880045645000 R14: 0000000000000000 R15: fffffffffffffff2 [ 1165.944295] FS: 00007f6c8235c780(0000) GS:ffff88022e200000(0000) knlGS:0000000000000000 [ 1165.944344] CS: 0010 DS: 0000 ES: 0000 CR0: 0000000080050033 [ 1165.944379] CR2: ffff880045645000 CR3: 000000021dcb2000 CR4: 00000000001407f0 [ 1165.944422] Stack: [ 1165.944434] ffffffff813b5772 ffff880222b4d098 ffff880222b4d098 0000000000000004 [ 1165.944480] ffff8802221e7dc0 ffffffff813b65c9 ffff880222b4d098 0000000000000004 [ 1165.944526] ffff880222b4d146 0000000000000246 ffff8802221e7df0 ffffffff813b6703 [ 1165.944573] Call Trace: [ 1165.944590] [&lt;ffffffff813b5772&gt;] ? __rpm_callback+0x32/0x70 [ 1165.944626] [&lt;ffffffff813b65c9&gt;] rpm_idle+0x259/0x340 [ 1165.944658] [&lt;ffffffff813b6703&gt;] __pm_runtime_idle+0x53/0x70 [ 1165.944695] [&lt;ffffffff812e6fd4&gt;] pci_device_remove+0x74/0xc0 [ 1165.944731] [&lt;ffffffff813aca4f&gt;] __device_release_driver+0x7f/0xf0 [ 1165.944770] [&lt;ffffffff813acae3&gt;] device_release_driver+0x23/0x30 [ 1165.944808] [&lt;ffffffff813ab82d&gt;] unbind_store+0xed/0x150 [ 1165.944842] [&lt;ffffffff813aaaa5&gt;] drv_attr_store+0x25/0x40 [ 1165.944877] [&lt;ffffffff8123ec7a&gt;] sysfs_kf_write+0x3a/0x50 [ 1165.944911] [&lt;ffffffff8123e1ee&gt;] kernfs_fop_write+0xee/0x180 [ 1165.944946] [&lt;ffffffff811c7967&gt;] vfs_write+0xb7/0x200 [ 1165.944978] [&lt;ffffffff811c85d9&gt;] SyS_write+0x59/0xd0 [ 1165.945010] [&lt;ffffffff8153db29&gt;] system_call_fastpath+0x16/0x1b [ 1165.945047] Code: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 &lt;00&gt; 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 [ 1165.945190] RIP [&lt;ffff880045645000&gt;] 0xffff880045645000 [ 1165.945224] RSP &lt;ffff8802221e7d70&gt; [ 1165.948044] CR2: ffff880045645000 [ 1165.969330] ---[ end trace 59b5489690ced9ea ]---</code></pre></div><p>This seems a little bit like those VGA arbitration missing issues - except that I thought to avoid that problematic with using UEFI in guest? The host archlinux is also booted using UEFI, CSM is disabled in bios. (Booting using CSM makes no difference, though).<br />nouveau is blacklisted and the nvidia card set to pci stub. Bootparams:</p><div class="codebox"><pre><code>intel_iommu=on pci-stub.ids=01:00.0,01:00.1</code></pre></div><p>After VM shutdown, lspci hangs forever, libvirt crashed and a system shutdown is not possible as some process hangs...</p><p>Any idea where to dig into?</p><p>Thanks a lot!</p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1481019">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1481021" class="blockpost roweven"> <h2><span><span class="conr">#3495</span> <a href="viewtopic.php?pid=1481021#p1481021">2014-12-02 22:43:19</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=75590">aw</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2013-10-04</span></dd> <dd><span>Posts: 921</span></dd> <dd class="usercontacts"><span class="email"><a href="misc.php?email=75590">Email</a></span> <span class="website"><a href="http://vfio.blogspot.com/" rel="nofollow">Website</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>MatthiasArch wrote:</cite><blockquote><div><div class="codebox"><pre><code>intel_iommu=on pci-stub.ids=01:00.0,01:00.1</code></pre></div></div></blockquote></div><p>Nak, pci-stub.ids takes vendor and device IDs, not bus address.</p> </div> <div class="postsignature postmsg"><hr /><p><a href="http://vfio.blogspot.com" rel="nofollow">http://vfio.blogspot.com</a><br />Looking for a more open forum to discuss vfio related uses?&#160; Try <a href="https://www.redhat.com/mailman/listinfo/vfio-users" rel="nofollow">https://www.redhat.com/mailman/listinfo/vfio-users</a></p></div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1481021">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1481075" class="blockpost rowodd"> <h2><span><span class="conr">#3496</span> <a href="viewtopic.php?pid=1481075#p1481075">2014-12-03 05:50:12</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=87064">kidchunks</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2014-12-03</span></dd> <dd><span>Posts: 6</span></dd> <dd class="usercontacts"><span class="email"><a href="misc.php?email=87064">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <p>I&#039;ve been cracking at this for about a week (off and on) and get stuck with the same problem on multiple setups. Before I talk about my problem, I tested the card by installing windows 8.1 on the host and everything worked fine.</p><p>Hardware Specs:</p><p>Test 1:<br />Mobo: Supermicro X8DAH+-F<br />CPU: Xeon X5670<br />Video Card: Sapphire r9 290x Tri-X OC<br />OS: Debian Wheezy with latest kernel release from alex william and qemu-kvm from wheezy backports (v2.1)</p><p>Test 2:<br />Same hardware as above<br />OS: Ubuntu 14.04 LTS (everything stock)</p><p>Now, I&#039;ve done all the necessary changes from post 1 (vfio binding, kernel command, stubbing and etc). I didn&#039;t do any patches given I don&#039;t think I need them.</p><p>Using the following to launch start the VM:</p><div class="codebox"><pre><code>qemu-system-x86_64 -enable-kvm -M q35 -m 4096 -cpu host -smp 8,sockets=1,cores=8,threads=1 \ -bios /usr/share/seabios/bios.bin -vga none -rtc base=localtime -device ioh3420,bus=pcie.0,addr=1c.0,multifunction=on,port=1,chassis=1,id=root.1 \ -device vfio-pci,host=85:00.0,bus=root.1,addr=00.0,multifunction=on,x-vga=on \ -device vfio-pci,host=85:00.1,bus=root.1,addr=00.1 \ -drive file=/root/win7.img,cache=none,if=virtio \ -cdrom /root/win7.iso \ -usb -usbdevice host:046d:c068 \ -no-reboot </code></pre></div><p>Devices:<br />85:00.0 &lt;-- video card<br />85:00.1 &lt;-- audio for card</p><p>When I start the VM, I can install the OS no problem through a monitor connected to the video card (no drivers installed). As soon as I install the drivers (any catalyst driver! I tested 13.12 through 14.11.2).</p><p>I get the following after the start screen (window logo):</p><div class="codebox"><pre><code>vfio-pci 0000:85:00.0: irq 89 for MSI/MSI-X</code></pre></div><p><em>the irq number changes each time</em></p><p>Immediately following that message..the VM process is killed. I tested both windows 7 and windows 8.1..same issue.</p><p>I&#039;m not sure how to trouble this because dmesg doesn&#039;t provide anything other than the irq message. I&#039;ve also tried searching this thread but seems no one has run into this edge case.</p><p>If anyone has any ideas, let me know! <img src="https://bbs.archlinux.org/img/smilies/smile.png" width="15" height="15" alt="smile" /></p><p>EDIT: Updated error message</p> <p class="postedit"><em>Last edited by kidchunks (2014-12-03 14:53:32)</em></p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1481075">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1481085" class="blockpost roweven"> <h2><span><span class="conr">#3497</span> <a href="viewtopic.php?pid=1481085#p1481085">2014-12-03 07:30:50</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=82442">slis</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2014-06-02</span></dd> <dd><span>Posts: 125</span></dd> <dd class="usercontacts"><span class="email"><a href="mailto:xslisx@gmail.com">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <p>try without -device vfio-pci,host=85:00.1,bus=root.1,addr=00.1 \ ?<br />i don&#039;t have amd, but reading this thread i think you need to remove amd audio device</p><p>edit: and try 440fx chipset not q35</p> <p class="postedit"><em>Last edited by slis (2014-12-03 10:57:11)</em></p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1481085">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1481100" class="blockpost rowodd"> <h2><span><span class="conr">#3498</span> <a href="viewtopic.php?pid=1481100#p1481100">2014-12-03 09:27:52</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=80387">dwe11er</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2014-03-18</span></dd> <dd><span>Posts: 73</span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>slis wrote:</cite><blockquote><div><p>try without -device vfio-pci,host=85:00.1,bus=root.1,addr=00.1 \ ?<br />i don&#039;t have amd, but reading this thread i think you need to remove amd audio device</p><p>edit: and try fx440 chipset not q35</p></div></blockquote></div><p>It actually depends on card (or maybe mobo&#039;s ACPI?). My HD7870 works fine with HD Audio assigned as function 0x1 on 440FX.</p> <p class="postedit"><em>Last edited by dwe11er (2014-12-03 09:29:11)</em></p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1481100">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1481101" class="blockpost roweven"> <h2><span><span class="conr">#3499</span> <a href="viewtopic.php?pid=1481101#p1481101">2014-12-03 09:41:04</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=85314">Duelist</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2014-09-22</span></dd> <dd><span>Posts: 358</span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>aw wrote:</cite><blockquote><div><div class="quotebox"><cite>4kGamer wrote:</cite><blockquote><div><p>Hi, I&#160; wanna buy a new CPU and motherboard.</p></div></blockquote></div><p>Sounds like you&#039;re already committed to a pricey upgrade, but FWIW I decided to go a more mild route upgrading from the i5-3470T.&#160; I found my motherboard is compatible with a Xeon E3-1245v2, found a reasonable deal for one on ebay, and now I&#039;ve got 2x the cores and a 500MHz boost.&#160; Including a Cooler Master Hyper 212 Plus, I&#039;m in it for well below the price of an i7-4790k alone, and it seems to have enough juice to run Steam in-home-streaming with the GTX750 (4-cores for the VM, leaving 4 threads for the host).</p></div></blockquote></div><p>You do know that xeon lacks integrated video core. <br />He may be needing it to get host output. However, sometimes buying a cheap-as-cardboard GT610 can be more profitable than buying i7 for integrated video.</p><p>Whoa, just noted that this post is #3499.</p> <p class="postedit"><em>Last edited by Duelist (2014-12-03 12:46:49)</em></p> </div> <div class="postsignature postmsg"><hr /><p><span class="bbs">The forum rules prohibit requesting support for distributions other than arch.</span><br /><a href="https://bbs.archlinux.org/viewtopic.php?pid=1551460#p1551460" rel="nofollow">I gave up.</a><a href="https://bbs.archlinux.org/viewtopic.php?id=162768" rel="nofollow"> It was too late.</a><br /><a href="http://pastebin.com/B3fL84bq" rel="nofollow">What I was trying to do</a>.<br /><a href="http://vfio.blogspot.com/" rel="nofollow">The reference about VFIO and KVM VGA passthrough.</a></p></div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1481101">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1481162" class="blockpost rowodd"> <h2><span><span class="conr">#3500</span> <a href="viewtopic.php?pid=1481162#p1481162">2014-12-03 13:40:04</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=75590">aw</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2013-10-04</span></dd> <dd><span>Posts: 921</span></dd> <dd class="usercontacts"><span class="email"><a href="misc.php?email=75590">Email</a></span> <span class="website"><a href="http://vfio.blogspot.com/" rel="nofollow">Website</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>Duelist wrote:</cite><blockquote><div><p>You do know that xeon lacks integrated video core. <br />He may be needing it to get host output. However, sometimes buying a cheap-as-cardboard GT610 can be more profitable than buying i7 for integrated video.</p><p>Whoa, just noted that this post is #3499.</p></div></blockquote></div><p>Check ark, E3-1245v2 has HD P4000 video.</p> </div> <div class="postsignature postmsg"><hr /><p><a href="http://vfio.blogspot.com" rel="nofollow">http://vfio.blogspot.com</a><br />Looking for a more open forum to discuss vfio related uses?&#160; Try <a href="https://www.redhat.com/mailman/listinfo/vfio-users" rel="nofollow">https://www.redhat.com/mailman/listinfo/vfio-users</a></p></div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1481162">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div class="postlinksb"> <div class="inbox crumbsplus"> <div class="pagepost"> <p class="pagelink conl"><span class="pages-label">Pages: </span><a rel="prev" class="item1" href="viewtopic.php?id=162768&amp;p=139">Previous</a> <a href="viewtopic.php?id=162768">1</a> <span class="spacer">…</span> <a href="viewtopic.php?id=162768&amp;p=138">138</a> <a href="viewtopic.php?id=162768&amp;p=139">139</a> <strong>140</strong> <a href="viewtopic.php?id=162768&amp;p=141">141</a> <a href="viewtopic.php?id=162768&amp;p=142">142</a> <span class="spacer">…</span> <a href="viewtopic.php?id=162768&amp;p=234">234</a> <a rel="next" href="viewtopic.php?id=162768&amp;p=141">Next</a></p> <p class="postlink conr">Topic closed</p> </div> <ul class="crumbs"> <li><a href="index.php">Index</a></li> <li><span>»&#160;</span><a href="viewforum.php?id=48">Topics Going Nowhere</a></li> <li><span>»&#160;</span><strong><a href="viewtopic.php?id=162768">KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</a></strong></li> </ul> <p class="subscribelink clearb"><a href="misc.php?action=subscribe&amp;tid=162768">Subscribe to this topic</a></p> <div class="clearer"></div> </div> </div> </div> <div id="brdfooter" class="block"> <h2><span>Board footer</span></h2> <div class="box"> <div id="brdfooternav" class="inbox"> <div class="conl"> <form id="qjump" method="get" action="viewforum.php"> <div><label><span>Jump to<br /></span> <select name="id" onchange="window.location=('viewforum.php?id='+this.options[this.selectedIndex].value)"> <optgroup label="Technical Issues and Assistance"> <option value="23">Newbie Corner</option> <option value="17">Installation</option> <option value="22">Kernel &amp; Hardware</option> <option value="18">Applications &amp; Desktop Environments</option> <option value="31">Laptop Issues</option> <option value="8">Networking, Server, and Protection</option> <option value="32">Multimedia and Games</option> <option value="50">System Administration</option> <option value="35">Other Architectures</option> </optgroup> <optgroup label="Arch-centric"> <option value="24">Announcements, Package &amp; Security Advisories</option> <option value="1">Arch Discussion</option> <option value="13">Forum &amp; Wiki discussion</option> </optgroup> <optgroup label="Pacman Upgrades, Packaging &amp; AUR"> <option value="44">Pacman &amp; Package Upgrade Issues</option> <option value="49">[testing] Repo Forum</option> <option value="4">Creating &amp; Modifying Packages</option> <option value="38">AUR Issues, Discussion &amp; PKGBUILD Requests</option> </optgroup> <optgroup label="Contributions &amp; Discussion"> <option value="20">GNU/Linux Discussion</option> <option value="27">Community Contributions</option> <option value="33">Programming &amp; Scripting</option> <option value="30">Other Languages</option> <option value="47">Artwork and Screenshots</option> <option value="42">Try This</option> </optgroup> <optgroup label="/dev/null"> <option value="29">Off-Topic</option> <option value="48" selected="selected">Topics Going Nowhere</option> <option value="36">Dustbin</option> </optgroup> </select></label> <input type="submit" value=" Go " accesskey="g" /> </div> </form> </div> <div class="conr"> <p id="feedlinks"><span class="atom"><a href="extern.php?action=feed&amp;tid=162768&amp;type=atom">Atom topic feed</a></span></p> <p id="poweredby">Powered by <a href="http://fluxbb.org/">FluxBB</a></p> </div> <div class="clearer"></div> </div> </div> </div> </div> <div class="end-box"></div> </div> </body> </html>
