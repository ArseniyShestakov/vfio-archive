<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"> <html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en" dir="ltr"> <head> <meta http-equiv="Content-Type" content="text/html; charset=utf-8" /> <title>KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9 (Page 16) / Topics Going Nowhere / Arch Linux Forums</title> <link rel="stylesheet" type="text/css" href="style/ArchLinux.css" /> <link rel="canonical" href="viewtopic.php?id=162768&amp;p=16" title="Page 16" /> <link rel="prev" href="viewtopic.php?id=162768&amp;p=15" title="Page 15" /> <link rel="next" href="viewtopic.php?id=162768&amp;p=17" title="Page 17" /> <link rel="alternate" type="application/atom+xml" href="extern.php?action=feed&amp;tid=162768&amp;type=atom" title="Atom topic feed" /> <link rel="stylesheet" media="screen" href="style/ArchLinux/arch.css?v=3" /> <link rel="stylesheet" media="screen" href="style/ArchLinux/archnavbar.css?v=2" /> <link rel="shortcut icon" href="style/ArchLinux/favicon.ico" /> </head> <body> <div id="archnavbar" class="anb-forum"> <div id="archnavbarlogo"><h1><a href="http://www.archlinux.org/">Arch Linux</a></h1></div> <div id="archnavbarmenu"> <ul id="archnavbarlist"> <li id="anb-home"><a href="http://www.archlinux.org/">Home</a></li><li id="anb-packages"><a href="http://www.archlinux.org/packages/">Packages</a></li><li id="anb-forums" class="anb-selected"><a href="https://bbs.archlinux.org/">Forums</a></li><li id="anb-wiki"><a href="https://wiki.archlinux.org/">Wiki</a></li><li id="anb-bugs"><a href="https://bugs.archlinux.org/">Bugs</a></li><li id="anb-aur"><a href="https://aur.archlinux.org/">AUR</a></li><li id="anb-download"><a href="http://www.archlinux.org/download/">Download</a></li> </ul> </div> </div> <div id="punviewtopic" class="pun"> <div class="top-box"></div> <div class="punwrap"> <div id="brdheader" class="block"> <div class="box"> <div id="brdmenu" class="inbox"> <ul> <li id="navindex" class="isactive"><a href="index.php">Index</a></li> <li id="navuserlist"><a href="userlist.php">User list</a></li> <li id="navsearch"><a href="search.php">Search</a></li> <li id="navprofile"><a href="profile.php?id=80749">Profile</a></li> <li id="navlogout"><a href="login.php?action=out&amp;id=80749&amp;csrf_token=5c20501ec397bb45ef8ee8c84db232c8d8e421c6">Logout</a></li> </ul> </div> <div id="brdwelcome" class="inbox"> <ul class="conl"> <li><span>Logged in as <strong>SXX</strong></span></li> <li><span>Last visit: 2015-08-16 12:20:09</span></li> </ul> <ul class="conr"> <li><span>Topics: <a href="search.php?action=show_replies" title="Find topics you have posted to.">Posted</a> | <a href="search.php?action=show_new" title="Find topics with new posts since your last visit.">New</a> | <a href="search.php?action=show_recent" title="Find topics with recent posts.">Active</a> | <a href="search.php?action=show_unanswered" title="Find topics with no replies.">Unanswered</a></span></li> </ul> <div class="clearer"></div> </div> </div> </div> <div id="brdmain"> <div class="linkst"> <div class="inbox crumbsplus"> <ul class="crumbs"> <li><a href="index.php">Index</a></li> <li><span>»&#160;</span><a href="viewforum.php?id=48">Topics Going Nowhere</a></li> <li><span>»&#160;</span><strong><a href="viewtopic.php?id=162768">KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</a></strong></li> </ul> <div class="pagepost"> <p class="pagelink conl"><span class="pages-label">Pages: </span><a rel="prev" class="item1" href="viewtopic.php?id=162768&amp;p=15">Previous</a> <a href="viewtopic.php?id=162768">1</a> <span class="spacer">…</span> <a href="viewtopic.php?id=162768&amp;p=14">14</a> <a href="viewtopic.php?id=162768&amp;p=15">15</a> <strong>16</strong> <a href="viewtopic.php?id=162768&amp;p=17">17</a> <a href="viewtopic.php?id=162768&amp;p=18">18</a> <span class="spacer">…</span> <a href="viewtopic.php?id=162768&amp;p=234">234</a> <a rel="next" href="viewtopic.php?id=162768&amp;p=17">Next</a></p> <p class="postlink conr">Topic closed</p> </div> <div class="clearer"></div> </div> </div> <div id="p1306236" class="blockpost rowodd blockpost1"> <h2><span><span class="conr">#376</span> <a href="viewtopic.php?pid=1306236#p1306236">2013-07-31 09:21:07</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=73593">BulliteShot</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2013-07-28</span></dd> <dd><span>Posts: 26</span></dd> <dd class="usercontacts"><span class="email"><a href="mailto:josh@servebyte.com">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>nbhs wrote:</cite><blockquote><div><div class="quotebox"><cite>BulliteShot wrote:</cite><blockquote><div><p>Driver installed is 12.104.0.0 along with Catalyst 13.4 and I&#039;m using Windows 7 in the VM. I&#039;ll mess around with the drivers and see if it likes the BETA or 12.10 versions.</p><p>Windows boots fine with the standard driver, but thats not much better than the standard VGA in Qemu to be honest <img src="https://bbs.archlinux.org/img/smilies/tongue.png" width="15" height="15" alt="tongue" /></p></div></blockquote></div><p>Try catalyst 12.10, works for me</p></div></blockquote></div><p>I&#039;ve tried 12.10, 13.4 and 13.6 BETA... no luck. Tried passing the VGA BIOS through too, but no luck there either <img src="https://bbs.archlinux.org/img/smilies/hmm.png" width="15" height="15" alt="hmm" /></p><p>Edit: We really need a list of hardware combinations which is confirmed to be working.</p> <p class="postedit"><em>Last edited by BulliteShot (2013-07-31 11:22:17)</em></p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1306236">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1306263" class="blockpost roweven"> <h2><span><span class="conr">#377</span> <a href="viewtopic.php?pid=1306263#p1306263">2013-07-31 11:53:21</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=71752">Diggo</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd class="postavatar"><img src="https://bbs.archlinux.org/img/avatars/71752.jpg?m=1375869480" width="80" height="80" alt="" /></dd> <dd><span>Registered: 2013-05-29</span></dd> <dd><span>Posts: 11</span></dd> <dd class="usercontacts"><span class="email"><a href="misc.php?email=71752">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <p>I updated my system, which resulted in a nonworking DomU <img src="https://bbs.archlinux.org/img/smilies/hmm.png" width="15" height="15" alt="hmm" /><br />Guess that´s the point where i throw away my old approach with pci-stub and the unpatched system. I am going to try vfio-vga and report my story :-)</p><p>@Bullite: So you´re setup was already working? I´d like to take your mobo into my list of vt-d hardware (*edit: sorry i missed the part with ati bsod*). But i am interested in collecting working combinations also.</p> <p class="postedit"><em>Last edited by Diggo (2013-07-31 11:53:59)</em></p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1306263">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1306264" class="blockpost rowodd"> <h2><span><span class="conr">#378</span> <a href="viewtopic.php?pid=1306264#p1306264">2013-07-31 11:59:44</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=73593">BulliteShot</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2013-07-28</span></dd> <dd><span>Posts: 26</span></dd> <dd class="usercontacts"><span class="email"><a href="mailto:josh@servebyte.com">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <p>It &quot;works&quot; using the old pci-attach without vfio. I seem to experience random BSOD of the VM due to the ATI driver... and then because it crashed without being able to eject the graphics card, the reset crashes the entire system.</p><p>That&#039;s why I would like to upgrade to hardware that works using this new vfio method.</p><p>My hardware is listed a few packages back.</p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1306264">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1306265" class="blockpost roweven"> <h2><span><span class="conr">#379</span> <a href="viewtopic.php?pid=1306265#p1306265">2013-07-31 12:02:37</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=71752">Diggo</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd class="postavatar"><img src="https://bbs.archlinux.org/img/avatars/71752.jpg?m=1375869480" width="80" height="80" alt="" /></dd> <dd><span>Registered: 2013-05-29</span></dd> <dd><span>Posts: 11</span></dd> <dd class="usercontacts"><span class="email"><a href="misc.php?email=71752">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <p>Ok i noted it here (http://www.techdudes.de/752/iommu-und-vt-d-taugliche-hardware/ - it´s german *g* so maybe it is not that useful for you). I haven´t read a lot in the last moths on vfio, what´s the major advantage over pci-attach?</p> <p class="postedit"><em>Last edited by Diggo (2013-07-31 12:05:14)</em></p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1306265">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1306273" class="blockpost rowodd"> <h2><span><span class="conr">#380</span> <a href="viewtopic.php?pid=1306273#p1306273">2013-07-31 12:53:01</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=73593">BulliteShot</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2013-07-28</span></dd> <dd><span>Posts: 26</span></dd> <dd class="usercontacts"><span class="email"><a href="mailto:josh@servebyte.com">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>Diggo wrote:</cite><blockquote><div><p>Ok i noted it here (http://www.techdudes.de/752/iommu-und-vt-d-taugliche-hardware/ - it´s german *g* so maybe it is not that useful for you). I haven´t read a lot in the last moths on vfio, what´s the major advantage over pci-attach?</p></div></blockquote></div><p>The vfio-reset patch and BIOS-level access from the VGA are the only advantages I am aware of.</p><p>If there was a similar fix for pci-attach then i&#039;d be happy</p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1306273">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1306362" class="blockpost roweven"> <h2><span><span class="conr">#381</span> <a href="viewtopic.php?pid=1306362#p1306362">2013-07-31 17:18:30</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=73558">mukiex</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2013-07-27</span></dd> <dd><span>Posts: 18</span></dd> <dd class="usercontacts"><span class="email"><a href="mailto:mukisign@gmail.com">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>nbhs wrote:</cite><blockquote><div><p>Try catalyst 12.10, works for me</p></div></blockquote></div><p>Thanks for the heads up on blacklisting the Intel driver, it worked!</p><p>I&#039;m getting a blue screen on windows loads up like many other people. Tried catalyst 12.10. Gonna try 12-6 as it&#039;s still after my card&#039;s release date, but I don&#039;t have high points. &#039;bout to knock out, I&#039;ll update you guys when it&#039;s done. Thankfully, being on ZFS makes rolling back to a pre-driver Windows install pretty trivial.</p><p>Edit note: Yep, bluescreen on atikmpag.sys , same on Catalyst 12.10 or 12.6</p> <p class="postedit"><em>Last edited by mukiex (2013-07-31 17:26:45)</em></p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1306362">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1306401" class="blockpost rowodd"> <h2><span><span class="conr">#382</span> <a href="viewtopic.php?pid=1306401#p1306401">2013-07-31 18:36:45</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=73593">BulliteShot</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2013-07-28</span></dd> <dd><span>Posts: 26</span></dd> <dd class="usercontacts"><span class="email"><a href="mailto:josh@servebyte.com">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>mukiex wrote:</cite><blockquote><div><div class="quotebox"><cite>nbhs wrote:</cite><blockquote><div><p>Try catalyst 12.10, works for me</p></div></blockquote></div><p>Thanks for the heads up on blacklisting the Intel driver, it worked!</p><p>I&#039;m getting a blue screen on windows loads up like many other people. Tried catalyst 12.10. Gonna try 12-6 as it&#039;s still after my card&#039;s release date, but I don&#039;t have high points. &#039;bout to knock out, I&#039;ll update you guys when it&#039;s done. Thankfully, being on ZFS makes rolling back to a pre-driver Windows install pretty trivial.</p><p>Edit note: Yep, bluescreen on atikmpag.sys , same on Catalyst 12.10 or 12.6</p></div></blockquote></div><p>I (was) pretty sure this was because we were using Intel Graphics on the host... but i&#039;ve disabled Intel Graphics in the BIOS and tried with a 2nd radeon card and I&#039;m seeing the same BSOD. Now I have no idea what the problem could be.</p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1306401">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1306421" class="blockpost roweven"> <h2><span><span class="conr">#383</span> <a href="viewtopic.php?pid=1306421#p1306421">2013-07-31 19:10:25</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=70922">nbhs</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd class="postavatar"><img src="https://bbs.archlinux.org/img/avatars/70922.jpg?m=1367773811" width="80" height="80" alt="" /></dd> <dd><span>From: Montevideo, Uruguay</span></dd> <dd><span>Registered: 2013-05-02</span></dd> <dd><span>Posts: 402</span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <p>have you guys tried installing only the driver without the hdmi driver and amd control panel? you could also try playing with the intel_iommu= options</p> <p class="postedit"><em>Last edited by nbhs (2013-07-31 19:12:06)</em></p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1306421">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1306633" class="blockpost rowodd"> <h2><span><span class="conr">#384</span> <a href="viewtopic.php?pid=1306633#p1306633">2013-08-01 10:59:30</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=73558">mukiex</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2013-07-27</span></dd> <dd><span>Posts: 18</span></dd> <dd class="usercontacts"><span class="email"><a href="mailto:mukisign@gmail.com">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <p>Hey nbhs. Just to make sure, are there any drivers we need to install that would improve things before doing Catalyst? Is there a specific method?</p><p>Right now I&#039;m installing catalyst by letting the installer extract (and closing it), and then right-clicking the VGA device, and pointing &quot;update driver&quot; to that installation folder. Is there a more in-depth method?</p><p>Quick note for searchability: It&#039;s the issue with atikmpag.sys ending with timestamp 51ae5d89</p><p>I&#039;ll let you guys know if I find a solution.</p> <p class="postedit"><em>Last edited by mukiex (2013-08-01 13:24:53)</em></p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1306633">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1306681" class="blockpost roweven"> <h2><span><span class="conr">#385</span> <a href="viewtopic.php?pid=1306681#p1306681">2013-08-01 13:33:45</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=70922">nbhs</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd class="postavatar"><img src="https://bbs.archlinux.org/img/avatars/70922.jpg?m=1367773811" width="80" height="80" alt="" /></dd> <dd><span>From: Montevideo, Uruguay</span></dd> <dd><span>Registered: 2013-05-02</span></dd> <dd><span>Posts: 402</span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>mukiex wrote:</cite><blockquote><div><p>Hey nbhs. Just to make sure, are there any drivers we need to install that would improve things before doing Catalyst? Is there a specific method?</p><p>Right now I&#039;m installing catalyst by letting the installer extract (and closing it), and then right-clicking the VGA device, and pointing &quot;update driver&quot; to that installation folder. Is there a more in-depth method?</p><p>Quick note for searchability: It&#039;s the issue with atikmpag.sys ending with timestamp 51ae5d89</p><p>I&#039;ll let you guys know if I find a solution.</p></div></blockquote></div><p>Nope, no driver needed, all i did was run the catalyst installer then rebooted</p><p>EDIT: have you tried playing with the intel_iommu= options like i mentioned? for example intel_iommu=pt,igfx_off</p> <p class="postedit"><em>Last edited by nbhs (2013-08-01 13:38:07)</em></p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1306681">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1306691" class="blockpost rowodd"> <h2><span><span class="conr">#386</span> <a href="viewtopic.php?pid=1306691#p1306691">2013-08-01 13:55:12</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=73558">mukiex</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2013-07-27</span></dd> <dd><span>Posts: 18</span></dd> <dd class="usercontacts"><span class="email"><a href="mailto:mukisign@gmail.com">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <p>Haven&#039;t tried intel_iommu=pt, but I&#039;ve tried both igfx_ options. I&#039;ll let you know what my results are.</p><p>Result: With intel_iommu=pt , iommu_group disappears</p><div class="codebox"><pre><code>cannot access /sys/bus/pci/devices/0000:01:00.0/iommu_group/devices: No such file or directory</code></pre></div> <p class="postedit"><em>Last edited by mukiex (2013-08-01 14:04:46)</em></p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1306691">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1306694" class="blockpost roweven"> <h2><span><span class="conr">#387</span> <a href="viewtopic.php?pid=1306694#p1306694">2013-08-01 14:05:06</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=73593">BulliteShot</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2013-07-28</span></dd> <dd><span>Posts: 26</span></dd> <dd class="usercontacts"><span class="email"><a href="mailto:josh@servebyte.com">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <p>It seems that only &quot;locked&quot; Intel processors support IOMMU which means no overclocking.</p><p>Can AMD processors overclock aswell as enabling IOMMU?</p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1306694">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1306699" class="blockpost rowodd"> <h2><span><span class="conr">#388</span> <a href="viewtopic.php?pid=1306699#p1306699">2013-08-01 14:22:43</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=73558">mukiex</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2013-07-27</span></dd> <dd><span>Posts: 18</span></dd> <dd class="usercontacts"><span class="email"><a href="mailto:mukisign@gmail.com">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <p>Hey BulliteShot: Indeed, that is the case. I own a 2nd i5 because of that ^_^</p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1306699">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1306717" class="blockpost roweven"> <h2><span><span class="conr">#389</span> <a href="viewtopic.php?pid=1306717#p1306717">2013-08-01 15:16:16</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=70922">nbhs</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd class="postavatar"><img src="https://bbs.archlinux.org/img/avatars/70922.jpg?m=1367773811" width="80" height="80" alt="" /></dd> <dd><span>From: Montevideo, Uruguay</span></dd> <dd><span>Registered: 2013-05-02</span></dd> <dd><span>Posts: 402</span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>BulliteShot wrote:</cite><blockquote><div><p>It seems that only &quot;locked&quot; Intel processors support IOMMU which means no overclocking.</p><p>Can AMD processors overclock aswell as enabling IOMMU?</p></div></blockquote></div><p>Yeah IOMMU support is only required on the mobo on amd systems, i own a bulldozer 8120 black box with unlocked multiplier, i can get it to 4.6ghz stable on a closed loop water system</p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1306717">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1306721" class="blockpost rowodd"> <h2><span><span class="conr">#390</span> <a href="viewtopic.php?pid=1306721#p1306721">2013-08-01 15:39:08</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=73575">pcworld</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>From: Germany</span></dd> <dd><span>Registered: 2013-07-28</span></dd> <dd><span>Posts: 6</span></dd> <dd class="usercontacts"><span class="email"><a href="mailto:0188801@gmail.com">Email</a></span> <span class="website"><a href="https://twitter.com/pcworldsoftware" rel="nofollow">Website</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>jgott wrote:</cite><blockquote><div><p>Like you, my ASUS motherboard has a broken IVRS table (with precisely the same wrong values as yours, apparently). In addition to overriding it in the kernel, …</p></div></blockquote></div><p>How to do that? I&#039;m considering buying an &quot;ASUS M5A97 Evo R2.0&quot;, however I would still like to be able to use IOMMU if that board suffers from the same issue.</p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1306721">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1306726" class="blockpost roweven"> <h2><span><span class="conr">#391</span> <a href="viewtopic.php?pid=1306726#p1306726">2013-08-01 16:00:49</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=73593">BulliteShot</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2013-07-28</span></dd> <dd><span>Posts: 26</span></dd> <dd class="usercontacts"><span class="email"><a href="mailto:josh@servebyte.com">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>mukiex wrote:</cite><blockquote><div><p>Hey BulliteShot: Indeed, that is the case. I own a 2nd i5 because of that ^_^</p></div></blockquote></div><div class="quotebox"><cite>nbhs wrote:</cite><blockquote><div><div class="quotebox"><cite>BulliteShot wrote:</cite><blockquote><div><p>It seems that only &quot;locked&quot; Intel processors support IOMMU which means no overclocking.</p><p>Can AMD processors overclock aswell as enabling IOMMU?</p></div></blockquote></div><p>Yeah IOMMU support is only required on the mobo on amd systems, i own a bulldozer 8120 black box with unlocked multiplier, i can get it to 4.6ghz stable on a closed loop water system</p></div></blockquote></div><p>*sigh* I for one am sick of Intel pushing these limitations.</p><p>Goodbye Intel, hello AMD!</p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1306726">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1306727" class="blockpost rowodd"> <h2><span><span class="conr">#392</span> <a href="viewtopic.php?pid=1306727#p1306727">2013-08-01 16:06:11</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=70922">nbhs</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd class="postavatar"><img src="https://bbs.archlinux.org/img/avatars/70922.jpg?m=1367773811" width="80" height="80" alt="" /></dd> <dd><span>From: Montevideo, Uruguay</span></dd> <dd><span>Registered: 2013-05-02</span></dd> <dd><span>Posts: 402</span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>pcworld wrote:</cite><blockquote><div><div class="quotebox"><cite>jgott wrote:</cite><blockquote><div><p>Like you, my ASUS motherboard has a broken IVRS table (with precisely the same wrong values as yours, apparently). In addition to overriding it in the kernel, …</p></div></blockquote></div><p>How to do that? I&#039;m considering buying an &quot;ASUS M5A97 Evo R2.0&quot;, however I would still like to be able to use IOMMU if that board suffers from the same issue.</p></div></blockquote></div><p>there&#039;s a &quot;ivrs_override=&quot; kernel parameter, IOMMU should work even without it, the workaround is to enable interrupt remapping support on these boards</p> <p class="postedit"><em>Last edited by nbhs (2013-08-01 16:10:34)</em></p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1306727">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1306729" class="blockpost roweven"> <h2><span><span class="conr">#393</span> <a href="viewtopic.php?pid=1306729#p1306729">2013-08-01 16:11:22</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=73712">cmdr</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2013-08-01</span></dd> <dd><span>Posts: 8</span></dd> <dd class="usercontacts"><span class="email"><a href="misc.php?email=73712">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <p>Hi,</p><p>thank you very much for your guide.<br />I&#039;m running into some problems when I try to passthrough a gpu to a guest.</p><p>Hardware:</p><ul><li><p>Xeon E3-1230v2</p></li><li><p>ASRock Fatal1ty Z77 professional</p></li><li><p>NVIDIA GTX-470 (Host)</p></li><li><p>ATI Radeon 5450 (Guest)</p></li></ul><div class="codebox"><pre><code># cat /proc/cmdline BOOT_IMAGE=/vmlinuz-linux-mainline root=/dev/mapper/desktop-root ro pci-stub.ids=1002:68f9,1002:aa68 intel_iommu=on cryptdevice=/dev/sda2:main quiet</code></pre></div><div class="codebox"><pre><code># lspci -tv -[0000:00]-+-00.0 Intel Corporation Xeon E3-1200 v2/Ivy Bridge DRAM Controller +-01.0-[01]--+-00.0 NVIDIA Corporation GF100 [GeForce GTX 470] | \-00.1 NVIDIA Corporation GF100 High Definition Audio Controller +-01.1-[02]--+-00.0 Advanced Micro Devices, Inc. [AMD/ATI] Cedar [Radeon HD 5000/6000/7350/8350 Series] | \-00.1 Advanced Micro Devices, Inc. [AMD/ATI] Cedar HDMI Audio [Radeon HD 5400/6300 Series] +-14.0 Intel Corporation 7 Series/C210 Series Chipset Family USB xHCI Host Controller +-16.0 Intel Corporation 7 Series/C210 Series Chipset Family MEI Controller #1 +-1a.0 Intel Corporation 7 Series/C210 Series Chipset Family USB Enhanced Host Controller #2 +-1b.0 Intel Corporation 7 Series/C210 Series Chipset Family High Definition Audio Controller +-1c.0-[03]-- +-1c.7-[04-0d]----00.0-[05-0d]--+-01.0-[06]----00.0 ASMedia Technology Inc. ASM1062 Serial ATA Controller | +-04.0-[07-08]----00.0-[08]-- | +-05.0-[09]----00.0 ASMedia Technology Inc. ASM1062 Serial ATA Controller | +-06.0-[0a]----00.0 Broadcom Corporation NetLink BCM57781 Gigabit Ethernet PCIe | +-07.0-[0b]----00.0 Etron Technology, Inc. EJ188/EJ198 USB 3.0 Host Controller | +-08.0-[0c]----00.0 Broadcom Corporation NetLink BCM57781 Gigabit Ethernet PCIe | \-09.0-[0d]--+-00.0 VIA Technologies, Inc. VT6315 Series Firewire Controller | \-00.1 VIA Technologies, Inc. VT6415 PATA IDE Host Controller +-1d.0 Intel Corporation 7 Series/C210 Series Chipset Family USB Enhanced Host Controller #1 +-1f.0 Intel Corporation Z77 Express Chipset LPC Controller +-1f.2 Intel Corporation 7 Series/C210 Series Chipset Family 6-port SATA Controller [AHCI mode] \-1f.3 Intel Corporation 7 Series/C210 Series Chipset Family SMBus Controller</code></pre></div><p>Using the second pcie slot, both gpus are in the same iommu_group (thats why i can&#039;t bind all devices in the group to vfio).</p><div class="codebox"><pre><code># readlink /sys/bus/pci/devices/0000\:02\:00.0/iommu_group ../../../../kernel/iommu_groups/1 # ls -l /sys/kernel/iommu_groups/1/devices/ total 0 lrwxrwxrwx 1 root root 0 Aug 1 17:40 0000:00:01.0 -&gt; ../../../../devices/pci0000:00/0000:00:01.0 &lt;- pci-bridge lrwxrwxrwx 1 root root 0 Aug 1 17:40 0000:00:01.1 -&gt; ../../../../devices/pci0000:00/0000:00:01.1 &lt;- pci-bridge lrwxrwxrwx 1 root root 0 Aug 1 17:40 0000:01:00.0 -&gt; ../../../../devices/pci0000:00/0000:00:01.0/0000:01:00.0 lrwxrwxrwx 1 root root 0 Aug 1 17:40 0000:01:00.1 -&gt; ../../../../devices/pci0000:00/0000:00:01.0/0000:01:00.1 lrwxrwxrwx 1 root root 0 Aug 1 17:40 0000:02:00.0 -&gt; ../../../../devices/pci0000:00/0000:00:01.1/0000:02:00.0 lrwxrwxrwx 1 root root 0 Aug 1 17:40 0000:02:00.1 -&gt; ../../../../devices/pci0000:00/0000:00:01.1/0000:02:00.1</code></pre></div><p>Using the third pcie slot, the second gpu is in the same iommu_group with the NIC&#039;s and stuff.</p><div class="codebox"><pre class="vscroll"><code># lspci | grep ATI 02:00.0 VGA compatible controller: Advanced Micro Devices, Inc. [AMD/ATI] Cedar [Radeon HD 5000/6000/7350/8350 Series] 02:00.1 Audio device: Advanced Micro Devices, Inc. [AMD/ATI] Cedar HDMI Audio [Radeon HD 5400/6300 Series] # readlink /sys/bus/pci/devices/0000\:02\:00.0/iommu_group ../../../../kernel/iommu_groups/6 # ls -l /sys/kernel/iommu_groups/6/devices/ total 0 lrwxrwxrwx 1 root root 0 Aug 1 18:00 0000:00:1c.0 -&gt; ../../../../devices/pci0000:00/0000:00:1c.0 lrwxrwxrwx 1 root root 0 Aug 1 18:00 0000:00:1c.7 -&gt; ../../../../devices/pci0000:00/0000:00:1c.7 lrwxrwxrwx 1 root root 0 Aug 1 18:00 0000:02:00.0 -&gt; ../../../../devices/pci0000:00/0000:00:1c.0/0000:02:00.0 lrwxrwxrwx 1 root root 0 Aug 1 18:00 0000:02:00.1 -&gt; ../../../../devices/pci0000:00/0000:00:1c.0/0000:02:00.1 lrwxrwxrwx 1 root root 0 Aug 1 18:00 0000:03:00.0 -&gt; ../../../../devices/pci0000:00/0000:00:1c.7/0000:03:00.0 lrwxrwxrwx 1 root root 0 Aug 1 18:00 0000:04:01.0 -&gt; ../../../../devices/pci0000:00/0000:00:1c.7/0000:03:00.0/0000:04:01.0 lrwxrwxrwx 1 root root 0 Aug 1 18:00 0000:04:04.0 -&gt; ../../../../devices/pci0000:00/0000:00:1c.7/0000:03:00.0/0000:04:04.0 lrwxrwxrwx 1 root root 0 Aug 1 18:00 0000:04:05.0 -&gt; ../../../../devices/pci0000:00/0000:00:1c.7/0000:03:00.0/0000:04:05.0 lrwxrwxrwx 1 root root 0 Aug 1 18:00 0000:04:06.0 -&gt; ../../../../devices/pci0000:00/0000:00:1c.7/0000:03:00.0/0000:04:06.0 lrwxrwxrwx 1 root root 0 Aug 1 18:00 0000:04:07.0 -&gt; ../../../../devices/pci0000:00/0000:00:1c.7/0000:03:00.0/0000:04:07.0 lrwxrwxrwx 1 root root 0 Aug 1 18:00 0000:04:08.0 -&gt; ../../../../devices/pci0000:00/0000:00:1c.7/0000:03:00.0/0000:04:08.0 lrwxrwxrwx 1 root root 0 Aug 1 18:00 0000:04:09.0 -&gt; ../../../../devices/pci0000:00/0000:00:1c.7/0000:03:00.0/0000:04:09.0 lrwxrwxrwx 1 root root 0 Aug 1 18:00 0000:05:00.0 -&gt; ../../../../devices/pci0000:00/0000:00:1c.7/0000:03:00.0/0000:04:01.0/0000:05:00.0 lrwxrwxrwx 1 root root 0 Aug 1 18:00 0000:06:00.0 -&gt; ../../../../devices/pci0000:00/0000:00:1c.7/0000:03:00.0/0000:04:04.0/0000:06:00.0 lrwxrwxrwx 1 root root 0 Aug 1 18:00 0000:08:00.0 -&gt; ../../../../devices/pci0000:00/0000:00:1c.7/0000:03:00.0/0000:04:05.0/0000:08:00.0 lrwxrwxrwx 1 root root 0 Aug 1 18:00 0000:09:00.0 -&gt; ../../../../devices/pci0000:00/0000:00:1c.7/0000:03:00.0/0000:04:06.0/0000:09:00.0 lrwxrwxrwx 1 root root 0 Aug 1 18:00 0000:0a:00.0 -&gt; ../../../../devices/pci0000:00/0000:00:1c.7/0000:03:00.0/0000:04:07.0/0000:0a:00.0 lrwxrwxrwx 1 root root 0 Aug 1 18:00 0000:0b:00.0 -&gt; ../../../../devices/pci0000:00/0000:00:1c.7/0000:03:00.0/0000:04:08.0/0000:0b:00.0 lrwxrwxrwx 1 root root 0 Aug 1 18:00 0000:0c:00.0 -&gt; ../../../../devices/pci0000:00/0000:00:1c.7/0000:03:00.0/0000:04:09.0/0000:0c:00.0 lrwxrwxrwx 1 root root 0 Aug 1 18:00 0000:0c:00.1 -&gt; ../../../../devices/pci0000:00/0000:00:1c.7/0000:03:00.0/0000:04:09.0/0000:0c:00.1</code></pre></div><p>Question:<br />Is there a workaround/fix for this or should i get a new mobo? <img src="https://bbs.archlinux.org/img/smilies/big_smile.png" width="15" height="15" alt="big_smile" /></p><p>Thank you!</p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1306729">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1306733" class="blockpost rowodd"> <h2><span><span class="conr">#394</span> <a href="viewtopic.php?pid=1306733#p1306733">2013-08-01 16:24:03</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=70922">nbhs</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd class="postavatar"><img src="https://bbs.archlinux.org/img/avatars/70922.jpg?m=1367773811" width="80" height="80" alt="" /></dd> <dd><span>From: Montevideo, Uruguay</span></dd> <dd><span>Registered: 2013-05-02</span></dd> <dd><span>Posts: 402</span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>cmdr wrote:</cite><blockquote><div><p>Hi,</p><p>thank you very much for your guide.<br />I&#039;m running into some problems when I try to passthrough a gpu to a guest.</p><p>Hardware:</p><ul><li><p>Xeon E3-1230v2</p></li><li><p>ASRock Fatal1ty Z77 professional</p></li><li><p>NVIDIA GTX-470 (Host)</p></li><li><p>ATI Radeon 5450 (Guest)</p></li></ul><div class="codebox"><pre><code># cat /proc/cmdline BOOT_IMAGE=/vmlinuz-linux-mainline root=/dev/mapper/desktop-root ro pci-stub.ids=1002:68f9,1002:aa68 intel_iommu=on cryptdevice=/dev/sda2:main quiet</code></pre></div><div class="codebox"><pre><code># lspci -tv -[0000:00]-+-00.0 Intel Corporation Xeon E3-1200 v2/Ivy Bridge DRAM Controller +-01.0-[01]--+-00.0 NVIDIA Corporation GF100 [GeForce GTX 470] | \-00.1 NVIDIA Corporation GF100 High Definition Audio Controller +-01.1-[02]--+-00.0 Advanced Micro Devices, Inc. [AMD/ATI] Cedar [Radeon HD 5000/6000/7350/8350 Series] | \-00.1 Advanced Micro Devices, Inc. [AMD/ATI] Cedar HDMI Audio [Radeon HD 5400/6300 Series] +-14.0 Intel Corporation 7 Series/C210 Series Chipset Family USB xHCI Host Controller +-16.0 Intel Corporation 7 Series/C210 Series Chipset Family MEI Controller #1 +-1a.0 Intel Corporation 7 Series/C210 Series Chipset Family USB Enhanced Host Controller #2 +-1b.0 Intel Corporation 7 Series/C210 Series Chipset Family High Definition Audio Controller +-1c.0-[03]-- +-1c.7-[04-0d]----00.0-[05-0d]--+-01.0-[06]----00.0 ASMedia Technology Inc. ASM1062 Serial ATA Controller | +-04.0-[07-08]----00.0-[08]-- | +-05.0-[09]----00.0 ASMedia Technology Inc. ASM1062 Serial ATA Controller | +-06.0-[0a]----00.0 Broadcom Corporation NetLink BCM57781 Gigabit Ethernet PCIe | +-07.0-[0b]----00.0 Etron Technology, Inc. EJ188/EJ198 USB 3.0 Host Controller | +-08.0-[0c]----00.0 Broadcom Corporation NetLink BCM57781 Gigabit Ethernet PCIe | \-09.0-[0d]--+-00.0 VIA Technologies, Inc. VT6315 Series Firewire Controller | \-00.1 VIA Technologies, Inc. VT6415 PATA IDE Host Controller +-1d.0 Intel Corporation 7 Series/C210 Series Chipset Family USB Enhanced Host Controller #1 +-1f.0 Intel Corporation Z77 Express Chipset LPC Controller +-1f.2 Intel Corporation 7 Series/C210 Series Chipset Family 6-port SATA Controller [AHCI mode] \-1f.3 Intel Corporation 7 Series/C210 Series Chipset Family SMBus Controller</code></pre></div><p>Using the second pcie slot, both gpus are in the same iommu_group (thats why i can&#039;t bind all devices in the group to vfio).</p><div class="codebox"><pre><code># readlink /sys/bus/pci/devices/0000\:02\:00.0/iommu_group ../../../../kernel/iommu_groups/1 # ls -l /sys/kernel/iommu_groups/1/devices/ total 0 lrwxrwxrwx 1 root root 0 Aug 1 17:40 0000:00:01.0 -&gt; ../../../../devices/pci0000:00/0000:00:01.0 &lt;- pci-bridge lrwxrwxrwx 1 root root 0 Aug 1 17:40 0000:00:01.1 -&gt; ../../../../devices/pci0000:00/0000:00:01.1 &lt;- pci-bridge lrwxrwxrwx 1 root root 0 Aug 1 17:40 0000:01:00.0 -&gt; ../../../../devices/pci0000:00/0000:00:01.0/0000:01:00.0 lrwxrwxrwx 1 root root 0 Aug 1 17:40 0000:01:00.1 -&gt; ../../../../devices/pci0000:00/0000:00:01.0/0000:01:00.1 lrwxrwxrwx 1 root root 0 Aug 1 17:40 0000:02:00.0 -&gt; ../../../../devices/pci0000:00/0000:00:01.1/0000:02:00.0 lrwxrwxrwx 1 root root 0 Aug 1 17:40 0000:02:00.1 -&gt; ../../../../devices/pci0000:00/0000:00:01.1/0000:02:00.1</code></pre></div><p>Using the third pcie slot, the second gpu is in the same iommu_group with the NIC&#039;s and stuff.</p><div class="codebox"><pre class="vscroll"><code># lspci | grep ATI 02:00.0 VGA compatible controller: Advanced Micro Devices, Inc. [AMD/ATI] Cedar [Radeon HD 5000/6000/7350/8350 Series] 02:00.1 Audio device: Advanced Micro Devices, Inc. [AMD/ATI] Cedar HDMI Audio [Radeon HD 5400/6300 Series] # readlink /sys/bus/pci/devices/0000\:02\:00.0/iommu_group ../../../../kernel/iommu_groups/6 # ls -l /sys/kernel/iommu_groups/6/devices/ total 0 lrwxrwxrwx 1 root root 0 Aug 1 18:00 0000:00:1c.0 -&gt; ../../../../devices/pci0000:00/0000:00:1c.0 lrwxrwxrwx 1 root root 0 Aug 1 18:00 0000:00:1c.7 -&gt; ../../../../devices/pci0000:00/0000:00:1c.7 lrwxrwxrwx 1 root root 0 Aug 1 18:00 0000:02:00.0 -&gt; ../../../../devices/pci0000:00/0000:00:1c.0/0000:02:00.0 lrwxrwxrwx 1 root root 0 Aug 1 18:00 0000:02:00.1 -&gt; ../../../../devices/pci0000:00/0000:00:1c.0/0000:02:00.1 lrwxrwxrwx 1 root root 0 Aug 1 18:00 0000:03:00.0 -&gt; ../../../../devices/pci0000:00/0000:00:1c.7/0000:03:00.0 lrwxrwxrwx 1 root root 0 Aug 1 18:00 0000:04:01.0 -&gt; ../../../../devices/pci0000:00/0000:00:1c.7/0000:03:00.0/0000:04:01.0 lrwxrwxrwx 1 root root 0 Aug 1 18:00 0000:04:04.0 -&gt; ../../../../devices/pci0000:00/0000:00:1c.7/0000:03:00.0/0000:04:04.0 lrwxrwxrwx 1 root root 0 Aug 1 18:00 0000:04:05.0 -&gt; ../../../../devices/pci0000:00/0000:00:1c.7/0000:03:00.0/0000:04:05.0 lrwxrwxrwx 1 root root 0 Aug 1 18:00 0000:04:06.0 -&gt; ../../../../devices/pci0000:00/0000:00:1c.7/0000:03:00.0/0000:04:06.0 lrwxrwxrwx 1 root root 0 Aug 1 18:00 0000:04:07.0 -&gt; ../../../../devices/pci0000:00/0000:00:1c.7/0000:03:00.0/0000:04:07.0 lrwxrwxrwx 1 root root 0 Aug 1 18:00 0000:04:08.0 -&gt; ../../../../devices/pci0000:00/0000:00:1c.7/0000:03:00.0/0000:04:08.0 lrwxrwxrwx 1 root root 0 Aug 1 18:00 0000:04:09.0 -&gt; ../../../../devices/pci0000:00/0000:00:1c.7/0000:03:00.0/0000:04:09.0 lrwxrwxrwx 1 root root 0 Aug 1 18:00 0000:05:00.0 -&gt; ../../../../devices/pci0000:00/0000:00:1c.7/0000:03:00.0/0000:04:01.0/0000:05:00.0 lrwxrwxrwx 1 root root 0 Aug 1 18:00 0000:06:00.0 -&gt; ../../../../devices/pci0000:00/0000:00:1c.7/0000:03:00.0/0000:04:04.0/0000:06:00.0 lrwxrwxrwx 1 root root 0 Aug 1 18:00 0000:08:00.0 -&gt; ../../../../devices/pci0000:00/0000:00:1c.7/0000:03:00.0/0000:04:05.0/0000:08:00.0 lrwxrwxrwx 1 root root 0 Aug 1 18:00 0000:09:00.0 -&gt; ../../../../devices/pci0000:00/0000:00:1c.7/0000:03:00.0/0000:04:06.0/0000:09:00.0 lrwxrwxrwx 1 root root 0 Aug 1 18:00 0000:0a:00.0 -&gt; ../../../../devices/pci0000:00/0000:00:1c.7/0000:03:00.0/0000:04:07.0/0000:0a:00.0 lrwxrwxrwx 1 root root 0 Aug 1 18:00 0000:0b:00.0 -&gt; ../../../../devices/pci0000:00/0000:00:1c.7/0000:03:00.0/0000:04:08.0/0000:0b:00.0 lrwxrwxrwx 1 root root 0 Aug 1 18:00 0000:0c:00.0 -&gt; ../../../../devices/pci0000:00/0000:00:1c.7/0000:03:00.0/0000:04:09.0/0000:0c:00.0 lrwxrwxrwx 1 root root 0 Aug 1 18:00 0000:0c:00.1 -&gt; ../../../../devices/pci0000:00/0000:00:1c.7/0000:03:00.0/0000:04:09.0/0000:0c:00.1</code></pre></div><p>Question:<br />Is there a workaround/fix for this or should i get a new mobo? <img src="https://bbs.archlinux.org/img/smilies/big_smile.png" width="15" height="15" alt="big_smile" /></p><p>Thank you!</p></div></blockquote></div><p>Some people were having this same problem with intel boards, take a look at this post on the kvm mailing list, im not sure this is the solution though: <a href="http://marc.info/?l=linux-kernel&amp;m=136993923507507&amp;w=2" rel="nofollow">http://marc.info/?l=linux-kernel&amp;m=136993923507507&amp;w=2</a></p> <p class="postedit"><em>Last edited by nbhs (2013-08-01 16:26:11)</em></p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1306733">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1306740" class="blockpost roweven"> <h2><span><span class="conr">#395</span> <a href="viewtopic.php?pid=1306740#p1306740">2013-08-01 16:47:27</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=70922">nbhs</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd class="postavatar"><img src="https://bbs.archlinux.org/img/avatars/70922.jpg?m=1367773811" width="80" height="80" alt="" /></dd> <dd><span>From: Montevideo, Uruguay</span></dd> <dd><span>Registered: 2013-05-02</span></dd> <dd><span>Posts: 402</span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>BulliteShot wrote:</cite><blockquote><div><div class="quotebox"><cite>mukiex wrote:</cite><blockquote><div><p>Hey BulliteShot: Indeed, that is the case. I own a 2nd i5 because of that ^_^</p></div></blockquote></div><div class="quotebox"><cite>nbhs wrote:</cite><blockquote><div><div class="quotebox"><cite>BulliteShot wrote:</cite><blockquote><div><p>It seems that only &quot;locked&quot; Intel processors support IOMMU which means no overclocking.</p><p>Can AMD processors overclock aswell as enabling IOMMU?</p></div></blockquote></div><p>Yeah IOMMU support is only required on the mobo on amd systems, i own a bulldozer 8120 black box with unlocked multiplier, i can get it to 4.6ghz stable on a closed loop water system</p></div></blockquote></div><p>*sigh* I for one am sick of Intel pushing these limitations.</p><p>Goodbye Intel, hello AMD!</p></div></blockquote></div><p>I think instead of spending money perhaps you could try posting you issue on the kvm and/or qemu mailing list, remember this is still an experimental feature being worked on <img src="https://bbs.archlinux.org/img/smilies/smile.png" width="15" height="15" alt="smile" /></p> <p class="postedit"><em>Last edited by nbhs (2013-08-01 16:49:15)</em></p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1306740">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1306860" class="blockpost rowodd"> <h2><span><span class="conr">#396</span> <a href="viewtopic.php?pid=1306860#p1306860">2013-08-02 00:31:47</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=73712">cmdr</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2013-08-01</span></dd> <dd><span>Posts: 8</span></dd> <dd class="usercontacts"><span class="email"><a href="misc.php?email=73712">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>nbhs wrote:</cite><blockquote><div><div class="quotebox"><cite>cmdr wrote:</cite><blockquote><div><p>-snip-</p></div></blockquote></div><p>Some people were having this same problem with intel boards, take a look at this post on the kvm mailing list, im not sure this is the solution though: <a href="http://marc.info/?l=linux-kernel&amp;m=136993923507507&amp;w=2" rel="nofollow">http://marc.info/?l=linux-kernel&amp;m=136993923507507&amp;w=2</a></p></div></blockquote></div><p>Hi,<br />thanks for your fast reply. I applied the patch, changed my command line and now the devices have their own groups (second gpu together with pci-bridge). </p><div class="quotebox"><blockquote><div><p># cat /proc/cmdline <br />BOOT_IMAGE=/vmlinuz-linux-mainline root=/dev/mapper/desktop-root ro pci-stub.ids=1002:68f9,1002:aa68 intel_iommu=on pcie_acs_override=id:8086:1e1e cryptdevice=/dev/sda2:main quiet</p><p># ls -l /sys/bus/pci/devices/0000\:02\:00.0/iommu_group/devices/<br />total 0<br />lrwxrwxrwx 1 root root 0 Aug&#160; 2 02:27 0000:00:1c.0 -&gt; ../../../../devices/pci0000:00/0000:00:1c.0<br />lrwxrwxrwx 1 root root 0 Aug&#160; 2 02:27 0000:02:00.0 -&gt; ../../../../devices/pci0000:00/0000:00:1c.0/0000:02:00.0<br />lrwxrwxrwx 1 root root 0 Aug&#160; 2 02:27 0000:02:00.1 -&gt; ../../../../devices/pci0000:00/0000:00:1c.0/0000:02:00.1</p><p>[&#160; &#160;53.014493] vfio-pci 0000:02:00.0: enabling device (0000 -&gt; 0003)</p></div></blockquote></div><p>I bind the gpu manually to vfio and qemu starts without errors but the attached screen stays black.</p><p>Edit: I blacklisted nouveau, nvidia, radeon and tried it without X but i had no success.</p><div class="quotebox"><blockquote><div><p>qemu-system-x86_64 -enable-kvm -M q35 -m 1024 -cpu host \<br />-smp 6,sockets=1,cores=6,threads=1 \<br />-bios /usr/share/qemu/bios.bin -vga none \<br />-device ioh3420,bus=pcie.0,addr=1c.0,multifunction=on,port=1,chassis=1,id=root.1 \<br />-device vfio-pci,host=02:00.0,bus=root.1,addr=00.0,multifunction=on,x-vga=on \<br />-device vfio-pci,host=02:00.1,bus=root.1,addr=00.1</p></div></blockquote></div> <p class="postedit"><em>Last edited by cmdr (2013-08-02 01:53:54)</em></p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1306860">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1306879" class="blockpost roweven"> <h2><span><span class="conr">#397</span> <a href="viewtopic.php?pid=1306879#p1306879">2013-08-02 02:34:43</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=70922">nbhs</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd class="postavatar"><img src="https://bbs.archlinux.org/img/avatars/70922.jpg?m=1367773811" width="80" height="80" alt="" /></dd> <dd><span>From: Montevideo, Uruguay</span></dd> <dd><span>Registered: 2013-05-02</span></dd> <dd><span>Posts: 402</span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>cmdr wrote:</cite><blockquote><div><div class="quotebox"><cite>nbhs wrote:</cite><blockquote><div><div class="quotebox"><cite>cmdr wrote:</cite><blockquote><div><p>-snip-</p></div></blockquote></div><p>Some people were having this same problem with intel boards, take a look at this post on the kvm mailing list, im not sure this is the solution though: <a href="http://marc.info/?l=linux-kernel&amp;m=136993923507507&amp;w=2" rel="nofollow">http://marc.info/?l=linux-kernel&amp;m=136993923507507&amp;w=2</a></p></div></blockquote></div><p>Hi,<br />thanks for your fast reply. I applied the patch, changed my command line and now the devices have their own groups (second gpu together with pci-bridge). </p><div class="quotebox"><blockquote><div><p># cat /proc/cmdline <br />BOOT_IMAGE=/vmlinuz-linux-mainline root=/dev/mapper/desktop-root ro pci-stub.ids=1002:68f9,1002:aa68 intel_iommu=on pcie_acs_override=id:8086:1e1e cryptdevice=/dev/sda2:main quiet</p><p># ls -l /sys/bus/pci/devices/0000\:02\:00.0/iommu_group/devices/<br />total 0<br />lrwxrwxrwx 1 root root 0 Aug&#160; 2 02:27 0000:00:1c.0 -&gt; ../../../../devices/pci0000:00/0000:00:1c.0<br />lrwxrwxrwx 1 root root 0 Aug&#160; 2 02:27 0000:02:00.0 -&gt; ../../../../devices/pci0000:00/0000:00:1c.0/0000:02:00.0<br />lrwxrwxrwx 1 root root 0 Aug&#160; 2 02:27 0000:02:00.1 -&gt; ../../../../devices/pci0000:00/0000:00:1c.0/0000:02:00.1</p><p>[&#160; &#160;53.014493] vfio-pci 0000:02:00.0: enabling device (0000 -&gt; 0003)</p></div></blockquote></div><p>I bind the gpu manually to vfio and qemu starts without errors but the attached screen stays black.</p><p>Edit: I blacklisted nouveau, nvidia, radeon and tried it without X but i had no success.</p><div class="quotebox"><blockquote><div><p>qemu-system-x86_64 -enable-kvm -M q35 -m 1024 -cpu host \<br />-smp 6,sockets=1,cores=6,threads=1 \<br />-bios /usr/share/qemu/bios.bin -vga none \<br />-device ioh3420,bus=pcie.0,addr=1c.0,multifunction=on,port=1,chassis=1,id=root.1 \<br />-device vfio-pci,host=02:00.0,bus=root.1,addr=00.0,multifunction=on,x-vga=on \<br />-device vfio-pci,host=02:00.1,bus=root.1,addr=00.1</p></div></blockquote></div></div></blockquote></div><p>Are you using the patched seabios? have you tried swapping cards? perhaps using pcie_acs_override=downstream or mutlifucion (i have really no idea here)?</p> <p class="postedit"><em>Last edited by nbhs (2013-08-02 02:46:52)</em></p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1306879">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1306971" class="blockpost rowodd"> <h2><span><span class="conr">#398</span> <a href="viewtopic.php?pid=1306971#p1306971">2013-08-02 10:32:46</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=73230">reintseri</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2013-07-16</span></dd> <dd><span>Posts: 6</span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <p>Ok I was meant to post my specs earlier, but summer vacation got in the way <img src="https://bbs.archlinux.org/img/smilies/smile.png" width="15" height="15" alt="smile" />.</p><p>So. I&#039;m using a 2009 Mac Pro with OS X and Arch Linux dual boot as a basis. 2 Xeon processors (8 cores) and 20 gigs of ram <img src="https://bbs.archlinux.org/img/smilies/smile.png" width="15" height="15" alt="smile" />. Modified kernel, QEMU and Seabios - downloaded from this thread.</p><p>Host graphics card - nVidia GeForce 9500 GT (Mac Edition) (Mac EFI boot loader needs this in the first PCIe slot to boot unfortunately.) Tested graphics cards to work in the second 16x PCIe slot: Radeon HD 5450 and Radeon HD 7750.</p><p>So on their own they work fine. But I&#039;ve also tried a 3-graphics-cards-setup to have two VMs. At this point it&#039;s not so stable anymore. I can have one Windows 8 VM with the HD 7750 running together with Ubuntu 12.04 with HD5450, but as soon as I install FGLRX or catalyst driver for it- it crashes and won&#039;t boot anymore. Also various error messages from the kernel can be seen during start and shutdown. Windows installation fails even earlier. So at this setup the HD 5450 is on a 4x PCIe slot.</p><p>Now the problem might be similar to what was posted earlier about the iommu_groups, the HD 7750 (on the 2nd 16x slot) shows only:</p><div class="codebox"><pre><code>0000:06:00.0 0000:06:00.1</code></pre></div><p>But the HD 5450 (on one of the free 4x slots) shows:</p><div class="codebox"><pre><code>0000:02:04.0 0000:04:00.0 0000:04:00.1</code></pre></div><p>So it includes one of the pcie switches:</p><div class="codebox"><pre><code>02:04.0 PCI bridge: Integrated Device Technology, Inc. [IDT] PES12T3G2 PCI Express Gen2 Switch (rev 01)</code></pre></div><p>Could this be the source of the problem? And could I change the iommu_groups somehow.</p><p>Thanks again,<br />Teemu Kämäräinen</p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1306971">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1307002" class="blockpost roweven"> <h2><span><span class="conr">#399</span> <a href="viewtopic.php?pid=1307002#p1307002">2013-08-02 12:07:29</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=73712">cmdr</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2013-08-01</span></dd> <dd><span>Posts: 8</span></dd> <dd class="usercontacts"><span class="email"><a href="misc.php?email=73712">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>nbhs wrote:</cite><blockquote><div><div class="quotebox"><cite>cmdr wrote:</cite><blockquote><div><div class="quotebox"><cite>nbhs wrote:</cite><blockquote><div><p>Some people were having this same problem with intel boards, take a look at this post on the kvm mailing list, im not sure this is the solution though: <a href="http://marc.info/?l=linux-kernel&amp;m=136993923507507&amp;w=2" rel="nofollow">http://marc.info/?l=linux-kernel&amp;m=136993923507507&amp;w=2</a></p></div></blockquote></div><p>Hi,<br />thanks for your fast reply. I applied the patch, changed my command line and now the devices have their own groups (second gpu together with pci-bridge). </p><div class="quotebox"><blockquote><div><p># cat /proc/cmdline <br />BOOT_IMAGE=/vmlinuz-linux-mainline root=/dev/mapper/desktop-root ro pci-stub.ids=1002:68f9,1002:aa68 intel_iommu=on pcie_acs_override=id:8086:1e1e cryptdevice=/dev/sda2:main quiet</p><p># ls -l /sys/bus/pci/devices/0000\:02\:00.0/iommu_group/devices/<br />total 0<br />lrwxrwxrwx 1 root root 0 Aug&#160; 2 02:27 0000:00:1c.0 -&gt; ../../../../devices/pci0000:00/0000:00:1c.0<br />lrwxrwxrwx 1 root root 0 Aug&#160; 2 02:27 0000:02:00.0 -&gt; ../../../../devices/pci0000:00/0000:00:1c.0/0000:02:00.0<br />lrwxrwxrwx 1 root root 0 Aug&#160; 2 02:27 0000:02:00.1 -&gt; ../../../../devices/pci0000:00/0000:00:1c.0/0000:02:00.1</p><p>[&#160; &#160;53.014493] vfio-pci 0000:02:00.0: enabling device (0000 -&gt; 0003)</p></div></blockquote></div><p>I bind the gpu manually to vfio and qemu starts without errors but the attached screen stays black.</p><p>Edit: I blacklisted nouveau, nvidia, radeon and tried it without X but i had no success.</p><div class="quotebox"><blockquote><div><p>qemu-system-x86_64 -enable-kvm -M q35 -m 1024 -cpu host \<br />-smp 6,sockets=1,cores=6,threads=1 \<br />-bios /usr/share/qemu/bios.bin -vga none \<br />-device ioh3420,bus=pcie.0,addr=1c.0,multifunction=on,port=1,chassis=1,id=root.1 \<br />-device vfio-pci,host=02:00.0,bus=root.1,addr=00.0,multifunction=on,x-vga=on \<br />-device vfio-pci,host=02:00.1,bus=root.1,addr=00.1</p></div></blockquote></div></div></blockquote></div><p>Are you using the patched seabios? have you tried swapping cards? perhaps using pcie_acs_override=downstream or mutlifucion (i have really no idea here)?</p></div></blockquote></div><p>Some minutes ago i applied this patch (<a href="http://lists.gnu.org/archive/html/qemu-devel/2013-05/msg04300.html" rel="nofollow">http://lists.gnu.org/archive/html/qemu- … 04300.html</a>) to the nvidia source and build it (i am using PKGBUILD from nvidia-all). Now i can see the boot messages on the attached screen but i have no boot media to install and test windows <img src="https://bbs.archlinux.org/img/smilies/tongue.png" width="15" height="15" alt="tongue" /> .<br />What i have done to get it to this point:</p><ul><li><p>clean arch install</p></li><li><p>kernel package from the first post with this patch (<a href="http://www.spinics.net/lists/kvm/msg92163.html" rel="nofollow">http://www.spinics.net/lists/kvm/msg92163.html</a>)</p></li><li><p>qemu &amp; seabios package from the first post</p></li><li><p>nvidia-all (<a href="https://aur.archlinux.org/packages/nvidia-all/" rel="nofollow">https://aur.archlinux.org/packages/nvidia-all/</a>) with this patch (<a href="http://lists.gnu.org/archive/html/qemu-devel/2013-05/msg04300.html" rel="nofollow">http://lists.gnu.org/archive/html/qemu- … 04300.html</a>)</p></li><li><p>manually attached devices to vfio (like in the usage examples <a href="http://lxr.free-electrons.com/source/Documentation/vfio.txt)" rel="nofollow">http://lxr.free-electrons.com/source/Do … /vfio.txt)</a></p></li></ul><div class="codebox"><pre><code>$ cat /proc/cmdline BOOT_IMAGE=/vmlinuz-linux-mainline root=/dev/mapper/desktop-root ro pci-stub.ids=1002:68f9,1002:aa68 intel_iommu=on pcie_acs_override=id:8086:1e1e cryptdevice=/dev/sda2:main quiet</code></pre></div><p>I think this works now, i&#039;ll check it later that day with a windows installation. Thanks for your ideas!</p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1307002">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1307007" class="blockpost rowodd"> <h2><span><span class="conr">#400</span> <a href="viewtopic.php?pid=1307007#p1307007">2013-08-02 12:11:16</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=70922">nbhs</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd class="postavatar"><img src="https://bbs.archlinux.org/img/avatars/70922.jpg?m=1367773811" width="80" height="80" alt="" /></dd> <dd><span>From: Montevideo, Uruguay</span></dd> <dd><span>Registered: 2013-05-02</span></dd> <dd><span>Posts: 402</span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>cmdr wrote:</cite><blockquote><div><div class="quotebox"><cite>nbhs wrote:</cite><blockquote><div><div class="quotebox"><cite>cmdr wrote:</cite><blockquote><div><p>Hi,<br />thanks for your fast reply. I applied the patch, changed my command line and now the devices have their own groups (second gpu together with pci-bridge). </p><br /><p>I bind the gpu manually to vfio and qemu starts without errors but the attached screen stays black.</p><p>Edit: I blacklisted nouveau, nvidia, radeon and tried it without X but i had no success.</p></div></blockquote></div><p>Are you using the patched seabios? have you tried swapping cards? perhaps using pcie_acs_override=downstream or mutlifucion (i have really no idea here)?</p></div></blockquote></div><p>Some minutes ago i applied this patch (<a href="http://lists.gnu.org/archive/html/qemu-devel/2013-05/msg04300.html" rel="nofollow">http://lists.gnu.org/archive/html/qemu- … 04300.html</a>) to the nvidia source and build it (i am using PKGBUILD from nvidia-all). Now i can see the boot messages on the attached screen but i have no boot media to install and test windows <img src="https://bbs.archlinux.org/img/smilies/tongue.png" width="15" height="15" alt="tongue" /> .<br />What i have done to get it to this point:</p><ul><li><p>clean arch install</p></li><li><p>kernel package from the first post with this patch (<a href="http://www.spinics.net/lists/kvm/msg92163.html" rel="nofollow">http://www.spinics.net/lists/kvm/msg92163.html</a>)</p></li><li><p>qemu &amp; seabios package from the first post</p></li><li><p>nvidia-all (<a href="https://aur.archlinux.org/packages/nvidia-all/" rel="nofollow">https://aur.archlinux.org/packages/nvidia-all/</a>) with this patch (<a href="http://lists.gnu.org/archive/html/qemu-devel/2013-05/msg04300.html" rel="nofollow">http://lists.gnu.org/archive/html/qemu- … 04300.html</a>)</p></li><li><p>manually attached devices to vfio (like in the usage examples <a href="http://lxr.free-electrons.com/source/Documentation/vfio.txt)" rel="nofollow">http://lxr.free-electrons.com/source/Do … /vfio.txt)</a></p></li></ul><div class="codebox"><pre><code>$ cat /proc/cmdline BOOT_IMAGE=/vmlinuz-linux-mainline root=/dev/mapper/desktop-root ro pci-stub.ids=1002:68f9,1002:aa68 intel_iommu=on pcie_acs_override=id:8086:1e1e cryptdevice=/dev/sda2:main quiet</code></pre></div><p>I think this works now, i&#039;ll check it later that day with a windows installation. Thanks for your ideas!</p></div></blockquote></div><p>Interesting, thanks a lot for your report</p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1307007">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div class="postlinksb"> <div class="inbox crumbsplus"> <div class="pagepost"> <p class="pagelink conl"><span class="pages-label">Pages: </span><a rel="prev" class="item1" href="viewtopic.php?id=162768&amp;p=15">Previous</a> <a href="viewtopic.php?id=162768">1</a> <span class="spacer">…</span> <a href="viewtopic.php?id=162768&amp;p=14">14</a> <a href="viewtopic.php?id=162768&amp;p=15">15</a> <strong>16</strong> <a href="viewtopic.php?id=162768&amp;p=17">17</a> <a href="viewtopic.php?id=162768&amp;p=18">18</a> <span class="spacer">…</span> <a href="viewtopic.php?id=162768&amp;p=234">234</a> <a rel="next" href="viewtopic.php?id=162768&amp;p=17">Next</a></p> <p class="postlink conr">Topic closed</p> </div> <ul class="crumbs"> <li><a href="index.php">Index</a></li> <li><span>»&#160;</span><a href="viewforum.php?id=48">Topics Going Nowhere</a></li> <li><span>»&#160;</span><strong><a href="viewtopic.php?id=162768">KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</a></strong></li> </ul> <p class="subscribelink clearb"><a href="misc.php?action=subscribe&amp;tid=162768">Subscribe to this topic</a></p> <div class="clearer"></div> </div> </div> </div> <div id="brdfooter" class="block"> <h2><span>Board footer</span></h2> <div class="box"> <div id="brdfooternav" class="inbox"> <div class="conl"> <form id="qjump" method="get" action="viewforum.php"> <div><label><span>Jump to<br /></span> <select name="id" onchange="window.location=('viewforum.php?id='+this.options[this.selectedIndex].value)"> <optgroup label="Technical Issues and Assistance"> <option value="23">Newbie Corner</option> <option value="17">Installation</option> <option value="22">Kernel &amp; Hardware</option> <option value="18">Applications &amp; Desktop Environments</option> <option value="31">Laptop Issues</option> <option value="8">Networking, Server, and Protection</option> <option value="32">Multimedia and Games</option> <option value="50">System Administration</option> <option value="35">Other Architectures</option> </optgroup> <optgroup label="Arch-centric"> <option value="24">Announcements, Package &amp; Security Advisories</option> <option value="1">Arch Discussion</option> <option value="13">Forum &amp; Wiki discussion</option> </optgroup> <optgroup label="Pacman Upgrades, Packaging &amp; AUR"> <option value="44">Pacman &amp; Package Upgrade Issues</option> <option value="49">[testing] Repo Forum</option> <option value="4">Creating &amp; Modifying Packages</option> <option value="38">AUR Issues, Discussion &amp; PKGBUILD Requests</option> </optgroup> <optgroup label="Contributions &amp; Discussion"> <option value="20">GNU/Linux Discussion</option> <option value="27">Community Contributions</option> <option value="33">Programming &amp; Scripting</option> <option value="30">Other Languages</option> <option value="47">Artwork and Screenshots</option> <option value="42">Try This</option> </optgroup> <optgroup label="/dev/null"> <option value="29">Off-Topic</option> <option value="48" selected="selected">Topics Going Nowhere</option> <option value="36">Dustbin</option> </optgroup> </select></label> <input type="submit" value=" Go " accesskey="g" /> </div> </form> </div> <div class="conr"> <p id="feedlinks"><span class="atom"><a href="extern.php?action=feed&amp;tid=162768&amp;type=atom">Atom topic feed</a></span></p> <p id="poweredby">Powered by <a href="http://fluxbb.org/">FluxBB</a></p> </div> <div class="clearer"></div> </div> </div> </div> </div> <div class="end-box"></div> </div> </body> </html>
