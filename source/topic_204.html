<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"> <html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en" dir="ltr"> <head> <meta http-equiv="Content-Type" content="text/html; charset=utf-8" /> <title>KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9 (Page 204) / Topics Going Nowhere / Arch Linux Forums</title> <link rel="stylesheet" type="text/css" href="style/ArchLinux.css" /> <link rel="canonical" href="viewtopic.php?id=162768&amp;p=204" title="Page 204" /> <link rel="prev" href="viewtopic.php?id=162768&amp;p=203" title="Page 203" /> <link rel="next" href="viewtopic.php?id=162768&amp;p=205" title="Page 205" /> <link rel="alternate" type="application/atom+xml" href="extern.php?action=feed&amp;tid=162768&amp;type=atom" title="Atom topic feed" /> <link rel="stylesheet" media="screen" href="style/ArchLinux/arch.css?v=3" /> <link rel="stylesheet" media="screen" href="style/ArchLinux/archnavbar.css?v=2" /> <link rel="shortcut icon" href="style/ArchLinux/favicon.ico" /> </head> <body> <div id="archnavbar" class="anb-forum"> <div id="archnavbarlogo"><h1><a href="http://www.archlinux.org/">Arch Linux</a></h1></div> <div id="archnavbarmenu"> <ul id="archnavbarlist"> <li id="anb-home"><a href="http://www.archlinux.org/">Home</a></li><li id="anb-packages"><a href="http://www.archlinux.org/packages/">Packages</a></li><li id="anb-forums" class="anb-selected"><a href="https://bbs.archlinux.org/">Forums</a></li><li id="anb-wiki"><a href="https://wiki.archlinux.org/">Wiki</a></li><li id="anb-bugs"><a href="https://bugs.archlinux.org/">Bugs</a></li><li id="anb-aur"><a href="https://aur.archlinux.org/">AUR</a></li><li id="anb-download"><a href="http://www.archlinux.org/download/">Download</a></li> </ul> </div> </div> <div id="punviewtopic" class="pun"> <div class="top-box"></div> <div class="punwrap"> <div id="brdheader" class="block"> <div class="box"> <div id="brdmenu" class="inbox"> <ul> <li id="navindex" class="isactive"><a href="index.php">Index</a></li> <li id="navuserlist"><a href="userlist.php">User list</a></li> <li id="navsearch"><a href="search.php">Search</a></li> <li id="navprofile"><a href="profile.php?id=80749">Profile</a></li> <li id="navlogout"><a href="login.php?action=out&amp;id=80749&amp;csrf_token=5c20501ec397bb45ef8ee8c84db232c8d8e421c6">Logout</a></li> </ul> </div> <div id="brdwelcome" class="inbox"> <ul class="conl"> <li><span>Logged in as <strong>SXX</strong></span></li> <li><span>Last visit: 2015-08-16 12:20:09</span></li> </ul> <ul class="conr"> <li><span>Topics: <a href="search.php?action=show_replies" title="Find topics you have posted to.">Posted</a> | <a href="search.php?action=show_new" title="Find topics with new posts since your last visit.">New</a> | <a href="search.php?action=show_recent" title="Find topics with recent posts.">Active</a> | <a href="search.php?action=show_unanswered" title="Find topics with no replies.">Unanswered</a></span></li> </ul> <div class="clearer"></div> </div> </div> </div> <div id="brdmain"> <div class="linkst"> <div class="inbox crumbsplus"> <ul class="crumbs"> <li><a href="index.php">Index</a></li> <li><span>»&#160;</span><a href="viewforum.php?id=48">Topics Going Nowhere</a></li> <li><span>»&#160;</span><strong><a href="viewtopic.php?id=162768">KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</a></strong></li> </ul> <div class="pagepost"> <p class="pagelink conl"><span class="pages-label">Pages: </span><a rel="prev" class="item1" href="viewtopic.php?id=162768&amp;p=203">Previous</a> <a href="viewtopic.php?id=162768">1</a> <span class="spacer">…</span> <a href="viewtopic.php?id=162768&amp;p=202">202</a> <a href="viewtopic.php?id=162768&amp;p=203">203</a> <strong>204</strong> <a href="viewtopic.php?id=162768&amp;p=205">205</a> <a href="viewtopic.php?id=162768&amp;p=206">206</a> <span class="spacer">…</span> <a href="viewtopic.php?id=162768&amp;p=234">234</a> <a rel="next" href="viewtopic.php?id=162768&amp;p=205">Next</a></p> <p class="postlink conr">Topic closed</p> </div> <div class="clearer"></div> </div> </div> <div id="p1528504" class="blockpost rowodd blockpost1"> <h2><span><span class="conr">#5076</span> <a href="viewtopic.php?pid=1528504#p1528504">2015-05-14 00:15:37</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=87826">The_Moves</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2015-01-06</span></dd> <dd><span>Posts: 58</span></dd> <dd class="usercontacts"><span class="email"><a href="misc.php?email=87826">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>corna wrote:</cite><blockquote><div><p>so I suppose I can&#039;t use ovmf...</p></div></blockquote></div><p>Have you looked at a different rom?</p><p><a href="http://www.techpowerup.com/vgabios/index.php?architecture=&amp;manufacturer=&amp;model=GTX+660+Ti&amp;interface=&amp;memType=&amp;memSize=" rel="nofollow">http://www.techpowerup.com/vgabios/inde … =&amp;memSize=</a></p> <p class="postedit"><em>Last edited by The_Moves (2015-05-14 00:15:53)</em></p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1528504">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1528565" class="blockpost roweven"> <h2><span><span class="conr">#5077</span> <a href="viewtopic.php?pid=1528565#p1528565">2015-05-14 07:54:53</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=91096">corna</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2015-05-13</span></dd> <dd><span>Posts: 12</span></dd> <dd class="usercontacts"><span class="email"><a href="mailto:nicola@corna.info">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <p>Yesterday I ran QEMU without specifing any GPU ROM and it worked!<br />Will I experience any performance loss/problem without a GPU ROM?<br />Thanks for your help btw :-)</p> <p class="postedit"><em>Last edited by corna (2015-05-14 07:55:28)</em></p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1528565">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1528575" class="blockpost rowodd"> <h2><span><span class="conr">#5078</span> <a href="viewtopic.php?pid=1528575#p1528575">2015-05-14 08:59:31</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=79471">Bronek</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>From: London</span></dd> <dd><span>Registered: 2014-02-14</span></dd> <dd><span>Posts: 90</span></dd> <dd class="usercontacts"><span class="email"><a href="misc.php?email=79471">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>corna wrote:</cite><blockquote><div><p>Yesterday I ran QEMU without specifing any GPU ROM and it worked!<br />Will I experience any performance loss/problem without a GPU ROM?<br />Thanks for your help btw :-)</p></div></blockquote></div><p>No at all; using GPU ROM only makes sense as a workaround in certain situations.</p> </div> <div class="postsignature postmsg"><hr /><p>Sorry about&#160; &quot;KVM VGA-Passthrough ...&quot; thread <img src="https://bbs.archlinux.org/img/smilies/sad.png" width="15" height="15" alt="sad" /> Anyone interested in continuing this discussion elsewhere, please contact me privately. I might be able to find it a new home.</p></div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1528575">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1528595" class="blockpost roweven"> <h2><span><span class="conr">#5079</span> <a href="viewtopic.php?pid=1528595#p1528595">2015-05-14 10:53:23</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=75548">Schlunze</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2013-10-03</span></dd> <dd><span>Posts: 13</span></dd> <dd class="usercontacts"><span class="email"><a href="mailto:ts_reload@gmx.net">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <p>Hello again,</p><p>i know that this topic is about vga-passthrough in the first place, but it´s the most experienced community in virtualisation topics out there!</p><p>I have absolutly no idea how to install Windows 7 UEFI correctly as VM or on bare metal.</p><p>I had some success passing through the intel sata controller to VM.</p><p>Installing Windows 7 VM with UEFI using ovmf/libvirt/qemu on the passed through sata controller with attached ssd works fine, until installer reboots.<br />I´ve not configured any hd´s in vmmanager, just the sata controller, loaded all virtio drivers from iso (hd was visible without driver).<br />After installation reboot, Windows 7 UEFI VM end up in ovmf EFI-Shell. Partitioning scheme and data is written to disk, just Windows Boot Manager fails to boot in ovmf.</p><p>I´ve read some older posts about the fat32 uefi partition and i think i´m really close to get the VM to work without the option to dual boot on bare metal. Only missing a little detail about configuring ovmf/qemu/libvirt to boot from passed through SATA controller with attached disk that contains the uefi fat32 partiton.</p><p>Does qemu / libvirt / ovmf need a configured disk to boot?<br />I use ovmf 16229-1. Do i need a special ovmf svn package from AUR?</p><p>A bunch of another off topic questions is Windows 7 UEFI bare metal installation in this case (dual boot part).<br />Looks like nowadays UEFI Windows installations are not as simple as they should be, or me missing very much basic knowledge about UEFI Systems.</p><p>My MB is Asrock Z97Extreme6.</p><p>I´ve found no useful article that describes my usecase for basic hd UEFI configuration in main bios.<br />- 1 linux gpt disk with syslinux on SATA A0<br />- 3 gpt lvm disks (storage for home network) on SATA A1-3<br />- 2 lvm disks without partition table (unplugged for testing) SATA1-2<br />- 1 windows7 uefi gpt disk (for win7 installation unformatted, or like later described with fully installed win7 uefi) on SATA0 <br />- 1 DVDRW on SATA A4</p><p>SATA connectors without A are the main ones from the Intel sata-controller.</p><p>In the good old non UEFI times just the disk configuration in main BIOS decided which disk is started, after Windows 7 UEFI installation i´ve got this strange Windows Boot Manager entry on main bios. </p><p>Do UEFI-Systems read data from disks for general hw initiation / OS initiation?<br />Why there is this new Windows entry in my BIOS instead of the disk description in main bios?<br />Is gummiboot a replacement for Windows Boot Manager or does it have to be the main bootloader that &quot;chainloads&quot; other OSses (WBM; syslinux...)?</p><p>These disks are my requirements to make use of UEFI on bare metal Asrock Bios. But im not able to install Win7 in this - i think - pretty common configuration.</p><p>It only installs and works, if i unplug all other disks. If i plug in the disks back on this previous working installation: <br />Windows Boot Manager fails to boot, <br />syslinux from linux gpt disk is second option in boot legacy, syslinux works normally from this point on.</p><p>I have absolutly no clue why a normal Windows 7 UEFI installation on bare metal does not work with all my disks attached. <br />All disks have gpt like described, except two lvm disks, they have no partition table. I´ve unpluged them for this test. I´ve tested with various disks unplugged, no luck.</p><p>Maybe someone of u have some experiences with this kinda UEFI stuff.</p><p>Ssd for Win7 is connected to sata0 on intel sata controller. Linux is on another disk (A0) with syslinux as another boot option in main bios.<br />With almost all necessary disks, exept the two disks without partition table (unplugged) the installation can´t be completed after reboot on bare metal.<br />Maybe its a wrong main bios configuration?</p><p>Maybe gummiboot is needed on bare metal to &quot;chainload?&quot; uefi OS and normal syslinux as another boot option, as main bootloader not the Asrock one.</p><p>Back to the VM - part.</p><p>Can somebody share a configuration example who managed to get a sata controller passthrough to work (with win7 uefi install, ovmf, libvirt xml)?</p><p>Thank you in advance.</p> <p class="postedit"><em>Last edited by Schlunze (2015-05-14 10:57:19)</em></p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1528595">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1528597" class="blockpost rowodd"> <h2><span><span class="conr">#5080</span> <a href="viewtopic.php?pid=1528597#p1528597">2015-05-14 10:56:45</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=85314">Duelist</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2014-09-22</span></dd> <dd><span>Posts: 358</span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>corna wrote:</cite><blockquote><div><p>The output of rom-parser (<a href="http://vfio.blogspot.it/2014/08/does-my-graphics-card-rom-support-efi.html" rel="nofollow">http://vfio.blogspot.it/2014/08/does-my … t-efi.html</a>) is this one</p><div class="codebox"><pre><code> Valid ROM signature found @0h, PCIR offset 190h PCIR: type 0, vendor: 10de, device: 1183, class: 030000 PCIR: revision 0, vendor revision: 1 Last image</code></pre></div><p>so I suppose I can&#039;t use ovmf...</p><p>What about libvirt? Can you link me the blog?<br />QEMU&#039;s version is 2.1, a recent one</p></div></blockquote></div><p>Try checking your manufacturer&#039;s site for VBIOS updates - maybe there&#039;ll be an UEFI-compatible(with GOP) one. Or lurk through the techpowerup database.<br />Because my gigabyte GT610 supports GOP.</p> </div> <div class="postsignature postmsg"><hr /><p><span class="bbs">The forum rules prohibit requesting support for distributions other than arch.</span><br /><a href="https://bbs.archlinux.org/viewtopic.php?pid=1551460#p1551460" rel="nofollow">I gave up.</a><a href="https://bbs.archlinux.org/viewtopic.php?id=162768" rel="nofollow"> It was too late.</a><br /><a href="http://pastebin.com/B3fL84bq" rel="nofollow">What I was trying to do</a>.<br /><a href="http://vfio.blogspot.com/" rel="nofollow">The reference about VFIO and KVM VGA passthrough.</a></p></div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1528597">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1528608" class="blockpost roweven"> <h2><span><span class="conr">#5081</span> <a href="viewtopic.php?pid=1528608#p1528608">2015-05-14 11:37:31</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=85004">protake</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2014-09-09</span></dd> <dd><span>Posts: 6</span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <p>The iommu group of my second card contains a lot of stuff, for example my network card. </p><div class="codebox"><pre><code>ls /sys/bus/pci/devices/0000:02:00.0/iommu_group/devices/ 0000:00:1c.0 0000:00:1c.5 0000:00:1c.6 0000:02:00.0 0000:02:00.1 0000:03:00.0 0000:04:00.0</code></pre></div><p>Unless I bind all these devices, qemu won&#039;t start. Is there anything I can do about this? This prevents my network connection from working, for example. Is my motherboard at fault here?</p> <p class="postedit"><em>Last edited by protake (2015-05-14 11:38:28)</em></p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1528608">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1528611" class="blockpost rowodd"> <h2><span><span class="conr">#5082</span> <a href="viewtopic.php?pid=1528611#p1528611">2015-05-14 11:51:19</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=91096">corna</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2015-05-13</span></dd> <dd><span>Posts: 12</span></dd> <dd class="usercontacts"><span class="email"><a href="mailto:nicola@corna.info">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>Duelist wrote:</cite><blockquote><div><div class="quotebox"><cite>corna wrote:</cite><blockquote><div><p>The output of rom-parser (<a href="http://vfio.blogspot.it/2014/08/does-my-graphics-card-rom-support-efi.html" rel="nofollow">http://vfio.blogspot.it/2014/08/does-my … t-efi.html</a>) is this one</p><div class="codebox"><pre><code> Valid ROM signature found @0h, PCIR offset 190h PCIR: type 0, vendor: 10de, device: 1183, class: 030000 PCIR: revision 0, vendor revision: 1 Last image</code></pre></div><p>so I suppose I can&#039;t use ovmf...</p><p>What about libvirt? Can you link me the blog?<br />QEMU&#039;s version is 2.1, a recent one</p></div></blockquote></div><p>Try checking your manufacturer&#039;s site for VBIOS updates - maybe there&#039;ll be an UEFI-compatible(with GOP) one. Or lurk through the techpowerup database.<br />Because my gigabyte GT610 supports GOP.</p></div></blockquote></div><p>I&#039;ve tried rom-parser with <a href="http://www.gigabyte.com/products/product-page.aspx?pid=4320#bios" rel="nofollow">this</a> Gigabyte BIOS and this is the output</p><div class="quotebox"><blockquote><div><p>Valid ROM signature found @400h, PCIR offset 190h<br />&#160; &#160; PCIR: type 0, vendor: 10de, device: 1183, class: 030000<br />&#160; &#160; PCIR: revision 0, vendor revision: 1<br />&#160; &#160; Last image</p></div></blockquote></div><p>but the BIOS description says</p><div class="quotebox"><blockquote><div><p>5. UEFI BIOS</p></div></blockquote></div><p>so I suppose that the rom-parser script is broken. Later I&#039;ll try if it works with OVMF</p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1528611">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1528616" class="blockpost roweven"> <h2><span><span class="conr">#5083</span> <a href="viewtopic.php?pid=1528616#p1528616">2015-05-14 12:03:23</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=82442">slis</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2014-06-02</span></dd> <dd><span>Posts: 125</span></dd> <dd class="usercontacts"><span class="email"><a href="mailto:xslisx@gmail.com">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>protake wrote:</cite><blockquote><div><p>The iommu group of my second card contains a lot of stuff, for example my network card. </p><div class="codebox"><pre><code>ls /sys/bus/pci/devices/0000:02:00.0/iommu_group/devices/ 0000:00:1c.0 0000:00:1c.5 0000:00:1c.6 0000:02:00.0 0000:02:00.1 0000:03:00.0 0000:04:00.0</code></pre></div><p>Unless I bind all these devices, qemu won&#039;t start. Is there anything I can do about this? This prevents my network connection from working, for example. Is my motherboard at fault here?</p></div></blockquote></div><p>You need ACS override patch for kernel.</p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1528616">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1528635" class="blockpost rowodd"> <h2><span><span class="conr">#5084</span> <a href="viewtopic.php?pid=1528635#p1528635">2015-05-14 13:00:21</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=85004">protake</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2014-09-09</span></dd> <dd><span>Posts: 6</span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>slis wrote:</cite><blockquote><div><div class="quotebox"><cite>protake wrote:</cite><blockquote><div><p>The iommu group of my second card contains a lot of stuff, for example my network card. </p><div class="codebox"><pre><code>ls /sys/bus/pci/devices/0000:02:00.0/iommu_group/devices/ 0000:00:1c.0 0000:00:1c.5 0000:00:1c.6 0000:02:00.0 0000:02:00.1 0000:03:00.0 0000:04:00.0</code></pre></div><p>Unless I bind all these devices, qemu won&#039;t start. Is there anything I can do about this? This prevents my network connection from working, for example. Is my motherboard at fault here?</p></div></blockquote></div><p>You need ACS override patch for kernel.</p></div></blockquote></div><p>Hm, strange. I was using the linux-vfio kernel yesterday, and I&#039;m pretty sure it was the same. I don&#039;t mind trying it again if it works, though...</p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1528635">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1528638" class="blockpost roweven"> <h2><span><span class="conr">#5085</span> <a href="viewtopic.php?pid=1528638#p1528638">2015-05-14 13:06:31</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=75590">aw</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2013-10-04</span></dd> <dd><span>Posts: 921</span></dd> <dd class="usercontacts"><span class="email"><a href="misc.php?email=75590">Email</a></span> <span class="website"><a href="http://vfio.blogspot.com/" rel="nofollow">Website</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>protake wrote:</cite><blockquote><div><div class="quotebox"><cite>slis wrote:</cite><blockquote><div><div class="quotebox"><cite>protake wrote:</cite><blockquote><div><p>The iommu group of my second card contains a lot of stuff, for example my network card. </p><div class="codebox"><pre><code>ls /sys/bus/pci/devices/0000:02:00.0/iommu_group/devices/ 0000:00:1c.0 0000:00:1c.5 0000:00:1c.6 0000:02:00.0 0000:02:00.1 0000:03:00.0 0000:04:00.0</code></pre></div><p>Unless I bind all these devices, qemu won&#039;t start. Is there anything I can do about this? This prevents my network connection from working, for example. Is my motherboard at fault here?</p></div></blockquote></div><p>You need ACS override patch for kernel.</p></div></blockquote></div><p>Hm, strange. I was using the linux-vfio kernel yesterday, and I&#039;m pretty sure it was the same. I don&#039;t mind trying it again if it works, though...</p></div></blockquote></div><p>There are kernel commandline options required to enable the acs override patch.&#160; What chipset is this?&#160; We have quirks in place for nearly all Intel PCH root ports, 9-series is coming in kernel 4.2</p> </div> <div class="postsignature postmsg"><hr /><p><a href="http://vfio.blogspot.com" rel="nofollow">http://vfio.blogspot.com</a><br />Looking for a more open forum to discuss vfio related uses?&#160; Try <a href="https://www.redhat.com/mailman/listinfo/vfio-users" rel="nofollow">https://www.redhat.com/mailman/listinfo/vfio-users</a></p></div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1528638">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1528643" class="blockpost rowodd"> <h2><span><span class="conr">#5086</span> <a href="viewtopic.php?pid=1528643#p1528643">2015-05-14 13:19:38</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=85004">protake</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2014-09-09</span></dd> <dd><span>Posts: 6</span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>aw wrote:</cite><blockquote><div><p>There are kernel commandline options required to enable the acs override patch.&#160; What chipset is this?&#160; We have quirks in place for nearly all Intel PCH root ports, 9-series is coming in kernel 4.2</p></div></blockquote></div><p>Intel H97.</p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1528643">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1528644" class="blockpost roweven"> <h2><span><span class="conr">#5087</span> <a href="viewtopic.php?pid=1528644#p1528644">2015-05-14 13:23:54</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=84760">Denso</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd class="postavatar"><img src="https://bbs.archlinux.org/img/avatars/84760.png?m=1412533733" width="71" height="80" alt="" /></dd> <dd><span>Registered: 2014-08-30</span></dd> <dd><span>Posts: 179</span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>protake wrote:</cite><blockquote><div><p>Intel H97.</p></div></blockquote></div><div class="quotebox"><cite>aw wrote:</cite><blockquote><div><p>9-series is coming in kernel 4.2</p></div></blockquote></div> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1528644">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1528651" class="blockpost rowodd"> <h2><span><span class="conr">#5088</span> <a href="viewtopic.php?pid=1528651#p1528651">2015-05-14 13:36:16</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=85004">protake</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2014-09-09</span></dd> <dd><span>Posts: 6</span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>Denso wrote:</cite><blockquote><div><div class="quotebox"><cite>protake wrote:</cite><blockquote><div><p>Intel H97.</p></div></blockquote></div><div class="quotebox"><cite>aw wrote:</cite><blockquote><div><p>9-series is coming in kernel 4.2</p></div></blockquote></div></div></blockquote></div><p>Yeah, I understood as much. I just wanted to mention it. Thanks for all the replies!</p><p>edit: Is there anything I could do until 4.2 hits?</p> <p class="postedit"><em>Last edited by protake (2015-05-14 16:43:29)</em></p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1528651">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1528756" class="blockpost roweven"> <h2><span><span class="conr">#5089</span> <a href="viewtopic.php?pid=1528756#p1528756">2015-05-14 17:29:03</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=80701">apex8</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2014-03-29</span></dd> <dd><span>Posts: 47</span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <p>I have the problem that google play movies doesn&#039;t work anymore on my arch host since around February this year. I didn&#039;t find a solution yet, also tried to use the windows version of firefox in wine, but it won&#039;t work.<br />Now I&#039;m wondering why it also doesn&#039;t work in my Windows 7 VM. I havn&#039;t installed much there. Basically it&#039;s a Firefox, flash player, Steam and drivers. Are there any host requirements or some qemu configuration I need to respect for that?</p><p>BR<br />apex</p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1528756">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1528765" class="blockpost rowodd"> <h2><span><span class="conr">#5090</span> <a href="viewtopic.php?pid=1528765#p1528765">2015-05-14 18:07:30</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=85314">Duelist</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2014-09-22</span></dd> <dd><span>Posts: 358</span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>apex8 wrote:</cite><blockquote><div><p>I have the problem that google play movies doesn&#039;t work anymore on my arch host since around February this year. I didn&#039;t find a solution yet, also tried to use the windows version of firefox in wine, but it won&#039;t work.<br />Now I&#039;m wondering why it also doesn&#039;t work in my Windows 7 VM. I havn&#039;t installed much there. Basically it&#039;s a Firefox, flash player, Steam and drivers. Are there any host requirements or some qemu configuration I need to respect for that?</p><p>BR<br />apex</p></div></blockquote></div><p>First thing that comes to my mind - some weird DRM system. You suuure that everything else works fine?</p> </div> <div class="postsignature postmsg"><hr /><p><span class="bbs">The forum rules prohibit requesting support for distributions other than arch.</span><br /><a href="https://bbs.archlinux.org/viewtopic.php?pid=1551460#p1551460" rel="nofollow">I gave up.</a><a href="https://bbs.archlinux.org/viewtopic.php?id=162768" rel="nofollow"> It was too late.</a><br /><a href="http://pastebin.com/B3fL84bq" rel="nofollow">What I was trying to do</a>.<br /><a href="http://vfio.blogspot.com/" rel="nofollow">The reference about VFIO and KVM VGA passthrough.</a></p></div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1528765">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1528769" class="blockpost roweven"> <h2><span><span class="conr">#5091</span> <a href="viewtopic.php?pid=1528769#p1528769">2015-05-14 18:28:33</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=80701">apex8</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2014-03-29</span></dd> <dd><span>Posts: 47</span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>Duelist wrote:</cite><blockquote><div><div class="quotebox"><cite>apex8 wrote:</cite><blockquote><div><p>I have the problem that google play movies doesn&#039;t work anymore on my arch host since around February this year. I didn&#039;t find a solution yet, also tried to use the windows version of firefox in wine, but it won&#039;t work.<br />Now I&#039;m wondering why it also doesn&#039;t work in my Windows 7 VM. I havn&#039;t installed much there. Basically it&#039;s a Firefox, flash player, Steam and drivers. Are there any host requirements or some qemu configuration I need to respect for that?</p><p>BR<br />apex</p></div></blockquote></div><p>First thing that comes to my mind - some weird DRM system. You suuure that everything else works fine?</p></div></blockquote></div><p>You mean in the VM? Gaming is totally fine. Couldn&#039;t think of anything in particular, which is missing..</p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1528769">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1528779" class="blockpost rowodd"> <h2><span><span class="conr">#5092</span> <a href="viewtopic.php?pid=1528779#p1528779">2015-05-14 19:11:16</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=85314">Duelist</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2014-09-22</span></dd> <dd><span>Posts: 358</span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>apex8 wrote:</cite><blockquote><div><div class="quotebox"><cite>Duelist wrote:</cite><blockquote><div><div class="quotebox"><cite>apex8 wrote:</cite><blockquote><div><p>I have the problem that google play movies doesn&#039;t work anymore on my arch host since around February this year. I didn&#039;t find a solution yet, also tried to use the windows version of firefox in wine, but it won&#039;t work.<br />Now I&#039;m wondering why it also doesn&#039;t work in my Windows 7 VM. I havn&#039;t installed much there. Basically it&#039;s a Firefox, flash player, Steam and drivers. Are there any host requirements or some qemu configuration I need to respect for that?</p><p>BR<br />apex</p></div></blockquote></div><p>First thing that comes to my mind - some weird DRM system. You suuure that everything else works fine?</p></div></blockquote></div><p>You mean in the VM? Gaming is totally fine. Couldn&#039;t think of anything in particular, which is missing..</p></div></blockquote></div><p>Oh, it doesn&#039;t work on the host...<br />What hardware do you have on the host? Maybe it&#039;s just some messed up codecs(google likes using &quot;new&quot; codecs like vp8/9 or something)?</p><br /><p>Slightly OT:<br />guys, please, save me from going insane - i&#039;m considering buying a third asus HD7750 silent GPU. It&#039;s located ~180km away, one of the cheapest 7750s, and i don&#039;t even have space in the case to fit it yet. But something shivers inside me when i look at it. Just imagine running a tri-way crossfire(however, amd support once said that crossfire requires an even number of cards) in a VM. Even if crossfire won&#039;t work, i&#039;ll just set up another VM... Maybe running it will require some hardcore case <span class="bbs">modding</span> butchering and fitting a riser-card to run it from x1 pci-e, or maybe i&#039;ll need to switch to kaveri C/APUs for pci-e3.0... But daaamn, i want that card, while understanding that the idea is bizarre.</p> <p class="postedit"><em>Last edited by Duelist (2015-05-14 19:20:39)</em></p> </div> <div class="postsignature postmsg"><hr /><p><span class="bbs">The forum rules prohibit requesting support for distributions other than arch.</span><br /><a href="https://bbs.archlinux.org/viewtopic.php?pid=1551460#p1551460" rel="nofollow">I gave up.</a><a href="https://bbs.archlinux.org/viewtopic.php?id=162768" rel="nofollow"> It was too late.</a><br /><a href="http://pastebin.com/B3fL84bq" rel="nofollow">What I was trying to do</a>.<br /><a href="http://vfio.blogspot.com/" rel="nofollow">The reference about VFIO and KVM VGA passthrough.</a></p></div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1528779">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1528807" class="blockpost roweven"> <h2><span><span class="conr">#5093</span> <a href="viewtopic.php?pid=1528807#p1528807">2015-05-14 21:08:35</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=75590">aw</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2013-10-04</span></dd> <dd><span>Posts: 921</span></dd> <dd class="usercontacts"><span class="email"><a href="misc.php?email=75590">Email</a></span> <span class="website"><a href="http://vfio.blogspot.com/" rel="nofollow">Website</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>Duelist wrote:</cite><blockquote><div><p>Slightly OT:<br />guys, please, save me from going insane - i&#039;m considering buying a third asus HD7750 silent GPU...</p></div></blockquote></div><p>That&#039;s certainly a strange obsession you&#039;ve got for a relatively mediocre card.&#160; I&#039;ve got my own, so I won&#039;t rib you on it too hard.&#160; It&#039;s at least silent, but if you&#039;re already got two of these power sucking cards in your system, do you really want to add 50% more?&#160; Personally I don&#039;t see why CF/SLI is even on the radar for most people, single card performance on a recent card should handily beat multi-card performance from a few years ago.&#160; I don&#039;t know about AMD, but Nvidia is doing some pretty impressive work on power efficiency with Maxwell.</p> </div> <div class="postsignature postmsg"><hr /><p><a href="http://vfio.blogspot.com" rel="nofollow">http://vfio.blogspot.com</a><br />Looking for a more open forum to discuss vfio related uses?&#160; Try <a href="https://www.redhat.com/mailman/listinfo/vfio-users" rel="nofollow">https://www.redhat.com/mailman/listinfo/vfio-users</a></p></div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1528807">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1528845" class="blockpost rowodd"> <h2><span><span class="conr">#5094</span> <a href="viewtopic.php?pid=1528845#p1528845">2015-05-14 23:54:19</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=84760">Denso</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd class="postavatar"><img src="https://bbs.archlinux.org/img/avatars/84760.png?m=1412533733" width="71" height="80" alt="" /></dd> <dd><span>Registered: 2014-08-30</span></dd> <dd><span>Posts: 179</span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>protake wrote:</cite><blockquote><div><p>edit: Is there anything I could do until 4.2 hits?</p></div></blockquote></div><p>Sure , compile a kernel with ACS patch , add :</p><div class="codebox"><pre><code>pcie_acs_override=downstream</code></pre></div><p>to your boot parameters .</p><p>Cheers !</p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1528845">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1529032" class="blockpost roweven"> <h2><span><span class="conr">#5095</span> <a href="viewtopic.php?pid=1529032#p1529032">2015-05-15 18:04:19</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=90340">paperinick</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2015-04-14</span></dd> <dd><span>Posts: 8</span></dd> <dd class="usercontacts"><span class="email"><a href="misc.php?email=90340">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <p>I am trying to use OVMF but after reboot the VM hangs with a black screen (even if I don&#039;t have VGA passthrough enabled). This happens even with some Linux distros as guest.<br />My fear is that I might be hitting some random daily OVMF build bug. If you have a successful setup with OVMF would you mind sharing the OVMF image you are using? Thanks!!</p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1529032">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1529092" class="blockpost rowodd"> <h2><span><span class="conr">#5096</span> <a href="viewtopic.php?pid=1529092#p1529092">2015-05-15 21:19:31</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=85314">Duelist</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2014-09-22</span></dd> <dd><span>Posts: 358</span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>aw wrote:</cite><blockquote><div><div class="quotebox"><cite>Duelist wrote:</cite><blockquote><div><p>Slightly OT:<br />guys, please, save me from going insane - i&#039;m considering buying a third asus HD7750 silent GPU...</p></div></blockquote></div><p>That&#039;s certainly a strange obsession you&#039;ve got for a relatively mediocre card.&#160; I&#039;ve got my own, so I won&#039;t rib you on it too hard.&#160; It&#039;s at least silent, but if you&#039;re already got two of these power sucking cards in your system, do you really want to add 50% more?&#160; Personally I don&#039;t see why CF/SLI is even on the radar for most people, single card performance on a recent card should handily beat multi-card performance from a few years ago.&#160; I don&#039;t know about AMD, but Nvidia is doing some pretty impressive work on power efficiency with Maxwell.</p></div></blockquote></div><p>Each card consumes only 55W full-throttle.Yes, that&#039;s almost twice as less than CPU&#039;s TDP. Considering ULPS and zerocore and simple declocking - when half-loaded or idle they should consume even less.<br />50% more? Not 50%. Second card gave me 1.3x-1.9x performance(unigine benchmark makes a good use of CF, heh). The reason i&#039;m obsessed with this - i can&#039;t sell them due to... multiple reasons.<br />But it&#039;s not enough performance-wise(and as my mind hints me - it&#039;ll never be), and having a somewhat unique and bizarre config makes me feel funny. Oh, and 2gb of video ram isn&#039;t quite awesome for my taste, however i don&#039;t like that tendency to bloat video ram sizes(12GB?! 512mb was enough-for-everyone some years ago)</p><p>Oh, and that HD7750 is still good on performance/power/money chart. Of course, GTX750 overtakes it, but still.<br />Due to some magic, i could&#039;ve continued mining litecoins and still have profit(because 55w of electricity was equal to zero cents per month. I&#039;m serious) four months ago. That&#039;s how weird these cards are.</p><div class="quotebox"><cite>paperinick wrote:</cite><blockquote><div><p>I am trying to use OVMF but after reboot the VM hangs with a black screen (even if I don&#039;t have VGA passthrough enabled). This happens even with some Linux distros as guest.<br />My fear is that I might be hitting some random daily OVMF build bug. If you have a successful setup with OVMF would you mind sharing the OVMF image you are using? Thanks!!</p></div></blockquote></div><p>Weeeeeeird. I have libvirt and kraxel-org-based jenkins-git images, and it works fine there.</p> <p class="postedit"><em>Last edited by Duelist (2015-05-15 21:20:55)</em></p> </div> <div class="postsignature postmsg"><hr /><p><span class="bbs">The forum rules prohibit requesting support for distributions other than arch.</span><br /><a href="https://bbs.archlinux.org/viewtopic.php?pid=1551460#p1551460" rel="nofollow">I gave up.</a><a href="https://bbs.archlinux.org/viewtopic.php?id=162768" rel="nofollow"> It was too late.</a><br /><a href="http://pastebin.com/B3fL84bq" rel="nofollow">What I was trying to do</a>.<br /><a href="http://vfio.blogspot.com/" rel="nofollow">The reference about VFIO and KVM VGA passthrough.</a></p></div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1529092">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1529106" class="blockpost roweven"> <h2><span><span class="conr">#5097</span> <a href="viewtopic.php?pid=1529106#p1529106">2015-05-15 21:42:30</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=75590">aw</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2013-10-04</span></dd> <dd><span>Posts: 921</span></dd> <dd class="usercontacts"><span class="email"><a href="misc.php?email=75590">Email</a></span> <span class="website"><a href="http://vfio.blogspot.com/" rel="nofollow">Website</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>Duelist wrote:</cite><blockquote><div><p>...because 55w of electricity was equal to zero cents per month....</p></div></blockquote></div><p>How do you figure that?&#160; Free electric?&#160; Surplus production?&#160; 55 watts 1.sh topic_100.html topic_101.html topic_102.html topic_103.html topic_104.html topic_105.html topic_106.html topic_107.html topic_108.html topic_109.html topic_10.html topic_110.html topic_111.html topic_112.html topic_113.html topic_114.html topic_115.html topic_116.html topic_117.html topic_118.html topic_119.html topic_11.html topic_120.html topic_121.html topic_122.html topic_123.html topic_124.html topic_125.html topic_126.html topic_127.html topic_128.html topic_129.html topic_12.html topic_130.html topic_131.html topic_132.html topic_133.html topic_134.html topic_135.html topic_136.html topic_137.html topic_138.html topic_139.html topic_13.html topic_140.html topic_141.html topic_142.html topic_143.html topic_144.html topic_145.html topic_146.html topic_147.html topic_148.html topic_149.html topic_14.html topic_150.html topic_151.html topic_152.html topic_153.html topic_154.html topic_155.html topic_156.html topic_157.html topic_158.html topic_159.html topic_15.html topic_160.html topic_161.html topic_162.html topic_163.html topic_164.html topic_165.html topic_166.html topic_167.html topic_168.html topic_169.html topic_16.html topic_170.html topic_171.html topic_172.html topic_173.html topic_174.html topic_175.html topic_176.html topic_177.html topic_178.html topic_179.html topic_17.html topic_180.html topic_181.html topic_182.html topic_183.html topic_184.html topic_185.html topic_186.html topic_187.html topic_188.html topic_189.html topic_18.html topic_190.html topic_191.html topic_192.html topic_193.html topic_194.html topic_195.html topic_196.html topic_197.html topic_198.html topic_199.html topic_19.html topic_1.html topic_200.html topic_201.html topic_202.html topic_203.html topic_20.html topic_21.html topic_22.html topic_23.html topic_24.html topic_25.html topic_26.html topic_27.html topic_28.html topic_29.html topic_2.html topic_30.html topic_31.html topic_32.html topic_33.html topic_34.html topic_35.html topic_36.html topic_37.html topic_38.html topic_39.html topic_3.html topic_40.html topic_41.html topic_42.html topic_43.html topic_44.html topic_45.html topic_46.html topic_47.html topic_48.html topic_49.html topic_4.html topic_50.html topic_51.html topic_52.html topic_53.html topic_54.html topic_55.html topic_56.html topic_57.html topic_58.html topic_59.html topic_5.html topic_60.html topic_61.html topic_62.html topic_63.html topic_64.html topic_65.html topic_66.html topic_67.html topic_68.html topic_69.html topic_6.html topic_70.html topic_71.html topic_72.html topic_73.html topic_74.html topic_75.html topic_76.html topic_77.html topic_78.html topic_79.html topic_7.html topic_80.html topic_81.html topic_82.html topic_83.html topic_84.html topic_85.html topic_86.html topic_87.html topic_88.html topic_89.html topic_8.html topic_90.html topic_91.html topic_92.html topic_93.html topic_94.html topic_95.html topic_96.html topic_97.html topic_98.html topic_99.html topic_9.html 24 hours = 1.32kW, which is 10 cents per day from my utility even at the lowest tier</p> </div> <div class="postsignature postmsg"><hr /><p><a href="http://vfio.blogspot.com" rel="nofollow">http://vfio.blogspot.com</a><br />Looking for a more open forum to discuss vfio related uses?&#160; Try <a href="https://www.redhat.com/mailman/listinfo/vfio-users" rel="nofollow">https://www.redhat.com/mailman/listinfo/vfio-users</a></p></div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1529106">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1529119" class="blockpost rowodd"> <h2><span><span class="conr">#5098</span> <a href="viewtopic.php?pid=1529119#p1529119">2015-05-15 22:13:33</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=91171">sweetsuicide</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2015-05-15</span></dd> <dd><span>Posts: 1</span></dd> <dd class="usercontacts"><span class="email"><a href="misc.php?email=91171">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <p>Hello everybody here,<br /> this is some awesome work done here. I built a computer specifically for running windows inside a vm with secondary GPU passthough. I followed instructions from the main page here mixed with the similar <a href="https://wiki.archlinux.org/index.php/PCI_passthrough_via_OVMF" rel="nofollow">https://wiki.archlinux.org/index.php/PC … h_via_OVMF</a> guide. This means that I have the builds from Hoffmann&#039;s repository. I have not stepped up to libvirt yet, mainly because I haven&#039;t installed any DE or WM.<br />So here&#039;s my problem: everything looks fine (qemu boots up, secondary gpu fires up with qxl), but I cannot install windows. Windows8 iso is not even browsable through the efi shell. Windows 7 is readable but it stops immediately with an error (boot related, 0xc000000d code something).<br />I have no I idea what&#039;s happening.<br />Setup is following:<br />i7-4770<br />ASRock Z87 Extreme4<br />16GB RAM<br />two ssd&#039;s<br />R9 280x</p><p>radeon module was blacklisted (even it doesn&#039;t seem like it&#039;s necessary, as video card powers up when I start qemu). Qemu command:</p><div class="codebox"><pre><code>qemu-system-x86_64\ -enable-kvm\ -cpu host,kvm=off\ -nographic -m 8192 -vga qxl\ -device vfio-pci,host=01:00.0 -device vfio-pci,host=01:00.1 -device vfio-pci,host=00:1b.0\ -drive if=pflash,format=raw,readonly,file=/usr/share/edk2.git/ovmf-x64/OVMF_CODE-pure-efi.fd\ -drive if=pflash,format=raw,file=/home/luca/this.fd\ -device virtio-scsi-pci,id=scsi -drive file=/mnt/SAND/win.cow,id=disk,if=none,cache=writeback\ -device scsi-hd,drive=disk -drive file=/home/user/Windows81.iso,id=isocd,if=none -device scsi-cd,drive=isocd\ -drive file=/home/luca/virtio-win-0.1.96.iso,id=virtiocd,if=none -device ide-cd,bus=ide.1,drive=virtiocd\ -usb -usbdevice host:045e:07f8 -usbdevice host:046d:c408</code></pre></div><p>Command given as root (not much choice here)</p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1529119">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1529124" class="blockpost roweven"> <h2><span><span class="conr">#5099</span> <a href="viewtopic.php?pid=1529124#p1529124">2015-05-15 22:35:25</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=75590">aw</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2013-10-04</span></dd> <dd><span>Posts: 921</span></dd> <dd class="usercontacts"><span class="email"><a href="misc.php?email=75590">Email</a></span> <span class="website"><a href="http://vfio.blogspot.com/" rel="nofollow">Website</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>sweetsuicide wrote:</cite><blockquote><div><p>secondary gpu fires up with qxl</p></div></blockquote></div><p>What does that even mean?</p><div class="quotebox"><blockquote><div><div class="codebox"><pre><code>qemu-system-x86_64\ -enable-kvm\ -cpu host,kvm=off\ -nographic -m 8192 -vga qxl\</code></pre></div></div></blockquote></div><p>Huh?&#160; QXL is an emulated graphics card.&#160; It might make sense to have it since you claim to be wanting to setup a secondary graphics configuration, but what&#039;s supposed to happen with <em>-nographic</em>?&#160; Where is the QXL graphics supposed to display?&#160; Your choices are SDL, VNC, or Spice, but if you leave <em>-nographic</em>, you might as well dump the QXL device with <em>-vga none</em>.</p><p>Others have had trouble with the ISO format, that may be what you&#039;re running into with the install image, something about UDF vs ISO9660.&#160; I&#039;ve never had a problem with images from MSDN.</p><p>Your setup seems textbook enough that I&#039;d follow the howto guide in my blog (link in sig) once you get your ISO format straightened out (libvirt does not require a DE/WM.&#160; Even the graphical tools like virt-manager can be run remotely if your system is headless).</p><p>BTW, you don&#039;t need kvm=off for an AMD GPU.</p> </div> <div class="postsignature postmsg"><hr /><p><a href="http://vfio.blogspot.com" rel="nofollow">http://vfio.blogspot.com</a><br />Looking for a more open forum to discuss vfio related uses?&#160; Try <a href="https://www.redhat.com/mailman/listinfo/vfio-users" rel="nofollow">https://www.redhat.com/mailman/listinfo/vfio-users</a></p></div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1529124">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1529130" class="blockpost rowodd"> <h2><span><span class="conr">#5100</span> <a href="viewtopic.php?pid=1529130#p1529130">2015-05-15 23:11:22</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=80701">apex8</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2014-03-29</span></dd> <dd><span>Posts: 47</span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <p>What would be a good choice for a motherboard at the moment, given that I still want to use it for a gaming VM and having at least two pcie x16 slots?</p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1529130">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div class="postlinksb"> <div class="inbox crumbsplus"> <div class="pagepost"> <p class="pagelink conl"><span class="pages-label">Pages: </span><a rel="prev" class="item1" href="viewtopic.php?id=162768&amp;p=203">Previous</a> <a href="viewtopic.php?id=162768">1</a> <span class="spacer">…</span> <a href="viewtopic.php?id=162768&amp;p=202">202</a> <a href="viewtopic.php?id=162768&amp;p=203">203</a> <strong>204</strong> <a href="viewtopic.php?id=162768&amp;p=205">205</a> <a href="viewtopic.php?id=162768&amp;p=206">206</a> <span class="spacer">…</span> <a href="viewtopic.php?id=162768&amp;p=234">234</a> <a rel="next" href="viewtopic.php?id=162768&amp;p=205">Next</a></p> <p class="postlink conr">Topic closed</p> </div> <ul class="crumbs"> <li><a href="index.php">Index</a></li> <li><span>»&#160;</span><a href="viewforum.php?id=48">Topics Going Nowhere</a></li> <li><span>»&#160;</span><strong><a href="viewtopic.php?id=162768">KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</a></strong></li> </ul> <p class="subscribelink clearb"><a href="misc.php?action=subscribe&amp;tid=162768">Subscribe to this topic</a></p> <div class="clearer"></div> </div> </div> </div> <div id="brdfooter" class="block"> <h2><span>Board footer</span></h2> <div class="box"> <div id="brdfooternav" class="inbox"> <div class="conl"> <form id="qjump" method="get" action="viewforum.php"> <div><label><span>Jump to<br /></span> <select name="id" onchange="window.location=('viewforum.php?id='+this.options[this.selectedIndex].value)"> <optgroup label="Technical Issues and Assistance"> <option value="23">Newbie Corner</option> <option value="17">Installation</option> <option value="22">Kernel &amp; Hardware</option> <option value="18">Applications &amp; Desktop Environments</option> <option value="31">Laptop Issues</option> <option value="8">Networking, Server, and Protection</option> <option value="32">Multimedia and Games</option> <option value="50">System Administration</option> <option value="35">Other Architectures</option> </optgroup> <optgroup label="Arch-centric"> <option value="24">Announcements, Package &amp; Security Advisories</option> <option value="1">Arch Discussion</option> <option value="13">Forum &amp; Wiki discussion</option> </optgroup> <optgroup label="Pacman Upgrades, Packaging &amp; AUR"> <option value="44">Pacman &amp; Package Upgrade Issues</option> <option value="49">[testing] Repo Forum</option> <option value="4">Creating &amp; Modifying Packages</option> <option value="38">AUR Issues, Discussion &amp; PKGBUILD Requests</option> </optgroup> <optgroup label="Contributions &amp; Discussion"> <option value="20">GNU/Linux Discussion</option> <option value="27">Community Contributions</option> <option value="33">Programming &amp; Scripting</option> <option value="30">Other Languages</option> <option value="47">Artwork and Screenshots</option> <option value="42">Try This</option> </optgroup> <optgroup label="/dev/null"> <option value="29">Off-Topic</option> <option value="48" selected="selected">Topics Going Nowhere</option> <option value="36">Dustbin</option> </optgroup> </select></label> <input type="submit" value=" Go " accesskey="g" /> </div> </form> </div> <div class="conr"> <p id="feedlinks"><span class="atom"><a href="extern.php?action=feed&amp;tid=162768&amp;type=atom">Atom topic feed</a></span></p> <p id="poweredby">Powered by <a href="http://fluxbb.org/">FluxBB</a></p> </div> <div class="clearer"></div> </div> </div> </div> </div> <div class="end-box"></div> </div> </body> </html>
