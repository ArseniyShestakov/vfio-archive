<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"> <html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en" dir="ltr"> <head> <meta http-equiv="Content-Type" content="text/html; charset=utf-8" /> <title>KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9 (Page 233) / Topics Going Nowhere / Arch Linux Forums</title> <link rel="stylesheet" type="text/css" href="style/ArchLinux.css" /> <link rel="canonical" href="viewtopic.php?id=162768&amp;p=233" title="Page 233" /> <link rel="prev" href="viewtopic.php?id=162768&amp;p=232" title="Page 232" /> <link rel="next" href="viewtopic.php?id=162768&amp;p=234" title="Page 234" /> <link rel="alternate" type="application/atom+xml" href="extern.php?action=feed&amp;tid=162768&amp;type=atom" title="Atom topic feed" /> <link rel="stylesheet" media="screen" href="style/ArchLinux/arch.css?v=3" /> <link rel="stylesheet" media="screen" href="style/ArchLinux/archnavbar.css?v=2" /> <link rel="shortcut icon" href="style/ArchLinux/favicon.ico" /> </head> <body> <div id="archnavbar" class="anb-forum"> <div id="archnavbarlogo"><h1><a href="http://www.archlinux.org/">Arch Linux</a></h1></div> <div id="archnavbarmenu"> <ul id="archnavbarlist"> <li id="anb-home"><a href="http://www.archlinux.org/">Home</a></li><li id="anb-packages"><a href="http://www.archlinux.org/packages/">Packages</a></li><li id="anb-forums" class="anb-selected"><a href="https://bbs.archlinux.org/">Forums</a></li><li id="anb-wiki"><a href="https://wiki.archlinux.org/">Wiki</a></li><li id="anb-bugs"><a href="https://bugs.archlinux.org/">Bugs</a></li><li id="anb-aur"><a href="https://aur.archlinux.org/">AUR</a></li><li id="anb-download"><a href="http://www.archlinux.org/download/">Download</a></li> </ul> </div> </div> <div id="punviewtopic" class="pun"> <div class="top-box"></div> <div class="punwrap"> <div id="brdheader" class="block"> <div class="box"> <div id="brdmenu" class="inbox"> <ul> <li id="navindex" class="isactive"><a href="index.php">Index</a></li> <li id="navuserlist"><a href="userlist.php">User list</a></li> <li id="navsearch"><a href="search.php">Search</a></li> <li id="navprofile"><a href="profile.php?id=80749">Profile</a></li> <li id="navlogout"><a href="login.php?action=out&amp;id=80749&amp;csrf_token=5c20501ec397bb45ef8ee8c84db232c8d8e421c6">Logout</a></li> </ul> </div> <div id="brdwelcome" class="inbox"> <ul class="conl"> <li><span>Logged in as <strong>SXX</strong></span></li> <li><span>Last visit: 2015-08-16 12:20:09</span></li> </ul> <ul class="conr"> <li><span>Topics: <a href="search.php?action=show_replies" title="Find topics you have posted to.">Posted</a> | <a href="search.php?action=show_new" title="Find topics with new posts since your last visit.">New</a> | <a href="search.php?action=show_recent" title="Find topics with recent posts.">Active</a> | <a href="search.php?action=show_unanswered" title="Find topics with no replies.">Unanswered</a></span></li> </ul> <div class="clearer"></div> </div> </div> </div> <div id="brdmain"> <div class="linkst"> <div class="inbox crumbsplus"> <ul class="crumbs"> <li><a href="index.php">Index</a></li> <li><span>»&#160;</span><a href="viewforum.php?id=48">Topics Going Nowhere</a></li> <li><span>»&#160;</span><strong><a href="viewtopic.php?id=162768">KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</a></strong></li> </ul> <div class="pagepost"> <p class="pagelink conl"><span class="pages-label">Pages: </span><a rel="prev" class="item1" href="viewtopic.php?id=162768&amp;p=232">Previous</a> <a href="viewtopic.php?id=162768">1</a> <span class="spacer">…</span> <a href="viewtopic.php?id=162768&amp;p=231">231</a> <a href="viewtopic.php?id=162768&amp;p=232">232</a> <strong>233</strong> <a href="viewtopic.php?id=162768&amp;p=234">234</a> <a rel="next" href="viewtopic.php?id=162768&amp;p=234">Next</a></p> <p class="postlink conr">Topic closed</p> </div> <div class="clearer"></div> </div> </div> <div id="p1550064" class="blockpost rowodd blockpost1"> <h2><span><span class="conr">#5801</span> <a href="viewtopic.php?pid=1550064#p1550064">2015-08-03 00:26:13</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=79950">holovati</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd class="postavatar"><img src="https://bbs.archlinux.org/img/avatars/79950.jpg?m=1396087223" width="74" height="74" alt="" /></dd> <dd><span>From: Denmark</span></dd> <dd><span>Registered: 2014-03-04</span></dd> <dd><span>Posts: 4</span></dd> <dd class="usercontacts"><span class="email"><a href="mailto:holovati@gmail.com">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>lersek wrote:</cite><blockquote><div><div class="quotebox"><cite>Duelist wrote:</cite><blockquote><div><p>Is there a legitimate way of attaching an ISA debug console to a libvirt domain(VM)? I tried to pass the regular options as qemu:commandline, but it says that there&#039;s no such option...<br />Googling that problem leads me to my own messages about that debug feature.</p></div></blockquote></div><p>I&#039;m sure you did the right thing -- almost. The bit that you probably missed is that the &quot;commandline&quot; and &quot;arg&quot; elements come from a different XML namespace than the rest of the elements in the domain XML. (They are defined by an XML Schema that targets the &quot;<a href="http://libvirt.org/schemas/domain/qemu/1.0" rel="nofollow">http://libvirt.org/schemas/domain/qemu/1.0</a>&quot; namespace -- BTW do not click this link, it&#039;s just a string.)</p><p>Therefore, you have to declare that XML namespace with a namespace prefix, and qualify the &quot;commandline&quot; and &quot;arg&quot; elements with this namespace prefix. This namespace / prefix association can occur in any element that (recursively) contains these elements; or, even, you could just set the default namespace with attributes of the &quot;arg&quot; and &quot;commandline&quot; elements themselves (but that would take a lot more typing). See:</p><p><a href="https://en.wikipedia.org/wiki/XML_namespace#Namespace_declaration" rel="nofollow">https://en.wikipedia.org/wiki/XML_names … eclaration</a></p><p>In practice though, the namespace is usually declared in the root element of the XML document.</p><p>Anyway, enough of the abstract discussion, here&#039;s what you need:</p><div class="codebox"><pre><code>&lt;domain type=&#039;kvm&#039; xmlns:qemu=&#039;http://libvirt.org/schemas/domain/qemu/1.0&#039;&gt; ... stuff ... &lt;qemu:commandline&gt; &lt;qemu:arg value=&#039;-global&#039;/&gt; &lt;qemu:arg value=&#039;isa-debugcon.iobase=0x402&#039;/&gt; &lt;qemu:arg value=&#039;-debugcon&#039;/&gt; &lt;qemu:arg value=&#039;file:/tmp/GUEST_NAME.log&#039;/&gt; &lt;/qemu:commandline&gt; &lt;/domain&gt;</code></pre></div><p>In the above, </p><div class="codebox"><pre><code>qemu</code></pre></div><p> is the <em>namespace prefix</em> being declared, </p><div class="codebox"><pre><code>http://libvirt.org/schemas/domain/qemu/1.0</code></pre></div><p> is the <em>namespace URI</em> being mapped to the </p><div class="codebox"><pre><code>qemu</code></pre></div><p> namespace prefix, and </p><div class="codebox"><pre><code>qemu:commandline</code></pre></div><p> and </p><div class="codebox"><pre><code>qemu:arg</code></pre></div><p> are the elements that you need.</p><p>(The &quot;qemu&quot; prefix is incidental, it could be replaced with any other prefix; the point is that the same prefix must be used in the namespace declaration and later for qualifying &quot;commandline&quot; and &quot;arg&quot;. The &quot;qemu&quot; prefix is just a &quot;mediator&quot;; what matters is that &quot;commandline&quot; and &quot;arg&quot; come from the namespace &quot;<a href="http://libvirt.org/schemas/domain/qemu/1.0" rel="nofollow">http://libvirt.org/schemas/domain/qemu/1.0</a>&quot;.)</p></div></blockquote></div><p>The namespace link seems dead.</p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1550064">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1550076" class="blockpost roweven"> <h2><span><span class="conr">#5802</span> <a href="viewtopic.php?pid=1550076#p1550076">2015-08-03 02:25:33</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=78620">mostlyharmless</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2014-01-16</span></dd> <dd><span>Posts: 50</span></dd> <dd class="usercontacts"><span class="email"><a href="misc.php?email=78620">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <p>Well if after 233 pages the Powers feel that the resident experts including the OP have violated the Arch Way, I guess that confirms everything I&#039;ve heard about the Arch community. Too bad. Perhaps I should just go back to Slackware, not that anyone really cares about that here.&#160; Sheesh.</p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1550076">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1550102" class="blockpost rowodd"> <h2><span><span class="conr">#5803</span> <a href="viewtopic.php?pid=1550102#p1550102">2015-08-03 06:32:46</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=92953">morphological</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2015-08-01</span></dd> <dd><span>Posts: 7</span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <p>KVM passthorugh seems to work fine on Lubuntu 14.4 but I seem to get better performance when I run it from arch.</p> <p class="postedit"><em>Last edited by morphological (2015-08-03 18:59:38)</em></p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1550102">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1550140" class="blockpost roweven"> <h2><span><span class="conr">#5804</span> <a href="viewtopic.php?pid=1550140#p1550140">2015-08-03 10:10:24</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=85314">Duelist</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2014-09-22</span></dd> <dd><span>Posts: 358</span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>morphological wrote:</cite><blockquote><div><p>Is there a way around using the grub.cfg, while getting the passthrough working?</p></div></blockquote></div><p>Depends on the bootloader you use. There&#039;s a very rude way of including the kernel command line into the kernel itself. Different platforms have it different. RaspberryPi, a common example of embedded linux, has a /boot/cmdline.txt file. But that&#039;s waay beyond of this topic.</p><br /><div class="quotebox"><cite>jasonwryan wrote:</cite><blockquote><div><p>No. There are support communities for those distributions; these boards are for Arch.</p></div></blockquote></div><p>Alright, alright! I have installed pacman again.</p><div class="codebox"><pre><code>[user@crossfire ~]$ pacman -V .--. Pacman v4.1.2 - libalpm v8.0.2 / _.-&#039; .-. .-. .-. Copyright (C) 2006-2013 Pacman Development Team \ &#039;-. &#039;-&#039; &#039;-&#039; &#039;-&#039; Copyright (C) 2002-2006 Judd Vinet &#039;--&#039; This program may be freely redistributed under the terms of the GNU General Public License. [user@crossfire ~]$ cat /etc/fedora-release Fedora release 22 (Twenty Two)</code></pre></div><p>See?</p> <p class="postedit"><em>Last edited by Duelist (2015-08-03 10:14:31)</em></p> </div> <div class="postsignature postmsg"><hr /><p><span class="bbs">The forum rules prohibit requesting support for distributions other than arch.</span><br /><a href="https://bbs.archlinux.org/viewtopic.php?pid=1551460#p1551460" rel="nofollow">I gave up.</a><a href="https://bbs.archlinux.org/viewtopic.php?id=162768" rel="nofollow"> It was too late.</a><br /><a href="http://pastebin.com/B3fL84bq" rel="nofollow">What I was trying to do</a>.<br /><a href="http://vfio.blogspot.com/" rel="nofollow">The reference about VFIO and KVM VGA passthrough.</a></p></div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1550140">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1550166" class="blockpost rowodd"> <h2><span><span class="conr">#5805</span> <a href="viewtopic.php?pid=1550166#p1550166">2015-08-03 12:19:02</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=92953">morphological</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2015-08-01</span></dd> <dd><span>Posts: 7</span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>Duelist wrote:</cite><blockquote><div><div class="quotebox"><cite>morphological wrote:</cite><blockquote><div><p>Is there a way around using the grub.cfg, while getting the passthrough working?</p></div></blockquote></div><p>Depends on the bootloader you use. There&#039;s a very rude way of including the kernel command line into the kernel itself. Different platforms have it different. RaspberryPi, a common example of embedded linux, has a /boot/cmdline.txt file. But that&#039;s waay beyond of this topic.</p></div></blockquote></div><p>I use arch and lubuntu 14.04 as my main systems.<br />Could you provide some links to documentation or a general topic designation this matter corresponds to?</p><p>Thanks!</p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1550166">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1550190" class="blockpost roweven"> <h2><span><span class="conr">#5806</span> <a href="viewtopic.php?pid=1550190#p1550190">2015-08-03 14:35:47</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=92995">fushfush</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2015-08-03</span></dd> <dd><span>Posts: 2</span></dd> <dd class="usercontacts"><span class="email"><a href="misc.php?email=92995">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <p>Hey Guys.</p><p>My current situations is this: </p><p>I got an W520 with an i7-2720QM and Nvidia Quadro 1000m. I want to virtualize with Debian as host and Windows as guest. Therefore i want to assign my Nvidia GPU to the guest. <br />The reason for this choice is because I&#039;m an mechanical engineering student, and that requires alot of windows-only programs.. </p><p>I got stuck at Nvidias error 43 problem. </p><p>I haved used the 377.88 Driver, with and without kvm as hidden. I have deleted all hypervisor tags.. It still reports error 43 ..&#160; </p><p>This is my config file over my virtual windows machine: </p><div class="codebox"><pre class="vscroll"><code>&lt;domain type=&#039;kvm&#039;&gt; &lt;name&gt;win7&lt;/name&gt; &lt;uuid&gt;5ebc2f74-7bbd-482d-99f4-660155187f8d&lt;/uuid&gt; &lt;memory unit=&#039;KiB&#039;&gt;6291456&lt;/memory&gt; &lt;currentMemory unit=&#039;KiB&#039;&gt;6291456&lt;/currentMemory&gt; &lt;vcpu placement=&#039;static&#039;&gt;4&lt;/vcpu&gt; &lt;os&gt; &lt;type arch=&#039;x86_64&#039; machine=&#039;pc-i440fx-2.3&#039;&gt;hvm&lt;/type&gt; &lt;bootmenu enable=&#039;no&#039;/&gt; &lt;/os&gt; &lt;features&gt; &lt;acpi/&gt; &lt;apic/&gt; &lt;pae/&gt; &lt;kvm&gt; &lt;hidden state=&#039;on&#039;/&gt; &lt;/kvm&gt; &lt;/features&gt; &lt;cpu mode=&#039;host-passthrough&#039;&gt; &lt;topology sockets=&#039;1&#039; cores=&#039;2&#039; threads=&#039;2&#039;/&gt; &lt;/cpu&gt; &lt;clock offset=&#039;localtime&#039;&gt; &lt;timer name=&#039;rtc&#039; tickpolicy=&#039;catchup&#039;/&gt; &lt;timer name=&#039;pit&#039; tickpolicy=&#039;delay&#039;/&gt; &lt;/clock&gt; &lt;on_poweroff&gt;destroy&lt;/on_poweroff&gt; &lt;on_reboot&gt;restart&lt;/on_reboot&gt; &lt;on_crash&gt;restart&lt;/on_crash&gt; &lt;pm&gt; &lt;suspend-to-mem enabled=&#039;no&#039;/&gt; &lt;suspend-to-disk enabled=&#039;no&#039;/&gt; &lt;/pm&gt; &lt;devices&gt; &lt;emulator&gt;/usr/bin/kvm&lt;/emulator&gt; &lt;disk type=&#039;block&#039; device=&#039;disk&#039;&gt; &lt;driver name=&#039;qemu&#039; type=&#039;raw&#039; cache=&#039;none&#039; io=&#039;native&#039;/&gt; &lt;source dev=&#039;/dev/sda3&#039;/&gt; &lt;target dev=&#039;vda&#039; bus=&#039;virtio&#039;/&gt; &lt;boot order=&#039;1&#039;/&gt; &lt;address type=&#039;pci&#039; domain=&#039;0x0000&#039; bus=&#039;0x00&#039; slot=&#039;0x07&#039; function=&#039;0x0&#039;/&gt; &lt;/disk&gt; &lt;disk type=&#039;block&#039; device=&#039;cdrom&#039;&gt; &lt;driver name=&#039;qemu&#039; type=&#039;raw&#039;/&gt; &lt;target dev=&#039;hdb&#039; bus=&#039;ide&#039;/&gt; &lt;readonly/&gt; &lt;boot order=&#039;3&#039;/&gt; &lt;address type=&#039;drive&#039; controller=&#039;0&#039; bus=&#039;0&#039; target=&#039;0&#039; unit=&#039;1&#039;/&gt; &lt;/disk&gt; &lt;controller type=&#039;usb&#039; index=&#039;0&#039; model=&#039;ich9-ehci1&#039;&gt; &lt;address type=&#039;pci&#039; domain=&#039;0x0000&#039; bus=&#039;0x00&#039; slot=&#039;0x06&#039; function=&#039;0x7&#039;/&gt; &lt;/controller&gt; &lt;controller type=&#039;usb&#039; index=&#039;0&#039; model=&#039;ich9-uhci1&#039;&gt; &lt;master startport=&#039;0&#039;/&gt; &lt;address type=&#039;pci&#039; domain=&#039;0x0000&#039; bus=&#039;0x00&#039; slot=&#039;0x06&#039; function=&#039;0x0&#039; multifunction=&#039;on&#039;/&gt; &lt;/controller&gt; &lt;controller type=&#039;usb&#039; index=&#039;0&#039; model=&#039;ich9-uhci2&#039;&gt; &lt;master startport=&#039;2&#039;/&gt; &lt;address type=&#039;pci&#039; domain=&#039;0x0000&#039; bus=&#039;0x00&#039; slot=&#039;0x06&#039; function=&#039;0x1&#039;/&gt; &lt;/controller&gt; &lt;controller type=&#039;usb&#039; index=&#039;0&#039; model=&#039;ich9-uhci3&#039;&gt; &lt;master startport=&#039;4&#039;/&gt; &lt;address type=&#039;pci&#039; domain=&#039;0x0000&#039; bus=&#039;0x00&#039; slot=&#039;0x06&#039; function=&#039;0x2&#039;/&gt; &lt;/controller&gt; &lt;controller type=&#039;pci&#039; index=&#039;0&#039; model=&#039;pci-root&#039;/&gt; &lt;controller type=&#039;ide&#039; index=&#039;0&#039;&gt; &lt;address type=&#039;pci&#039; domain=&#039;0x0000&#039; bus=&#039;0x00&#039; slot=&#039;0x01&#039; function=&#039;0x1&#039;/&gt; &lt;/controller&gt; &lt;controller type=&#039;virtio-serial&#039; index=&#039;0&#039;&gt; &lt;address type=&#039;pci&#039; domain=&#039;0x0000&#039; bus=&#039;0x00&#039; slot=&#039;0x05&#039; function=&#039;0x0&#039;/&gt; &lt;/controller&gt; &lt;interface type=&#039;network&#039;&gt; &lt;mac address=&#039;52:54:00:69:ea:30&#039;/&gt; &lt;source network=&#039;default&#039;/&gt; &lt;model type=&#039;virtio&#039;/&gt; &lt;address type=&#039;pci&#039; domain=&#039;0x0000&#039; bus=&#039;0x00&#039; slot=&#039;0x03&#039; function=&#039;0x0&#039;/&gt; &lt;/interface&gt; &lt;serial type=&#039;pty&#039;&gt; &lt;target port=&#039;0&#039;/&gt; &lt;/serial&gt; &lt;console type=&#039;pty&#039;&gt; &lt;target type=&#039;serial&#039; port=&#039;0&#039;/&gt; &lt;/console&gt; &lt;channel type=&#039;spicevmc&#039;&gt; &lt;target type=&#039;virtio&#039; name=&#039;com.redhat.spice.0&#039;/&gt; &lt;address type=&#039;virtio-serial&#039; controller=&#039;0&#039; bus=&#039;0&#039; port=&#039;1&#039;/&gt; &lt;/channel&gt; &lt;input type=&#039;tablet&#039; bus=&#039;usb&#039;/&gt; &lt;input type=&#039;mouse&#039; bus=&#039;ps2&#039;/&gt; &lt;input type=&#039;keyboard&#039; bus=&#039;ps2&#039;/&gt; &lt;graphics type=&#039;spice&#039; autoport=&#039;yes&#039;/&gt; &lt;sound model=&#039;ich6&#039;&gt; &lt;address type=&#039;pci&#039; domain=&#039;0x0000&#039; bus=&#039;0x00&#039; slot=&#039;0x04&#039; function=&#039;0x0&#039;/&gt; &lt;/sound&gt; &lt;video&gt; &lt;model type=&#039;qxl&#039; ram=&#039;65536&#039; vram=&#039;65536&#039; vgamem=&#039;16384&#039; heads=&#039;1&#039;/&gt; &lt;address type=&#039;pci&#039; domain=&#039;0x0000&#039; bus=&#039;0x00&#039; slot=&#039;0x02&#039; function=&#039;0x0&#039;/&gt; &lt;/video&gt; &lt;hostdev mode=&#039;subsystem&#039; type=&#039;pci&#039; managed=&#039;yes&#039;&gt; &lt;source&gt; &lt;address domain=&#039;0x0000&#039; bus=&#039;0x01&#039; slot=&#039;0x00&#039; function=&#039;0x0&#039;/&gt; &lt;/source&gt; &lt;address type=&#039;pci&#039; domain=&#039;0x0000&#039; bus=&#039;0x00&#039; slot=&#039;0x09&#039; function=&#039;0x0&#039;/&gt; &lt;/hostdev&gt; &lt;redirdev bus=&#039;usb&#039; type=&#039;spicevmc&#039;&gt; &lt;/redirdev&gt; &lt;redirdev bus=&#039;usb&#039; type=&#039;spicevmc&#039;&gt; &lt;/redirdev&gt; &lt;redirdev bus=&#039;usb&#039; type=&#039;spicevmc&#039;&gt; &lt;/redirdev&gt; &lt;redirdev bus=&#039;usb&#039; type=&#039;spicevmc&#039;&gt; &lt;/redirdev&gt; &lt;memballoon model=&#039;virtio&#039;&gt; &lt;address type=&#039;pci&#039; domain=&#039;0x0000&#039; bus=&#039;0x00&#039; slot=&#039;0x08&#039; function=&#039;0x0&#039;/&gt; &lt;/memballoon&gt; &lt;/devices&gt; &lt;/domain&gt;</code></pre></div><p>Can you help me with something i can go on with? I&#039;m pretty stuck at this point.</p><p>Thanks!</p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1550190">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1550222" class="blockpost rowodd"> <h2><span><span class="conr">#5807</span> <a href="viewtopic.php?pid=1550222#p1550222">2015-08-03 16:30:39</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=85314">Duelist</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2014-09-22</span></dd> <dd><span>Posts: 358</span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>fushfush wrote:</cite><blockquote><div><p>Hey Guys.</p><p>My current situations is this: </p><p>I got an W520 with an i7-2720QM and Nvidia Quadro 1000m. I want to virtualize with Debian as host and Windows as guest. Therefore i want to assign my Nvidia GPU to the guest. <br />The reason for this choice is because I&#039;m an mechanical engineering student, and that requires alot of windows-only programs.. <br />Thanks!</p></div></blockquote></div><p>Assuming this is a laptop, there was no one, who got it working properly AFAIR. So you&#039;re pretty much stuck with windows. However, i find it strange you have a quadro in there...<br />I can&#039;t give you an advice, but i can link you <a href="https://docs.google.com/spreadsheets/d/1LnGpTrXalwGVNy0PWJDURhyxa3sgqkGXmvNCIvIMenk/edit#gid=0" rel="nofollow">the spreadsheet of hardware.</a></p> </div> <div class="postsignature postmsg"><hr /><p><span class="bbs">The forum rules prohibit requesting support for distributions other than arch.</span><br /><a href="https://bbs.archlinux.org/viewtopic.php?pid=1551460#p1551460" rel="nofollow">I gave up.</a><a href="https://bbs.archlinux.org/viewtopic.php?id=162768" rel="nofollow"> It was too late.</a><br /><a href="http://pastebin.com/B3fL84bq" rel="nofollow">What I was trying to do</a>.<br /><a href="http://vfio.blogspot.com/" rel="nofollow">The reference about VFIO and KVM VGA passthrough.</a></p></div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1550222">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1550242" class="blockpost roweven"> <h2><span><span class="conr">#5808</span> <a href="viewtopic.php?pid=1550242#p1550242">2015-08-03 18:11:02</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=25579">jasonwryan</a></strong></dt> <dd class="usertitle"><strong>Forum &amp; Wiki Admin</strong></dd> <dd class="postavatar"><img src="https://bbs.archlinux.org/img/avatars/25579.png?m=1386831523" width="80" height="69" alt="" /></dd> <dd><span>From: .nz</span></dd> <dd><span>Registered: 2009-05-09</span></dd> <dd><span>Posts: 15,669</span></dd> <dd class="usercontacts"><span class="email"><a href="misc.php?email=25579">Email</a></span> <span class="website"><a href="http://jasonwryan.com/" rel="nofollow">Website</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>Duelist wrote:</cite><blockquote><div><div class="quotebox"><cite>jasonwryan wrote:</cite><blockquote><div><p>No. There are support communities for those distributions; these boards are for Arch.</p></div></blockquote></div><p>Alright, alright! I have installed pacman again.</p><div class="codebox"><pre><code>[user@crossfire ~]$ pacman -V .--. Pacman v4.1.2 - libalpm v8.0.2 / _.-&#039; .-. .-. .-. Copyright (C) 2006-2013 Pacman Development Team \ &#039;-. &#039;-&#039; &#039;-&#039; &#039;-&#039; Copyright (C) 2002-2006 Judd Vinet &#039;--&#039; This program may be freely redistributed under the terms of the GNU General Public License. [user@crossfire ~]$ cat /etc/fedora-release Fedora release 22 (Twenty Two)</code></pre></div><p>See?</p></div></blockquote></div><p>I see you aren&#039;t running Arch and you are going out of your way to flout the Forum Etiquette and antagonise the staff...</p> </div> <div class="postsignature postmsg"><hr /><p><a href="http://www.flickr.com/photos/jasonwryan/9333810442/lightbox/" rel="nofollow">Arch + dwm</a>&#160; &#160;•&#160; &#160;<a href="http://bitbucket.jasonwryan.com/" rel="nofollow">Mercurial repos</a>&#160; •&#160; &#160;<a href="https://github.com/jasonwryan/" rel="nofollow">Github</a></p><p>Registered Linux User #482438</p></div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1550242">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1550261" class="blockpost rowodd"> <h2><span><span class="conr">#5809</span> <a href="viewtopic.php?pid=1550261#p1550261">2015-08-03 18:57:44</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=92953">morphological</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2015-08-01</span></dd> <dd><span>Posts: 7</span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <p>Hey there.</p><p>I have got the Passthrough working on my GTX 750TI and 4690K&#160; with Windows 10.<br />Performance is ok and overclocking of the GPU works, but I am noticing one little problem.</p><p>Coretemp and CPUZ are both reporting weird values, or none at all. <br />My CPU is at 4.5GHZ, yet 4GHZ are displayed.<br /><a href="http://s16.postimg.org/uaw7ohahv/Untitled.png" rel="nofollow">http://s16.postimg.org/uaw7ohahv/Untitled.png</a></p><p>I have seen this occurring on other systems, but couldnt find out how to fix it.</p><p>nbhs also seems to have a CPUZ CPU Frequency output of 4GHZ, which is probably incorrect.<br /><a href="http://i.imgur.com/PtTM4BD.jpg" rel="nofollow">http://i.imgur.com/PtTM4BD.jpg</a></p> <p class="postedit"><em>Last edited by morphological (2015-08-03 19:03:16)</em></p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1550261">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1550276" class="blockpost roweven"> <h2><span><span class="conr">#5810</span> <a href="viewtopic.php?pid=1550276#p1550276">2015-08-03 19:47:44</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong>shade</strong></dt> <dd class="usertitle"><strong>Banned</strong></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>morphological wrote:</cite><blockquote><div><p>Hey there.</p><p>I have got the Passthrough working on my GTX 750TI and 4690K&#160; with Windows 10.<br />Performance is ok and overclocking of the GPU works, but I am noticing one little problem.</p><p>Coretemp and CPUZ are both reporting weird values, or none at all. <br />My CPU is at 4.5GHZ, yet 4GHZ are displayed.<br /><a href="http://s16.postimg.org/uaw7ohahv/Untitled.png" rel="nofollow">http://s16.postimg.org/uaw7ohahv/Untitled.png</a></p><p>I have seen this occurring on other systems, but couldnt find out how to fix it.</p><p>nbhs also seems to have a CPUZ CPU Frequency output of 4GHZ, which is probably incorrect.<br /><a href="http://i.imgur.com/PtTM4BD.jpg" rel="nofollow">http://i.imgur.com/PtTM4BD.jpg</a></p></div></blockquote></div><p><a href="https://bbs.archlinux.org/viewtopic.php?pid=1548843#p1548843" rel="nofollow">Been there.</a><br />We can&#039;t get the temperatures right for two years on modern AMD platforms(TCTL!), and you&#039;re asking for frequencies inside the VM.</p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1550276">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1550387" class="blockpost rowodd"> <h2><span><span class="conr">#5811</span> <a href="viewtopic.php?pid=1550387#p1550387">2015-08-04 03:24:22</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=90432">wmarler</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>From: Denver, CO</span></dd> <dd><span>Registered: 2015-04-18</span></dd> <dd><span>Posts: 7</span></dd> <dd class="usercontacts"><span class="email"><a href="misc.php?email=90432">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <p>What&#039;s the SOW with regards to passthrough of USB audio devices? That was by far the easiest way I&#039;ve found to get sound working without lag, but a) it doesn&#039;t mux audio from the guest and the host, and (more importantly) b) the audio is &quot;crackly.&quot; I&#039;m not sure where to pull debug data from to submit a bug report nor ... really where to submit a bug report anyway. </p><p>Also ... I&#039;m open to suggestions! I think I saw one person with successful audio by &quot;buying a different USB audio device,&quot; which I&#039;m not opposed to, just want to try a few more things first.</p><p>I haven&#039;t really had good luck with PulseAudio (mostly because I&#039;m not sure how to verify that the environment variables I&#039;m exporting are being accepted by the vm when it starts; managing this machine using virt-manager).</p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1550387">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1550412" class="blockpost roweven"> <h2><span><span class="conr">#5812</span> <a href="viewtopic.php?pid=1550412#p1550412">2015-08-04 06:53:46</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=92953">morphological</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2015-08-01</span></dd> <dd><span>Posts: 7</span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <p>I am wondering if the UEFI GPU Passthrough method via OVMF would grant me more GPU and CPU performance in the VM, than the legacy variant with i915 and arbiter patch.<br />Are there any reports on that subject?</p> <p class="postedit"><em>Last edited by morphological (2015-08-04 07:13:28)</em></p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1550412">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1550414" class="blockpost rowodd"> <h2><span><span class="conr">#5813</span> <a href="viewtopic.php?pid=1550414#p1550414">2015-08-04 07:30:59</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=92995">fushfush</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2015-08-03</span></dd> <dd><span>Posts: 2</span></dd> <dd class="usercontacts"><span class="email"><a href="misc.php?email=92995">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>Duelist wrote:</cite><blockquote><div><div class="quotebox"><cite>fushfush wrote:</cite><blockquote><div><p>Hey Guys.</p><p>My current situations is this: </p><p>I got an W520 with an i7-2720QM and Nvidia Quadro 1000m. I want to virtualize with Debian as host and Windows as guest. Therefore i want to assign my Nvidia GPU to the guest. <br />The reason for this choice is because I&#039;m an mechanical engineering student, and that requires alot of windows-only programs.. <br />Thanks!</p></div></blockquote></div><p>Assuming this is a laptop, there was no one, who got it working properly AFAIR. So you&#039;re pretty much stuck with windows. However, i find it strange you have a quadro in there...<br />I can&#039;t give you an advice, but i can link you <a href="https://docs.google.com/spreadsheets/d/1LnGpTrXalwGVNy0PWJDURhyxa3sgqkGXmvNCIvIMenk/edit#gid=0" rel="nofollow">the spreadsheet of hardware.</a></p></div></blockquote></div><p>Thanks for for spreadsheet, and yes its a Quadro. Its a workstation laptop designed for CAD/FEM-work.. You&#039;re right about posting on an wrong forum, but arch seems to have much more knowledge about this topic then debian .. Another reason to try Arch.</p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1550414">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1550459" class="blockpost roweven"> <h2><span><span class="conr">#5814</span> <a href="viewtopic.php?pid=1550459#p1550459">2015-08-04 11:51:58</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=89552">lersek</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2015-03-15</span></dd> <dd><span>Posts: 34</span></dd> <dd class="usercontacts"><span class="email"><a href="misc.php?email=89552">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>holovati wrote:</cite><blockquote><div><div class="quotebox"><cite>lersek wrote:</cite><blockquote><div><p>(They are defined by an XML Schema that targets the &quot;<a href="http://libvirt.org/schemas/domain/qemu/1.0" rel="nofollow">http://libvirt.org/schemas/domain/qemu/1.0</a>&quot; namespace -- BTW do not click this link, it&#039;s just a string.)</p></div></blockquote></div><p>The namespace link seems dead.</p></div></blockquote></div><p>Oh geez, did you read what I wrote at all? I trimmed the quote now, to add more emphasis. The namespace URI is *just a string*, not something to retrieve from the network. This is explained in the wikipedia articles that I had linked, and I had also mentioned it in my comment; see above.</p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1550459">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1550504" class="blockpost rowodd"> <h2><span><span class="conr">#5815</span> <a href="viewtopic.php?pid=1550504#p1550504">2015-08-04 14:55:53</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=79471">Bronek</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>From: London</span></dd> <dd><span>Registered: 2014-02-14</span></dd> <dd><span>Posts: 90</span></dd> <dd class="usercontacts"><span class="email"><a href="misc.php?email=79471">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>fushfush wrote:</cite><blockquote><div><p>Thanks for for spreadsheet, and yes its a Quadro. Its a workstation laptop designed for CAD/FEM-work.. You&#039;re right about posting on an wrong forum, but arch seems to have much more knowledge about this topic then debian .. Another reason to try Arch.</p></div></blockquote></div><p>well I am afraid not for much longer. The main author of this functionality in both kernel and qemu is now gone from this thread, since he happens to be a RedHat developer and local moderators here told in no uncertain terms that this forum should be used for Arch related issues only.</p> <p class="postedit"><em>Last edited by Bronek (2015-08-04 14:57:02)</em></p> </div> <div class="postsignature postmsg"><hr /><p>Sorry about&#160; &quot;KVM VGA-Passthrough ...&quot; thread <img src="https://bbs.archlinux.org/img/smilies/sad.png" width="15" height="15" alt="sad" /> Anyone interested in continuing this discussion elsewhere, please contact me privately. I might be able to find it a new home.</p></div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1550504">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1550624" class="blockpost roweven"> <h2><span><span class="conr">#5816</span> <a href="viewtopic.php?pid=1550624#p1550624">2015-08-04 21:15:26</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong>Samsonite</strong></dt> <dd class="usertitle"><strong>Banned</strong></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>morphological wrote:</cite><blockquote><div><p>I am wondering if the UEFI GPU Passthrough method via OVMF would grant me more GPU and CPU performance in the VM, than the legacy variant with i915 and arbiter patch.<br />Are there any reports on that subject?</p></div></blockquote></div><p>Hmm, from what i remember - there was no viable difference in Unigine Heaven 4.0 benchmark numbers.<br />Usually people come to OVMF when x-vga doesn&#039;t work, so that makes it difficult to test side-by-side.<br />Take the opportunity to be the first! I suppoose there may be slight CPU difference, but otherwise the numbers should be close.</p><div class="quotebox"><cite>lersek wrote:</cite><blockquote><div><div class="quotebox"><cite>holovati wrote:</cite><blockquote><div><div class="quotebox"><cite>lersek wrote:</cite><blockquote><div><p>(They are defined by an XML Schema that targets the &quot;<a href="http://libvirt.org/schemas/domain/qemu/1.0" rel="nofollow">http://libvirt.org/schemas/domain/qemu/1.0</a>&quot; namespace -- BTW do not click this link, it&#039;s just a string.)</p></div></blockquote></div><p>The namespace link seems dead.</p></div></blockquote></div><p>Oh geez, did you read what I wrote at all? I trimmed the quote now, to add more emphasis. The namespace URI is *just a string*, not something to retrieve from the network. This is explained in the wikipedia articles that I had linked, and I had also mentioned it in my comment; see above.</p></div></blockquote></div><p>Don&#039;t stress out, i see that guy for the first time there.<br />I&#039;ve been successful in attaching the debug console, however i haven&#039;t compiled a test platform yet.<br />There seem to be some hardware failure of some sort on my machine, as windows 10 install with the latest OVMF build BSODs with some kernel-level errors. The nested virtualization toggle, suddenly, makes some difference, as with it enabled it crashes more often. Also, not only the setup, but the passed-through devices suddenly remain code-10&#039;ed on some builds.<br />Is there some patching in process, like someone rewriting SMBus logic maybe or something?</p><p>OLD, maybe even pre-sourceforge-war builds work like a charm...</p> <p class="postedit"><em>Last edited by Samsonite (2015-08-04 21:16:52)</em></p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1550624">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1550664" class="blockpost rowodd"> <h2><span><span class="conr">#5817</span> <a href="viewtopic.php?pid=1550664#p1550664">2015-08-04 23:54:36</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=84538">mauorrizze</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2014-08-22</span></dd> <dd><span>Posts: 17</span></dd> <dd class="usercontacts"><span class="email"><a href="misc.php?email=84538">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>jasonwryan wrote:</cite><blockquote><div><p>I see you aren&#039;t running Arch[...]</p></div></blockquote></div><p>Dear Jason Wryan,<br />I hope you&#039;re joking, aren&#039;t you? I&#039;ve got the deepest respect for this community and also your work you invest in moderation (and administration?) of this forum. I know there&#039;s the &quot;Arch Linux distribution support ONLY&quot; rule, but there&#039;s also the &quot;Respect other distributions and operating systems&quot; rule. I think it&#039;s correct to say with many problems, especially beginner&#039;s problems, that a mix of users from different linux distributions might complicate the solution and a separation is often usefull and yes, this forum here has archlinux in its domain name, logo and everywhere. Acknowledged.<br />BUT: this thread&#039;s topic is a power-user, enthusiast topic, involving several aspects of a linux system. Kernel modules, -parameters, lot of different software packets etc. There can&#039;t be a topic with this name in each distribution forum, because there aren&#039;t enough people with interest and knowledge. Instead, because the lack of another single forum that fits the whole package of this topic and nonetheless because Arch linux has been predestined for this kind of experiments in the beginning (quite current kernel, AUR), this forum HAPPEND to be the place where this thread EMERGED, many arch users joined the discussion more than two years ago and still in 2013, the first cross-distribution users joined, too. Some of them had questions, but some joined with deep knowledge, partially even involved in development, helping both arch- and non-arch-users.<br />If you strip the non-arch-part of this thread, you might kill not all, but most of its usefulness.</p><p>PLEASE rethink your decision of strict observation of this thread and banning non-arch-users. Because of this thread no harm was done besides violation of one rule of the etiquette and bruising some egos. Sure, violating the etiquette is more than nothing, but on the other hand this thread was very, very useful and unique. There&#039;s no guarantee that AW, Duelist and other power-contributors would return/stay, but we can at least try.</p><p>If you want to close this thread I&#039;d hope we could find a way to revive it somewhere else, but apart from the question if you&#039;d export all posts for us, I&#039;d no idea where. I or someone else could host a specific forum, but I have my doubts enough users would find it/register/follow. Google for KVM VGA and if you resist clicking &quot;kvm switches&quot;, you&#039;re directed here.</p><p>P.S: You can&#039;t ban me because for not being an arch user, because I am. Longterm. But you&#039;re free to ban me for having offended you in any way. Gonna make it easy by reporting your comments in this thread, propably to yourself <img src="https://bbs.archlinux.org/img/smilies/big_smile.png" width="15" height="15" alt="big_smile" /> , but, well, I really don&#039;t understand the sudden and non-comprehensible events, more than two years after the creation of this helpful and productive thread.</p><p>Regards, an irritated arch user</p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1550664">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1550665" class="blockpost roweven"> <h2><span><span class="conr">#5818</span> <a href="viewtopic.php?pid=1550665#p1550665">2015-08-05 00:08:09</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=27289">ewaller</a></strong></dt> <dd class="usertitle"><strong>Forum Moderator</strong></dd> <dd class="postavatar"><img src="https://bbs.archlinux.org/img/avatars/27289.jpg?m=1406180442" width="80" height="80" alt="" /></dd> <dd><span>From: Pasadena, CA</span></dd> <dd><span>Registered: 2009-07-13</span></dd> <dd><span>Posts: 10,547</span></dd> <dd class="usercontacts"><span class="email"><a href="misc.php?email=27289">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <p>Allow me to clarify a few things.&#160; First, this topic has been discussed by the moderation team.&#160; It is not just one of us taking action.<br />We do welcome everyone on the forums, regardless of whether they do, or do not use Arch Linux.&#160; At issue is that these are support forums for Arch Linux, and it is our goal to have them be the canonical reference for Arch.&#160; We have nothing against other distributions and we wish them well, but having specific support information that is appropriate for non Arch distributions that is not applicable to Arch is inconsistent with our published policies.</p><p>There has been no talk about closing or deleting this thread amongst the moderators.</p><p><a href="https://wiki.archlinux.org/index.php/Forum_etiquette#Arch_Linux_distribution_support_ONLY" rel="nofollow">https://wiki.archlinux.org/index.php/Fo … pport_ONLY</a><br /><a href="https://wiki.archlinux.org/index.php/Forum_etiquette#Respect_the_staff" rel="nofollow">https://wiki.archlinux.org/index.php/Fo … _the_staff</a></p><p>Can we try to pull this back on track as it applies to Arch Linux?</p><p>Edit:&#160; mauorrizze, I did see your report, but not until after I posted this message.</p> <p class="postedit"><em>Last edited by ewaller (2015-08-05 00:11:19)</em></p> </div> <div class="postsignature postmsg"><hr /><p>Nothing is too wonderful to be true, if it be consistent with the laws of nature -- <em>Michael Faraday</em><br />Like you, I have no idea what you are doing, but I am pretty sure it is wrong...<em>Jasonwryan</em><br />----<br /><a href="http://www.catb.org/~esr/faqs/smart-questions.html" rel="nofollow">How to Ask Questions the Smart Way</a></p></div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1550665">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1550759" class="blockpost rowodd"> <h2><span><span class="conr">#5819</span> <a href="viewtopic.php?pid=1550759#p1550759">2015-08-05 10:44:52</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=58583">Nesousx</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2012-03-27</span></dd> <dd><span>Posts: 46</span></dd> <dd class="usercontacts"><span class="email"><a href="misc.php?email=58583">Email</a></span> <span class="website"><a href="https://www.kodi-xbmc.com/" rel="nofollow">Website</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <p>Hi everyone,</p><p>I have a working vga passthrough setup and I&#039;d like to switch from gummiboot to grub. My &quot;stupid&quot; Asrock motheboard has a button that &quot;clears&quot; the bios on the I/O shield. If I press it while trying to a plug a cable it&#039;ll erase the bios config, and I have to reinstall gummibit via a LiveCD... which is boring !</p><p>My setup is : IGD for host, and an Nvidia GTX card for my guest VM.</p><p>I installed grub and it works as expected : it loads my os with the required kernel. However, </p><p>However, as soon as I add the&#160; <strong>&quot;intel_iommu=on&quot;</strong> to <strong>GRUB_CMDLINE_LINUX</strong> in <strong>/etc/default/grub</strong> and regenerate config file, then my system stops booting right after grub. I have a weird screen similar to this one : <a href="http://lists.linuxfoundation.org/pipermail/iommu/attachments/20140609/acc9d8a5/attachment-0001.jpg" rel="nofollow">http://lists.linuxfoundation.org/piperm … t-0001.jpg</a>. The problem seems to be like this guy here: <a href="http://lists.linuxfoundation.org/pipermail/iommu/2014-June/008805.html" rel="nofollow">http://lists.linuxfoundation.org/piperm … 08805.html</a></p><p>I tried each of the following :</p><div class="codebox"><pre><code>GRUB_CMDLINE_LINUX=&quot;intel_iommu=on, igfx_off&quot; GRUB_CMDLINE_LINUX=&quot;intel_iommu=on, igfx_on&quot; GRUB_CMDLINE_LINUX=&quot;intel_iommu=on, igfx_off vfio_iommu_type msi=1 pci-stub.ids=10de:13c2,10de:0fbb,00:1d.0&quot;</code></pre></div><p>Nothing worked.</p><p>Right now it works fine with gummiboot and the following &quot;boot line&quot;, in&#160; <strong>/boot/loader/entries/vfio.conf</strong> :</p><div class="codebox"><pre><code>options root=/dev/sda2 rw intel_iommu=on,igfx_off vfio_iommu_type msi=1 pci-stub.ids=10de:13c2,10de:0fbb,00:1d.0</code></pre></div><p>I&#039;d glad to hear any thought on this. Thanks in advance.</p> <p class="postedit"><em>Last edited by Nesousx (2015-08-05 12:26:58)</em></p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1550759">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1550803" class="blockpost roweven"> <h2><span><span class="conr">#5820</span> <a href="viewtopic.php?pid=1550803#p1550803">2015-08-05 14:16:15</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong>Ecliptual</strong></dt> <dd class="usertitle"><strong>Guest</strong></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>Nesousx wrote:</cite><blockquote><div><p>Hi everyone,</p><p>I have a working vga passthrough setup and I&#039;d like to switch from gummiboot to grub. My &quot;stupid&quot; Asrock motheboard has a button that &quot;clears&quot; the bios on the I/O shield. If I press it while trying to a plug a cable it&#039;ll erase the bios config, and I have to reinstall gummibit via a LiveCD... which is boring !</p><p>My setup is : IGD for host, and an Nvidia GTX card for my guest VM.</p><p>I installed grub and it works as expected : it loads my os with the required kernel. However, </p><p>However, as soon as I add the&#160; <strong>&quot;intel_iommu=on&quot;</strong> to <strong>GRUB_CMDLINE_LINUX</strong> in <strong>/etc/default/grub</strong> and regenerate config file, then my system stops booting right after grub. I have a weird screen similar to this one : <a href="http://lists.linuxfoundation.org/pipermail/iommu/attachments/20140609/acc9d8a5/attachment-0001.jpg" rel="nofollow">http://lists.linuxfoundation.org/piperm … t-0001.jpg</a>. The problem seems to be like this guy here: <a href="http://lists.linuxfoundation.org/pipermail/iommu/2014-June/008805.html" rel="nofollow">http://lists.linuxfoundation.org/piperm … 08805.html</a></p><p>I tried each of the following :</p><div class="codebox"><pre><code>GRUB_CMDLINE_LINUX=&quot;intel_iommu=on, igfx_off&quot; GRUB_CMDLINE_LINUX=&quot;intel_iommu=on, igfx_on&quot; GRUB_CMDLINE_LINUX=&quot;intel_iommu=on, igfx_off vfio_iommu_type msi=1 pci-stub.ids=10de:13c2,10de:0fbb,00:1d.0&quot;</code></pre></div><p>Nothing worked.</p><p>Right now it works fine with gummiboot and the following &quot;boot line&quot;, in&#160; <strong>/boot/loader/entries/vfio.conf</strong> :</p><div class="codebox"><pre><code>options root=/dev/sda2 rw intel_iommu=on,igfx_off vfio_iommu_type msi=1 pci-stub.ids=10de:13c2,10de:0fbb,00:1d.0</code></pre></div><p>I&#039;d glad to hear any thought on this. Thanks in advance.</p></div></blockquote></div><p>First of all, &quot;vfio_iommu_type&quot; isn&#039;t a valid parameter to begin with.<br />Make sure you don&#039;t need the i915 vgaarb patch.<br />Which screen outputs this mess? The IGD one or GPU one?<br />Seems like you&#039;ve got it working only on EFI-boot without CSM, am i right?<br />Also, you say it works &quot;fine&quot; with the gummiboot and igfx_off - you&#039;re using the system as a headless host?</p><br /><div class="quotebox"><cite>ewaller wrote:</cite><blockquote><div><p>but having specific support information that is appropriate for non Arch distributions that is not applicable to Arch is inconsistent with our published policies.</p></div></blockquote></div><p>The only distro-specific information is, obviously, kernel patches and boot loaders. I may not remember everything, but one of the things arch users have different is OVMF git builds - there&#039;s an AUR package for that, afair. Most of distro-specific information is easily adapted for arch.</p><div class="quotebox"><cite>ewaller wrote:</cite><blockquote><div><p>There has been no talk about closing or deleting this thread amongst the moderators.<br /><a href="https://wiki.archlinux.org/index.php/Forum_etiquette#Arch_Linux_distribution_support_ONLY" rel="nofollow">https://wiki.archlinux.org/index.php/Fo … pport_ONLY</a><br /><a href="https://wiki.archlinux.org/index.php/Forum_etiquette#Respect_the_staff" rel="nofollow">https://wiki.archlinux.org/index.php/Fo … _the_staff</a><br />Can we try to pull this back on track as it applies to Arch Linux?</p></div></blockquote></div><p>Nice to see that this wasn&#039;t one man&#039;s decision.<br />I&#039;ve thought about collaborating with nbhs in order to close &amp; move this thread to another forum, but i think no one would like this.<br />I don&#039;t know about aw, but I am staying here. Even if i&#039;ll have to hide from you all thoroughly.<br />For everyone.<br />I just don&#039;t understand the idea of saying &quot;arch only&quot; to non-arch helpers. What i should do to follow that policy? <span class="bbs">Install arch?</span> I mean, i&#039;ve helped(or tried to help) to arch, gentoo, fedora and ubuntu users, to me they&#039;re no different. Moreover, most people don&#039;t even specify their distro at all...</p> <p class="postedit"><em>Last edited by Ecliptual (2015-08-05 14:17:08)</em></p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1550803">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1550811" class="blockpost rowodd"> <h2><span><span class="conr">#5821</span> <a href="viewtopic.php?pid=1550811#p1550811">2015-08-05 14:35:14</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=58583">Nesousx</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2012-03-27</span></dd> <dd><span>Posts: 46</span></dd> <dd class="usercontacts"><span class="email"><a href="misc.php?email=58583">Email</a></span> <span class="website"><a href="https://www.kodi-xbmc.com/" rel="nofollow">Website</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <p>Thanks for your reply Ecliptual.</p><p>I thought that with latest kernels, (can&#039;t remember which version, 4.1 I believe) which is the one I am using iirc, I no longer needed arbiter patch. Because indeed, it looks like the problem is coming from here since I am using IGD on host and with a &quot;head&quot; setup, so it is the IGD that messes.</p><p>I am booting full EFI as far as I understand it, but I have no clue about the CSM thing.</p><p>Finally, I&#039;ll look on the vfio_iommu_tpe thing and remove it if it is not valid.</p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1550811">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1550812" class="blockpost roweven"> <h2><span><span class="conr">#5822</span> <a href="viewtopic.php?pid=1550812#p1550812">2015-08-05 14:43:20</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong>Ecliptual</strong></dt> <dd class="usertitle"><strong>Guest</strong></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>Nesousx wrote:</cite><blockquote><div><p>I am booting full EFI as far as I understand it, but I have no clue about the CSM thing.</p></div></blockquote></div><p>That&#039;s easy to check.<br />0. The UEFI setup menu should be clear to understand, try checking there.<br />1. MBR entries won&#039;t be there. So if you don&#039;t have an ESP - you won&#039;t be able to boot. You&#039;re using gummiboot, so i assume you do have a valid ESP with the EFI loader in there.<br />2. I think /dev/vga_arbiter doesn&#039;t exist on systems booted without VGA present.<br />3. check lspci for these VGA memory and port IO ranges. They may not be present on a pure efi system.</p><div class="codebox"><pre><code> Region 0: Memory at c0000000 (64-bit, prefetchable) [size=256M] Region 2: Memory at fe300000 (64-bit, non-prefetchable) [size=256K] Region 4: I/O ports at e000 [size=256]</code></pre></div><p>Actually, you spark my interest...</p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1550812">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1550919" class="blockpost rowodd"> <h2><span><span class="conr">#5823</span> <a href="viewtopic.php?pid=1550919#p1550919">2015-08-05 22:10:26</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=58583">Nesousx</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2012-03-27</span></dd> <dd><span>Posts: 46</span></dd> <dd class="usercontacts"><span class="email"><a href="misc.php?email=58583">Email</a></span> <span class="website"><a href="https://www.kodi-xbmc.com/" rel="nofollow">Website</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>Ecliptual wrote:</cite><blockquote><div><div class="quotebox"><cite>Nesousx wrote:</cite><blockquote><div><p>I am booting full EFI as far as I understand it, but I have no clue about the CSM thing.</p></div></blockquote></div><p>That&#039;s easy to check.<br />0. The UEFI setup menu should be clear to understand, try checking there.<br />1. MBR entries won&#039;t be there. So if you don&#039;t have an ESP - you won&#039;t be able to boot. You&#039;re using gummiboot, so i assume you do have a valid ESP with the EFI loader in there.<br />2. I think /dev/vga_arbiter doesn&#039;t exist on systems booted without VGA present.<br />3. check lspci for these VGA memory and port IO ranges. They may not be present on a pure efi system.</p><div class="codebox"><pre><code> Region 0: Memory at c0000000 (64-bit, prefetchable) [size=256M] Region 2: Memory at fe300000 (64-bit, non-prefetchable) [size=256K] Region 4: I/O ports at e000 [size=256]</code></pre></div><p>Actually, you spark my interest...</p></div></blockquote></div><p>I&#039;ll be more than happy to answer your questions, however I need more explanation.</p><p>0. Not sure where to find this thing, I checked my bios in order to see if I could access some kind of UEFI shell, didn&#039;t find anything.<br />1. I also assume I have a valid ESP, I remember doing it when installing Arch for the first time. I have a fat boot partition with a /boot/EFI folder mounted there. I believe this is what you are talking about.<br />2. Does this help ?:</p><div class="codebox"><pre><code>ls -l /dev/vga_arbiter crw------- 1 root root 10, 63 6 août 00:01 /dev/vga_arbiter</code></pre></div><p>3.</p><div class="codebox"><pre><code>lspci 00:00.0 Host bridge: Intel Corporation Xeon E3-1200 v2/3rd Gen Core processor DRAM Controller (rev 09) 00:01.0 PCI bridge: Intel Corporation Xeon E3-1200 v2/3rd Gen Core processor PCI Express Root Port (rev 09) 00:02.0 VGA compatible controller: Intel Corporation Xeon E3-1200 v2/3rd Gen Core processor Graphics Controller (rev 09) 00:14.0 USB controller: Intel Corporation 7 Series/C210 Series Chipset Family USB xHCI Host Controller (rev 04) 00:16.0 Communication controller: Intel Corporation 7 Series/C210 Series Chipset Family MEI Controller #1 (rev 04) 00:1a.0 USB controller: Intel Corporation 7 Series/C210 Series Chipset Family USB Enhanced Host Controller #2 (rev 04) 00:1b.0 Audio device: Intel Corporation 7 Series/C210 Series Chipset Family High Definition Audio Controller (rev 04) 00:1c.0 PCI bridge: Intel Corporation 7 Series/C210 Series Chipset Family PCI Express Root Port 1 (rev c4) 00:1c.4 PCI bridge: Intel Corporation 7 Series/C210 Series Chipset Family PCI Express Root Port 5 (rev c4) 00:1c.5 PCI bridge: Intel Corporation 7 Series/C210 Series Chipset Family PCI Express Root Port 6 (rev c4) 00:1c.6 PCI bridge: Intel Corporation 7 Series/C210 Series Chipset Family PCI Express Root Port 7 (rev c4) 00:1d.0 USB controller: Intel Corporation 7 Series/C210 Series Chipset Family USB Enhanced Host Controller #1 (rev 04) 00:1f.0 ISA bridge: Intel Corporation Z77 Express Chipset LPC Controller (rev 04) 00:1f.2 SATA controller: Intel Corporation 7 Series/C210 Series Chipset Family 6-port SATA Controller [AHCI mode] (rev 04) 00:1f.3 SMBus: Intel Corporation 7 Series/C210 Series Chipset Family SMBus Controller (rev 04) 01:00.0 VGA compatible controller: NVIDIA Corporation GM204 [GeForce GTX 970] (rev a1) 01:00.1 Audio device: NVIDIA Corporation GM204 High Definition Audio Controller (rev a1) 03:00.0 SATA controller: ASMedia Technology Inc. ASM1062 Serial ATA Controller (rev 01) 04:00.0 Ethernet controller: Broadcom Corporation NetLink BCM57781 Gigabit Ethernet PCIe (rev 10) 05:00.0 USB controller: ASMedia Technology Inc. ASM1042 SuperSpeed USB Host Controller</code></pre></div><div class="codebox"><pre><code>00:02.0 VGA compatible controller: Intel Corporation Xeon E3-1200 v2/3rd Gen Core processor Graphics Controller (rev 09) (prog-if 00 [VGA controller]) Subsystem: ASRock Incorporation Device 0152 Control: I/O+ Mem+ BusMaster+ SpecCycle- MemWINV- VGASnoop- ParErr- Stepping- SERR- FastB2B- DisINTx+ Status: Cap+ 66MHz- UDF- FastB2B+ ParErr- DEVSEL=fast &gt;TAbort- &lt;TAbort- &lt;MAbort- &gt;SERR- &lt;PERR- INTx- Latency: 0 Interrupt: pin A routed to IRQ 37 Region 0: Memory at f7400000 (64-bit, non-prefetchable) [size=4M] Region 2: Memory at d0000000 (64-bit, prefetchable) [size=256M] Region 4: I/O ports at f000 [size=64] Expansion ROM at &lt;unassigned&gt; [disabled] Capabilities: &lt;access denied&gt; Kernel driver in use: i915 Kernel modules: i915</code></pre></div><div class="codebox"><pre><code>01:00.0 VGA compatible controller: NVIDIA Corporation GM204 [GeForce GTX 970] (rev a1) (prog-if 00 [VGA controller]) Subsystem: ASUSTeK Computer Inc. Device 8508 Control: I/O- Mem- BusMaster- SpecCycle- MemWINV- VGASnoop- ParErr- Stepping- SERR- FastB2B- DisINTx- Status: Cap+ 66MHz- UDF- FastB2B- ParErr- DEVSEL=fast &gt;TAbort- &lt;TAbort- &lt;MAbort- &gt;SERR- &lt;PERR- INTx- Interrupt: pin A routed to IRQ 11 Region 0: Memory at f6000000 (32-bit, non-prefetchable) [disabled] [size=16M] Region 1: Memory at e0000000 (64-bit, prefetchable) [disabled] [size=256M] Region 3: Memory at f0000000 (64-bit, prefetchable) [disabled] [size=32M] Region 5: I/O ports at e000 [disabled] [size=128] Expansion ROM at f7000000 [disabled] [size=512K] Capabilities: &lt;access denied&gt; Kernel driver in use: vfio-pci Kernel modules: nouveau</code></pre></div> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1550919">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1550924" class="blockpost roweven"> <h2><span><span class="conr">#5824</span> <a href="viewtopic.php?pid=1550924#p1550924">2015-08-05 22:37:04</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=93072">FlatronEZ</a></strong></dt> <dd class="usertitle"><strong>Banned</strong></dd> <dd><span>Registered: 2015-08-05</span></dd> <dd><span>Posts: 2</span></dd> <dd class="usercontacts"><span class="email"><a href="misc.php?email=93072">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <p>Hello,</p><p>I am new to this community and hope I don&#039;t do anything completely wrong here <img src="https://bbs.archlinux.org/img/smilies/wink.png" width="15" height="15" alt="wink" /></p><p>So my problem is the &quot;standard&quot; Nvidia Error Code 43 problem.</p><p>First my setup:</p><div class="codebox"><pre><code>Ubuntu 15.04 3.19.0-26-generic #27-Ubuntu SMP Tue Jul 28 18:27:31 UTC 2015 QEMU emulator version 2.2.0 (Debian 1:2.2+dfsg-5expubuntu9.3) i7 4790k Nvidia GTX 750 Ti (Palit) (in main PCIe slot) MB: Gigabyte Z97X Gaming 7</code></pre></div><p>I installed Windows 10 (64bit) as a guest operating system using virt-manager. The installation process worked fine and the OS is running. When I pass my Nvidia GTX 750 Ti to the guest and install the latest Nvidia Driver then the card get&#039;s recognized correctly but gives me error code 43 after the reboot.</p><p>So what I tried: </p><p>Adding &quot;intel_iommu=on igfx_off&quot; to my boot paramters aswell as manually adding &quot;-kvm=off&quot; to my virsh config with:</p><div class="codebox"><pre><code>&lt;domain type=&#039;kvm&#039; xmlns:qemu=&#039;http://libvirt.org/schemas/domain/qemu/1.0&#039;&gt; [...] &lt;qemu:commandline&gt; &lt;qemu:arg value=&#039;-kvm=off&#039;/&gt; &lt;/qemu:commandline&gt;</code></pre></div><p>which gave me this error: &quot;qemu-system-x86_64: -kvm=off: invalid option&quot;</p><p>Okay so for now I dont know what to try next... What can I try to get my card running?</p><p>Here is my virt-manager config:</p><div class="codebox"><pre class="vscroll"><code>&lt;domain type=&#039;kvm&#039; xmlns:qemu=&#039;http://libvirt.org/schemas/domain/qemu/1.0&#039;&gt; &lt;name&gt;Windows-10&lt;/name&gt; &lt;uuid&gt;c7f056b0-fd21-4cfe-a050-dd23cdc40ef6&lt;/uuid&gt; &lt;memory unit=&#039;KiB&#039;&gt;8388608&lt;/memory&gt; &lt;currentMemory unit=&#039;KiB&#039;&gt;8388608&lt;/currentMemory&gt; &lt;vcpu placement=&#039;static&#039; current=&#039;1&#039;&gt;8&lt;/vcpu&gt; &lt;os&gt; &lt;type arch=&#039;x86_64&#039; machine=&#039;pc-i440fx-utopic&#039;&gt;hvm&lt;/type&gt; &lt;boot dev=&#039;hd&#039;/&gt; &lt;/os&gt; &lt;features&gt; &lt;acpi/&gt; &lt;apic/&gt; &lt;pae/&gt; &lt;/features&gt; &lt;cpu mode=&#039;custom&#039; match=&#039;exact&#039;&gt; &lt;model fallback=&#039;allow&#039;&gt;SandyBridge&lt;/model&gt; &lt;vendor&gt;Intel&lt;/vendor&gt; &lt;feature policy=&#039;require&#039; name=&#039;vme&#039;/&gt; &lt;feature policy=&#039;require&#039; name=&#039;dtes64&#039;/&gt; &lt;feature policy=&#039;require&#039; name=&#039;invpcid&#039;/&gt; &lt;feature policy=&#039;require&#039; name=&#039;vmx&#039;/&gt; &lt;feature policy=&#039;require&#039; name=&#039;erms&#039;/&gt; &lt;feature policy=&#039;require&#039; name=&#039;xtpr&#039;/&gt; &lt;feature policy=&#039;require&#039; name=&#039;smep&#039;/&gt; &lt;feature policy=&#039;require&#039; name=&#039;pbe&#039;/&gt; &lt;feature policy=&#039;require&#039; name=&#039;est&#039;/&gt; &lt;feature policy=&#039;require&#039; name=&#039;monitor&#039;/&gt; &lt;feature policy=&#039;require&#039; name=&#039;abm&#039;/&gt; &lt;feature policy=&#039;require&#039; name=&#039;tm&#039;/&gt; &lt;feature policy=&#039;require&#039; name=&#039;acpi&#039;/&gt; &lt;feature policy=&#039;require&#039; name=&#039;fma&#039;/&gt; &lt;feature policy=&#039;require&#039; name=&#039;osxsave&#039;/&gt; &lt;feature policy=&#039;require&#039; name=&#039;ht&#039;/&gt; &lt;feature policy=&#039;require&#039; name=&#039;pdcm&#039;/&gt; &lt;feature policy=&#039;require&#039; name=&#039;pdpe1gb&#039;/&gt; &lt;feature policy=&#039;require&#039; name=&#039;fsgsbase&#039;/&gt; &lt;feature policy=&#039;require&#039; name=&#039;f16c&#039;/&gt; &lt;feature policy=&#039;require&#039; name=&#039;ds&#039;/&gt; &lt;feature policy=&#039;require&#039; name=&#039;invtsc&#039;/&gt; &lt;feature policy=&#039;require&#039; name=&#039;tm2&#039;/&gt; &lt;feature policy=&#039;require&#039; name=&#039;avx2&#039;/&gt; &lt;feature policy=&#039;require&#039; name=&#039;ss&#039;/&gt; &lt;feature policy=&#039;require&#039; name=&#039;bmi1&#039;/&gt; &lt;feature policy=&#039;require&#039; name=&#039;bmi2&#039;/&gt; &lt;feature policy=&#039;require&#039; name=&#039;pcid&#039;/&gt; &lt;feature policy=&#039;require&#039; name=&#039;ds_cpl&#039;/&gt; &lt;feature policy=&#039;require&#039; name=&#039;movbe&#039;/&gt; &lt;feature policy=&#039;require&#039; name=&#039;rdrand&#039;/&gt; &lt;/cpu&gt; &lt;clock offset=&#039;localtime&#039;&gt; &lt;timer name=&#039;rtc&#039; tickpolicy=&#039;catchup&#039;/&gt; &lt;timer name=&#039;pit&#039; tickpolicy=&#039;delay&#039;/&gt; &lt;timer name=&#039;hpet&#039; present=&#039;no&#039;/&gt; &lt;/clock&gt; &lt;on_poweroff&gt;destroy&lt;/on_poweroff&gt; &lt;on_reboot&gt;restart&lt;/on_reboot&gt; &lt;on_crash&gt;restart&lt;/on_crash&gt; &lt;pm&gt; &lt;suspend-to-mem enabled=&#039;no&#039;/&gt; &lt;suspend-to-disk enabled=&#039;no&#039;/&gt; &lt;/pm&gt; &lt;devices&gt; &lt;emulator&gt;/usr/bin/kvm-spice&lt;/emulator&gt; &lt;disk type=&#039;file&#039; device=&#039;disk&#039;&gt; &lt;driver name=&#039;qemu&#039; type=&#039;qcow2&#039;/&gt; &lt;source file=&#039;/var/lib/libvirt/images/Windows-10.qcow2&#039;/&gt; &lt;target dev=&#039;hda&#039; bus=&#039;ide&#039;/&gt; &lt;address type=&#039;drive&#039; controller=&#039;0&#039; bus=&#039;0&#039; target=&#039;0&#039; unit=&#039;0&#039;/&gt; &lt;/disk&gt; &lt;disk type=&#039;block&#039; device=&#039;cdrom&#039;&gt; &lt;driver name=&#039;qemu&#039; type=&#039;raw&#039;/&gt; &lt;target dev=&#039;hdb&#039; bus=&#039;ide&#039;/&gt; &lt;readonly/&gt; &lt;address type=&#039;drive&#039; controller=&#039;0&#039; bus=&#039;0&#039; target=&#039;0&#039; unit=&#039;1&#039;/&gt; &lt;/disk&gt; &lt;controller type=&#039;pci&#039; index=&#039;0&#039; model=&#039;pci-root&#039;/&gt; &lt;controller type=&#039;ide&#039; index=&#039;0&#039;&gt; &lt;address type=&#039;pci&#039; domain=&#039;0x0000&#039; bus=&#039;0x00&#039; slot=&#039;0x01&#039; function=&#039;0x1&#039;/&gt; &lt;/controller&gt; &lt;controller type=&#039;virtio-serial&#039; index=&#039;0&#039;&gt; &lt;address type=&#039;pci&#039; domain=&#039;0x0000&#039; bus=&#039;0x00&#039; slot=&#039;0x05&#039; function=&#039;0x0&#039;/&gt; &lt;/controller&gt; &lt;controller type=&#039;usb&#039; index=&#039;0&#039; model=&#039;nec-xhci&#039;&gt; &lt;address type=&#039;pci&#039; domain=&#039;0x0000&#039; bus=&#039;0x00&#039; slot=&#039;0x06&#039; function=&#039;0x0&#039;/&gt; &lt;/controller&gt; &lt;interface type=&#039;network&#039;&gt; &lt;mac address=&#039;52:54:00:56:38:04&#039;/&gt; &lt;source network=&#039;default&#039;/&gt; &lt;model type=&#039;rtl8139&#039;/&gt; &lt;address type=&#039;pci&#039; domain=&#039;0x0000&#039; bus=&#039;0x00&#039; slot=&#039;0x03&#039; function=&#039;0x0&#039;/&gt; &lt;/interface&gt; &lt;serial type=&#039;pty&#039;&gt; &lt;target port=&#039;0&#039;/&gt; &lt;/serial&gt; &lt;console type=&#039;pty&#039;&gt; &lt;target type=&#039;serial&#039; port=&#039;0&#039;/&gt; &lt;/console&gt; &lt;channel type=&#039;spicevmc&#039;&gt; &lt;target type=&#039;virtio&#039; name=&#039;com.redhat.spice.0&#039;/&gt; &lt;address type=&#039;virtio-serial&#039; controller=&#039;0&#039; bus=&#039;0&#039; port=&#039;1&#039;/&gt; &lt;/channel&gt; &lt;input type=&#039;tablet&#039; bus=&#039;usb&#039;/&gt; &lt;input type=&#039;mouse&#039; bus=&#039;ps2&#039;/&gt; &lt;input type=&#039;keyboard&#039; bus=&#039;ps2&#039;/&gt; &lt;graphics type=&#039;spice&#039; autoport=&#039;yes&#039;/&gt; &lt;sound model=&#039;ich6&#039;&gt; &lt;address type=&#039;pci&#039; domain=&#039;0x0000&#039; bus=&#039;0x00&#039; slot=&#039;0x04&#039; function=&#039;0x0&#039;/&gt; &lt;/sound&gt; &lt;video&gt; &lt;model type=&#039;cirrus&#039; vram=&#039;16384&#039; heads=&#039;1&#039;/&gt; &lt;address type=&#039;pci&#039; domain=&#039;0x0000&#039; bus=&#039;0x00&#039; slot=&#039;0x02&#039; function=&#039;0x0&#039;/&gt; &lt;/video&gt; &lt;video&gt; &lt;model type=&#039;qxl&#039; ram=&#039;65536&#039; vram=&#039;65536&#039; vgamem=&#039;16384&#039; heads=&#039;1&#039;/&gt; &lt;address type=&#039;pci&#039; domain=&#039;0x0000&#039; bus=&#039;0x00&#039; slot=&#039;0x0a&#039; function=&#039;0x0&#039;/&gt; &lt;/video&gt; &lt;hostdev mode=&#039;subsystem&#039; type=&#039;pci&#039; managed=&#039;yes&#039;&gt; &lt;source&gt; &lt;address domain=&#039;0x0000&#039; bus=&#039;0x01&#039; slot=&#039;0x00&#039; function=&#039;0x0&#039;/&gt; &lt;/source&gt; &lt;address type=&#039;pci&#039; domain=&#039;0x0000&#039; bus=&#039;0x00&#039; slot=&#039;0x08&#039; function=&#039;0x0&#039;/&gt; &lt;/hostdev&gt; &lt;hostdev mode=&#039;subsystem&#039; type=&#039;pci&#039; managed=&#039;yes&#039;&gt; &lt;source&gt; &lt;address domain=&#039;0x0000&#039; bus=&#039;0x01&#039; slot=&#039;0x00&#039; function=&#039;0x1&#039;/&gt; &lt;/source&gt; &lt;address type=&#039;pci&#039; domain=&#039;0x0000&#039; bus=&#039;0x00&#039; slot=&#039;0x09&#039; function=&#039;0x0&#039;/&gt; &lt;/hostdev&gt; &lt;redirdev bus=&#039;usb&#039; type=&#039;spicevmc&#039;&gt; &lt;/redirdev&gt; &lt;redirdev bus=&#039;usb&#039; type=&#039;spicevmc&#039;&gt; &lt;/redirdev&gt; &lt;redirdev bus=&#039;usb&#039; type=&#039;spicevmc&#039;&gt; &lt;/redirdev&gt; &lt;redirdev bus=&#039;usb&#039; type=&#039;spicevmc&#039;&gt; &lt;/redirdev&gt; &lt;memballoon model=&#039;virtio&#039;&gt; &lt;address type=&#039;pci&#039; domain=&#039;0x0000&#039; bus=&#039;0x00&#039; slot=&#039;0x07&#039; function=&#039;0x0&#039;/&gt; &lt;/memballoon&gt; &lt;/devices&gt; &lt;qemu:commandline&gt; &lt;qemu:arg value=&#039;-kvm=off&#039;/&gt; &lt;/qemu:commandline&gt; &lt;/domain&gt;</code></pre></div><br /><p>Let me know if you need more information!</p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1550924">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1550936" class="blockpost rowodd"> <h2><span><span class="conr">#5825</span> <a href="viewtopic.php?pid=1550936#p1550936">2015-08-05 22:54:31</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=38091">WorMzy</a></strong></dt> <dd class="usertitle"><strong>Forum Moderator</strong></dd> <dd class="postavatar"><img src="https://bbs.archlinux.org/img/avatars/38091.jpg?m=1394665353" width="80" height="80" alt="" /></dd> <dd><span>From: England</span></dd> <dd><span>Registered: 2010-06-16</span></dd> <dd><span>Posts: 3,492</span></dd> <dd class="usercontacts"><span class="email"><a href="misc.php?email=38091">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>FlatronEZ wrote:</cite><blockquote><div><p>Hello,</p><p>I am new to this community and hope I don&#039;t do anything completely wrong here <img src="https://bbs.archlinux.org/img/smilies/wink.png" width="15" height="15" alt="wink" /><br />First my setup:</p><div class="codebox"><pre><code>Ubuntu 15.04 3.19.0-26-generic #27-Ubuntu SMP Tue Jul 28 18:27:31 UTC 2015 QEMU emulator version 2.2.0 (Debian 1:2.2+dfsg-5expubuntu9.3) i7 4790k Nvidia GTX 750 Ti (Palit) (in main PCIe slot) MB: Gigabyte Z97X Gaming 7</code></pre></div></div></blockquote></div><p>Please ask on the Ubuntu support forums, we only support Arch here.</p><p><a href="https://wiki.archlinux.org/index.php/Forum_etiquette#Arch_Linux_distribution_support_ONLY" rel="nofollow">https://wiki.archlinux.org/index.php/Fo … pport_ONLY</a></p> </div> <div class="postsignature postmsg"><hr /><p><strong>Sakura:-</strong><br />Mobo: ASUS P8Z77-V PRO // Processor: Intel Core i7-3770K 3.4GHz // GFX: nVidia GeForce GTX 970 Ti // RAM: 16GB (4x 4GB) Corsair DDR3 (@ 1333MHz) // Storage: 1x 3TB Seagate SATAII 4x 1TB Samsung SATAII, 2x 120GB Corsair SSD</p></div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1550936">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div class="postlinksb"> <div class="inbox crumbsplus"> <div class="pagepost"> <p class="pagelink conl"><span class="pages-label">Pages: </span><a rel="prev" class="item1" href="viewtopic.php?id=162768&amp;p=232">Previous</a> <a href="viewtopic.php?id=162768">1</a> <span class="spacer">…</span> <a href="viewtopic.php?id=162768&amp;p=231">231</a> <a href="viewtopic.php?id=162768&amp;p=232">232</a> <strong>233</strong> <a href="viewtopic.php?id=162768&amp;p=234">234</a> <a rel="next" href="viewtopic.php?id=162768&amp;p=234">Next</a></p> <p class="postlink conr">Topic closed</p> </div> <ul class="crumbs"> <li><a href="index.php">Index</a></li> <li><span>»&#160;</span><a href="viewforum.php?id=48">Topics Going Nowhere</a></li> <li><span>»&#160;</span><strong><a href="viewtopic.php?id=162768">KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</a></strong></li> </ul> <p class="subscribelink clearb"><a href="misc.php?action=subscribe&amp;tid=162768">Subscribe to this topic</a></p> <div class="clearer"></div> </div> </div> </div> <div id="brdfooter" class="block"> <h2><span>Board footer</span></h2> <div class="box"> <div id="brdfooternav" class="inbox"> <div class="conl"> <form id="qjump" method="get" action="viewforum.php"> <div><label><span>Jump to<br /></span> <select name="id" onchange="window.location=('viewforum.php?id='+this.options[this.selectedIndex].value)"> <optgroup label="Technical Issues and Assistance"> <option value="23">Newbie Corner</option> <option value="17">Installation</option> <option value="22">Kernel &amp; Hardware</option> <option value="18">Applications &amp; Desktop Environments</option> <option value="31">Laptop Issues</option> <option value="8">Networking, Server, and Protection</option> <option value="32">Multimedia and Games</option> <option value="50">System Administration</option> <option value="35">Other Architectures</option> </optgroup> <optgroup label="Arch-centric"> <option value="24">Announcements, Package &amp; Security Advisories</option> <option value="1">Arch Discussion</option> <option value="13">Forum &amp; Wiki discussion</option> </optgroup> <optgroup label="Pacman Upgrades, Packaging &amp; AUR"> <option value="44">Pacman &amp; Package Upgrade Issues</option> <option value="49">[testing] Repo Forum</option> <option value="4">Creating &amp; Modifying Packages</option> <option value="38">AUR Issues, Discussion &amp; PKGBUILD Requests</option> </optgroup> <optgroup label="Contributions &amp; Discussion"> <option value="20">GNU/Linux Discussion</option> <option value="27">Community Contributions</option> <option value="33">Programming &amp; Scripting</option> <option value="30">Other Languages</option> <option value="47">Artwork and Screenshots</option> <option value="42">Try This</option> </optgroup> <optgroup label="/dev/null"> <option value="29">Off-Topic</option> <option value="48" selected="selected">Topics Going Nowhere</option> <option value="36">Dustbin</option> </optgroup> </select></label> <input type="submit" value=" Go " accesskey="g" /> </div> </form> </div> <div class="conr"> <p id="feedlinks"><span class="atom"><a href="extern.php?action=feed&amp;tid=162768&amp;type=atom">Atom topic feed</a></span></p> <p id="poweredby">Powered by <a href="http://fluxbb.org/">FluxBB</a></p> </div> <div class="clearer"></div> </div> </div> </div> </div> <div class="end-box"></div> </div> </body> </html>
