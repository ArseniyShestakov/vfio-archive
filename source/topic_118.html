<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"> <html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en" dir="ltr"> <head> <meta http-equiv="Content-Type" content="text/html; charset=utf-8" /> <title>KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9 (Page 118) / Topics Going Nowhere / Arch Linux Forums</title> <link rel="stylesheet" type="text/css" href="style/ArchLinux.css" /> <link rel="canonical" href="viewtopic.php?id=162768&amp;p=118" title="Page 118" /> <link rel="prev" href="viewtopic.php?id=162768&amp;p=117" title="Page 117" /> <link rel="next" href="viewtopic.php?id=162768&amp;p=119" title="Page 119" /> <link rel="alternate" type="application/atom+xml" href="extern.php?action=feed&amp;tid=162768&amp;type=atom" title="Atom topic feed" /> <link rel="stylesheet" media="screen" href="style/ArchLinux/arch.css?v=3" /> <link rel="stylesheet" media="screen" href="style/ArchLinux/archnavbar.css?v=2" /> <link rel="shortcut icon" href="style/ArchLinux/favicon.ico" /> </head> <body> <div id="archnavbar" class="anb-forum"> <div id="archnavbarlogo"><h1><a href="http://www.archlinux.org/">Arch Linux</a></h1></div> <div id="archnavbarmenu"> <ul id="archnavbarlist"> <li id="anb-home"><a href="http://www.archlinux.org/">Home</a></li><li id="anb-packages"><a href="http://www.archlinux.org/packages/">Packages</a></li><li id="anb-forums" class="anb-selected"><a href="https://bbs.archlinux.org/">Forums</a></li><li id="anb-wiki"><a href="https://wiki.archlinux.org/">Wiki</a></li><li id="anb-bugs"><a href="https://bugs.archlinux.org/">Bugs</a></li><li id="anb-aur"><a href="https://aur.archlinux.org/">AUR</a></li><li id="anb-download"><a href="http://www.archlinux.org/download/">Download</a></li> </ul> </div> </div> <div id="punviewtopic" class="pun"> <div class="top-box"></div> <div class="punwrap"> <div id="brdheader" class="block"> <div class="box"> <div id="brdmenu" class="inbox"> <ul> <li id="navindex" class="isactive"><a href="index.php">Index</a></li> <li id="navuserlist"><a href="userlist.php">User list</a></li> <li id="navsearch"><a href="search.php">Search</a></li> <li id="navprofile"><a href="profile.php?id=80749">Profile</a></li> <li id="navlogout"><a href="login.php?action=out&amp;id=80749&amp;csrf_token=5c20501ec397bb45ef8ee8c84db232c8d8e421c6">Logout</a></li> </ul> </div> <div id="brdwelcome" class="inbox"> <ul class="conl"> <li><span>Logged in as <strong>SXX</strong></span></li> <li><span>Last visit: 2015-08-16 12:20:09</span></li> </ul> <ul class="conr"> <li><span>Topics: <a href="search.php?action=show_replies" title="Find topics you have posted to.">Posted</a> | <a href="search.php?action=show_new" title="Find topics with new posts since your last visit.">New</a> | <a href="search.php?action=show_recent" title="Find topics with recent posts.">Active</a> | <a href="search.php?action=show_unanswered" title="Find topics with no replies.">Unanswered</a></span></li> </ul> <div class="clearer"></div> </div> </div> </div> <div id="brdmain"> <div class="linkst"> <div class="inbox crumbsplus"> <ul class="crumbs"> <li><a href="index.php">Index</a></li> <li><span>»&#160;</span><a href="viewforum.php?id=48">Topics Going Nowhere</a></li> <li><span>»&#160;</span><strong><a href="viewtopic.php?id=162768">KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</a></strong></li> </ul> <div class="pagepost"> <p class="pagelink conl"><span class="pages-label">Pages: </span><a rel="prev" class="item1" href="viewtopic.php?id=162768&amp;p=117">Previous</a> <a href="viewtopic.php?id=162768">1</a> <span class="spacer">…</span> <a href="viewtopic.php?id=162768&amp;p=116">116</a> <a href="viewtopic.php?id=162768&amp;p=117">117</a> <strong>118</strong> <a href="viewtopic.php?id=162768&amp;p=119">119</a> <a href="viewtopic.php?id=162768&amp;p=120">120</a> <span class="spacer">…</span> <a href="viewtopic.php?id=162768&amp;p=234">234</a> <a rel="next" href="viewtopic.php?id=162768&amp;p=119">Next</a></p> <p class="postlink conr">Topic closed</p> </div> <div class="clearer"></div> </div> </div> <div id="p1464291" class="blockpost rowodd blockpost1"> <h2><span><span class="conr">#2926</span> <a href="viewtopic.php?pid=1464291#p1464291">2014-10-09 16:50:23</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=82238">sinny</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2014-05-24</span></dd> <dd><span>Posts: 75</span></dd> <dd class="usercontacts"><span class="email"><a href="misc.php?email=82238">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>Denso wrote:</cite><blockquote><div><div class="quotebox"><cite>dwe11er wrote:</cite><blockquote><div><div class="quotebox"><cite>Denso wrote:</cite><blockquote><div><p>Hi everyone .</p><p>Can anyone who uses OVMF successfully post his entire qemu launch command ?</p><p>OVMF might be the answer to all my hangs issues on VMs&#039; reboots , but it still doesn&#039;t detect any of my drives .</p><p>I don&#039;t use libvirt , just plain shell scripts .</p><p>Much appreciated .</p></div></blockquote></div><div class="codebox"><pre><code>LC_ALL=C PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin QEMU_AUDIO_DRV=none /usr/sbin/qemu-system-x86_64 -name windows -S -machine pc-i440fx-2.1,accel=kvm,usb=off -cpu host,hv_time,-kvm_pv_eoi,hv_relaxed,hv_vapic,hv_spinlocks=0x1fff -drive file=/usr/share/ovmf/x64/ovmf_code_x64.bin,if=pflash,format=raw,unit=0,readonly=on -drive file=/var/lib/libvirt/qemu/nvram/windows_VARS.fd,if=pflash,format=raw,unit=1 -m 8192 -mem-prealloc -mem-path /dev/hugepages/libvirt/qemu -realtime mlock=off -smp 6,sockets=1,cores=3,threads=2 -uuid 09d81f35-51a4-4c7d-8db0-46597c7233ba -nographic -no-user-config -nodefaults -chardev socket,id=charmonitor,path=/var/lib/libvirt/qemu/windows.monitor,server,nowait -mon chardev=charmonitor,id=monitor,mode=control -rtc base=localtime,clock=vm,driftfix=slew -global kvm-pit.lost_tick_policy=discard -no-hpet -no-shutdown -global PIIX4_PM.disable_s3=1 -global PIIX4_PM.disable_s4=1 -boot strict=on -device ich9-usb-ehci1,id=usb,bus=pci.0,addr=0x4.0x7 -device ich9-usb-uhci1,masterbus=usb.0,firstport=0,bus=pci.0,multifunction=on,addr=0x4 -drive file=/dev/storage/windows-ovmf,if=none,id=drive-virtio-disk0,format=raw,aio=native -device virtio-blk-pci,ioeventfd=on,scsi=off,bus=pci.0,addr=0x5,drive=drive-virtio-disk0,id=virtio-disk0,bootindex=1 -drive file=/dev/storage/steam,if=none,id=drive-virtio-disk1,format=raw,aio=native -device virtio-blk-pci,ioeventfd=on,scsi=off,bus=pci.0,addr=0x6,drive=drive-virtio-disk1,id=virtio-disk1 -netdev tap,fd=21,id=hostnet0,vhost=on,vhostfd=22 -device virtio-net-pci,netdev=hostnet0,id=net0,mac=52:54:00:c6:b5:45,bus=pci.0,addr=0x3 -chardev pty,id=charserial0 -device isa-serial,chardev=charserial0,id=serial0 -device vfio-pci,host=00:1b.0,id=hostdev0,bus=pci.0,addr=0x2 -device vfio-pci,host=01:00.0,id=hostdev1,bus=pci.0,multifunction=on,addr=0x7,rombar=0,romfile=/var/lib/libvirt/firmware/HD7870_EFI.rom -device vfio-pci,host=01:00.1,id=hostdev2,bus=pci.0,addr=0x7.0x1 -device usb-host,hostbus=2,hostaddr=17,id=hostdev3 -device usb-host,hostbus=2,hostaddr=3,id=hostdev4 -device virtio-balloon-pci,id=balloon0,bus=pci.0,addr=0x8 -set device.virtio-disk0.scsi=off -set device.virtio-disk0.x-data-plane=on -set device.virtio-disk1.scsi=off -set device.virtio-disk1.x-data-plane=on -msg timestamp=on</code></pre></div><p>It&#039;s how libvirt launches my vm, but should work anyway with few adjustments.</p></div></blockquote></div><p>Thank you very much !</p><p>I&#039;m going to adapt these settings to my existing WIndows VM , however I couldn&#039;t find the file &quot;windows_VARS.fd&quot; , and Google points me to your post , if it isn&#039;t any trouble can you tell me what is it for ? is it important ? if so , how can I create one ?</p><p>Sorry for this barge of questions , I want to learn .</p></div></blockquote></div><p>@&quot;windows_VARS.fd&quot;:<br />i suspect you should read up every post at aw&#039;s blog (search in his forum sig) - especially the ones related to ovmf, even more especially for ovmf split image support</p><p>it&#039;s a bit strange that you try to find it somewhere externally even though this command line parameter declaration looks almost identical to guest&#039;s hard drive info</p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1464291">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1464416" class="blockpost roweven"> <h2><span><span class="conr">#2927</span> <a href="viewtopic.php?pid=1464416#p1464416">2014-10-10 00:42:28</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=84538">mauorrizze</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2014-08-22</span></dd> <dd><span>Posts: 17</span></dd> <dd class="usercontacts"><span class="email"><a href="misc.php?email=84538">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>Denso wrote:</cite><blockquote><div><p>I couldn&#039;t find the file &quot;windows_VARS.fd&quot;</p></div></blockquote></div><p>To summarize the infos from aw&#039;s blog: if you use splitted OVMF images, libvirt copies for you the vars-file, for qemu you should do it manually because this file might get modified. The original file is part or compiled of your OVMF-package. <a href="http://vfio.blogspot.de/2014/09/ovmf-split-image-support.html" rel="nofollow">http://vfio.blogspot.de/2014/09/ovmf-sp … pport.html</a></p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1464416">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1464511" class="blockpost rowodd"> <h2><span><span class="conr">#2928</span> <a href="viewtopic.php?pid=1464511#p1464511">2014-10-10 12:17:12</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=84760">Denso</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd class="postavatar"><img src="https://bbs.archlinux.org/img/avatars/84760.png?m=1412533733" width="71" height="80" alt="" /></dd> <dd><span>Registered: 2014-08-30</span></dd> <dd><span>Posts: 179</span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <p>Thank you both !</p><p>My OVMF is exactly 2MB and according to Alex&#039;s blog post , it is a unified package so specifying a VARS file is not necessary I guess .</p><p>I don&#039;t know what is wrong with my shell script , but OVMF always drops me to the shell with no disks detected . Been trying for weeks ...</p><div class="codebox"><pre><code>qemu-system-x86_64 -name gaming -nographic \ -enable-kvm -m 8192 -cpu host,hv_time,hv_relaxed,hv_vapic,hv_spinlocks=0x1000,kvm=off -smp 4,sockets=1,cores=4,threads=1 \ -pflash /VMs/ovmf_x64.bin -device vfio-pci,host=02:00.0,bus=bus=pci.0,addr=addr=0x7,multifunction=on \ -device vfio-pci,host=02:00.1,bus=bus=pci.0,0x7.0x1 \ -drive file=/VMs/Win_Gaming.qed,cache=writeback,if=none,id=drive0,aio=native \ -device virtio-blk-pci,drive=drive0,ioeventfd=on,bootindex=1 \ -drive file=/VMs/Gaming_External.qed,cache=none,if=none,id=drive1,aio=native \ -device virtio-blk-pci,drive=drive1,ioeventfd=on \ -net nic,model=virtio,macaddr=64:25:5E:87:0E:5C -net bridge,br=br0 \ -usb -usbdevice host:1c4f:0034 -usbdevice host:1c4f:0002 -usbdevice host:0a12:0001 \ -localtime \ -monitor unix:/tmp/vm_gaming,server,nowait &amp;</code></pre></div> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1464511">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1464548" class="blockpost roweven"> <h2><span><span class="conr">#2929</span> <a href="viewtopic.php?pid=1464548#p1464548">2014-10-10 14:47:53</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=82238">sinny</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2014-05-24</span></dd> <dd><span>Posts: 75</span></dd> <dd class="usercontacts"><span class="email"><a href="misc.php?email=82238">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>Denso wrote:</cite><blockquote><div><p>Thank you both !</p><p>My OVMF is exactly 2MB and according to Alex&#039;s blog post , it is a unified package so specifying a VARS file is not necessary I guess .</p><p>I don&#039;t know what is wrong with my shell script , but OVMF always drops me to the shell with no disks detected . Been trying for weeks ...</p><div class="codebox"><pre><code>qemu-system-x86_64 -name gaming -nographic \ -enable-kvm -m 8192 -cpu host,hv_time,hv_relaxed,hv_vapic,hv_spinlocks=0x1000,kvm=off -smp 4,sockets=1,cores=4,threads=1 \ -pflash /VMs/ovmf_x64.bin -device vfio-pci,host=02:00.0,bus=bus=pci.0,addr=addr=0x7,multifunction=on \ -device vfio-pci,host=02:00.1,bus=bus=pci.0,0x7.0x1 \ -drive file=/VMs/Win_Gaming.qed,cache=writeback,if=none,id=drive0,aio=native \ -device virtio-blk-pci,drive=drive0,ioeventfd=on,bootindex=1 \ -drive file=/VMs/Gaming_External.qed,cache=none,if=none,id=drive1,aio=native \ -device virtio-blk-pci,drive=drive1,ioeventfd=on \ -net nic,model=virtio,macaddr=64:25:5E:87:0E:5C -net bridge,br=br0 \ -usb -usbdevice host:1c4f:0034 -usbdevice host:1c4f:0002 -usbdevice host:0a12:0001 \ -localtime \ -monitor unix:/tmp/vm_gaming,server,nowait &amp;</code></pre></div></div></blockquote></div><p>it always dropped me there whenever i was trying to boot something that is not uefi-aware (ISO&#039;s mostly)<br />if you try to switch already installed os - i guess you should reinstall (not that aware of details but it seems to me at least windows-installed boot stuff/layout is different depending on whether it&#039;s bios or uefi)</p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1464548">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1464581" class="blockpost rowodd"> <h2><span><span class="conr">#2930</span> <a href="viewtopic.php?pid=1464581#p1464581">2014-10-10 17:19:09</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=85749">Drakulix</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2014-10-10</span></dd> <dd><span>Posts: 4</span></dd> <dd class="usercontacts"><span class="email"><a href="misc.php?email=85749">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <p>Hi there!<br />I have some question on this subject and got already pretty far on my own, although I have a very experimental hardware configuration, but I am stuck now and need some help.</p><p>First about my hardware setup. Please don&#039;t tell me right away, that VGA Passthough will not work on my setup. I know that some people might have mixed feeling, when reading the next sentence.</p><p>So I have a Macbook Pro Retina 15&quot; with an Intel HD4000 and an nVidia GeForce 650M and yes I am trying to Passthough a Mobile Graphics Card.<br />My CPU (Intel(R) Core(TM) i7-3720QM) does support VT-d, I have no idea, what my mainbroad might support. It is from mid-2012, so I have at least a chance, I guess.</p><p>I am running Linux Kernel 3.17 with the acs override patch, the i915 vga arbiter fixes and some other patches. (4 cherry picks from 3.18.&#160; First to fix broken HDMI info frames with nouveau, and some about my battery and thunderbold hotplug support on apple devices. So nothing else that should matter.)</p><p>I know that my HDMI connector is directly attached to my graphics card. My kernel also contains a self-made patch that allows me to switch my mux directly (bypassing vga_switcheroo and the ability to switch without any graphic drivers loaded). So I can decide, if my internal screen is attached to my intel card or the nvidia card. (works nicely, if someone needs help on that subject, feel free to pm me. the wiki article is not very helpful with this).</p><p>I can currently boot a Windows 7 SP1 (64-Bit) VM with VGA Passthough either on my HDMI Monitor (allowing my to use linux meanwhile) or on my internal screen (swapping the mux beforehand and after running qemu via a little bash script). The graphics card does get detected, I can install the nVidia drivers, but I get error 43 in the Device Manager.</p><br /><p>Some more details:</p><p>I have the following in my kernel boot parameters:</p><div class="codebox"><pre><code>modprobe.blacklist=nouveau i915.enable_hd_vgaarb=1 pci-stub.ids=10de:0fd5,10de:0e1b,8086:1547 intel_iommu=on</code></pre></div><p>I am normally running the with nouveau drivers, the nvidia drivers are not installed.<br />The last device:vendor-id pair is from my thunderbolt connectors, which appear to be connected to the same iommu_group my graphics adapter is (probably for displayport output).<br />I need to bind them to vfio as well, otherwise I get an error in qemu (iommu_group not viable).<br />Everything shows up as loaded by pci-stub correctly, before I bind to vfio-pci.</p><p>So this is what my binding looks like:</p><div class="codebox"><pre><code>sudo ./vfio-bind 0000:01:00.0 0000:01:00.1 0000:05:00.0 0000:06:00.0 0000:06:03.0 0000:06:04.0 0000:06:05.0 0000:06:06.0 0000:07:00.0</code></pre></div><p>The first is my graphics card, the seconds is HDMI audio, the rest is thunderbolt.</p><p>I also have the following set via configs in modprobe.d:</p><div class="codebox"><pre><code>options kvm ignore_msrs=1 options vfio_iommu_type1 allow_unsafe_interrupts=1</code></pre></div><p>I need the second option, at least thats what qemu tells me, when I try to boot without it.</p><p>Last but not atleast I run qemu like this:</p><div class="codebox"><pre><code>sudo qemu-system-x86_64 -enable-kvm -M q35 -m 2048 -cpu host -smp 4,sockets=1,cores=4,threads=1 \ -bios /usr/share/qemu/bios.bin -vga none -device ioh3420,bus=pcie.0,addr=1c.0,multifunction=on,port=1,chassis=1,id=root.1 \ -device vfio-pci,host=01:00.0,bus=root.1,addr=00.0,multifunction=on,x-vga=on,romfile=vbios.rom \ -device vfio-pci,host=01:00.1,bus=root.1,addr=00.1 -drive file=QEMU/windows.img,id=disk,format=qcow2 \ -device ide-hd,bus=ide.0,drive=disk -device qxl</code></pre></div><p>I need to pass the romfile, otherwise qemu complains and dmesg says something like &quot;Invalid VBIOS Contents&quot;. I am using -device qxl, since I do want to use my keyboard and trackpad.</p><br /><p>I am using the qemu package from the arch repos, which is version 2.1.2. The qemu-git package failed for some reason, but I can try to get it to work, if that would help anything.</p><p>If you need any more informations, please feel free to ask.<br />I have not much ideas left, to fix the error 43. I already removed all hv_* functions and added kvm=off to my qemu cpu options, still not any better.</p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1464581">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1464687" class="blockpost roweven"> <h2><span><span class="conr">#2931</span> <a href="viewtopic.php?pid=1464687#p1464687">2014-10-11 00:18:08</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=84238">Mardok45</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2014-08-10</span></dd> <dd><span>Posts: 5</span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <p>I&#039;ve done a lot of switching between Xen and QEMU when researching this topic and have ultimately decided to stick with QEMU.&#160; I have a desktop that&#039;s running both Windows 7 and Gentoo and it works almost perfectly.</p><p>There&#039;s still one problem that I haven&#039;t solved yet.&#160; My Windows VM has a Nvidia GTX 260 exposed to it and I am able to play Dota 2.&#160; However, Dota 2 was having framerate problems.&#160; I know for a fact that on bare-metal, my GTX 260 chews right through Dota 2 with no problems.&#160; I expect a performance degredation, but this is unusually slow.&#160; </p><p>I looked at the CPU usage, and all four CPU&#039;s that were exposed to it were running at 50%.&#160; So the CPU isn&#039;t the problem.&#160; I looked at the memory usage and 2 gigabytes were used out of the 3 that were exposed to it.&#160; So the memory isn&#039;t the problem.</p><p>After a lot of head-scratching, I noticed that the GTX 260 was really quiet through all this.&#160; Usually when playing a game like Dota 2, the GPU fan gets really loud.&#160; I think the problem is the GTX 260 isn&#039;t increasing its clock speed.</p><p>I tried a QEMU config using the Q35 machine model and the 440FX model and both have the same problem.</p><p>I tried turning on maximum performance in the NVidia control panel and Windows settings, but neither solved the problem.&#160; Does anyone know what the problem might be?</p> <p class="postedit"><em>Last edited by Mardok45 (2014-10-11 00:19:59)</em></p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1464687">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1464694" class="blockpost rowodd"> <h2><span><span class="conr">#2932</span> <a href="viewtopic.php?pid=1464694#p1464694">2014-10-11 00:46:16</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=82442">slis</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2014-06-02</span></dd> <dd><span>Posts: 125</span></dd> <dd class="usercontacts"><span class="email"><a href="mailto:xslisx@gmail.com">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>Mardok45 wrote:</cite><blockquote><div><p>I&#039;ve done a lot of switching between Xen and QEMU when researching this topic and have ultimately decided to stick with QEMU.&#160; I have a desktop that&#039;s running both Windows 7 and Gentoo and it works almost perfectly.</p><p>There&#039;s still one problem that I haven&#039;t solved yet.&#160; My Windows VM has a Nvidia GTX 260 exposed to it and I am able to play Dota 2.&#160; However, Dota 2 was having framerate problems.&#160; I know for a fact that on bare-metal, my GTX 260 chews right through Dota 2 with no problems.&#160; I expect a performance degredation, but this is unusually slow.&#160; </p><p>I looked at the CPU usage, and all four CPU&#039;s that were exposed to it were running at 50%.&#160; So the CPU isn&#039;t the problem.&#160; I looked at the memory usage and 2 gigabytes were used out of the 3 that were exposed to it.&#160; So the memory isn&#039;t the problem.</p><p>After a lot of head-scratching, I noticed that the GTX 260 was really quiet through all this.&#160; Usually when playing a game like Dota 2, the GPU fan gets really loud.&#160; I think the problem is the GTX 260 isn&#039;t increasing its clock speed.</p><p>I tried a QEMU config using the Q35 machine model and the 440FX model and both have the same problem.</p><p>I tried turning on maximum performance in the NVidia control panel and Windows settings, but neither solved the problem.&#160; Does anyone know what the problem might be?</p></div></blockquote></div><p>Try different cpu configs, here works best with 2 or more cores 1 thread each, and hv-time option that doesn&#039;t work with drivers after 340.xx..</p> <p class="postedit"><em>Last edited by slis (2014-10-11 01:10:06)</em></p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1464694">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1464703" class="blockpost roweven"> <h2><span><span class="conr">#2933</span> <a href="viewtopic.php?pid=1464703#p1464703">2014-10-11 01:58:19</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=84238">Mardok45</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2014-08-10</span></dd> <dd><span>Posts: 5</span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>slis wrote:</cite><blockquote><div><div class="quotebox"><cite>Mardok45 wrote:</cite><blockquote><div><p>I&#039;ve done a lot of switching between Xen and QEMU when researching this topic and have ultimately decided to stick with QEMU.&#160; I have a desktop that&#039;s running both Windows 7 and Gentoo and it works almost perfectly.</p><p>There&#039;s still one problem that I haven&#039;t solved yet.&#160; My Windows VM has a Nvidia GTX 260 exposed to it and I am able to play Dota 2.&#160; However, Dota 2 was having framerate problems.&#160; I know for a fact that on bare-metal, my GTX 260 chews right through Dota 2 with no problems.&#160; I expect a performance degredation, but this is unusually slow.&#160; </p><p>I looked at the CPU usage, and all four CPU&#039;s that were exposed to it were running at 50%.&#160; So the CPU isn&#039;t the problem.&#160; I looked at the memory usage and 2 gigabytes were used out of the 3 that were exposed to it.&#160; So the memory isn&#039;t the problem.</p><p>After a lot of head-scratching, I noticed that the GTX 260 was really quiet through all this.&#160; Usually when playing a game like Dota 2, the GPU fan gets really loud.&#160; I think the problem is the GTX 260 isn&#039;t increasing its clock speed.</p><p>I tried a QEMU config using the Q35 machine model and the 440FX model and both have the same problem.</p><p>I tried turning on maximum performance in the NVidia control panel and Windows settings, but neither solved the problem.&#160; Does anyone know what the problem might be?</p></div></blockquote></div><p>Try different cpu configs, here works best with 2 or more cores 1 thread each, and hv-time option that doesn&#039;t work with drivers after 340.xx..</p></div></blockquote></div><div class="codebox"><pre><code>qemu-system-x86_64 \ -nodefconfig \ -monitor stdio -serial none -parallel none \ -enable-kvm \ -rtc base=localtime \ -M q35 \ -smp 4,sockets=1,cores=4,threads=1 -cpu host,kvm=off \ -m 3072 \ -device ioh3420,bus=pcie.0,addr=1c.0,multifunction=on,port=1,chassis=1,id=root.1 \ -netdev bridge,br=br0,id=hostnet0 -device virtio-net-pci,netdev=hostnet0,id=net0,mac=02:12:34:56:78:97 \ -drive file=/dev/system/windows,cache=none,if=none,id=drive0,aio=threads,format=raw -device virtio-blk-pci,drive=drive0,ioeventfd=on,bootindex=2 \ -drive file=/root/win7.iso,if=none,id=cd0,aio=threads,format=raw -device ide-cd,drive=cd0,bootindex=1 \ -drive file=/root/qemu/virtio.iso,if=none,id=cd1,aio=threads,format=raw -device ide-cd,drive=cd1,bus=ide.1 \ -device vfio-pci,host=00:12.0,bus=pcie.0 \ -device vfio-pci,host=00:12.2,bus=pcie.0 \ -device vfio-pci,host=00:14.2,bus=pcie.0 \ -device vfio-pci,host=01:00.0,multifunction=on,x-vga=on,bus=pcie.0 \ -vga none \ -nographic \</code></pre></div><p>I&#039;m running the 334 drivers.&#160; I removed hv-time and it doesn&#039;t seem to help.&#160; I&#039;m not sure why the GPU wouldn&#039;t increase its clock speed.</p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1464703">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1464742" class="blockpost rowodd"> <h2><span><span class="conr">#2934</span> <a href="viewtopic.php?pid=1464742#p1464742">2014-10-11 07:04:04</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=82442">slis</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2014-06-02</span></dd> <dd><span>Posts: 125</span></dd> <dd class="usercontacts"><span class="email"><a href="mailto:xslisx@gmail.com">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <p>well i got here native like perfomance in dota2, with hv-time and 2+ cores, remove that smp option maybe?</p><br /><p><a href="http://pastie.org/9639320" rel="nofollow">http://pastie.org/9639320</a></p><p>i&#039;m using this config for streaming on headless server for last 2-3 months and with 340.82 driver it works without problem.</p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1464742">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1464780" class="blockpost roweven"> <h2><span><span class="conr">#2935</span> <a href="viewtopic.php?pid=1464780#p1464780">2014-10-11 09:36:51</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=84760">Denso</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd class="postavatar"><img src="https://bbs.archlinux.org/img/avatars/84760.png?m=1412533733" width="71" height="80" alt="" /></dd> <dd><span>Registered: 2014-08-30</span></dd> <dd><span>Posts: 179</span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>sinny wrote:</cite><blockquote><div><p>it always dropped me there whenever i was trying to boot something that is not uefi-aware (ISO&#039;s mostly)<br />if you try to switch already installed os - i guess you should reinstall (not that aware of details but it seems to me at least windows-installed boot stuff/layout is different depending on whether it&#039;s bios or uefi)</p></div></blockquote></div><p>Then how can one install Windows if the installation media could not be detected , I&#039;m using Windows 8.1 ISO ?</p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1464780">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1464804" class="blockpost rowodd"> <h2><span><span class="conr">#2936</span> <a href="viewtopic.php?pid=1464804#p1464804">2014-10-11 11:11:46</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=76566">cryptonymous</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2013-11-05</span></dd> <dd><span>Posts: 6</span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <p>Can anyone who have tried using OVMF confirm that initial OVMF bootup messages and EFI shell are shown on a monitor connected to a passed-through video card? I can seem to get even this basic thing to work with OVMF.</p><p>Command line I&#039;ve tried:</p><div class="codebox"><pre><code>qemu-system-x86_64 -enable-kvm -machine pc-i440fx-2.1,accel=kvm,usb=off -device vfio-pci,host=01:00.0,bus=pci.0,addr=7,multifunction=on,romfile=/home/user/NV280MS1-EFI.rom -device vfio-pci,host=01:00.1,bus=pci.0,addr=7.1 -drive if=pflash,format=raw,readonly,file=/tmp/usr/share/edk2.git/ovmf-x64/OVMF-pure-efi.fd -vga none -nographic</code></pre></div><p>All messages, including EFI shell, are shown on QEMU&#039;s curses console. Nothing is shown on a passed-though video card. Does it mean EFI ROM that performs video card initialization doesn&#039;t run properly? If I type `pci&#039; command in EFI shell, I see that correct VID/PID pair is listed for the video card, thus it is clearly detected.</p><p>The ROM file I use (NV280MS1-EFI.rom) does have a EFI part:</p><div class="codebox"><pre><code>Valid ROM signature found @400h, PCIR offset 190h PCIR: type 0, vendor: 10de, device: 0fc6, class: 030000 PCIR: revision 0, vendor revision: 1 Valid ROM signature found @10000h, PCIR offset 1ch PCIR: type 3, vendor: 10de, device: 0fc6, class: 030000 PCIR: revision 3, vendor revision: 0 EFI: Signature Valid Last image</code></pre></div><p>Video card in question is a NVidia GTX 650 (MSI N650 PE 1GD5/OC). Initially it came with hybrid (EFI/Legacy) BIOS flashed, later update was just Legacy. I&#039;m trying to use original ROM I&#039;ve fortunately backed up before reflashing.</p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1464804">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1464892" class="blockpost roweven"> <h2><span><span class="conr">#2937</span> <a href="viewtopic.php?pid=1464892#p1464892">2014-10-11 16:01:25</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=82238">sinny</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2014-05-24</span></dd> <dd><span>Posts: 75</span></dd> <dd class="usercontacts"><span class="email"><a href="misc.php?email=82238">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>Denso wrote:</cite><blockquote><div><div class="quotebox"><cite>sinny wrote:</cite><blockquote><div><p>it always dropped me there whenever i was trying to boot something that is not uefi-aware (ISO&#039;s mostly)<br />if you try to switch already installed os - i guess you should reinstall (not that aware of details but it seems to me at least windows-installed boot stuff/layout is different depending on whether it&#039;s bios or uefi)</p></div></blockquote></div><p>Then how can one install Windows if the installation media could not be detected , I&#039;m using Windows 8.1 ISO ?</p></div></blockquote></div><p>_right_ (that&#039;s the key part here) innstallation media should work without problems<br />what processor are you emulating (probably 64 bit)?<br />what iso are you trying? does it match processor bitness (it may matter)? are you sure it&#039;s uefi-bootable?</p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1464892">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1464900" class="blockpost rowodd"> <h2><span><span class="conr">#2938</span> <a href="viewtopic.php?pid=1464900#p1464900">2014-10-11 16:39:48</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=84760">Denso</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd class="postavatar"><img src="https://bbs.archlinux.org/img/avatars/84760.png?m=1412533733" width="71" height="80" alt="" /></dd> <dd><span>Registered: 2014-08-30</span></dd> <dd><span>Posts: 179</span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>sinny wrote:</cite><blockquote><div><p>_right_ (that&#039;s the key part here) innstallation media should work without problems<br />what processor are you emulating (probably 64 bit)?<br />what iso are you trying? does it match processor bitness (it may matter)? are you sure it&#039;s uefi-bootable?</p></div></blockquote></div><p>1 - Processor is passed-through (-cpu host) which is an i7-5930k .</p><p>2 - I&#039;m using the Windows 8.1 Enterprise ISO (MSDN with Update) .</p><p>I don&#039;t see why shouldn&#039;t it be UEFI-compatible , when I switch machine type to 440FX , it detects the ISO , but refuses to boot it . I tried to manually execute the file located at /EFI/BOOT/BOOTX64.EFI&#160; but it hangs the VM for 3 seconds then return to the shell .</p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1464900">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1464916" class="blockpost roweven"> <h2><span><span class="conr">#2939</span> <a href="viewtopic.php?pid=1464916#p1464916">2014-10-11 17:43:12</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=84238">Mardok45</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2014-08-10</span></dd> <dd><span>Posts: 5</span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>slis wrote:</cite><blockquote><div><p>well i got here native like perfomance in dota2, with hv-time and 2+ cores, remove that smp option maybe?</p><br /><p><a href="http://pastie.org/9639320" rel="nofollow">http://pastie.org/9639320</a></p><p>i&#039;m using this config for streaming on headless server for last 2-3 months and with 340.82 driver it works without problem.</p></div></blockquote></div><p>I copied and edited that config and it seemed to help a bit.&#160; It&#039;s still not running anywhere near native performance, but Dota 2 is at least playable.&#160; I&#039;m running a 6-core Bulldozer CPU, so maybe I just need to throw better hardware at it.&#160; The VM is running the 334 Nvidia drivers.</p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1464916">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1465089" class="blockpost rowodd"> <h2><span><span class="conr">#2940</span> <a href="viewtopic.php?pid=1465089#p1465089">2014-10-12 04:57:06</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=82238">sinny</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2014-05-24</span></dd> <dd><span>Posts: 75</span></dd> <dd class="usercontacts"><span class="email"><a href="misc.php?email=82238">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>Mardok45 wrote:</cite><blockquote><div><div class="quotebox"><cite>slis wrote:</cite><blockquote><div><p>well i got here native like perfomance in dota2, with hv-time and 2+ cores, remove that smp option maybe?</p><br /><p><a href="http://pastie.org/9639320" rel="nofollow">http://pastie.org/9639320</a></p><p>i&#039;m using this config for streaming on headless server for last 2-3 months and with 340.82 driver it works without problem.</p></div></blockquote></div><p>I copied and edited that config and it seemed to help a bit.&#160; It&#039;s still not running anywhere near native performance, but Dota 2 is at least playable.&#160; I&#039;m running a 6-core Bulldozer CPU, so maybe I just need to throw better hardware at it.&#160; The VM is running the 334 Nvidia drivers.</p></div></blockquote></div><p>try to disable any sound for vm - just drop any sound-related parameters from xml or commandline<br />also look at real qemu invocation parameters and look for something that is not needed or simply wrong<br />check that your memory allocation is normal (hugetlbfs?)<br />review your cpu allocation scheme (your current config binds to cpus 0-4, but are these cpus isolated from host usage?)</p><p>p.s. all this was written too many times all over the thread already, is copy-pasting someone&#039;s xml the best of your abilities?</p> <p class="postedit"><em>Last edited by sinny (2014-10-12 04:58:03)</em></p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1465089">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1465127" class="blockpost roweven"> <h2><span><span class="conr">#2941</span> <a href="viewtopic.php?pid=1465127#p1465127">2014-10-12 11:13:58</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=85314">Duelist</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2014-09-22</span></dd> <dd><span>Posts: 358</span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <p>lspci -nn</p><div class="codebox"><pre><code>01:00.0 VGA compatible controller [0300]: Advanced Micro Devices, Inc. [AMD/ATI] Cape Verde PRO [Radeon HD 7750 / R7 250E] [1002:683f] 01:00.1 Audio device [0403]: Advanced Micro Devices, Inc. [AMD/ATI] Cape Verde/Pitcairn HDMI Audio [Radeon HD 7700/7800 Series] [1002:aab0] 02:00.0 VGA compatible controller [0300]: Advanced Micro Devices, Inc. [AMD/ATI] Cape Verde PRO [Radeon HD 7750 / R7 250E] [1002:683f] 02:00.1 Audio device [0403]: Advanced Micro Devices, Inc. [AMD/ATI] Cape Verde/Pitcairn HDMI Audio [Radeon HD 7700/7800 Series] [1002:aab0] 04:00.0 VGA compatible controller [0300]: NVIDIA Corporation GF119 [GeForce GT 610] [10de:104a] (rev a1) 04:00.1 Audio device [0403]: NVIDIA Corporation GF119 HDMI Audio Controller [10de:0e08] (rev a1)</code></pre></div><p>dmesg: <a href="http://pastebin.com/wp56ts9Y" rel="nofollow">http://pastebin.com/wp56ts9Y</a></p><div class="codebox"><pre><code>sudo qemu-system-x86_64 \ -boot menu=on \ -enable-kvm \ -M q35 \ -m 4096 \ -cpu host \ -net none \ -rtc base=localtime \ -smp 4,sockets=1,cores=4,threads=1 \ -netdev tap,ifname=tap0,id=tap0 \ -drive file=&#039;/mnt/hdd/qemu-vfio-win.img&#039;,id=disk,format=raw,cache=none \ -drive file=&#039;/mnt/hdd/virtio.iso&#039;,id=cdrom,format=raw,readonly=on \ -device ioh3420,addr=02.0,multifunction=on,port=1,chassis=1,id=root.0 \ -device ioh3420,addr=04.0,multifunction=on,port=1,chassis=2,id=root.1 \ -device ioh3420,addr=06.0,multifunction=on,port=1,chassis=3,id=root.2 \ -device virtio-blk-pci,bus=root.2,addr=04.0,drive=disk \ -device ide-cd,unit=0,drive=cdrom \ -device ich9-intel-hda,bus=root.2,addr=00.0,id=sound0 \ -device hda-duplex,id=sound0-codec0,bus=sound0.0,cad=0 \ -device virtio-net-pci,netdev=tap0,bus=root.2,addr=01.0 \ -device vfio-pci,host=01:00.0,bus=root.0,addr=00.0,multifunction=on,x-vga=on \ -device vfio-pci,host=01:00.1,bus=root.0,addr=00.1 \ -device vfio-pci,host=02:00.0,bus=root.1,addr=00.0,multifunction=on,x-vga=off \ -device vfio-pci,host=02:00.1,bus=root.1,addr=00.1 \ -vga none \ -device qxl,bus=root.2,addr=02.0</code></pre></div><p>BSOD 116 after catalyst install inside windows VM.<br />Second card doesn&#039;t start yet - device code 10. </p><p>I have patched host nvidia driver so /dev/vga_arbiter would be</p><div class="codebox"><pre><code>count:3,PCI:0000:01:00.0,decodes=io+mem,owns=none,locks=none(0:0)</code></pre></div><p>QEMU 2.1.2</p><p>AMD Catalyst 14.9</p><p>Also:</p><div class="codebox"><pre><code>options kvm-amd npt=0 blacklist nouveau options nouveau modeset=0</code></pre></div><p>Full dmesg(quite lenghty): <a href="http://pastebin.com/HiJh81Ct" rel="nofollow">http://pastebin.com/HiJh81Ct</a></p><p>ls /sys/kernel/iommu_groups/*/devices:</p><div class="codebox"><pre><code>/sys/kernel/iommu_groups/1/devices: 0000:00:02.0 0000:01:00.0 0000:01:00.1 /sys/kernel/iommu_groups/2/devices: 0000:00:04.0 0000:02:00.0 0000:02:00.1</code></pre></div><p>Full lspci: <a href="http://pastebin.com/0ZED3z7U" rel="nofollow">http://pastebin.com/0ZED3z7U</a></p><br /><p>Any ideas how to:<br />- fix BSOD? <strong>disabling HDMI audio doesn&#039;t help anymore</strong><br />- fix code 10 on second gpu?</p><p>Maybe i should use -M pc and -nodefaults?</p><p>UPD:Same dmesg messages appear, but for the different device, the gpu itself, when passing only GPUs without HDMI audio.</p> <p class="postedit"><em>Last edited by Duelist (2014-10-12 14:03:53)</em></p> </div> <div class="postsignature postmsg"><hr /><p><span class="bbs">The forum rules prohibit requesting support for distributions other than arch.</span><br /><a href="https://bbs.archlinux.org/viewtopic.php?pid=1551460#p1551460" rel="nofollow">I gave up.</a><a href="https://bbs.archlinux.org/viewtopic.php?id=162768" rel="nofollow"> It was too late.</a><br /><a href="http://pastebin.com/B3fL84bq" rel="nofollow">What I was trying to do</a>.<br /><a href="http://vfio.blogspot.com/" rel="nofollow">The reference about VFIO and KVM VGA passthrough.</a></p></div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1465127">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1465132" class="blockpost rowodd"> <h2><span><span class="conr">#2942</span> <a href="viewtopic.php?pid=1465132#p1465132">2014-10-12 11:30:48</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=80279">novist</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2014-03-14</span></dd> <dd><span>Posts: 34</span></dd> <dd class="usercontacts"><span class="email"><a href="misc.php?email=80279">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <p>I wonder - has anyone tried and succeeded making this work on a laptop? All in all - it should work just fine on laptop with APU and dedicated GPU. What i dont know is how laptop could switch display to dedicated gpu. Anyone know if this is even possible with today&#039;s hardware?</p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1465132">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1465157" class="blockpost roweven"> <h2><span><span class="conr">#2943</span> <a href="viewtopic.php?pid=1465157#p1465157">2014-10-12 12:52:31</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=85314">Duelist</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2014-09-22</span></dd> <dd><span>Posts: 358</span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>novist wrote:</cite><blockquote><div><p>I wonder - has anyone tried and succeeded making this work on a laptop? All in all - it should work just fine on laptop with APU and dedicated GPU. What i dont know is how laptop could switch display to dedicated gpu. Anyone know if this is even possible with today&#039;s hardware?</p></div></blockquote></div><p>I&#039;ve built a pair of systems with APU and dual graphics.</p><p>It does not switch. It works the other way.</p><p>APU has it&#039;s own GPU inside, sitting on pci-e bus(thanks to UNB and integrated pci-e controller), which handles the video output.<br />When running dual graphics(having discrete gpu) - it&#039;s simply just crossfire between those cards.<br />On the desktop part, some applications may not support crossfire(or dual graphics may be turned off) and chosen device for rendering will depend from chosen output - for example, if you have your screen plugged in your motherboard then APU&#039;s GPU will render the scene and vice versa.<br />On the notebook part - some notebooks have video output routed physically to the dedicated GPU(usually those notebooks have non-APU versions, but that&#039;s quite rare), some have video output routed to APU.</p><p>It is not Nvidia Optimus, these notebooks just don&#039;t switch GPUs for energy saving, instead, they have zerocore technology in crossfire which cuts power to the secondary GPU.</p><br /><p>BUT! All those shiny new(&quot;new&quot; as 2012-new) technologies won&#039;t work with that particular technology quite right - i couldn&#039;t get fglrx working on host AND passing the second card to VM at the same time. fglrx seem to be messing around and scanning whole PC for related vendor-dev-ids and touching those devices without asking anyone.</p> </div> <div class="postsignature postmsg"><hr /><p><span class="bbs">The forum rules prohibit requesting support for distributions other than arch.</span><br /><a href="https://bbs.archlinux.org/viewtopic.php?pid=1551460#p1551460" rel="nofollow">I gave up.</a><a href="https://bbs.archlinux.org/viewtopic.php?id=162768" rel="nofollow"> It was too late.</a><br /><a href="http://pastebin.com/B3fL84bq" rel="nofollow">What I was trying to do</a>.<br /><a href="http://vfio.blogspot.com/" rel="nofollow">The reference about VFIO and KVM VGA passthrough.</a></p></div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1465157">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1465357" class="blockpost rowodd"> <h2><span><span class="conr">#2944</span> <a href="viewtopic.php?pid=1465357#p1465357">2014-10-12 22:33:21</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=85749">Drakulix</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2014-10-10</span></dd> <dd><span>Posts: 4</span></dd> <dd class="usercontacts"><span class="email"><a href="misc.php?email=85749">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <p>So I guess getting ignored means, nobody else has an idea?</p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1465357">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1465402" class="blockpost roweven"> <h2><span><span class="conr">#2945</span> <a href="viewtopic.php?pid=1465402#p1465402">2014-10-13 04:39:34</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=82238">sinny</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2014-05-24</span></dd> <dd><span>Posts: 75</span></dd> <dd class="usercontacts"><span class="email"><a href="misc.php?email=82238">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>Drakulix wrote:</cite><blockquote><div><p>So I guess getting ignored means, nobody else has an idea?</p></div></blockquote></div><p>probably. you got very experimental hardware set on top of experimental softwasre feature (==experimental squared?)</p><p>plus, me personnally would not expect someone trying to achieve anything (related to the discussion here) on apple <span class="bbs">garb</span> devices - you either get these to forget everything &quot;complex&quot; or stick with other hardware choices that allow more flexibility/choices</p><p>so i&#039;m afraid you are on your own there or, if you are lucky, there will be very little pre-existing experience for you to lean on</p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1465402">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1465430" class="blockpost rowodd"> <h2><span><span class="conr">#2946</span> <a href="viewtopic.php?pid=1465430#p1465430">2014-10-13 08:39:59</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=85749">Drakulix</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2014-10-10</span></dd> <dd><span>Posts: 4</span></dd> <dd class="usercontacts"><span class="email"><a href="misc.php?email=85749">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>sinny wrote:</cite><blockquote><div><div class="quotebox"><cite>Drakulix wrote:</cite><blockquote><div><p>So I guess getting ignored means, nobody else has an idea?</p></div></blockquote></div><p>probably. you got very experimental hardware set on top of experimental softwasre feature (==experimental squared?)</p><p>plus, me personnally would not expect someone trying to achieve anything (related to the discussion here) on apple <span class="bbs">garb</span> devices - you either get these to forget everything &quot;complex&quot; or stick with other hardware choices that allow more flexibility/choices</p><p>so i&#039;m afraid you are on your own there or, if you are lucky, there will be very little pre-existing experience for you to lean on</p></div></blockquote></div><p>Sure it is an experimental setup and sure there are probably not many users, that did try this already.<br />To be honest, I did not buy this hardware intentionally to do kvm-stuff on it or even install linux. I just recently switched and I am still stunned by the possibilities. Thats why I wanted to give it a try, because surprisingly enough my hardware seemed to meet all requirements. I already got quite far, that is why I want to try on.</p><p>And Code 43 seems to be a very common issue, so I did hope, there were some more hints then just &quot;add kvm=off&quot;, &quot;remove the hv_* functions&quot; and &quot;put your card in another PCIe-Port&quot; (which would obviously not work on my setup).</p><p>I am also not afraid of looking at huge log files or even try to write patches on my own, I just don&#039;t know where to start with this weird error. So if anybody has some hints, what I could try, that would be great.</p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1465430">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1465434" class="blockpost roweven"> <h2><span><span class="conr">#2947</span> <a href="viewtopic.php?pid=1465434#p1465434">2014-10-13 09:02:00</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=75590">aw</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2013-10-04</span></dd> <dd><span>Posts: 921</span></dd> <dd class="usercontacts"><span class="email"><a href="misc.php?email=75590">Email</a></span> <span class="website"><a href="http://vfio.blogspot.com/" rel="nofollow">Website</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>Drakulix wrote:</cite><blockquote><div><p>So I guess getting ignored means, nobody else has an idea?</p></div></blockquote></div><p>Just following your wishes:</p><div class="quotebox"><cite>Drakulix wrote:</cite><blockquote><div><p>Please don&#039;t tell me right away, that VGA Passthough will not work on my setup.</p></div></blockquote></div><p><img src="https://bbs.archlinux.org/img/smilies/wink.png" width="15" height="15" alt="wink" /></p><p>Seriously, laptops with dual graphics do strange and bizarre things and Code 43 is a pretty standard &quot;I give up&quot; error code from the Nvidia driver.&#160; We don&#039;t have the source, so we can only guess what might be wrong.&#160; Sometimes these laptops require vendor drivers for the discrete GPU to work rather than the standard Nvidia driver.&#160; When that GPU gets extracted into a VM, it may not behave exactly like devices supported by the standard driver.&#160; Especially on an Apple product, it&#039;s not clear that expecting the Windows driver to work is valid.</p> </div> <div class="postsignature postmsg"><hr /><p><a href="http://vfio.blogspot.com" rel="nofollow">http://vfio.blogspot.com</a><br />Looking for a more open forum to discuss vfio related uses?&#160; Try <a href="https://www.redhat.com/mailman/listinfo/vfio-users" rel="nofollow">https://www.redhat.com/mailman/listinfo/vfio-users</a></p></div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1465434">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1465437" class="blockpost rowodd"> <h2><span><span class="conr">#2948</span> <a href="viewtopic.php?pid=1465437#p1465437">2014-10-13 09:19:13</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=85749">Drakulix</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2014-10-10</span></dd> <dd><span>Posts: 4</span></dd> <dd class="usercontacts"><span class="email"><a href="misc.php?email=85749">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>aw wrote:</cite><blockquote><div><div class="quotebox"><cite>Drakulix wrote:</cite><blockquote><div><p>So I guess getting ignored means, nobody else has an idea?</p></div></blockquote></div><p>Just following your wishes:</p><div class="quotebox"><cite>Drakulix wrote:</cite><blockquote><div><p>Please don&#039;t tell me right away, that VGA Passthough will not work on my setup.</p></div></blockquote></div><p><img src="https://bbs.archlinux.org/img/smilies/wink.png" width="15" height="15" alt="wink" /></p></div></blockquote></div><p>I think, you can guess, that I just wanted to avoid the usual &quot;anti-apple-hate&quot;. <img src="https://bbs.archlinux.org/img/smilies/wink.png" width="15" height="15" alt="wink" /></p><br /><div class="quotebox"><cite>aw wrote:</cite><blockquote><div><p>Seriously, laptops with dual graphics do strange and bizarre things and Code 43 is a pretty standard &quot;I give up&quot; error code from the Nvidia driver.&#160; We don&#039;t have the source, so we can only guess what might be wrong.&#160; Sometimes these laptops require vendor drivers for the discrete GPU to work rather than the standard Nvidia driver.&#160; When that GPU gets extracted into a VM, it may not behave exactly like devices supported by the standard driver.&#160; Especially on an Apple product, it&#039;s not clear that expecting the Windows driver to work is valid.</p></div></blockquote></div><p>I did always use the unmodified nvidia drivers from their website on a bootcamp installed system without any issue (never installed them either though apple&#039;s magical setup program or windows update). Apple isn&#039;t even using nvidia optimus, it is just a hardware mux, no weird shared buffers between the two graphic cards. I guess that is as close to desktop graphics, as it can get on a laptop.<br />Does anybody at least have an idea, how I can get more verbose output from the involved kernel modules and/or qemu? I start reading into the source code if necessary, I am not yet giving up. <img src="https://bbs.archlinux.org/img/smilies/wink.png" width="15" height="15" alt="wink" /></p> <p class="postedit"><em>Last edited by Drakulix (2014-10-13 09:19:54)</em></p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1465437">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1465531" class="blockpost roweven"> <h2><span><span class="conr">#2949</span> <a href="viewtopic.php?pid=1465531#p1465531">2014-10-13 17:01:59</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=85314">Duelist</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2014-09-22</span></dd> <dd><span>Posts: 358</span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>aw wrote:</cite><blockquote><div><p> We don&#039;t have the source, so we can only guess what might be wrong.</p></div></blockquote></div><p>Even worse.</p><div class="quotebox"><blockquote><div><p>/* _NVRM_COPYRIGHT_BEGIN_<br /> *<br /> 1.sh topic_100.html topic_101.html topic_102.html topic_103.html topic_104.html topic_105.html topic_106.html topic_107.html topic_108.html topic_109.html topic_10.html topic_110.html topic_111.html topic_112.html topic_113.html topic_114.html topic_115.html topic_116.html topic_117.html topic_11.html topic_12.html topic_13.html topic_14.html topic_15.html topic_16.html topic_17.html topic_18.html topic_19.html topic_1.html topic_20.html topic_21.html topic_22.html topic_23.html topic_24.html topic_25.html topic_26.html topic_27.html topic_28.html topic_29.html topic_2.html topic_30.html topic_31.html topic_32.html topic_33.html topic_34.html topic_35.html topic_36.html topic_37.html topic_38.html topic_39.html topic_3.html topic_40.html topic_41.html topic_42.html topic_43.html topic_44.html topic_45.html topic_46.html topic_47.html topic_48.html topic_49.html topic_4.html topic_50.html topic_51.html topic_52.html topic_53.html topic_54.html topic_55.html topic_56.html topic_57.html topic_58.html topic_59.html topic_5.html topic_60.html topic_61.html topic_62.html topic_63.html topic_64.html topic_65.html topic_66.html topic_67.html topic_68.html topic_69.html topic_6.html topic_70.html topic_71.html topic_72.html topic_73.html topic_74.html topic_75.html topic_76.html topic_77.html topic_78.html topic_79.html topic_7.html topic_80.html topic_81.html topic_82.html topic_83.html topic_84.html topic_85.html topic_86.html topic_87.html topic_88.html topic_89.html topic_8.html topic_90.html topic_91.html topic_92.html topic_93.html topic_94.html topic_95.html topic_96.html topic_97.html topic_98.html topic_99.html topic_9.html Copyright 2011 by NVIDIA Corporation.&#160; All rights reserved.&#160; All<br /> 1.sh topic_100.html topic_101.html topic_102.html topic_103.html topic_104.html topic_105.html topic_106.html topic_107.html topic_108.html topic_109.html topic_10.html topic_110.html topic_111.html topic_112.html topic_113.html topic_114.html topic_115.html topic_116.html topic_117.html topic_11.html topic_12.html topic_13.html topic_14.html topic_15.html topic_16.html topic_17.html topic_18.html topic_19.html topic_1.html topic_20.html topic_21.html topic_22.html topic_23.html topic_24.html topic_25.html topic_26.html topic_27.html topic_28.html topic_29.html topic_2.html topic_30.html topic_31.html topic_32.html topic_33.html topic_34.html topic_35.html topic_36.html topic_37.html topic_38.html topic_39.html topic_3.html topic_40.html topic_41.html topic_42.html topic_43.html topic_44.html topic_45.html topic_46.html topic_47.html topic_48.html topic_49.html topic_4.html topic_50.html topic_51.html topic_52.html topic_53.html topic_54.html topic_55.html topic_56.html topic_57.html topic_58.html topic_59.html topic_5.html topic_60.html topic_61.html topic_62.html topic_63.html topic_64.html topic_65.html topic_66.html topic_67.html topic_68.html topic_69.html topic_6.html topic_70.html topic_71.html topic_72.html topic_73.html topic_74.html topic_75.html topic_76.html topic_77.html topic_78.html topic_79.html topic_7.html topic_80.html topic_81.html topic_82.html topic_83.html topic_84.html topic_85.html topic_86.html topic_87.html topic_88.html topic_89.html topic_8.html topic_90.html topic_91.html topic_92.html topic_93.html topic_94.html topic_95.html topic_96.html topic_97.html topic_98.html topic_99.html topic_9.html information contained herein is proprietary and confidential to NVIDIA<br /> 1.sh topic_100.html topic_101.html topic_102.html topic_103.html topic_104.html topic_105.html topic_106.html topic_107.html topic_108.html topic_109.html topic_10.html topic_110.html topic_111.html topic_112.html topic_113.html topic_114.html topic_115.html topic_116.html topic_117.html topic_11.html topic_12.html topic_13.html topic_14.html topic_15.html topic_16.html topic_17.html topic_18.html topic_19.html topic_1.html topic_20.html topic_21.html topic_22.html topic_23.html topic_24.html topic_25.html topic_26.html topic_27.html topic_28.html topic_29.html topic_2.html topic_30.html topic_31.html topic_32.html topic_33.html topic_34.html topic_35.html topic_36.html topic_37.html topic_38.html topic_39.html topic_3.html topic_40.html topic_41.html topic_42.html topic_43.html topic_44.html topic_45.html topic_46.html topic_47.html topic_48.html topic_49.html topic_4.html topic_50.html topic_51.html topic_52.html topic_53.html topic_54.html topic_55.html topic_56.html topic_57.html topic_58.html topic_59.html topic_5.html topic_60.html topic_61.html topic_62.html topic_63.html topic_64.html topic_65.html topic_66.html topic_67.html topic_68.html topic_69.html topic_6.html topic_70.html topic_71.html topic_72.html topic_73.html topic_74.html topic_75.html topic_76.html topic_77.html topic_78.html topic_79.html topic_7.html topic_80.html topic_81.html topic_82.html topic_83.html topic_84.html topic_85.html topic_86.html topic_87.html topic_88.html topic_89.html topic_8.html topic_90.html topic_91.html topic_92.html topic_93.html topic_94.html topic_95.html topic_96.html topic_97.html topic_98.html topic_99.html topic_9.html Corporation.&#160; Any use, reproduction, or disclosure without the written<br /> 1.sh topic_100.html topic_101.html topic_102.html topic_103.html topic_104.html topic_105.html topic_106.html topic_107.html topic_108.html topic_109.html topic_10.html topic_110.html topic_111.html topic_112.html topic_113.html topic_114.html topic_115.html topic_116.html topic_117.html topic_11.html topic_12.html topic_13.html topic_14.html topic_15.html topic_16.html topic_17.html topic_18.html topic_19.html topic_1.html topic_20.html topic_21.html topic_22.html topic_23.html topic_24.html topic_25.html topic_26.html topic_27.html topic_28.html topic_29.html topic_2.html topic_30.html topic_31.html topic_32.html topic_33.html topic_34.html topic_35.html topic_36.html topic_37.html topic_38.html topic_39.html topic_3.html topic_40.html topic_41.html topic_42.html topic_43.html topic_44.html topic_45.html topic_46.html topic_47.html topic_48.html topic_49.html topic_4.html topic_50.html topic_51.html topic_52.html topic_53.html topic_54.html topic_55.html topic_56.html topic_57.html topic_58.html topic_59.html topic_5.html topic_60.html topic_61.html topic_62.html topic_63.html topic_64.html topic_65.html topic_66.html topic_67.html topic_68.html topic_69.html topic_6.html topic_70.html topic_71.html topic_72.html topic_73.html topic_74.html topic_75.html topic_76.html topic_77.html topic_78.html topic_79.html topic_7.html topic_80.html topic_81.html topic_82.html topic_83.html topic_84.html topic_85.html topic_86.html topic_87.html topic_88.html topic_89.html topic_8.html topic_90.html topic_91.html topic_92.html topic_93.html topic_94.html topic_95.html topic_96.html topic_97.html topic_98.html topic_99.html topic_9.html permission of NVIDIA Corporation is prohibited.<br /> *<br /> 1.sh topic_100.html topic_101.html topic_102.html topic_103.html topic_104.html topic_105.html topic_106.html topic_107.html topic_108.html topic_109.html topic_10.html topic_110.html topic_111.html topic_112.html topic_113.html topic_114.html topic_115.html topic_116.html topic_117.html topic_11.html topic_12.html topic_13.html topic_14.html topic_15.html topic_16.html topic_17.html topic_18.html topic_19.html topic_1.html topic_20.html topic_21.html topic_22.html topic_23.html topic_24.html topic_25.html topic_26.html topic_27.html topic_28.html topic_29.html topic_2.html topic_30.html topic_31.html topic_32.html topic_33.html topic_34.html topic_35.html topic_36.html topic_37.html topic_38.html topic_39.html topic_3.html topic_40.html topic_41.html topic_42.html topic_43.html topic_44.html topic_45.html topic_46.html topic_47.html topic_48.html topic_49.html topic_4.html topic_50.html topic_51.html topic_52.html topic_53.html topic_54.html topic_55.html topic_56.html topic_57.html topic_58.html topic_59.html topic_5.html topic_60.html topic_61.html topic_62.html topic_63.html topic_64.html topic_65.html topic_66.html topic_67.html topic_68.html topic_69.html topic_6.html topic_70.html topic_71.html topic_72.html topic_73.html topic_74.html topic_75.html topic_76.html topic_77.html topic_78.html topic_79.html topic_7.html topic_80.html topic_81.html topic_82.html topic_83.html topic_84.html topic_85.html topic_86.html topic_87.html topic_88.html topic_89.html topic_8.html topic_90.html topic_91.html topic_92.html topic_93.html topic_94.html topic_95.html topic_96.html topic_97.html topic_98.html topic_99.html topic_9.html _NVRM_COPYRIGHT_END_<br /> */</p></div></blockquote></div><p>Even if we had - there would be legal issues. Because any use is prohibited. And asking nvidia something like &quot;we want to get our KVM vga passthrough working&quot; would be obviously pointless because... you know why.</p> </div> <div class="postsignature postmsg"><hr /><p><span class="bbs">The forum rules prohibit requesting support for distributions other than arch.</span><br /><a href="https://bbs.archlinux.org/viewtopic.php?pid=1551460#p1551460" rel="nofollow">I gave up.</a><a href="https://bbs.archlinux.org/viewtopic.php?id=162768" rel="nofollow"> It was too late.</a><br /><a href="http://pastebin.com/B3fL84bq" rel="nofollow">What I was trying to do</a>.<br /><a href="http://vfio.blogspot.com/" rel="nofollow">The reference about VFIO and KVM VGA passthrough.</a></p></div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1465531">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1465584" class="blockpost rowodd"> <h2><span><span class="conr">#2950</span> <a href="viewtopic.php?pid=1465584#p1465584">2014-10-13 19:45:48</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=69685">Chetyre</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2013-03-27</span></dd> <dd><span>Posts: 34</span></dd> <dd class="usercontacts"><span class="email"><a href="misc.php?email=69685">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <p>Upgraded my kernel to 3.17, but I lost my host graphics.</p><p>Actually that happened to in 3.16, but I never mentioned it because I was thinking of messing with ovmf (which failed)</p><p>I need the VGA arbiter patch. With it on I can&#039;t see anything on host, with it off I get garbled graphics as expected. Back in 3.15 everything just worked. What could be wrong?</p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1465584">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div class="postlinksb"> <div class="inbox crumbsplus"> <div class="pagepost"> <p class="pagelink conl"><span class="pages-label">Pages: </span><a rel="prev" class="item1" href="viewtopic.php?id=162768&amp;p=117">Previous</a> <a href="viewtopic.php?id=162768">1</a> <span class="spacer">…</span> <a href="viewtopic.php?id=162768&amp;p=116">116</a> <a href="viewtopic.php?id=162768&amp;p=117">117</a> <strong>118</strong> <a href="viewtopic.php?id=162768&amp;p=119">119</a> <a href="viewtopic.php?id=162768&amp;p=120">120</a> <span class="spacer">…</span> <a href="viewtopic.php?id=162768&amp;p=234">234</a> <a rel="next" href="viewtopic.php?id=162768&amp;p=119">Next</a></p> <p class="postlink conr">Topic closed</p> </div> <ul class="crumbs"> <li><a href="index.php">Index</a></li> <li><span>»&#160;</span><a href="viewforum.php?id=48">Topics Going Nowhere</a></li> <li><span>»&#160;</span><strong><a href="viewtopic.php?id=162768">KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</a></strong></li> </ul> <p class="subscribelink clearb"><a href="misc.php?action=subscribe&amp;tid=162768">Subscribe to this topic</a></p> <div class="clearer"></div> </div> </div> </div> <div id="brdfooter" class="block"> <h2><span>Board footer</span></h2> <div class="box"> <div id="brdfooternav" class="inbox"> <div class="conl"> <form id="qjump" method="get" action="viewforum.php"> <div><label><span>Jump to<br /></span> <select name="id" onchange="window.location=('viewforum.php?id='+this.options[this.selectedIndex].value)"> <optgroup label="Technical Issues and Assistance"> <option value="23">Newbie Corner</option> <option value="17">Installation</option> <option value="22">Kernel &amp; Hardware</option> <option value="18">Applications &amp; Desktop Environments</option> <option value="31">Laptop Issues</option> <option value="8">Networking, Server, and Protection</option> <option value="32">Multimedia and Games</option> <option value="50">System Administration</option> <option value="35">Other Architectures</option> </optgroup> <optgroup label="Arch-centric"> <option value="24">Announcements, Package &amp; Security Advisories</option> <option value="1">Arch Discussion</option> <option value="13">Forum &amp; Wiki discussion</option> </optgroup> <optgroup label="Pacman Upgrades, Packaging &amp; AUR"> <option value="44">Pacman &amp; Package Upgrade Issues</option> <option value="49">[testing] Repo Forum</option> <option value="4">Creating &amp; Modifying Packages</option> <option value="38">AUR Issues, Discussion &amp; PKGBUILD Requests</option> </optgroup> <optgroup label="Contributions &amp; Discussion"> <option value="20">GNU/Linux Discussion</option> <option value="27">Community Contributions</option> <option value="33">Programming &amp; Scripting</option> <option value="30">Other Languages</option> <option value="47">Artwork and Screenshots</option> <option value="42">Try This</option> </optgroup> <optgroup label="/dev/null"> <option value="29">Off-Topic</option> <option value="48" selected="selected">Topics Going Nowhere</option> <option value="36">Dustbin</option> </optgroup> </select></label> <input type="submit" value=" Go " accesskey="g" /> </div> </form> </div> <div class="conr"> <p id="feedlinks"><span class="atom"><a href="extern.php?action=feed&amp;tid=162768&amp;type=atom">Atom topic feed</a></span></p> <p id="poweredby">Powered by <a href="http://fluxbb.org/">FluxBB</a></p> </div> <div class="clearer"></div> </div> </div> </div> </div> <div class="end-box"></div> </div> </body> </html>
