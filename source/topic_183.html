<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"> <html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en" dir="ltr"> <head> <meta http-equiv="Content-Type" content="text/html; charset=utf-8" /> <title>KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9 (Page 183) / Topics Going Nowhere / Arch Linux Forums</title> <link rel="stylesheet" type="text/css" href="style/ArchLinux.css" /> <link rel="canonical" href="viewtopic.php?id=162768&amp;p=183" title="Page 183" /> <link rel="prev" href="viewtopic.php?id=162768&amp;p=182" title="Page 182" /> <link rel="next" href="viewtopic.php?id=162768&amp;p=184" title="Page 184" /> <link rel="alternate" type="application/atom+xml" href="extern.php?action=feed&amp;tid=162768&amp;type=atom" title="Atom topic feed" /> <link rel="stylesheet" media="screen" href="style/ArchLinux/arch.css?v=3" /> <link rel="stylesheet" media="screen" href="style/ArchLinux/archnavbar.css?v=2" /> <link rel="shortcut icon" href="style/ArchLinux/favicon.ico" /> </head> <body> <div id="archnavbar" class="anb-forum"> <div id="archnavbarlogo"><h1><a href="http://www.archlinux.org/">Arch Linux</a></h1></div> <div id="archnavbarmenu"> <ul id="archnavbarlist"> <li id="anb-home"><a href="http://www.archlinux.org/">Home</a></li><li id="anb-packages"><a href="http://www.archlinux.org/packages/">Packages</a></li><li id="anb-forums" class="anb-selected"><a href="https://bbs.archlinux.org/">Forums</a></li><li id="anb-wiki"><a href="https://wiki.archlinux.org/">Wiki</a></li><li id="anb-bugs"><a href="https://bugs.archlinux.org/">Bugs</a></li><li id="anb-aur"><a href="https://aur.archlinux.org/">AUR</a></li><li id="anb-download"><a href="http://www.archlinux.org/download/">Download</a></li> </ul> </div> </div> <div id="punviewtopic" class="pun"> <div class="top-box"></div> <div class="punwrap"> <div id="brdheader" class="block"> <div class="box"> <div id="brdmenu" class="inbox"> <ul> <li id="navindex" class="isactive"><a href="index.php">Index</a></li> <li id="navuserlist"><a href="userlist.php">User list</a></li> <li id="navsearch"><a href="search.php">Search</a></li> <li id="navprofile"><a href="profile.php?id=80749">Profile</a></li> <li id="navlogout"><a href="login.php?action=out&amp;id=80749&amp;csrf_token=5c20501ec397bb45ef8ee8c84db232c8d8e421c6">Logout</a></li> </ul> </div> <div id="brdwelcome" class="inbox"> <ul class="conl"> <li><span>Logged in as <strong>SXX</strong></span></li> <li><span>Last visit: 2015-08-16 12:20:09</span></li> </ul> <ul class="conr"> <li><span>Topics: <a href="search.php?action=show_replies" title="Find topics you have posted to.">Posted</a> | <a href="search.php?action=show_new" title="Find topics with new posts since your last visit.">New</a> | <a href="search.php?action=show_recent" title="Find topics with recent posts.">Active</a> | <a href="search.php?action=show_unanswered" title="Find topics with no replies.">Unanswered</a></span></li> </ul> <div class="clearer"></div> </div> </div> </div> <div id="brdmain"> <div class="linkst"> <div class="inbox crumbsplus"> <ul class="crumbs"> <li><a href="index.php">Index</a></li> <li><span>»&#160;</span><a href="viewforum.php?id=48">Topics Going Nowhere</a></li> <li><span>»&#160;</span><strong><a href="viewtopic.php?id=162768">KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</a></strong></li> </ul> <div class="pagepost"> <p class="pagelink conl"><span class="pages-label">Pages: </span><a rel="prev" class="item1" href="viewtopic.php?id=162768&amp;p=182">Previous</a> <a href="viewtopic.php?id=162768">1</a> <span class="spacer">…</span> <a href="viewtopic.php?id=162768&amp;p=181">181</a> <a href="viewtopic.php?id=162768&amp;p=182">182</a> <strong>183</strong> <a href="viewtopic.php?id=162768&amp;p=184">184</a> <a href="viewtopic.php?id=162768&amp;p=185">185</a> <span class="spacer">…</span> <a href="viewtopic.php?id=162768&amp;p=234">234</a> <a rel="next" href="viewtopic.php?id=162768&amp;p=184">Next</a></p> <p class="postlink conr">Topic closed</p> </div> <div class="clearer"></div> </div> </div> <div id="p1513484" class="blockpost rowodd blockpost1"> <h2><span><span class="conr">#4551</span> <a href="viewtopic.php?pid=1513484#p1513484">2015-03-23 00:57:54</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=75590">aw</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2013-10-04</span></dd> <dd><span>Posts: 921</span></dd> <dd class="usercontacts"><span class="email"><a href="misc.php?email=75590">Email</a></span> <span class="website"><a href="http://vfio.blogspot.com/" rel="nofollow">Website</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>nbhs wrote:</cite><blockquote><div><div class="quotebox"><cite>aw wrote:</cite><blockquote><div><div class="quotebox"><cite>tritron4 wrote:</cite><blockquote><div><p>I would go with radeon R9 270 or&#160; better. Nvidia will give you error 43.</p></div></blockquote></div><p>The only issue I&#039;m aware of with using nvidia for the host is that the proprietary driver grabs the vga arbiter lock and doesn&#039;t release it.&#160; So you either need to avoid vga or hack nvidia&#039;s wrapper code.</p></div></blockquote></div><p>I think nvidia fixed this since i&#039;m using the stock drivers without issue.</p></div></blockquote></div><p>I use IGD for my host graphics, but I just download the latest driver, NVIDIA-Linux-x86_64-346.47&#160; In there I find:</p><div class="codebox"><pre><code>kernel/nv.c:nvidia_probe() ... #if defined(CONFIG_VGA_ARB) #if defined(VGA_DEFAULT_DEVICE) vga_tryget(VGA_DEFAULT_DEVICE, VGA_RSRC_LEGACY_MASK); #endif vga_set_legacy_decoding(dev, VGA_RSRC_NONE); #endif</code></pre></div><p>There&#039;s no call to vga_put() anywhere.&#160; Still looks broken to me, but maybe this is dead code or there are corner cases.</p> </div> <div class="postsignature postmsg"><hr /><p><a href="http://vfio.blogspot.com" rel="nofollow">http://vfio.blogspot.com</a><br />Looking for a more open forum to discuss vfio related uses?&#160; Try <a href="https://www.redhat.com/mailman/listinfo/vfio-users" rel="nofollow">https://www.redhat.com/mailman/listinfo/vfio-users</a></p></div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1513484">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1513490" class="blockpost roweven"> <h2><span><span class="conr">#4552</span> <a href="viewtopic.php?pid=1513490#p1513490">2015-03-23 01:21:47</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=75590">aw</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2013-10-04</span></dd> <dd><span>Posts: 921</span></dd> <dd class="usercontacts"><span class="email"><a href="misc.php?email=75590">Email</a></span> <span class="website"><a href="http://vfio.blogspot.com/" rel="nofollow">Website</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>aw wrote:</cite><blockquote><div><div class="quotebox"><cite>nbhs wrote:</cite><blockquote><div><p>I think nvidia fixed this since i&#039;m using the stock drivers without issue.</p></div></blockquote></div><p>I use IGD for my host graphics, but I just download the latest driver, NVIDIA-Linux-x86_64-346.47&#160; In there I find:</p><div class="codebox"><pre><code>kernel/nv.c:nvidia_probe() ... #if defined(CONFIG_VGA_ARB) #if defined(VGA_DEFAULT_DEVICE) vga_tryget(VGA_DEFAULT_DEVICE, VGA_RSRC_LEGACY_MASK); #endif vga_set_legacy_decoding(dev, VGA_RSRC_NONE); #endif</code></pre></div><p>There&#039;s no call to vga_put() anywhere.&#160; Still looks broken to me, but maybe this is dead code or there are corner cases.</p></div></blockquote></div><p>Oh, maybe it is fixed.&#160; Calling vga_set_legacy_decoding() clears the locked resources and does an implicit __vga_put().</p><p>EDIT: Embarrassing, it might be me who fixed it <a href="http://git.kernel.org/cgit/linux/kernel/git/torvalds/linux.git/commit/?id=5c0f6ee766d7c689e71a7df5e5fa87941affd75a" rel="nofollow">http://git.kernel.org/cgit/linux/kernel … 941affd75a</a></p> <p class="postedit"><em>Last edited by aw (2015-03-23 01:28:02)</em></p> </div> <div class="postsignature postmsg"><hr /><p><a href="http://vfio.blogspot.com" rel="nofollow">http://vfio.blogspot.com</a><br />Looking for a more open forum to discuss vfio related uses?&#160; Try <a href="https://www.redhat.com/mailman/listinfo/vfio-users" rel="nofollow">https://www.redhat.com/mailman/listinfo/vfio-users</a></p></div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1513490">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1513508" class="blockpost rowodd"> <h2><span><span class="conr">#4553</span> <a href="viewtopic.php?pid=1513508#p1513508">2015-03-23 04:36:24</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=89744">asd651651</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2015-03-23</span></dd> <dd><span>Posts: 2</span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <p>hi, <br />I can pass through GPU successfully but after shutdown the VM and restart the VM, the host system stuck. Does anyone have that problem too?<br />It seems like the problem only occurs when passing through GPU, there is no such problem when passing through the USB controller. </p><p>Here’s my system environment:<br />&#160; &#160; Kernel version: 3.18.8 (patched with linux-mainline)<br />&#160; &#160; GPU: GTX 295<br />&#160; &#160; Qemu: 2.2.0</p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1513508">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1513515" class="blockpost roweven"> <h2><span><span class="conr">#4554</span> <a href="viewtopic.php?pid=1513515#p1513515">2015-03-23 05:04:16</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=88564">hotfunction</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2015-02-05</span></dd> <dd><span>Posts: 10</span></dd> <dd class="usercontacts"><span class="email"><a href="misc.php?email=88564">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <p>Yes, I suffer from the booting problem too...<br />When I use the VFIO GPU passthrough in a VM, shutdown the VM, but I cannot boot the VM unless I restart my host system.<br />Does anyone know this problem?</p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1513515">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1513582" class="blockpost rowodd"> <h2><span><span class="conr">#4555</span> <a href="viewtopic.php?pid=1513582#p1513582">2015-03-23 12:17:05</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=71471">dRaiser</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>From: Poland</span></dd> <dd><span>Registered: 2013-05-20</span></dd> <dd><span>Posts: 49</span></dd> <dd class="usercontacts"><span class="email"><a href="mailto:pw@draiser.net">Email</a></span> <span class="website"><a href="http://draiser.net/en" rel="nofollow">Website</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>aw wrote:</cite><blockquote><div><div class="quotebox"><cite>aw wrote:</cite><blockquote><div><div class="quotebox"><cite>nbhs wrote:</cite><blockquote><div><p>I think nvidia fixed this since i&#039;m using the stock drivers without issue.</p></div></blockquote></div><p>I use IGD for my host graphics, but I just download the latest driver, NVIDIA-Linux-x86_64-346.47&#160; In there I find:</p><div class="codebox"><pre><code>kernel/nv.c:nvidia_probe() ... #if defined(CONFIG_VGA_ARB) #if defined(VGA_DEFAULT_DEVICE) vga_tryget(VGA_DEFAULT_DEVICE, VGA_RSRC_LEGACY_MASK); #endif vga_set_legacy_decoding(dev, VGA_RSRC_NONE); #endif</code></pre></div><p>There&#039;s no call to vga_put() anywhere.&#160; Still looks broken to me, but maybe this is dead code or there are corner cases.</p></div></blockquote></div><p>Oh, maybe it is fixed.&#160; Calling vga_set_legacy_decoding() clears the locked resources and does an implicit __vga_put().</p><p>EDIT: Embarrassing, it might be me who fixed it <a href="http://git.kernel.org/cgit/linux/kernel/git/torvalds/linux.git/commit/?id=5c0f6ee766d7c689e71a7df5e5fa87941affd75a" rel="nofollow">http://git.kernel.org/cgit/linux/kernel … 941affd75a</a></p></div></blockquote></div><p>Perhaps I misunderstood what a problem is, thanks for clarifying.</p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1513582">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1513605" class="blockpost roweven"> <h2><span><span class="conr">#4556</span> <a href="viewtopic.php?pid=1513605#p1513605">2015-03-23 13:51:28</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=87826">The_Moves</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2015-01-06</span></dd> <dd><span>Posts: 58</span></dd> <dd class="usercontacts"><span class="email"><a href="misc.php?email=87826">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>tritron4 wrote:</cite><blockquote><div><p>I would go with radeon R9 270 or&#160; better. Nvidia will give you error 43.</p></div></blockquote></div><p>Look up PCIe &#039;Function Level Reset&#039;</p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1513605">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1513634" class="blockpost rowodd"> <h2><span><span class="conr">#4557</span> <a href="viewtopic.php?pid=1513634#p1513634">2015-03-23 15:37:30</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=85314">Duelist</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2014-09-22</span></dd> <dd><span>Posts: 358</span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <p>To be honest, i&#039;d totally go check that huge google spreadsheet with stats before changing existing or beginning a new setup.</p> </div> <div class="postsignature postmsg"><hr /><p><span class="bbs">The forum rules prohibit requesting support for distributions other than arch.</span><br /><a href="https://bbs.archlinux.org/viewtopic.php?pid=1551460#p1551460" rel="nofollow">I gave up.</a><a href="https://bbs.archlinux.org/viewtopic.php?id=162768" rel="nofollow"> It was too late.</a><br /><a href="http://pastebin.com/B3fL84bq" rel="nofollow">What I was trying to do</a>.<br /><a href="http://vfio.blogspot.com/" rel="nofollow">The reference about VFIO and KVM VGA passthrough.</a></p></div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1513634">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1513636" class="blockpost roweven"> <h2><span><span class="conr">#4558</span> <a href="viewtopic.php?pid=1513636#p1513636">2015-03-23 15:42:26</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=71471">dRaiser</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>From: Poland</span></dd> <dd><span>Registered: 2013-05-20</span></dd> <dd><span>Posts: 49</span></dd> <dd class="usercontacts"><span class="email"><a href="mailto:pw@draiser.net">Email</a></span> <span class="website"><a href="http://draiser.net/en" rel="nofollow">Website</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <p>@Duelist, thank you - haven&#039;t seen that before. Great resource!</p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1513636">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1513638" class="blockpost rowodd"> <h2><span><span class="conr">#4559</span> <a href="viewtopic.php?pid=1513638#p1513638">2015-03-23 15:51:46</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=85314">Duelist</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2014-09-22</span></dd> <dd><span>Posts: 358</span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>dRaiser wrote:</cite><blockquote><div><p>@Duelist, thank you - haven&#039;t seen that before. Great resource!</p></div></blockquote></div><p>While most of the data is okay, some setups may be semi-working(like my entry). If you&#039;re in doubt - you can search that user&#039;s posts in this thread using google site: search.</p> </div> <div class="postsignature postmsg"><hr /><p><span class="bbs">The forum rules prohibit requesting support for distributions other than arch.</span><br /><a href="https://bbs.archlinux.org/viewtopic.php?pid=1551460#p1551460" rel="nofollow">I gave up.</a><a href="https://bbs.archlinux.org/viewtopic.php?id=162768" rel="nofollow"> It was too late.</a><br /><a href="http://pastebin.com/B3fL84bq" rel="nofollow">What I was trying to do</a>.<br /><a href="http://vfio.blogspot.com/" rel="nofollow">The reference about VFIO and KVM VGA passthrough.</a></p></div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1513638">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1513659" class="blockpost roweven"> <h2><span><span class="conr">#4560</span> <a href="viewtopic.php?pid=1513659#p1513659">2015-03-23 18:14:01</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=85314">Duelist</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2014-09-22</span></dd> <dd><span>Posts: 358</span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <p>A short tale about SELinux and VM audio:<br />QEMU is run as root(which is bad, but i&#039;m too lazy to figure out all the permissions..i should really do this one day), i turned on qemu&#039;s VNC audio extension, and SELinux prevents that run-as-root process to access user&#039;s pulseaudio. Which is cool.<br />Setting SELinux mode to permissive(which is bad too) doesn&#039;t help too, as root isn&#039;t allowed to access user&#039;s pulse by something else.<br />Since i don&#039;t understand either SELinux or PulseAudio(when i set up my gentoo system, i didn&#039;t use SELinux and pulse audio simply didn&#039;t exist), it&#039;s easier for me to plug a dedicated sound device into my machine and passthrough it.</p><p>BUT!<br />There are GPU HDMI Audio devices! Does anybody know how do i fetch audio from them?<br />Do i really-really-really need to use some TV screen with HDMI Audio capability(since it&#039;s digital)? Or, maybe, there&#039;s some way of transferring audio through DVI, but my monitor doesn&#039;t support that?<br />Maybe there&#039;s some weird device which gets only HDMI&#039;s audio signal(like video capture device, only for audio) and feeds it into speakers/SPDIF/line in of the sound card?<br />Also, i remember some older GPUs had SPDIF out on them for that purpose, and you could plug it anywhere you need, including your motherboard. Do those still exist, or &quot;if there&#039;s HDMI, then there&#039;s no SPDIF&quot;?</p> <p class="postedit"><em>Last edited by Duelist (2015-03-23 18:14:19)</em></p> </div> <div class="postsignature postmsg"><hr /><p><span class="bbs">The forum rules prohibit requesting support for distributions other than arch.</span><br /><a href="https://bbs.archlinux.org/viewtopic.php?pid=1551460#p1551460" rel="nofollow">I gave up.</a><a href="https://bbs.archlinux.org/viewtopic.php?id=162768" rel="nofollow"> It was too late.</a><br /><a href="http://pastebin.com/B3fL84bq" rel="nofollow">What I was trying to do</a>.<br /><a href="http://vfio.blogspot.com/" rel="nofollow">The reference about VFIO and KVM VGA passthrough.</a></p></div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1513659">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1513661" class="blockpost rowodd"> <h2><span><span class="conr">#4561</span> <a href="viewtopic.php?pid=1513661#p1513661">2015-03-23 18:38:45</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=71471">dRaiser</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>From: Poland</span></dd> <dd><span>Registered: 2013-05-20</span></dd> <dd><span>Posts: 49</span></dd> <dd class="usercontacts"><span class="email"><a href="mailto:pw@draiser.net">Email</a></span> <span class="website"><a href="http://draiser.net/en" rel="nofollow">Website</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>Duelist wrote:</cite><blockquote><div><div class="quotebox"><cite>dRaiser wrote:</cite><blockquote><div><p>@Duelist, thank you - haven&#039;t seen that before. Great resource!</p></div></blockquote></div><p>While most of the data is okay, some setups may be semi-working(like my entry). If you&#039;re in doubt - you can search that user&#039;s posts in this thread using google site: search.</p></div></blockquote></div><p>Well, I&#039;m familiar with Google site search, thank you. <img src="https://bbs.archlinux.org/img/smilies/wink.png" width="15" height="15" alt="wink" /></p><p>I&#039;ve added my setup too. It&#039;s working very nicely, only it&#039;s a little outdated since Radeon 4850 is mostly good only for Blizzard games nowadays.</p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1513661">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1513662" class="blockpost roweven"> <h2><span><span class="conr">#4562</span> <a href="viewtopic.php?pid=1513662#p1513662">2015-03-23 18:46:11</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=75590">aw</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2013-10-04</span></dd> <dd><span>Posts: 921</span></dd> <dd class="usercontacts"><span class="email"><a href="misc.php?email=75590">Email</a></span> <span class="website"><a href="http://vfio.blogspot.com/" rel="nofollow">Website</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>Duelist wrote:</cite><blockquote><div><p>BUT!<br />There are GPU HDMI Audio devices! Does anybody know how do i fetch audio from them?<br />Do i really-really-really need to use some TV screen with HDMI Audio capability(since it&#039;s digital)? Or, maybe, there&#039;s some way of transferring audio through DVI, but my monitor doesn&#039;t support that?<br />Maybe there&#039;s some weird device which gets only HDMI&#039;s audio signal(like video capture device, only for audio) and feeds it into speakers/SPDIF/line in of the sound card?<br />Also, i remember some older GPUs had SPDIF out on them for that purpose, and you could plug it anywhere you need, including your motherboard. Do those still exist, or &quot;if there&#039;s HDMI, then there&#039;s no SPDIF&quot;?</p></div></blockquote></div><p>Using a &quot;TV&quot; is the easiest way to get audio out of HDMI.&#160; If you&#039;re using nvidia, be sure to check my blog post about using MSI interrupts.&#160; Nvidia audio works way better with MSI interrupts.&#160; You can also do audio over DVI.&#160; My HD8570 only has DP and DVI connections, my DP-&gt;HDMI adapter broke so I temporarily used a DVI-&gt;HDMI adapter and was quite surprised when I still had audio.&#160; There are splitters and some (most?) receivers with HDMI input will allow you to channel the audio somewhere other than the TV.&#160; HDCP copy protection comes into play when you start splitting the output, but that&#039;s only an issue if you&#039;re wanting to send protected content out to the screen.</p> </div> <div class="postsignature postmsg"><hr /><p><a href="http://vfio.blogspot.com" rel="nofollow">http://vfio.blogspot.com</a><br />Looking for a more open forum to discuss vfio related uses?&#160; Try <a href="https://www.redhat.com/mailman/listinfo/vfio-users" rel="nofollow">https://www.redhat.com/mailman/listinfo/vfio-users</a></p></div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1513662">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1513685" class="blockpost rowodd"> <h2><span><span class="conr">#4563</span> <a href="viewtopic.php?pid=1513685#p1513685">2015-03-23 20:26:06</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=59241">tritron4</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2012-04-14</span></dd> <dd><span>Posts: 146</span></dd> <dd class="usercontacts"><span class="email"><a href="misc.php?email=59241">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <p>I have no issues with my R9 270 I have A88X-pro asus motherboard and options vfio_iommu_type1 disable_hugepages=1 It works great. I can shutdown and restart guest without any issues.<br />Windows allows to select audio output over hdmi this will work with tv or lcd monitor with speakers. I guess you can use converter to extract audio out of hdmi. Other option is to use usb sound card.</p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1513685">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1513690" class="blockpost roweven"> <h2><span><span class="conr">#4564</span> <a href="viewtopic.php?pid=1513690#p1513690">2015-03-23 20:37:49</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=85314">Duelist</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2014-09-22</span></dd> <dd><span>Posts: 358</span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>tritron4 wrote:</cite><blockquote><div><p>lcd monitor with speakers.</p></div></blockquote></div><p>Some screens do not support audio over DVI, but have speakers. Usually, they have 3.5mm line in on their back.<br />---</p><p>Alright, i&#039;ve got a problem..</p><div class="codebox"><pre><code>Error starting domain: internal error: early end of file from monitor: possible problem: 2015-03-23T20:34:22.276172Z qemu-system-x86_64: -device vfio-pci,host=03:05.0,id=hostdev4,bus=pci.0,addr=0xd: vfio: failed to set iommu for container: Device or resource busy 2015-03-23T20:34:22.276310Z qemu-system-x86_64: -device vfio-pci,host=03:05.0,id=hostdev4,bus=pci.0,addr=0xd: vfio: failed to setup container for group 7 2015-03-23T20:34:22.276368Z qemu-system-x86_64: -device vfio-pci,host=03:05.0,id=hostdev4,bus=pci.0,addr=0xd: vfio: failed to get group 7 2015-03-23T20:34:22.276432Z qemu-system-x86_64: -device vfio-pci,host=03:05.0,id=hostdev4,bus=pci.0,addr=0xd: Device initialization failed. 2015-03-23T20:34:22.276499Z qemu-system-x86_64: -device vfio-pci,host=03:05.0,id=hostdev4,bus=pci.0,addr=0xd: Device &#039;vfio-pci&#039; could not be initialized Traceback (most recent call last): File &quot;/usr/share/virt-manager/virtManager/asyncjob.py&quot;, line 89, in cb_wrapper callback(asyncjob, *args, **kwargs) File &quot;/usr/share/virt-manager/virtManager/asyncjob.py&quot;, line 125, in tmpcb callback(*args, **kwargs) File &quot;/usr/share/virt-manager/virtManager/domain.py&quot;, line 1388, in startup self._backend.create() File &quot;/usr/lib64/python2.7/site-packages/libvirt.py&quot;, line 999, in create if ret == -1: raise libvirtError (&#039;virDomainCreate() failed&#039;, dom=self) libvirtError: internal error: early end of file from monitor: possible problem: 2015-03-23T20:34:22.276172Z qemu-system-x86_64: -device vfio-pci,host=03:05.0,id=hostdev4,bus=pci.0,addr=0xd: vfio: failed to set iommu for container: Device or resource busy 2015-03-23T20:34:22.276310Z qemu-system-x86_64: -device vfio-pci,host=03:05.0,id=hostdev4,bus=pci.0,addr=0xd: vfio: failed to setup container for group 7 2015-03-23T20:34:22.276368Z qemu-system-x86_64: -device vfio-pci,host=03:05.0,id=hostdev4,bus=pci.0,addr=0xd: vfio: failed to get group 7 2015-03-23T20:34:22.276432Z qemu-system-x86_64: -device vfio-pci,host=03:05.0,id=hostdev4,bus=pci.0,addr=0xd: Device initialization failed. 2015-03-23T20:34:22.276499Z qemu-system-x86_64: -device vfio-pci,host=03:05.0,id=hostdev4,bus=pci.0,addr=0xd: Device &#039;vfio-pci&#039; could not be initialized</code></pre></div><p>Device or resource busy. But..</p><div class="codebox"><pre><code>03:05.0 Multimedia audio controller: Device 1234:1880 (rev 02) Subsystem: Device 1234:2000 Flags: fast devsel, IRQ 1 I/O ports at &lt;ignored&gt; [disabled] Kernel driver in use: vfio-pci</code></pre></div><div class="codebox"><pre><code>cgroup_device_acl = [ &quot;/dev/null&quot;, &quot;/dev/full&quot;, &quot;/dev/zero&quot;, &quot;/dev/random&quot;, &quot;/dev/urandom&quot;, &quot;/dev/ptmx&quot;, &quot;/dev/kvm&quot;, &quot;/dev/kqemu&quot;, &quot;/dev/rtc&quot;,&quot;/dev/hpet&quot;, &quot;/dev/vfio/vfio&quot;, &quot;/dev/vfio/1&quot;, &quot;/dev/vfio/2&quot;, &quot;/dev/vfio/7&quot; ]</code></pre></div><p>And nothing in dmesg.</p><p>I bet this is something obvious, but i just can&#039;t see it. Any hints where to look?</p> </div> <div class="postsignature postmsg"><hr /><p><span class="bbs">The forum rules prohibit requesting support for distributions other than arch.</span><br /><a href="https://bbs.archlinux.org/viewtopic.php?pid=1551460#p1551460" rel="nofollow">I gave up.</a><a href="https://bbs.archlinux.org/viewtopic.php?id=162768" rel="nofollow"> It was too late.</a><br /><a href="http://pastebin.com/B3fL84bq" rel="nofollow">What I was trying to do</a>.<br /><a href="http://vfio.blogspot.com/" rel="nofollow">The reference about VFIO and KVM VGA passthrough.</a></p></div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1513690">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1513692" class="blockpost rowodd"> <h2><span><span class="conr">#4565</span> <a href="viewtopic.php?pid=1513692#p1513692">2015-03-23 20:41:48</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=59241">tritron4</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2012-04-14</span></dd> <dd><span>Posts: 146</span></dd> <dd class="usercontacts"><span class="email"><a href="misc.php?email=59241">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <p>Did you load modules ? I had seen this error when pci-stub was not loaded at boot. </p><div class="quotebox"><cite>Duelist wrote:</cite><blockquote><div><div class="quotebox"><cite>tritron4 wrote:</cite><blockquote><div><p>lcd monitor with speakers.</p></div></blockquote></div><p>Some screens do not support audio over DVI, but have speakers. Usually, they have 3.5mm line in on their back.<br />---</p><p>Alright, i&#039;ve got a problem..</p><div class="codebox"><pre><code>Error starting domain: internal error: early end of file from monitor: possible problem: 2015-03-23T20:34:22.276172Z qemu-system-x86_64: -device vfio-pci,host=03:05.0,id=hostdev4,bus=pci.0,addr=0xd: vfio: failed to set iommu for container: Device or resource busy 2015-03-23T20:34:22.276310Z qemu-system-x86_64: -device vfio-pci,host=03:05.0,id=hostdev4,bus=pci.0,addr=0xd: vfio: failed to setup container for group 7 2015-03-23T20:34:22.276368Z qemu-system-x86_64: -device vfio-pci,host=03:05.0,id=hostdev4,bus=pci.0,addr=0xd: vfio: failed to get group 7 2015-03-23T20:34:22.276432Z qemu-system-x86_64: -device vfio-pci,host=03:05.0,id=hostdev4,bus=pci.0,addr=0xd: Device initialization failed. 2015-03-23T20:34:22.276499Z qemu-system-x86_64: -device vfio-pci,host=03:05.0,id=hostdev4,bus=pci.0,addr=0xd: Device &#039;vfio-pci&#039; could not be initialized Traceback (most recent call last): File &quot;/usr/share/virt-manager/virtManager/asyncjob.py&quot;, line 89, in cb_wrapper callback(asyncjob, *args, **kwargs) File &quot;/usr/share/virt-manager/virtManager/asyncjob.py&quot;, line 125, in tmpcb callback(*args, **kwargs) File &quot;/usr/share/virt-manager/virtManager/domain.py&quot;, line 1388, in startup self._backend.create() File &quot;/usr/lib64/python2.7/site-packages/libvirt.py&quot;, line 999, in create if ret == -1: raise libvirtError (&#039;virDomainCreate() failed&#039;, dom=self) libvirtError: internal error: early end of file from monitor: possible problem: 2015-03-23T20:34:22.276172Z qemu-system-x86_64: -device vfio-pci,host=03:05.0,id=hostdev4,bus=pci.0,addr=0xd: vfio: failed to set iommu for container: Device or resource busy 2015-03-23T20:34:22.276310Z qemu-system-x86_64: -device vfio-pci,host=03:05.0,id=hostdev4,bus=pci.0,addr=0xd: vfio: failed to setup container for group 7 2015-03-23T20:34:22.276368Z qemu-system-x86_64: -device vfio-pci,host=03:05.0,id=hostdev4,bus=pci.0,addr=0xd: vfio: failed to get group 7 2015-03-23T20:34:22.276432Z qemu-system-x86_64: -device vfio-pci,host=03:05.0,id=hostdev4,bus=pci.0,addr=0xd: Device initialization failed. 2015-03-23T20:34:22.276499Z qemu-system-x86_64: -device vfio-pci,host=03:05.0,id=hostdev4,bus=pci.0,addr=0xd: Device &#039;vfio-pci&#039; could not be initialized</code></pre></div><p>Device or resource busy. But..</p><div class="codebox"><pre><code>03:05.0 Multimedia audio controller: Device 1234:1880 (rev 02) Subsystem: Device 1234:2000 Flags: fast devsel, IRQ 1 I/O ports at &lt;ignored&gt; [disabled] Kernel driver in use: vfio-pci</code></pre></div><div class="codebox"><pre><code>cgroup_device_acl = [ &quot;/dev/null&quot;, &quot;/dev/full&quot;, &quot;/dev/zero&quot;, &quot;/dev/random&quot;, &quot;/dev/urandom&quot;, &quot;/dev/ptmx&quot;, &quot;/dev/kvm&quot;, &quot;/dev/kqemu&quot;, &quot;/dev/rtc&quot;,&quot;/dev/hpet&quot;, &quot;/dev/vfio/vfio&quot;, &quot;/dev/vfio/1&quot;, &quot;/dev/vfio/2&quot;, &quot;/dev/vfio/7&quot; ]</code></pre></div><p>And nothing in dmesg.</p><p>I bet this is something obvious, but i just can&#039;t see it. Any hints where to look?</p></div></blockquote></div> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1513692">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1513693" class="blockpost roweven"> <h2><span><span class="conr">#4566</span> <a href="viewtopic.php?pid=1513693#p1513693">2015-03-23 20:45:08</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=87826">The_Moves</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2015-01-06</span></dd> <dd><span>Posts: 58</span></dd> <dd class="usercontacts"><span class="email"><a href="misc.php?email=87826">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <p>Are you trying to pass through your onboard audio? When I tried doing this, my previous system with either hang or do this. I don&#039;t see any of the below in your recent previous posts:</p><p>cat /proc/cmdline<br />cat /etc/default/grub<br />lspci -nn</p><p>Might have this wrong as I don&#039;t have access to my comp at the moment.</p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1513693">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1513700" class="blockpost rowodd"> <h2><span><span class="conr">#4567</span> <a href="viewtopic.php?pid=1513700#p1513700">2015-03-23 21:00:04</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=85314">Duelist</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2014-09-22</span></dd> <dd><span>Posts: 358</span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <p>That is a dedicated audio device. pci-stub shouldn&#039;t be needed, but i&#039;ll try adding it anyways.<br />Before VFIO-PCI driver bound the device, it wasn&#039;t bound to anything.<br />UPD:</p><div class="codebox"><pre><code>BOOT_IMAGE=/vmlinuz-3.19.1-201.fc21.x86_64 root=UUID=86383473-85bd-44d7-9d15-0f15ec76da28 ro vconsole.font=latarcyrheb-sun16 nofb pci-stub.ids=1234:1880,1002:683f,1002:aab0,1002:683f,1002:683f enable_mtrr_cleanup iommu=pt acpi_enforce_resources=lax</code></pre></div><p>Alright, as i thought, adding pci stub doesn&#039;t help at all.<br />IOMMU groups look same way as they look for devices 01:00.0 and 02:00.0 which work fine.<br />I wonder why there&#039;s some disabled IO range indicated..</p><p>Anyway, it&#039;s just a simple, dumb pci device! Why wouldn&#039;t it passthrough..</p><div class="codebox"><pre><code>03:05.0 Multimedia audio controller [0401]: Device [1234:1880] (rev 02) Subsystem: Device [1234:2000] Control: I/O- Mem- BusMaster- SpecCycle- MemWINV- VGASnoop- ParErr- Stepping- SERR- FastB2B- DisINTx- Status: Cap- 66MHz- UDF- FastB2B- ParErr- DEVSEL=fast &gt;TAbort- &lt;TAbort- &lt;MAbort- &gt;SERR- &lt;PERR- INTx- Interrupt: pin A routed to IRQ 1 Region 0: I/O ports at &lt;ignored&gt; [disabled] Kernel driver in use: vfio-pci</code></pre></div><p>If i recall correctly, it&#039;s Sound Blaster 16 PCI with rebadged ensoniq chip, made by creative. It&#039;s so old, that stock fedora kernel doesn&#039;t have drivers for it, however, it seemed to be AC&#039;97-compliant.</p><div class="codebox"><pre><code>00:14.4 PCI bridge: Advanced Micro Devices, Inc. [AMD] FCH PCI Bridge (rev 40) (prog-if 01 [Subtractive decode]) Control: I/O+ Mem+ BusMaster+ SpecCycle- MemWINV- VGASnoop+ ParErr- Stepping- SERR- FastB2B- DisINTx- Status: Cap- 66MHz+ UDF- FastB2B+ ParErr- DEVSEL=medium &gt;TAbort- &lt;TAbort- &lt;MAbort- &gt;SERR- &lt;PERR- INTx- Latency: 64 Bus: primary=00, secondary=03, subordinate=03, sec-latency=64 I/O behind bridge: 0000f000-00000fff Memory behind bridge: fff00000-000fffff Prefetchable memory behind bridge: fff00000-000fffff Secondary status: 66MHz- FastB2B+ ParErr- DEVSEL=medium &gt;TAbort- &lt;TAbort- &lt;MAbort+ &lt;SERR- &lt;PERR+ BridgeCtl: Parity- SERR- NoISA- VGA- MAbort- &gt;Reset- FastB2B- PriDiscTmr- SecDiscTmr- DiscTmrStat- DiscTmrSERREn-</code></pre></div><p>Upstream PCI bridge seems fine to me too.</p> <p class="postedit"><em>Last edited by Duelist (2015-03-23 22:19:38)</em></p> </div> <div class="postsignature postmsg"><hr /><p><span class="bbs">The forum rules prohibit requesting support for distributions other than arch.</span><br /><a href="https://bbs.archlinux.org/viewtopic.php?pid=1551460#p1551460" rel="nofollow">I gave up.</a><a href="https://bbs.archlinux.org/viewtopic.php?id=162768" rel="nofollow"> It was too late.</a><br /><a href="http://pastebin.com/B3fL84bq" rel="nofollow">What I was trying to do</a>.<br /><a href="http://vfio.blogspot.com/" rel="nofollow">The reference about VFIO and KVM VGA passthrough.</a></p></div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1513700">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1513750" class="blockpost roweven"> <h2><span><span class="conr">#4568</span> <a href="viewtopic.php?pid=1513750#p1513750">2015-03-24 02:31:44</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=59241">tritron4</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2012-04-14</span></dd> <dd><span>Posts: 146</span></dd> <dd class="usercontacts"><span class="email"><a href="misc.php?email=59241">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <p>Read this <a href="https://lkml.org/lkml/2013/6/28/647" rel="nofollow">https://lkml.org/lkml/2013/6/28/647</a></p><p>Did you try this ? options vfio_iommu_type1 disable_hugepages=1</p><p><a href="http://spica-and-roid.blogspot.com.au/2012/07/howto-kvm-passthrough.html" rel="nofollow">http://spica-and-roid.blogspot.com.au/2 … rough.html</a><br />7. Necessary permission modifications [3]<br />According to my experience, you might encounter an error saying:<br />Device &#039;pci-assign&#039; could not be initialized.</p><p>Before you try any solution, first make sure that modules such as kvm, kvm_intel, pci_stub are loaded. Also make sure that intel_iommu=on is in your grub configuration file (even if you see IOMMU from dmesg, it doesn&#039;t ensure that INTEL_IOMMU is enabled).</p><p>The command that fixed it was:<br /># echo 1 &gt; /sys/module/kvm/parameters/allow_unsafe_assigned_interrupts</p> <p class="postedit"><em>Last edited by tritron4 (2015-03-24 02:42:27)</em></p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1513750">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1513793" class="blockpost rowodd"> <h2><span><span class="conr">#4569</span> <a href="viewtopic.php?pid=1513793#p1513793">2015-03-24 09:21:34</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=85314">Duelist</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2014-09-22</span></dd> <dd><span>Posts: 358</span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>tritron4 wrote:</cite><blockquote><div><p>Read this <a href="https://lkml.org/lkml/2013/6/28/647" rel="nofollow">https://lkml.org/lkml/2013/6/28/647</a></p><p>Did you try this ? options vfio_iommu_type1 disable_hugepages=1</p><p><a href="http://spica-and-roid.blogspot.com.au/2012/07/howto-kvm-passthrough.html" rel="nofollow">http://spica-and-roid.blogspot.com.au/2 … rough.html</a><br />7. Necessary permission modifications [3]<br />According to my experience, you might encounter an error saying:<br />Device &#039;pci-assign&#039; could not be initialized.</p><p>Before you try any solution, first make sure that modules such as kvm, kvm_intel, pci_stub are loaded. Also make sure that intel_iommu=on is in your grub configuration file (even if you see IOMMU from dmesg, it doesn&#039;t ensure that INTEL_IOMMU is enabled).</p><p>The command that fixed it was:<br /># echo 1 &gt; /sys/module/kvm/parameters/allow_unsafe_assigned_interrupts</p></div></blockquote></div><p>I appreciate your help, but...<br />IOMMU is 100% online, since devices 01:00.0 and 02:00.0 are getting passed-through fine.<br />Hugepages aren&#039;t used<span class="bbs">(but i might try forcefully disabling them).</span> and were disabled a long time ago.<br />QEMU is run as root, clear_emulator_capabilities are set to zero. ACS is working fine, the device is isolated in it&#039;s IOMMU group, and since this is an AMD system - there shouldn&#039;t be any problems with ACS.<br />But the idea of rebinding the device is interesting, i might give it a try.</p><p>Rebinding a device gives weird issues:</p><div class="codebox"><pre><code>[ 821.585416] pci 0000:00:14.4: PCI bridge to [bus 03] [ 821.585427] pci 0000:00:14.4: bridge window [io 0x1000-0x1fff] [ 821.594894] pci 0000:00:14.4: PCI bridge to [bus 03] [ 821.594903] pci 0000:00:14.4: bridge window [io 0x1000-0x1fff] [ 821.598754] pci 0000:00:14.4: PCI bridge to [bus 03] [ 821.598762] pci 0000:00:14.4: bridge window [io 0x1000-0x1fff] [ 821.602439] pci 0000:00:14.4: PCI bridge to [bus 03] [ 821.602446] pci 0000:00:14.4: bridge window [io 0x1000-0x1fff] [ 821.604906] pci 0000:00:14.4: PCI bridge to [bus 03] [ 821.604914] pci 0000:00:14.4: bridge window [io 0x1000-0x1fff]</code></pre></div><p>I&#039;m fine with that message, but it&#039;s repeated five times. Something is quite not right here.</p><p>UPD:</p><div class="codebox"><pre><code>[ 71.303135] vfio_ecap_init: 0000:01:00.0 hiding ecap 0x19@0x270 [ 71.334630] vfio-pci 0000:02:00.0: enabling device (0000 -&gt; 0003) [ 71.356269] vfio_ecap_init: 0000:02:00.0 hiding ecap 0x19@0x270 [ 71.385082] pci-stub 0000:03:05.0: enabling device (0000 -&gt; 0001) [ 71.638238] virbr0: port 2(vnet0) entered learning state [ 71.868569] pci-stub 0000:03:05.0: kvm assign device [ 73.644474] virbr0: topology change detected, propagating [ 73.644526] virbr0: port 2(vnet0) entered forwarding state [ 74.983914] kvm: zapping shadow pages for mmio generation wraparound</code></pre></div><p>Changed VFIO to KVM pci-assign:</p><div class="codebox"><pre><code> &lt;hostdev mode=&#039;subsystem&#039; type=&#039;pci&#039; managed=&#039;yes&#039;&gt; &lt;driver name=&#039;kvm&#039;/&gt; &lt;source&gt; &lt;address domain=&#039;0x0000&#039; bus=&#039;0x03&#039; slot=&#039;0x05&#039; function=&#039;0x0&#039;/&gt; &lt;/source&gt; &lt;alias name=&#039;hostdev4&#039;/&gt; &lt;rom bar=&#039;on&#039;/&gt; &lt;address type=&#039;pci&#039; domain=&#039;0x0000&#039; bus=&#039;0x00&#039; slot=&#039;0x02&#039; function=&#039;0x0&#039;/&gt; &lt;/hostdev&gt;</code></pre></div><p>And the device is passed-through, showing up in VM&#039;s device manager.<br />It looks bound to pci-stub from host&#039;s perspective, however, dmesg clearly shows that it&#039;s fine:</p><div class="codebox"><pre><code>03:05.0 Multimedia audio controller [0401]: Device [1234:1880] (rev 02) Subsystem: Device [1234:2000] Control: I/O- Mem- BusMaster- SpecCycle- MemWINV- VGASnoop- ParErr- Stepping- SERR- FastB2B- DisINTx- Status: Cap- 66MHz- UDF- FastB2B- ParErr- DEVSEL=fast &gt;TAbort- &lt;TAbort- &lt;MAbort- &gt;SERR- &lt;PERR- INTx- Interrupt: pin A routed to IRQ 20 Region 0: I/O ports at 1000 [disabled] [size=128] Kernel driver in use: pci-stub</code></pre></div> <p class="postedit"><em>Last edited by Duelist (2015-03-24 11:05:01)</em></p> </div> <div class="postsignature postmsg"><hr /><p><span class="bbs">The forum rules prohibit requesting support for distributions other than arch.</span><br /><a href="https://bbs.archlinux.org/viewtopic.php?pid=1551460#p1551460" rel="nofollow">I gave up.</a><a href="https://bbs.archlinux.org/viewtopic.php?id=162768" rel="nofollow"> It was too late.</a><br /><a href="http://pastebin.com/B3fL84bq" rel="nofollow">What I was trying to do</a>.<br /><a href="http://vfio.blogspot.com/" rel="nofollow">The reference about VFIO and KVM VGA passthrough.</a></p></div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1513793">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1513826" class="blockpost roweven"> <h2><span><span class="conr">#4570</span> <a href="viewtopic.php?pid=1513826#p1513826">2015-03-24 12:23:04</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=89764">syshack</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2015-03-24</span></dd> <dd><span>Posts: 5</span></dd> <dd class="usercontacts"><span class="email"><a href="mailto:syshack@me.com">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>erganzi wrote:</cite><blockquote><div><div class="quotebox"><cite>aw wrote:</cite><blockquote><div><div class="quotebox"><cite>erganzi wrote:</cite><blockquote><div><p>Hi, aw:</p><p>my kernel/qemu version info as following:</p><p>linux-3.12.5 from kernel.org with following patchs.<br />pci/iommu: Quirk non-compliant PCIe-to-PCI bridges<br />i915_fixes[1]<br />i915_fixes[2]<br />Enable overrides for missing ACS capabilities</p><p>qemu-2.0.0 with patch<br />vfio-pci: Disallow device from using NoSnoop transactions</p></div></blockquote></div><p>Oh jeez, ping me again when you&#039;re using something reasonable.&#160; I&#039;d suggest at least 3.16 and QEMU 2.2.&#160; You don&#039;t need any patches unless you have ACS issues with IOMMU groups.</p></div></blockquote></div><br /><p>OK, I will try. <br />but yesterday I tried RHEL 7.0, it worked well with GRID K2. and the kernel version is 3.10.0-121.el7.x86_64 , qemu version is 1.5.3-60.el7.<br />had they work with the patched ?</p></div></blockquote></div><p>Can u share your success experience with me?</p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1513826">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1513832" class="blockpost rowodd"> <h2><span><span class="conr">#4571</span> <a href="viewtopic.php?pid=1513832#p1513832">2015-03-24 13:06:27</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=85314">Duelist</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2014-09-22</span></dd> <dd><span>Posts: 358</span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <p>I didn&#039;t even notice my kernel got updated from 3.18.x to 3.19.1. Thanks redhat folks, everything still works fine.<br />Some pages ago people asked about 3.19..</p> </div> <div class="postsignature postmsg"><hr /><p><span class="bbs">The forum rules prohibit requesting support for distributions other than arch.</span><br /><a href="https://bbs.archlinux.org/viewtopic.php?pid=1551460#p1551460" rel="nofollow">I gave up.</a><a href="https://bbs.archlinux.org/viewtopic.php?id=162768" rel="nofollow"> It was too late.</a><br /><a href="http://pastebin.com/B3fL84bq" rel="nofollow">What I was trying to do</a>.<br /><a href="http://vfio.blogspot.com/" rel="nofollow">The reference about VFIO and KVM VGA passthrough.</a></p></div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1513832">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1513833" class="blockpost roweven"> <h2><span><span class="conr">#4572</span> <a href="viewtopic.php?pid=1513833#p1513833">2015-03-24 13:10:21</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=59241">tritron4</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2012-04-14</span></dd> <dd><span>Posts: 146</span></dd> <dd class="usercontacts"><span class="email"><a href="misc.php?email=59241">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <p>So does it work than ?</p><div class="quotebox"><cite>Duelist wrote:</cite><blockquote><div><div class="quotebox"><cite>tritron4 wrote:</cite><blockquote><div><p>Read this <a href="https://lkml.org/lkml/2013/6/28/647" rel="nofollow">https://lkml.org/lkml/2013/6/28/647</a></p><p>Did you try this ? options vfio_iommu_type1 disable_hugepages=1</p><p><a href="http://spica-and-roid.blogspot.com.au/2012/07/howto-kvm-passthrough.html" rel="nofollow">http://spica-and-roid.blogspot.com.au/2 … rough.html</a><br />7. Necessary permission modifications [3]<br />According to my experience, you might encounter an error saying:<br />Device &#039;pci-assign&#039; could not be initialized.</p><p>Before you try any solution, first make sure that modules such as kvm, kvm_intel, pci_stub are loaded. Also make sure that intel_iommu=on is in your grub configuration file (even if you see IOMMU from dmesg, it doesn&#039;t ensure that INTEL_IOMMU is enabled).</p><p>The command that fixed it was:<br /># echo 1 &gt; /sys/module/kvm/parameters/allow_unsafe_assigned_interrupts</p></div></blockquote></div><p>I appreciate your help, but...<br />IOMMU is 100% online, since devices 01:00.0 and 02:00.0 are getting passed-through fine.<br />Hugepages aren&#039;t used<span class="bbs">(but i might try forcefully disabling them).</span> and were disabled a long time ago.<br />QEMU is run as root, clear_emulator_capabilities are set to zero. ACS is working fine, the device is isolated in it&#039;s IOMMU group, and since this is an AMD system - there shouldn&#039;t be any problems with ACS.<br />But the idea of rebinding the device is interesting, i might give it a try.</p><p>Rebinding a device gives weird issues:</p><div class="codebox"><pre><code>[ 821.585416] pci 0000:00:14.4: PCI bridge to [bus 03] [ 821.585427] pci 0000:00:14.4: bridge window [io 0x1000-0x1fff] [ 821.594894] pci 0000:00:14.4: PCI bridge to [bus 03] [ 821.594903] pci 0000:00:14.4: bridge window [io 0x1000-0x1fff] [ 821.598754] pci 0000:00:14.4: PCI bridge to [bus 03] [ 821.598762] pci 0000:00:14.4: bridge window [io 0x1000-0x1fff] [ 821.602439] pci 0000:00:14.4: PCI bridge to [bus 03] [ 821.602446] pci 0000:00:14.4: bridge window [io 0x1000-0x1fff] [ 821.604906] pci 0000:00:14.4: PCI bridge to [bus 03] [ 821.604914] pci 0000:00:14.4: bridge window [io 0x1000-0x1fff]</code></pre></div><p>I&#039;m fine with that message, but it&#039;s repeated five times. Something is quite not right here.</p><p>UPD:</p><div class="codebox"><pre><code>[ 71.303135] vfio_ecap_init: 0000:01:00.0 hiding ecap 0x19@0x270 [ 71.334630] vfio-pci 0000:02:00.0: enabling device (0000 -&gt; 0003) [ 71.356269] vfio_ecap_init: 0000:02:00.0 hiding ecap 0x19@0x270 [ 71.385082] pci-stub 0000:03:05.0: enabling device (0000 -&gt; 0001) [ 71.638238] virbr0: port 2(vnet0) entered learning state [ 71.868569] pci-stub 0000:03:05.0: kvm assign device [ 73.644474] virbr0: topology change detected, propagating [ 73.644526] virbr0: port 2(vnet0) entered forwarding state [ 74.983914] kvm: zapping shadow pages for mmio generation wraparound</code></pre></div><p>Changed VFIO to KVM pci-assign:</p><div class="codebox"><pre><code> &lt;hostdev mode=&#039;subsystem&#039; type=&#039;pci&#039; managed=&#039;yes&#039;&gt; &lt;driver name=&#039;kvm&#039;/&gt; &lt;source&gt; &lt;address domain=&#039;0x0000&#039; bus=&#039;0x03&#039; slot=&#039;0x05&#039; function=&#039;0x0&#039;/&gt; &lt;/source&gt; &lt;alias name=&#039;hostdev4&#039;/&gt; &lt;rom bar=&#039;on&#039;/&gt; &lt;address type=&#039;pci&#039; domain=&#039;0x0000&#039; bus=&#039;0x00&#039; slot=&#039;0x02&#039; function=&#039;0x0&#039;/&gt; &lt;/hostdev&gt;</code></pre></div><p>And the device is passed-through, showing up in VM&#039;s device manager.<br />It looks bound to pci-stub from host&#039;s perspective, however, dmesg clearly shows that it&#039;s fine:</p><div class="codebox"><pre><code>03:05.0 Multimedia audio controller [0401]: Device [1234:1880] (rev 02) Subsystem: Device [1234:2000] Control: I/O- Mem- BusMaster- SpecCycle- MemWINV- VGASnoop- ParErr- Stepping- SERR- FastB2B- DisINTx- Status: Cap- 66MHz- UDF- FastB2B- ParErr- DEVSEL=fast &gt;TAbort- &lt;TAbort- &lt;MAbort- &gt;SERR- &lt;PERR- INTx- Interrupt: pin A routed to IRQ 20 Region 0: I/O ports at 1000 [disabled] [size=128] Kernel driver in use: pci-stub</code></pre></div></div></blockquote></div> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1513833">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1513834" class="blockpost rowodd"> <h2><span><span class="conr">#4573</span> <a href="viewtopic.php?pid=1513834#p1513834">2015-03-24 13:16:08</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=75590">aw</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2013-10-04</span></dd> <dd><span>Posts: 921</span></dd> <dd class="usercontacts"><span class="email"><a href="misc.php?email=75590">Email</a></span> <span class="website"><a href="http://vfio.blogspot.com/" rel="nofollow">Website</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>syshack wrote:</cite><blockquote><div><div class="quotebox"><cite>erganzi wrote:</cite><blockquote><div><p>OK, I will try. <br />but yesterday I tried RHEL 7.0, it worked well with GRID K2. and the kernel version is 3.10.0-121.el7.x86_64 , qemu version is 1.5.3-60.el7.<br />had they work with the patched ?</p></div></blockquote></div><p>Can u share your success experience with me?</p></div></blockquote></div><p>RHEL7 supports GPU assignment of K-series Quadro (2000 and up), GRID, and Telsa.&#160; This uses the non-VGA, secondary GPU model.&#160; Configuration is documented here:</p><p><a href="http://documentation-devel.engineering.redhat.com/site/documentation/en-US/Red_Hat_Enterprise_Linux/7/html/Virtualization_Deployment_and_Administration_Guide/sect-device-GPU.html" rel="nofollow">http://documentation-devel.engineering. … e-GPU.html</a></p> </div> <div class="postsignature postmsg"><hr /><p><a href="http://vfio.blogspot.com" rel="nofollow">http://vfio.blogspot.com</a><br />Looking for a more open forum to discuss vfio related uses?&#160; Try <a href="https://www.redhat.com/mailman/listinfo/vfio-users" rel="nofollow">https://www.redhat.com/mailman/listinfo/vfio-users</a></p></div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1513834">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1513847" class="blockpost roweven"> <h2><span><span class="conr">#4574</span> <a href="viewtopic.php?pid=1513847#p1513847">2015-03-24 13:54:04</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=85100">Tyrewt</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2014-09-13</span></dd> <dd><span>Posts: 14</span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>asd651651 wrote:</cite><blockquote><div><p>hi, <br />I can pass through GPU successfully but after shutdown the VM and restart the VM, the host system stuck. Does anyone have that problem too?<br />It seems like the problem only occurs when passing through GPU, there is no such problem when passing through the USB controller. </p><p>Here’s my system environment:<br />&#160; &#160; Kernel version: 3.18.8 (patched with linux-mainline)<br />&#160; &#160; GPU: GTX 295<br />&#160; &#160; Qemu: 2.2.0</p></div></blockquote></div><p>Yes, I too experience this and have not found a solution.</p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1513847">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1513848" class="blockpost rowodd"> <h2><span><span class="conr">#4575</span> <a href="viewtopic.php?pid=1513848#p1513848">2015-03-24 13:56:21</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=59241">tritron4</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2012-04-14</span></dd> <dd><span>Posts: 146</span></dd> <dd class="usercontacts"><span class="email"><a href="misc.php?email=59241">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>Tyrewt wrote:</cite><blockquote><div><div class="quotebox"><cite>asd651651 wrote:</cite><blockquote><div><p>hi, <br />I can pass through GPU successfully but after shutdown the VM and restart the VM, the host system stuck. Does anyone have that problem too?<br />It seems like the problem only occurs when passing through GPU, there is no such problem when passing through the USB controller. </p><p>Here’s my system environment:<br />&#160; &#160; Kernel version: 3.18.8 (patched with linux-mainline)<br />&#160; &#160; GPU: GTX 295<br />&#160; &#160; Qemu: 2.2.0</p></div></blockquote></div><p>Yes, I too experience this and have not found a solution.</p></div></blockquote></div><p>Any error messages in log ?</p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1513848">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div class="postlinksb"> <div class="inbox crumbsplus"> <div class="pagepost"> <p class="pagelink conl"><span class="pages-label">Pages: </span><a rel="prev" class="item1" href="viewtopic.php?id=162768&amp;p=182">Previous</a> <a href="viewtopic.php?id=162768">1</a> <span class="spacer">…</span> <a href="viewtopic.php?id=162768&amp;p=181">181</a> <a href="viewtopic.php?id=162768&amp;p=182">182</a> <strong>183</strong> <a href="viewtopic.php?id=162768&amp;p=184">184</a> <a href="viewtopic.php?id=162768&amp;p=185">185</a> <span class="spacer">…</span> <a href="viewtopic.php?id=162768&amp;p=234">234</a> <a rel="next" href="viewtopic.php?id=162768&amp;p=184">Next</a></p> <p class="postlink conr">Topic closed</p> </div> <ul class="crumbs"> <li><a href="index.php">Index</a></li> <li><span>»&#160;</span><a href="viewforum.php?id=48">Topics Going Nowhere</a></li> <li><span>»&#160;</span><strong><a href="viewtopic.php?id=162768">KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</a></strong></li> </ul> <p class="subscribelink clearb"><a href="misc.php?action=subscribe&amp;tid=162768">Subscribe to this topic</a></p> <div class="clearer"></div> </div> </div> </div> <div id="brdfooter" class="block"> <h2><span>Board footer</span></h2> <div class="box"> <div id="brdfooternav" class="inbox"> <div class="conl"> <form id="qjump" method="get" action="viewforum.php"> <div><label><span>Jump to<br /></span> <select name="id" onchange="window.location=('viewforum.php?id='+this.options[this.selectedIndex].value)"> <optgroup label="Technical Issues and Assistance"> <option value="23">Newbie Corner</option> <option value="17">Installation</option> <option value="22">Kernel &amp; Hardware</option> <option value="18">Applications &amp; Desktop Environments</option> <option value="31">Laptop Issues</option> <option value="8">Networking, Server, and Protection</option> <option value="32">Multimedia and Games</option> <option value="50">System Administration</option> <option value="35">Other Architectures</option> </optgroup> <optgroup label="Arch-centric"> <option value="24">Announcements, Package &amp; Security Advisories</option> <option value="1">Arch Discussion</option> <option value="13">Forum &amp; Wiki discussion</option> </optgroup> <optgroup label="Pacman Upgrades, Packaging &amp; AUR"> <option value="44">Pacman &amp; Package Upgrade Issues</option> <option value="49">[testing] Repo Forum</option> <option value="4">Creating &amp; Modifying Packages</option> <option value="38">AUR Issues, Discussion &amp; PKGBUILD Requests</option> </optgroup> <optgroup label="Contributions &amp; Discussion"> <option value="20">GNU/Linux Discussion</option> <option value="27">Community Contributions</option> <option value="33">Programming &amp; Scripting</option> <option value="30">Other Languages</option> <option value="47">Artwork and Screenshots</option> <option value="42">Try This</option> </optgroup> <optgroup label="/dev/null"> <option value="29">Off-Topic</option> <option value="48" selected="selected">Topics Going Nowhere</option> <option value="36">Dustbin</option> </optgroup> </select></label> <input type="submit" value=" Go " accesskey="g" /> </div> </form> </div> <div class="conr"> <p id="feedlinks"><span class="atom"><a href="extern.php?action=feed&amp;tid=162768&amp;type=atom">Atom topic feed</a></span></p> <p id="poweredby">Powered by <a href="http://fluxbb.org/">FluxBB</a></p> </div> <div class="clearer"></div> </div> </div> </div> </div> <div class="end-box"></div> </div> </body> </html>
