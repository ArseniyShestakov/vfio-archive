<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"> <html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en" dir="ltr"> <head> <meta http-equiv="Content-Type" content="text/html; charset=utf-8" /> <title>KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9 (Page 32) / Topics Going Nowhere / Arch Linux Forums</title> <link rel="stylesheet" type="text/css" href="style/ArchLinux.css" /> <link rel="canonical" href="viewtopic.php?id=162768&amp;p=32" title="Page 32" /> <link rel="prev" href="viewtopic.php?id=162768&amp;p=31" title="Page 31" /> <link rel="next" href="viewtopic.php?id=162768&amp;p=33" title="Page 33" /> <link rel="alternate" type="application/atom+xml" href="extern.php?action=feed&amp;tid=162768&amp;type=atom" title="Atom topic feed" /> <link rel="stylesheet" media="screen" href="style/ArchLinux/arch.css?v=3" /> <link rel="stylesheet" media="screen" href="style/ArchLinux/archnavbar.css?v=2" /> <link rel="shortcut icon" href="style/ArchLinux/favicon.ico" /> </head> <body> <div id="archnavbar" class="anb-forum"> <div id="archnavbarlogo"><h1><a href="http://www.archlinux.org/">Arch Linux</a></h1></div> <div id="archnavbarmenu"> <ul id="archnavbarlist"> <li id="anb-home"><a href="http://www.archlinux.org/">Home</a></li><li id="anb-packages"><a href="http://www.archlinux.org/packages/">Packages</a></li><li id="anb-forums" class="anb-selected"><a href="https://bbs.archlinux.org/">Forums</a></li><li id="anb-wiki"><a href="https://wiki.archlinux.org/">Wiki</a></li><li id="anb-bugs"><a href="https://bugs.archlinux.org/">Bugs</a></li><li id="anb-aur"><a href="https://aur.archlinux.org/">AUR</a></li><li id="anb-download"><a href="http://www.archlinux.org/download/">Download</a></li> </ul> </div> </div> <div id="punviewtopic" class="pun"> <div class="top-box"></div> <div class="punwrap"> <div id="brdheader" class="block"> <div class="box"> <div id="brdmenu" class="inbox"> <ul> <li id="navindex" class="isactive"><a href="index.php">Index</a></li> <li id="navuserlist"><a href="userlist.php">User list</a></li> <li id="navsearch"><a href="search.php">Search</a></li> <li id="navprofile"><a href="profile.php?id=80749">Profile</a></li> <li id="navlogout"><a href="login.php?action=out&amp;id=80749&amp;csrf_token=5c20501ec397bb45ef8ee8c84db232c8d8e421c6">Logout</a></li> </ul> </div> <div id="brdwelcome" class="inbox"> <ul class="conl"> <li><span>Logged in as <strong>SXX</strong></span></li> <li><span>Last visit: 2015-08-16 12:20:09</span></li> </ul> <ul class="conr"> <li><span>Topics: <a href="search.php?action=show_replies" title="Find topics you have posted to.">Posted</a> | <a href="search.php?action=show_new" title="Find topics with new posts since your last visit.">New</a> | <a href="search.php?action=show_recent" title="Find topics with recent posts.">Active</a> | <a href="search.php?action=show_unanswered" title="Find topics with no replies.">Unanswered</a></span></li> </ul> <div class="clearer"></div> </div> </div> </div> <div id="brdmain"> <div class="linkst"> <div class="inbox crumbsplus"> <ul class="crumbs"> <li><a href="index.php">Index</a></li> <li><span>»&#160;</span><a href="viewforum.php?id=48">Topics Going Nowhere</a></li> <li><span>»&#160;</span><strong><a href="viewtopic.php?id=162768">KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</a></strong></li> </ul> <div class="pagepost"> <p class="pagelink conl"><span class="pages-label">Pages: </span><a rel="prev" class="item1" href="viewtopic.php?id=162768&amp;p=31">Previous</a> <a href="viewtopic.php?id=162768">1</a> <span class="spacer">…</span> <a href="viewtopic.php?id=162768&amp;p=30">30</a> <a href="viewtopic.php?id=162768&amp;p=31">31</a> <strong>32</strong> <a href="viewtopic.php?id=162768&amp;p=33">33</a> <a href="viewtopic.php?id=162768&amp;p=34">34</a> <span class="spacer">…</span> <a href="viewtopic.php?id=162768&amp;p=234">234</a> <a rel="next" href="viewtopic.php?id=162768&amp;p=33">Next</a></p> <p class="postlink conr">Topic closed</p> </div> <div class="clearer"></div> </div> </div> <div id="p1350064" class="blockpost rowodd blockpost1"> <h2><span><span class="conr">#776</span> <a href="viewtopic.php?pid=1350064#p1350064">2013-11-15 23:21:44</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=76479">Norcoen</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>From: Norway</span></dd> <dd><span>Registered: 2013-11-02</span></dd> <dd><span>Posts: 23</span></dd> <dd class="usercontacts"><span class="email"><a href="mailto:frankmoll@gmx.net">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <p>I rebuilt qemu now, qemu-1.7.r29486.g5c5432e<br />Still the same error with usb passthrough.<br />Can I increase verbosity or is there some sort of error log to search for more information, why it could not add the usb device?<br />Without the machine boots up fine.</p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1350064">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1350086" class="blockpost roweven"> <h2><span><span class="conr">#777</span> <a href="viewtopic.php?pid=1350086#p1350086">2013-11-16 00:53:20</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=76843">gentoo-nut</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2013-11-14</span></dd> <dd><span>Posts: 4</span></dd> <dd class="usercontacts"><span class="email"><a href="misc.php?email=76843">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>aw wrote:</cite><blockquote><div><p>Windows doesn&#039;t much like hardware changes, so it&#039;s worth a shot to reinstall.&#160; Others have noted success with Radeon cards when they attach the audio device to bus=pcie.0 rather than as function 1 of the GPU behind the root port.</p></div></blockquote></div><p>Well ... I did the re-install this time with the ioh3420 root there .. and no dice, same thing</p><p>THEN .. I moved the HDMI audio function back over to pci.2 as you suggested, kept the VGA over on the ioh, and BAM.&#160; Great success.&#160; Full 3D accel and I can reboot the thing freely, meanwhile the host is rock solid stable.&#160; AW, thank you x100000000000 for that suggestion.&#160; And even more for all of your hard work, great work mind you, and great idea for the VFIO mechanism.&#160; This is truly great stuff, once it becomes easier we can imagine how popular this type of setup could be!!&#160; (seriously, this is awesome)</p><p>And nbhs, thank you again for putting the software recipe together on the first post, as well as for all of the help you have given me over the past couple months.&#160; &#160;It&#039;s been a long often very stressful journey, but I think I am finally finished.&#160; &#160;I&#039;ll be doing some stability testing over the next few hours and will report back one final time with some screenshots and a summary of what all I&#039;ve ran into.&#160; BUT IT WORKS, I am so happy right now.... <img src="https://bbs.archlinux.org/img/smilies/smile.png" width="15" height="15" alt="smile" /> <img src="https://bbs.archlinux.org/img/smilies/smile.png" width="15" height="15" alt="smile" /></p><p>[ actually the hdmi audio shows code 10, can&#039;t start, as expected I guess.&#160; But who cares, I really don&#039;t even want that in the first place.&#160; <img src="https://bbs.archlinux.org/img/smilies/smile.png" width="15" height="15" alt="smile" /> ]</p> <p class="postedit"><em>Last edited by gentoo-nut (2013-11-16 01:17:49)</em></p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1350086">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1350127" class="blockpost rowodd"> <h2><span><span class="conr">#778</span> <a href="viewtopic.php?pid=1350127#p1350127">2013-11-16 06:04:41</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=76794">ilya80</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2013-11-12</span></dd> <dd><span>Posts: 34</span></dd> <dd class="usercontacts"><span class="email"><a href="misc.php?email=76794">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>Norcoen wrote:</cite><blockquote><div><p>I rebuilt qemu now, qemu-1.7.r29486.g5c5432e<br />Still the same error with usb passthrough.<br />Can I increase verbosity or is there some sort of error log to search for more information, why it could not add the usb device?<br />Without the machine boots up fine.</p></div></blockquote></div><p>Hi!</p><p>It really looks like you have built QEMU without usb support. If your qemu starts, can you connect to it via VNC and issue &quot;info usb&quot; and &quot;info hostusb&quot; commands?</p><p>To build with usb support you need to run ./configure --help and check the options - there are options to enable it. Then you may have to install some libs.</p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1350127">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1350128" class="blockpost roweven"> <h2><span><span class="conr">#779</span> <a href="viewtopic.php?pid=1350128#p1350128">2013-11-16 06:06:32</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=76794">ilya80</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2013-11-12</span></dd> <dd><span>Posts: 34</span></dd> <dd class="usercontacts"><span class="email"><a href="misc.php?email=76794">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <p>I installed debian as guest and nouveau doesnt start. Since its all opensource I thought there can be a way to get more diagnostics out of it... any hints?</p><p>Thanks,<br />Ilya.</p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1350128">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1350159" class="blockpost rowodd"> <h2><span><span class="conr">#780</span> <a href="viewtopic.php?pid=1350159#p1350159">2013-11-16 10:49:18</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=70922">nbhs</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd class="postavatar"><img src="https://bbs.archlinux.org/img/avatars/70922.jpg?m=1367773811" width="80" height="80" alt="" /></dd> <dd><span>From: Montevideo, Uruguay</span></dd> <dd><span>Registered: 2013-05-02</span></dd> <dd><span>Posts: 402</span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>gentoo-nut wrote:</cite><blockquote><div><p>...</p></div></blockquote></div><p>Nice to see you finally got it working!</p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1350159">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1350192" class="blockpost roweven"> <h2><span><span class="conr">#781</span> <a href="viewtopic.php?pid=1350192#p1350192">2013-11-16 12:44:25</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=70922">nbhs</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd class="postavatar"><img src="https://bbs.archlinux.org/img/avatars/70922.jpg?m=1367773811" width="80" height="80" alt="" /></dd> <dd><span>From: Montevideo, Uruguay</span></dd> <dd><span>Registered: 2013-05-02</span></dd> <dd><span>Posts: 402</span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>Norcoen wrote:</cite><blockquote><div><p>I rebuilt qemu now, qemu-1.7.r29486.g5c5432e<br />Still the same error with usb passthrough.<br />Can I increase verbosity or is there some sort of error log to search for more information, why it could not add the usb device?<br />Without the machine boots up fine.</p></div></blockquote></div><p>Maybe perhaps you&#039;re missing some usb dependencies see this post: <a href="https://bbs.archlinux.org/viewtopic.php?pid=1337135#p1337135" rel="nofollow">https://bbs.archlinux.org/viewtopic.php … 5#p1337135</a></p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1350192">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1350210" class="blockpost rowodd"> <h2><span><span class="conr">#782</span> <a href="viewtopic.php?pid=1350210#p1350210">2013-11-16 13:34:49</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=76922">kaladis</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2013-11-16</span></dd> <dd><span>Posts: 1</span></dd> <dd class="usercontacts"><span class="email"><a href="mailto:j.luebbert@kaladix.org">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <p>I have a P15SM Notebook with i7-4800MQ with integrated graphics and Radeon 8970. There are 3 ports for graphics: Display Port, Mini Display Port and HDMI.</p><p>I would like to run X on one port (+ Notebook screen) using the IGP and a Windows VM with the discrete GPU on another port.</p><p>Is this possible? If so, how do configure which GPU is used for which port?</p><p>So far I got the below commands running fine - just without any graphic output:</p><p>echo &quot;8086 0c01&quot; &gt; /sys/bus/pci/drivers/vfio-pci/new_id<br />echo 0000:01:00.0 &gt; /sys/bus/pci/devices/0000:01:00.0/driver/unbind<br />echo 0000:01:00.0 &gt; /sys/bus/pci/drivers/vfio-pci/bind <br />sudo qemu-system-x86_64 -M q35 -m 8G -enable-kvm -cpu Haswell -vga none -parallel none -bios /usr/share/qemu/bios.bin -smp 4,sockets=1,cores=4,threads=1 -device ioh3420,bus=pcie.0,addr=1c.0,multifunction=on,port=1,chassis=1,id=root.1 -device ahci,bus=pcie.0,id=ahci -device vfio-pci,host=01:00.0,x-vga=on,addr=0.0,multifunction=on,bus=root.1 -vnc :1</p><p>Thanks a lot</p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1350210">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1350268" class="blockpost roweven"> <h2><span><span class="conr">#783</span> <a href="viewtopic.php?pid=1350268#p1350268">2013-11-16 16:22:07</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=75590">aw</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2013-10-04</span></dd> <dd><span>Posts: 921</span></dd> <dd class="usercontacts"><span class="email"><a href="misc.php?email=75590">Email</a></span> <span class="website"><a href="http://vfio.blogspot.com/" rel="nofollow">Website</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>kaladis wrote:</cite><blockquote><div><p>I have a P15SM Notebook with i7-4800MQ with integrated graphics and Radeon 8970. There are 3 ports for graphics: Display Port, Mini Display Port and HDMI.</p><p>I would like to run X on one port (+ Notebook screen) using the IGP and a Windows VM with the discrete GPU on another port.</p><p>Is this possible? If so, how do configure which GPU is used for which port?</p><p>So far I got the below commands running fine - just without any graphic output:</p><p>echo &quot;8086 0c01&quot; &gt; /sys/bus/pci/drivers/vfio-pci/new_id<br />echo 0000:01:00.0 &gt; /sys/bus/pci/devices/0000:01:00.0/driver/unbind<br />echo 0000:01:00.0 &gt; /sys/bus/pci/drivers/vfio-pci/bind <br />sudo qemu-system-x86_64 -M q35 -m 8G -enable-kvm -cpu Haswell -vga none -parallel none -bios /usr/share/qemu/bios.bin -smp 4,sockets=1,cores=4,threads=1 -device ioh3420,bus=pcie.0,addr=1c.0,multifunction=on,port=1,chassis=1,id=root.1 -device ahci,bus=pcie.0,id=ahci -device vfio-pci,host=01:00.0,x-vga=on,addr=0.0,multifunction=on,bus=root.1 -vnc :1</p><p>Thanks a lot</p></div></blockquote></div><p>Unless you have the schematic for the laptop we can&#039;t really tell you whether it&#039;s even possible.&#160; Is there a hardware mux that can switch individual output ports to each graphics device independently?&#160; Who knows.&#160; I don&#039;t know about IGD/Radeon laptops, but modern IGD/Nvidia laptops don&#039;t attach the Nvidia device to any output, the IGD and Nvidia are meant to work together.&#160; The Nvidia renders into buffers which are displayed by the IGD.&#160; I have an older, pre-optimus Asus UL30VT with discrete Nvidia + IGD.&#160; In this case I&#039;ve figured out that laptop panel is switchable between graphics using a mux in ACPI.&#160; Even then I can only get standard VGA drivers to work, the accelerated drivers just turn the screen black.</p><p>So, for your device, it may be possible to get this to work, it may not.&#160; Either way it&#039;s going to take some digging and guesswork on your part to figure out if outputs can be switched and how to do it.&#160; It may be telling if the device works with standard Intel and AMD graphics drivers or whether it requires a custom driver from the laptop vendor.&#160; If it requires a custom driver, I doubt you&#039;re going to have much success.&#160; Good luck.</p> </div> <div class="postsignature postmsg"><hr /><p><a href="http://vfio.blogspot.com" rel="nofollow">http://vfio.blogspot.com</a><br />Looking for a more open forum to discuss vfio related uses?&#160; Try <a href="https://www.redhat.com/mailman/listinfo/vfio-users" rel="nofollow">https://www.redhat.com/mailman/listinfo/vfio-users</a></p></div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1350268">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1350315" class="blockpost rowodd"> <h2><span><span class="conr">#784</span> <a href="viewtopic.php?pid=1350315#p1350315">2013-11-16 18:24:00</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=65027">blacky</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2012-10-26</span></dd> <dd><span>Posts: 10</span></dd> <dd class="usercontacts"><span class="email"><a href="misc.php?email=65027">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>blacky wrote:</cite><blockquote><div><div class="quotebox"><cite>nbhs wrote:</cite><blockquote><div><p>Use the packages i provided instead of the AUR ones</p></div></blockquote></div><p>I thought that those were o.k. too since you linked them</p><div class="quotebox"><cite>nbhs wrote:</cite><blockquote><div><p>qemu-git.tar.gz (includes NoSnoop patch) OR qemu-git from AUR<br />seabios.tar.gz (1.7.3.2)<br />linux-mainline.tar.gz (3.12.0 includes acs override patch and i915 fixes) OR&#160; linux-mainline from AUR</p></div></blockquote></div><p>But of course I’ll follow your advise, thanks!</p></div></blockquote></div><p>… and it was good advise. Although I’m not completely finished just yet I can now tell you that I successfully booted Windows.</p><p>Maybe interesting facts:</p><p>* migrated <strong>existing</strong> Windows 7 installation from its own physical machine into a virtual environment<br />* Using <strong>IGP</strong> on board graphics from ASRock Z87 Extreme6 for Arch Linux Host <strong>works</strong><br />* Successfully passed through <strong>Radeon HD 4850</strong> to Windows</p><p>Findings: </p><p>* Booting Windows from ssd using a virtualized AHCI controller did not work. Although the Windows repair disk did find the installation nothing I tried to fix it (bootsect, bcdedit, bootrec, etc.) worked. Error messages included but were not limited to “Windows failed to start. A recent hardware or software change might be the cause.”, “An error occurred while attempting to read the boot configuration data” and “An error occurred while attempting to read the boot configuration data”. Then I decided to boot up Windows on the physical host an install all drivers for both the physical machine and virtio. Since I then tried booting (in qemu) using virtio straight away and it worked I don’t know if this or any of the other drivers did the trick.<br />* It might not have been necessary to decrypt the Windows main drive if I had installed the virtio-drivers before. Also: Don’t decrypt using the rescue CD from TrueCrypt in Qemu. They tell you it will be painfully slow and they mean that. Also it’s single threaded.</p><p>Next step: </p><p>* Try to pass Creative X-Fi through to Windows. I’m not very optimistic on this one; it looks like it may be sharing it’s IOMMU group with a ton of other stuff<br />* Set up cpuset<br />* Fine tuning</p><p><strong>Thank you so very, very much, nbhs!</strong></p><p>I wanted to try this with Xen back in 2008 but unfortunately my BIOS (yes, only that) did not support VT-d. Now I’m finally there an this is thanks to you and all the other fine people around here. <strong>Thank you all!</strong></p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1350315">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1350324" class="blockpost roweven"> <h2><span><span class="conr">#785</span> <a href="viewtopic.php?pid=1350324#p1350324">2013-11-16 18:41:23</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=70922">nbhs</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd class="postavatar"><img src="https://bbs.archlinux.org/img/avatars/70922.jpg?m=1367773811" width="80" height="80" alt="" /></dd> <dd><span>From: Montevideo, Uruguay</span></dd> <dd><span>Registered: 2013-05-02</span></dd> <dd><span>Posts: 402</span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>blacky wrote:</cite><blockquote><div><p>...<br />* Try to pass Creative X-Fi through to Windows. I’m not very optimistic on this one; it looks like it may be sharing it’s IOMMU group with a ton of other stuff<br />...</p></div></blockquote></div><p>Try using the acs override workarround</p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1350324">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1350417" class="blockpost rowodd"> <h2><span><span class="conr">#786</span> <a href="viewtopic.php?pid=1350417#p1350417">2013-11-16 23:03:42</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=76479">Norcoen</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>From: Norway</span></dd> <dd><span>Registered: 2013-11-02</span></dd> <dd><span>Posts: 23</span></dd> <dd class="usercontacts"><span class="email"><a href="mailto:frankmoll@gmx.net">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>ilya80 wrote:</cite><blockquote><div><p>Hi!</p><p>It really looks like you have built QEMU without usb support. If your qemu starts, can you connect to it via VNC and issue &quot;info usb&quot; and &quot;info hostusb&quot; commands?</p><p>To build with usb support you need to run ./configure --help and check the options - there are options to enable it. Then you may have to install some libs.</p></div></blockquote></div><div class="quotebox"><cite>nbhs wrote:</cite><blockquote><div><p>Maybe perhaps you&#039;re missing some usb dependencies see this post: <a href="https://bbs.archlinux.org/viewtopic.php?pid=1337135#p1337135" rel="nofollow">https://bbs.archlinux.org/viewtopic.php … 5#p1337135</a></p></div></blockquote></div><p>I think I fixed it now. Even tough configure didn&#039;t complain anymore, and I did a &quot;yum-builddep qemu&quot; as aw suggested, libusb-devel and some other stuff was still missing.</p><div class="codebox"><pre class="vscroll"><code>$ ./configure --prefix=/home/user/qemu-1.7.r29486.g5c5432e --sysconfdir=/etc --audio-drv-list=&#039;pa alsa sdl oss&#039; \ &gt; --python=/usr/bin/python2 --smbd=/sbin/smbd \ &gt; --enable-docs --libexecdir=/home/user/qemu-1.7.r29486.g5c5432e/libexec \ &gt; --disable-gtk --enable-linux-aio --enable-seccomp \ &gt; --enable-spice --localstatedir=/var Install prefix /home/user/qemu-1.7.r29486.g5c5432e BIOS directory /home/user/qemu-1.7.r29486.g5c5432e/share/qemu binary directory /home/user/qemu-1.7.r29486.g5c5432e/bin library directory /home/user/qemu-1.7.r29486.g5c5432e/lib libexec directory /home/user/qemu-1.7.r29486.g5c5432e/libexec include directory /home/user/qemu-1.7.r29486.g5c5432e/include config directory /etc local state directory /var Manual directory /home/user/qemu-1.7.r29486.g5c5432e/share/man ELF interp prefix /usr/gnemul/qemu-%M Source path /home/user/qemu-git/test/qemu-1.7.r29486.g5c5432e C compiler cc Host C compiler cc C++ compiler c++ Objective-C compiler cc CFLAGS -O2 -U_FORTIFY_SOURCE -D_FORTIFY_SOURCE=2 -g -D_FILE_OFFSET_BITS=64 -D__USE_FILE_OFFSET64 -I/usr/include/glusterfs QEMU_CFLAGS -Werror -fPIE -DPIE -m64 -D_GNU_SOURCE -D_FILE_OFFSET_BITS=64 -D_LARGEFILE_SOURCE -Wstrict-prototypes -Wredundant-decls -Wall -Wundef -Wwrite-strings -Wmissing-prototypes -fno-strict-aliasing -Wendif-labels -Wmissing-include-dirs -Wempty-body -Wnested-externs -Wformat-security -Wformat-y2k -Winit-self -Wignored-qualifiers -Wold-style-declaration -Wold-style-definition -Wtype-limits -fstack-protector-all -I/usr/include/p11-kit-1 -I/usr/include/libpng15 -I/usr/include/spice-server -I/usr/include/cacard -I/usr/include/glib-2.0 -I/usr/lib64/glib-2.0/include -I/usr/include/pixman-1 -I/usr/include/nss3 -I/usr/include/nspr4 -I/usr/include/spice-1 -I/usr/include/nss3 -I/usr/include/nspr4 -pthread -I/usr/include/glib-2.0 -I/usr/lib64/glib-2.0/include -I/usr/include/libusb-1.0 -I/usr/include/pixman-1 LDFLAGS -Wl,--warn-common -Wl,-z,relro -Wl,-z,now -pie -m64 -g make make install install python /usr/bin/python2 smbd /sbin/smbd host CPU x86_64 host big endian no target list alpha-softmmu arm-softmmu cris-softmmu i386-softmmu lm32-softmmu m68k-softmmu microblazeel-softmmu microblaze-softmmu mips64el-softmmu mips64-softmmu mipsel-softmmu mips-softmmu moxie-softmmu or32-softmmu ppc64-softmmu ppcemb-softmmu ppc-softmmu s390x-softmmu sh4eb-softmmu sh4-softmmu sparc64-softmmu sparc-softmmu unicore32-softmmu x86_64-softmmu xtensaeb-softmmu xtensa-softmmu alpha-linux-user armeb-linux-user arm-linux-user cris-linux-user i386-linux-user m68k-linux-user microblazeel-linux-user microblaze-linux-user mips64el-linux-user mips64-linux-user mipsel-linux-user mips-linux-user mipsn32el-linux-user mipsn32-linux-user or32-linux-user ppc64abi32-linux-user ppc64-linux-user ppc-linux-user s390x-linux-user sh4eb-linux-user sh4-linux-user sparc32plus-linux-user sparc64-linux-user sparc-linux-user unicore32-linux-user x86_64-linux-user tcg debug enabled no gprof enabled no sparse enabled no strip binaries yes profiler no static build no -Werror enabled yes pixman system SDL support yes GTK support no curses support yes curl support yes mingw32 support no Audio drivers pa alsa sdl oss Block whitelist (rw) Block whitelist (ro) VirtFS support yes VNC support yes VNC TLS support yes VNC SASL support yes VNC JPEG support yes VNC PNG support yes VNC WS support yes xen support no brlapi support yes bluez support yes Documentation yes GUEST_BASE yes PIE yes vde support no Linux AIO support yes ATTR/XATTR support yes Install blobs yes KVM support yes RDMA support no TCG interpreter no fdt support yes preadv support yes fdatasync yes madvise yes posix_madvise yes sigev_thread_id yes uuid support yes libcap-ng support no vhost-net support yes vhost-scsi support yes Trace backend nop Trace output file trace-&lt;pid&gt; spice support yes (0.12.6/0.12.4) rbd support yes xfsctl support yes nss used yes libusb yes usb net redir yes GLX support yes libiscsi support yes build guest agent yes QGA VSS support no seccomp support yes coroutine backend ucontext coroutine pool yes GlusterFS support yes virtio-blk-data-plane yes gcov gcov gcov enabled no TPM support no libssh2 support yes TPM passthrough no QOM debugging yes vhdx yes</code></pre></div><p>So libusb is now saying &quot;yes&quot;, are some of the others saying &quot;no&quot; important?</p><p>I can now passthrough the usb devices I need and managed to install Win7Ultimate in a 30GB .img-file as shown in the first post. (Just for now, until it works)<br />My install process looked like this:<br />1. boot from win7.iso<br />2. select &quot;disk&quot; and start installation<br />3. reboot<br />4. installation process finishes<br />5. reboot<br />6. initial setup of win7: chose computer name, select network and password, etc.</p><p>BUT</p><p>When it&#039;s finished, it never boots the actual system, after seabios it just stops with a blinking underline &quot;_&quot; while one of my cpu cores runs at 100% load all the time.<br />I tried this many times now, with installation on an .img-file, a real /dev/sdj disk and even by passing through the&#160; pcie-controller with a disk attached (unfortunately windows states it cant be installed on this disk, when doing so)</p><p>Is this a known problem someone ran into before? My old installation still works fine, my wildest guess is that using emulated q35 chipset with an image of win7 from 2010 is just not working.<br />Any ideas?</p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1350417">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1350485" class="blockpost roweven"> <h2><span><span class="conr">#787</span> <a href="viewtopic.php?pid=1350485#p1350485">2013-11-17 00:46:43</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=70922">nbhs</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd class="postavatar"><img src="https://bbs.archlinux.org/img/avatars/70922.jpg?m=1367773811" width="80" height="80" alt="" /></dd> <dd><span>From: Montevideo, Uruguay</span></dd> <dd><span>Registered: 2013-05-02</span></dd> <dd><span>Posts: 402</span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>Norcoen wrote:</cite><blockquote><div><p>...</p></div></blockquote></div><p>Dont use my script, use the command line or use this one:</p><div class="codebox"><pre class="vscroll"><code>#!/bin/sh QEMU=/usr/bin/qemu-system-x86_64 VCPUS=&quot;6&quot; CPU=&quot;Opteron_G4&quot; MEM=&quot;8192&quot; MEM_PATH=&quot;/dev/hugepages&quot; BIOS=&quot;/usr/share/qemu/bios.bin&quot; NET=&quot;-netdev bridge,br=br0,id=hostnet0 -device virtio-net-pci,netdev=hostnet0,id=net0&quot; USB_DEVICES=&quot;&quot; PCI_DEVICES=&quot;00:11.0 04:00.0 05:00.0 06:00.0&quot; GPU=&quot;07:00.0&quot; GPU_SND=&quot;07:00.1&quot; SND=true SND_DRIVER_OPTS=&quot;QEMU_ALSA_DAC_BUFFER_SIZE=512 QEMU_ALSA_DAC_PERIOD_SIZE=170 QEMU_AUDIO_DRV=alsa &quot; VBIOS=&quot;/usr/local/share/qemu/vgabios-6950.bin&quot; CDROM=&quot;&quot; HDD=&quot;&quot; QEMU_ARGS=&quot; -M q35 -enable-kvm -monitor stdio&quot; EXTRA_ARGS=&quot;-boot menu=on&quot; if [ -n &quot;$GPU&quot; ]; then EXTRA_ARGS+=&quot; -vga none -nographic&quot; DEV+=&quot; -device ioh3420,bus=pcie.0,addr=1c.0,multifunction=on,port=1,chassis=1,id=root.1&quot; if [ -n &quot;$VBIOS&quot; ]; then DEV+=&quot; -device vfio-pci,host=$GPU,x-vga=on,addr=0.0,multifunction=on,bus=root.1,romfile=$VBIOS&quot; else DEV+=&quot; -device vfio-pci,host=$GPU,x-vga=on,addr=0.0,multifunction=on,bus=root.1&quot; fi if [ -n &quot;$GPU_SND&quot; ]; then DEV+=&quot; -device vfio-pci,host=$GPU_SND,addr=0.1,bus=root.1&quot; fi fi if [ -n &quot;$PCI_DEVICES&quot; ]; then for d in $PCI_DEVICES; do DEV+=&quot; -device vfio-pci,host=$d&quot; done fi if [ -n &quot;$HDD&quot; ] || [ -n &quot;$CDROM&quot; ]; then DEV+=&quot; -device ahci,bus=pcie.0,id=ahci&quot; if [ -n &quot;$HDD&quot; ]; then STORAGE+=&quot; -drive file=$HDD,id=disk,format=raw -device ide-hd,bus=ahci.0,drive=disk&quot; fi if [ -n &quot;$CDROM&quot; ]; then STORAGE+=&quot; -drive file=$CDROM,id=isocd -device ide-cd,bus=ahci.1,drive=isocd&quot; fi fi if [ -n &quot;$CPU&quot; ]; then CPU=&quot;-cpu $CPU -smp $VCPUS,sockets=1,cores=$VCPUS,threads=1&quot; else CPU=&quot;-smp $VCPUS,sockets=1,cores=$VCPUS,threads=1&quot; fi if [ -n &quot;$BIOS&quot; ]; then BIOS=&quot; -bios $BIOS&quot; fi if $SND ; then SND=&quot;-device ich9-intel-hda,bus=pcie.0,addr=1b.0,id=sound0 -device hda-duplex,cad=0&quot; export $SND_DRIVER_OPTS else SND=&quot;&quot; fi if [ -n &quot;$MEM&quot; ]; then MEMORY+=&quot;-m $MEM&quot; if [ -n &quot;$MEM_PATH&quot; ]; then MEMORY+=&quot; -mem-prealloc -mem-path $MEM_PATH&quot; fi fi if [ -n &quot;$USB_DEVICES&quot; ]; then for u in $USB_DEVICES; do USB_DEV+=&quot; -usbdevice $u&quot; done fi $QEMU $BIOS $CPU $MEMORY $QEMU_ARGS $DEV $USB_DEV $NET $SND $STORAGE $EXTRA_ARGS echo &quot;All Done!!&quot;</code></pre></div> <p class="postedit"><em>Last edited by nbhs (2013-11-17 00:50:28)</em></p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1350485">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1350519" class="blockpost rowodd"> <h2><span><span class="conr">#788</span> <a href="viewtopic.php?pid=1350519#p1350519">2013-11-17 01:57:46</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=76479">Norcoen</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>From: Norway</span></dd> <dd><span>Registered: 2013-11-02</span></dd> <dd><span>Posts: 23</span></dd> <dd class="usercontacts"><span class="email"><a href="mailto:frankmoll@gmx.net">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <p>same problem <img src="https://bbs.archlinux.org/img/smilies/hmm.png" width="15" height="15" alt="hmm" /><br />This time I didn&#039;t even get to configure Win7, it stopped after the installation process rebootet the 2nd time.<br />I see the line &quot;SeaBIOS (version rel-1.7.3.2-0-[...]&quot; above the blinking cursor.</p><p>After this I stopped qemu and started it again so it startet where it left off, finishing the installation.<br />After configuring win7 I even got to see the desktop for a few seconds until it decided to do a reboot... and now: back to the blinking cursor. Does not boot anymore. Doesn&#039;t matter how often I reset qemu.<br />Only thing I&#039;m wondering about, is the qemu-console showing &quot;QEMU 1.6.90 monitor - type &#039;help&#039; for more information&quot;.<br />Shouldn&#039;t it be 1.7.x?</p> <p class="postedit"><em>Last edited by Norcoen (2013-11-17 01:58:32)</em></p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1350519">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1350592" class="blockpost roweven"> <h2><span><span class="conr">#789</span> <a href="viewtopic.php?pid=1350592#p1350592">2013-11-17 08:26:25</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=76794">ilya80</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2013-11-12</span></dd> <dd><span>Posts: 34</span></dd> <dd class="usercontacts"><span class="email"><a href="misc.php?email=76794">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>Norcoen wrote:</cite><blockquote><div><p>same problem <img src="https://bbs.archlinux.org/img/smilies/hmm.png" width="15" height="15" alt="hmm" /></p></div></blockquote></div><p>If you fail booting / installing win - try various settings for -cpu option for qemu. host, qemu64, your actual CPU type, etc. Thats what helped me.</p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1350592">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1350670" class="blockpost rowodd"> <h2><span><span class="conr">#790</span> <a href="viewtopic.php?pid=1350670#p1350670">2013-11-17 13:12:33</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=76479">Norcoen</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>From: Norway</span></dd> <dd><span>Registered: 2013-11-02</span></dd> <dd><span>Posts: 23</span></dd> <dd class="usercontacts"><span class="email"><a href="mailto:frankmoll@gmx.net">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <p>Thanks. You were right with the -cpu options. <img src="https://bbs.archlinux.org/img/smilies/smile.png" width="15" height="15" alt="smile" /><br />I just changed CPU=&quot;Haswell&quot; in the script to CPU=&quot;host&quot; and it is booting fine now, didn&#039;t even need to re-install the system.</p><p>I&#039;m currently installing drivers to check if everything is working. But I wonder, why the machine has access to the internet... I set NET=&quot;&quot; in the script</p><div class="codebox"><pre class="vscroll"><code>#!/bin/sh QEMU=/home/user/qemu-1.7.r29486.g5c5432e/bin/qemu-system-x86_64 VCPUS=&quot;8&quot; CPU=&quot;host&quot; MEM=&quot;8192&quot; #MEM_PATH=&quot;/dev/hugepages&quot; MEM_PATH=&quot;&quot; BIOS=&quot;/home/user/qemu-1.7.r29486.g5c5432e/share/qemu/bios.bin&quot; #NET=&quot;-netdev bridge,br=br0,id=hostnet0 -device virtio-net-pci,netdev=hostnet0,id=net0&quot; NET=&quot;&quot; #USB_DEVICES=&quot;&quot; USB_DEVICES=&quot;host:1267:0210&quot; PCI_DEVICES=&quot;04:00.0 08:00.0 09:00.0&quot; #PCI_DEVICES=&quot;&quot; GPU=&quot;01:00.0&quot; GPU_SND=&quot;01:00.1&quot; SND=false SND_DRIVER_OPTS=&quot;QEMU_ALSA_DAC_BUFFER_SIZE=512 QEMU_ALSA_DAC_PERIOD_SIZE=170 QEMU_AUDIO_DRV=alsa &quot; VBIOS=&quot;&quot; CDROM=&quot;/home/user/Dokumente/KVM/Win7.iso&quot; HDD=&quot;/media/BigStorage/Temp/windowskvm.img&quot; QEMU_ARGS=&quot; -M q35 -enable-kvm -monitor stdio&quot; EXTRA_ARGS=&quot;-boot menu=on&quot; if [ -n &quot;$GPU&quot; ]; then EXTRA_ARGS+=&quot; -vga none -nographic&quot; DEV+=&quot; -device ioh3420,bus=pcie.0,addr=1c.0,multifunction=on,port=1,chassis=1,id=root.1&quot; if [ -n &quot;$VBIOS&quot; ]; then DEV+=&quot; -device vfio-pci,host=$GPU,x-vga=on,addr=0.0,multifunction=on,bus=root.1,romfile=$VBIOS&quot; else DEV+=&quot; -device vfio-pci,host=$GPU,x-vga=on,addr=0.0,multifunction=on,bus=root.1&quot; fi if [ -n &quot;$GPU_SND&quot; ]; then DEV+=&quot; -device vfio-pci,host=$GPU_SND,addr=0.1,bus=root.1&quot; fi fi if [ -n &quot;$PCI_DEVICES&quot; ]; then for d in $PCI_DEVICES; do DEV+=&quot; -device vfio-pci,host=$d&quot; done fi if [ -n &quot;$HDD&quot; ] || [ -n &quot;$CDROM&quot; ]; then DEV+=&quot; -device ahci,bus=pcie.0,id=ahci&quot; if [ -n &quot;$HDD&quot; ]; then STORAGE+=&quot; -drive file=$HDD,id=disk,format=raw -device ide-hd,bus=ahci.0,drive=disk&quot; fi if [ -n &quot;$CDROM&quot; ]; then STORAGE+=&quot; -drive file=$CDROM,id=isocd -device ide-cd,bus=ahci.1,drive=isocd&quot; fi fi if [ -n &quot;$CPU&quot; ]; then CPU=&quot;-cpu $CPU -smp $VCPUS,sockets=1,cores=$VCPUS,threads=1&quot; else CPU=&quot;-smp $VCPUS,sockets=1,cores=$VCPUS,threads=1&quot; fi if [ -n &quot;$BIOS&quot; ]; then BIOS=&quot; -bios $BIOS&quot; fi if $SND ; then SND=&quot;-device ich9-intel-hda,bus=pcie.0,addr=1b.0,id=sound0 -device hda-duplex,cad=0&quot; export $SND_DRIVER_OPTS else SND=&quot;&quot; fi if [ -n &quot;$MEM&quot; ]; then MEMORY+=&quot;-m $MEM&quot; if [ -n &quot;$MEM_PATH&quot; ]; then MEMORY+=&quot; -mem-prealloc -mem-path $MEM_PATH&quot; fi fi if [ -n &quot;$USB_DEVICES&quot; ]; then for u in $USB_DEVICES; do USB_DEV+=&quot; -usbdevice $u&quot; done fi $QEMU $BIOS $CPU $MEMORY $QEMU_ARGS $DEV $USB_DEV $NET $SND $STORAGE $EXTRA_ARGS echo &quot;All Done!!&quot;</code></pre></div><p>Still Windows7 has &quot;Intel(R) PRO/1000 MT-Networkconnection&quot;.<br />IP-Adress: 10.0.2.15<br />Subnet: 255.255.255.0<br />Gateway: 10.0.2.2<br />DHCP: 10.0.2.2<br />DNS: 10.0.2.3</p><p>Where is this coming from? The adress looks like the one I got from bridged network in virt-manager.</p><p>//Edit:<br />Unfortunately, I&#039;m getting a bluescreen with atikmpag.sys now everytime I try to boot the system <img src="https://bbs.archlinux.org/img/smilies/hmm.png" width="15" height="15" alt="hmm" /></p> <p class="postedit"><em>Last edited by Norcoen (2013-11-17 13:26:25)</em></p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1350670">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1350741" class="blockpost roweven"> <h2><span><span class="conr">#791</span> <a href="viewtopic.php?pid=1350741#p1350741">2013-11-17 16:40:15</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=76794">ilya80</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2013-11-12</span></dd> <dd><span>Posts: 34</span></dd> <dd class="usercontacts"><span class="email"><a href="misc.php?email=76794">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>Norcoen wrote:</cite><blockquote><div><p>Unfortunately, I&#039;m getting a bluescreen with atikmpag.sys now everytime I try to boot the system <img src="https://bbs.archlinux.org/img/smilies/hmm.png" width="15" height="15" alt="hmm" /></p></div></blockquote></div><p>&quot;I get a BSOD 0x00000116&#160; atikmpag.sys if i remove the ati driver, the VM work good but no graphique acceleration.<br />Edit: I found the problem to slove it juste put clear_emulator_capabilities=0 in qemu.conf&quot;</p><p>Is blue screen code the same? You could try this.</p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1350741">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1350762" class="blockpost rowodd"> <h2><span><span class="conr">#792</span> <a href="viewtopic.php?pid=1350762#p1350762">2013-11-17 17:35:59</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=73712">cmdr</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2013-08-01</span></dd> <dd><span>Posts: 8</span></dd> <dd class="usercontacts"><span class="email"><a href="misc.php?email=73712">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <p>Hi,<br />after playing around with my guest i still have 2 unsolved problems.<br />1. When i reboot the guest the screen stays black. I have to reboot the host to get the guest working again.<br />2. qemu does not show the pa or alsa driver hence sound is not working in the guest. (qemu-git PKGBUILD from first post, libpulse &amp; pulseaudio packages installed)</p><div class="codebox"><pre><code># qemu-system-x86_64 -audio-help | grep Name Name: oss Name: none Name: wav</code></pre></div><p>Maybe someone can help me fixing this? <img src="https://bbs.archlinux.org/img/smilies/big_smile.png" width="15" height="15" alt="big_smile" /></p><p>Thanks in advance!</p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1350762">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1350784" class="blockpost roweven"> <h2><span><span class="conr">#793</span> <a href="viewtopic.php?pid=1350784#p1350784">2013-11-17 19:03:14</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=76479">Norcoen</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>From: Norway</span></dd> <dd><span>Registered: 2013-11-02</span></dd> <dd><span>Posts: 23</span></dd> <dd class="usercontacts"><span class="email"><a href="mailto:frankmoll@gmx.net">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>ilya80 wrote:</cite><blockquote><div><p>&quot;I get a BSOD 0x00000116&#160; atikmpag.sys if i remove the ati driver, the VM work good but no graphique acceleration.<br />Edit: I found the problem to slove it juste put clear_emulator_capabilities=0 in qemu.conf&quot;</p><p>Is blue screen code the same? You could try this.</p></div></blockquote></div><p>Yes, I&#039;m getting this one:<br /><a href="http://pichoster.adbt2.ath.cx/viewpic/2013-11-17195947jpgeOvpEsU.jpg" rel="nofollow"><span class="postimg"><img src="http://pichoster.adbt2.ath.cx/viewpic/y/2013-11-17195947jpgeOvpEsU.jpg" alt="2013-11-17195947jpgeOvpEsU.jpg" /></span></a><br />Where is qemu.conf lcoated usually? Or do I have to create it manually?</p> <p class="postedit"><em>Last edited by Norcoen (2013-11-17 19:03:34)</em></p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1350784">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1350790" class="blockpost rowodd"> <h2><span><span class="conr">#794</span> <a href="viewtopic.php?pid=1350790#p1350790">2013-11-17 19:15:19</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=76794">ilya80</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2013-11-12</span></dd> <dd><span>Posts: 34</span></dd> <dd class="usercontacts"><span class="email"><a href="misc.php?email=76794">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>Norcoen wrote:</cite><blockquote><div><div class="quotebox"><cite>ilya80 wrote:</cite><blockquote><div><p>&quot;I get a BSOD 0x00000116&#160; atikmpag.sys if i remove the ati driver, the VM work good but no graphique acceleration.<br />Edit: I found the problem to slove it juste put clear_emulator_capabilities=0 in qemu.conf&quot;</p><p>Is blue screen code the same? You could try this.</p></div></blockquote></div><p>Yes, I&#039;m getting this one:<br /><a href="http://pichoster.adbt2.ath.cx/viewpic/2013-11-17195947jpgeOvpEsU.jpg" rel="nofollow">http://pichoster.adbt2.ath.cx/viewpic/y/2013-11-17195947jpgeOvpEsU.jpg</a><br />Where is qemu.conf lcoated usually? Or do I have to create it manually?</p></div></blockquote></div><p>Dude use google. Its in /etc/libvirt/qemu.conf usually.</p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1350790">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1350828" class="blockpost roweven"> <h2><span><span class="conr">#795</span> <a href="viewtopic.php?pid=1350828#p1350828">2013-11-17 20:50:09</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=76479">Norcoen</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>From: Norway</span></dd> <dd><span>Registered: 2013-11-02</span></dd> <dd><span>Posts: 23</span></dd> <dd class="usercontacts"><span class="email"><a href="mailto:frankmoll@gmx.net">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <p>Sorry, I was looking in /etc/qemu/, and it wasn&#039;t there, I forgot the connection to libvirtd.<br />I already have &quot;clear_emulator_capabilities=0&quot; in said qemu.conf, because before finding this board, I followed another tutorial and applied the last paragraph of this site:<br /><a href="http://fedoraproject.org/wiki/How_to_debug_Virtualization_problems#PCI_device_assignment" rel="nofollow">http://fedoraproject.org/wiki/How_to_de … assignment</a></p><p>So, I have the same bluescreen error, but your solution somehow does not apply for me <img src="https://bbs.archlinux.org/img/smilies/hmm.png" width="15" height="15" alt="hmm" /></p><p>//edit:<br />I found out, the qemu-git I built isn&#039;t looking in /etc/libvirt/ but in /etc/qemu, so I copied my qemu.conf to that location, now getting this error:</p><div class="codebox"><pre><code>qemu-system-x86_64:/etc/qemu/qemu.conf:198: no group defined</code></pre></div><p>Line 198 is</p><div class="codebox"><pre><code>user = &quot;root&quot;</code></pre></div><p>So I&#039;m stuck again...</p><p>//edit2:<br />I played around a bit with the config, and the seems to be around the group for the QEMU processes:</p><div class="codebox"><pre><code># The group for QEMU processes run by the system instance. It can be # specified in a similar way to user. group = &quot;root&quot;</code></pre></div><p>If I delete that line, I get a parser error, but if I set it to any group, root, my user, qemu, kvm, I just get the error above, that no group is defined.</p> <p class="postedit"><em>Last edited by Norcoen (2013-11-17 21:26:54)</em></p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1350828">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1350839" class="blockpost rowodd"> <h2><span><span class="conr">#796</span> <a href="viewtopic.php?pid=1350839#p1350839">2013-11-17 21:09:13</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=76766">mafferri</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2013-11-11</span></dd> <dd><span>Posts: 7</span></dd> <dd class="usercontacts"><span class="email"><a href="misc.php?email=76766">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>aw wrote:</cite><blockquote><div><p>I&#039;m not sure how this is going to help your performance though, it&#039;s pretty random whether re-loading the host driver is going to resolve anything that the guest driver can&#039;t.&#160; For graphics devices, if you&#039;re using kernel+qemu that support bus reset, that should provide something nearly as good as a host reboot.</p></div></blockquote></div><p>have the kernel 3.12.0-rc7<br />I do not know exactly what it was anyway because I did set the values of kvm and kvm-amd.<br />Solved in this way</p><br /><br /><p>/proc/cmdline</p><div class="quotebox"><blockquote><div><p>root=PARTUUID=F942477B-23BB-4880-A611-17B3CF4040A7 ro ivrs_ioapic[5]=00:14.0 acpi_sleep=s3_bios,s3_mode vfio_iommu_type1.allow_unsafe_interrupts=1 kvm.allow_unsafe_assigned_interrupts=1 kvm.ignore_msrs=1 kvm_amd.npt=1 pci-stub.ids=1002:6738,1002:aa88,1033:0194</p></div></blockquote></div><p>dmesg</p><div class="codebox"><pre><code>[ 6289.907200] kvm_get_msr_common: 70 callbacks suppressed [ 6289.907203] kvm [2383]: vcpu0 ignored rdmsr: 0xe8 [ 6289.907208] kvm [2383]: vcpu0 ignored rdmsr: 0xe7 [ 6289.911413] kvm [2383]: vcpu0 ignored rdmsr: 0xe8 [ 6289.911417] kvm [2383]: vcpu0 ignored rdmsr: 0xe7 [ 6289.969551] kvm [2383]: vcpu1 ignored rdmsr: 0xe8 [ 6289.969557] kvm [2383]: vcpu1 ignored rdmsr: 0xe7 [ 6289.973760] kvm [2383]: vcpu1 ignored rdmsr: 0xe8 [ 6289.973765] kvm [2383]: vcpu1 ignored rdmsr: 0xe7</code></pre></div><p>What could this message be?</p><br /><p>here&#039;s what starts libvirt</p><div class="quotebox"><blockquote><div><p>2013-11-17 17:31:32.777+0000: starting up<br />LC_ALL=C PATH=/bin:/sbin:/bin:/sbin:/usr/bin:/usr/sbin:/usr/bin:/usr/sbin:/usr/local/bin:/usr/local/sbin:/opt/bin:/usr/x86_64-pc-linux-gnu/gcc-bin/4.7.3 HOME=/root USER=root QEMU_AUDIO_DRV=none /usr/bin/qemu-system-x86_64 -name dcdcdcd,process=qemu:dcdcdcd -S -machine pc-q35-1.6,accel=kvm,usb=off,mem-merge=off -cpu host -m 3993 -realtime mlock=on -smp 2,sockets=1,cores=3,threads=1 -uuid 34bbd363-5c7a-9147-dff1-c04d90d335eb -nographic -no-user-config -nodefaults -chardev socket,id=charmonitor,path=/var/lib/libvirt/qemu/dcdcdcd.monitor,server,nowait -mon chardev=charmonitor,id=monitor,mode=control -rtc base=localtime -no-shutdown -no-acpi -boot order=dc,menu=on -device i82801b11-bridge,id=pci.1,bus=pcie.0,addr=0x2 -device pci-bridge,chassis_nr=2,id=pci.2,bus=pci.1,addr=0x1 -device piix3-usb-uhci,id=usb,bus=pci.2,addr=0x1 -drive file=/var/lib/libvirt/images/virtio-win-0.1-65.iso,if=none,id=drive-ide0-0-0,readonly=on,format=raw -device ide-cd,bus=ide.0,unit=0,drive=drive-ide0-0-0,id=ide0-0-0 -drive file=/dev/mapper/350014ee00384381d,if=none,id=drive-sata0-0-1,format=raw -device ide-hd,bus=ide.1,drive=drive-sata0-0-1,id=sata0-0-1 -netdev tap,fd=18,id=hostnet0,vhost=on,vhostfd=19 -device virtio-net-pci,netdev=hostnet0,id=net0,mac=52:54:00:58:63:38,bus=pci.2,addr=0x2 -device usb-host,hostbus=3,hostaddr=3,id=hostdev0 -device usb-host,hostbus=5,hostaddr=2,id=hostdev1 -device usb-host,hostbus=5,hostaddr=3,id=hostdev2 -bios /usr/share/seabios/bios.bin -vga none -device ioh3420,bus=pcie.0,addr=1c.0,multifunction=on,port=1,chassis=1,id=root.1 -device vfio-pci,host=06:00.0,bus=root.1,addr=00.0,multifunction=on,x-vga=on,rombar=0,romfile=/usr/share/qemu/vbios.rom -device vfio-pci,host=06:00.1,bus=root.1,addr=00.1 -device vfio-pci,host=04:00.0,bus=pcie.0 -device vfio-pci,host=05:00.0,bus=pcie.0 .<br />Domain id=3 is tainted: high-privileges<br />Domain id=3 is tainted: custom-argv<br />Domain id=3 is tainted: host-cpu</p></div></blockquote></div><p>I can not pass the usb3 controller, the host interfere but I think the drivers is vfio-pci<br />what I could try?</p><div class="codebox"><pre class="vscroll"><code>04:00.0 USB controller: NEC Corporation uPD720200 USB 3.0 Host Controller (rev 04) (prog-if 30 [XHCI]) Subsystem: Micro-Star International Co., Ltd. Device 7640 Control: I/O- Mem+ BusMaster+ SpecCycle- MemWINV- VGASnoop- ParErr- Stepping- SERR+ FastB2B- DisINTx+ Status: Cap+ 66MHz- UDF- FastB2B- ParErr- DEVSEL=fast &gt;TAbort- &lt;TAbort- &lt;MAbort- &gt;SERR- &lt;PERR- INTx- Latency: 0, Cache Line Size: 64 bytes Interrupt: pin A routed to IRQ 51 Region 0: Memory at f7300000 (64-bit, non-prefetchable) [size=8K] Capabilities: [50] Power Management version 3 Flags: PMEClk- DSI- D1- D2- AuxCurrent=375mA PME(D0+,D1-,D2-,D3hot+,D3cold+) Status: D0 NoSoftRst+ PME-Enable- DSel=0 DScale=0 PME- Capabilities: [70] MSI: Enable- Count=1/8 Maskable- 64bit+ Address: 0000000000000000 Data: 0000 Capabilities: [90] MSI-X: Enable+ Count=8 Masked- Vector table: BAR=0 offset=00001000 PBA: BAR=0 offset=00001080 Capabilities: [a0] Express (v2) Endpoint, MSI 00 DevCap: MaxPayload 128 bytes, PhantFunc 0, Latency L0s unlimited, L1 unlimited ExtTag- AttnBtn- AttnInd- PwrInd- RBE+ FLReset- DevCtl: Report errors: Correctable+ Non-Fatal+ Fatal+ Unsupported- RlxdOrd- ExtTag- PhantFunc- AuxPwr- NoSnoop- MaxPayload 128 bytes, MaxReadReq 512 bytes DevSta: CorrErr- UncorrErr- FatalErr- UnsuppReq- AuxPwr+ TransPend- LnkCap: Port #0, Speed 5GT/s, Width x1, ASPM L0s L1, Latency L0 &lt;4us, L1 unlimited ClockPM+ Surprise- LLActRep- BwNot- LnkCtl: ASPM Disabled; RCB 64 bytes Disabled- Retrain- CommClk+ ExtSynch- ClockPM- AutWidDis- BWInt- AutBWInt- LnkSta: Speed 5GT/s, Width x1, TrErr- Train- SlotClk+ DLActive- BWMgmt- ABWMgmt- DevCap2: Completion Timeout: Not Supported, TimeoutDis+, LTR+, OBFF Not Supported DevCtl2: Completion Timeout: 50us to 50ms, TimeoutDis-, LTR-, OBFF Disabled LnkCtl2: Target Link Speed: 5GT/s, EnterCompliance- SpeedDis- Transmit Margin: Normal Operating Range, EnterModifiedCompliance- ComplianceSOS- Compliance De-emphasis: -6dB LnkSta2: Current De-emphasis Level: -3.5dB, EqualizationComplete-, EqualizationPhase1- EqualizationPhase2-, EqualizationPhase3-, LinkEqualizationRequest- Capabilities: [100 v1] Advanced Error Reporting UESta: DLP- SDES- TLP- FCP- CmpltTO- CmpltAbrt- UnxCmplt- RxOF- MalfTLP- ECRC- UnsupReq- ACSViol- UEMsk: DLP- SDES- TLP- FCP- CmpltTO- CmpltAbrt- UnxCmplt- RxOF- MalfTLP- ECRC- UnsupReq- ACSViol- UESvrt: DLP+ SDES+ TLP- FCP+ CmpltTO- CmpltAbrt- UnxCmplt- RxOF+ MalfTLP+ ECRC- UnsupReq- ACSViol- CESta: RxErr- BadTLP- BadDLLP- Rollover- Timeout- NonFatalErr- CEMsk: RxErr- BadTLP- BadDLLP- Rollover- Timeout- NonFatalErr- AERCap: First Error Pointer: 00, GenCap- CGenEn- ChkCap- ChkEn- Capabilities: [140 v1] Device Serial Number ff-ff-ff-ff-ff-ff-ff-ff Capabilities: [150 v1] Latency Tolerance Reporting Max snoop latency: 0ns Max no snoop latency: 0ns Kernel driver in use: vfio-pci 05:00.0 USB controller: NEC Corporation uPD720200 USB 3.0 Host Controller (rev 04) (prog-if 30 [XHCI]) Subsystem: Micro-Star International Co., Ltd. Device 7640 Control: I/O- Mem+ BusMaster+ SpecCycle- MemWINV- VGASnoop- ParErr- Stepping- SERR+ FastB2B- DisINTx+ Status: Cap+ 66MHz- UDF- FastB2B- ParErr- DEVSEL=fast &gt;TAbort- &lt;TAbort- &lt;MAbort- &gt;SERR- &lt;PERR- INTx- Latency: 0, Cache Line Size: 64 bytes Interrupt: pin A routed to IRQ 50 Region 0: Memory at f7200000 (64-bit, non-prefetchable) [size=8K] Capabilities: [50] Power Management version 3 Flags: PMEClk- DSI- D1- D2- AuxCurrent=375mA PME(D0+,D1-,D2-,D3hot+,D3cold+) Status: D0 NoSoftRst+ PME-Enable- DSel=0 DScale=0 PME- Capabilities: [70] MSI: Enable- Count=1/8 Maskable- 64bit+ Address: 0000000000000000 Data: 0000 Capabilities: [90] MSI-X: Enable+ Count=8 Masked- Vector table: BAR=0 offset=00001000 PBA: BAR=0 offset=00001080 Capabilities: [a0] Express (v2) Endpoint, MSI 00 DevCap: MaxPayload 128 bytes, PhantFunc 0, Latency L0s unlimited, L1 unlimited ExtTag- AttnBtn- AttnInd- PwrInd- RBE+ FLReset- DevCtl: Report errors: Correctable+ Non-Fatal+ Fatal+ Unsupported- RlxdOrd- ExtTag- PhantFunc- AuxPwr- NoSnoop- MaxPayload 128 bytes, MaxReadReq 512 bytes DevSta: CorrErr- UncorrErr- FatalErr- UnsuppReq- AuxPwr+ TransPend- LnkCap: Port #0, Speed 5GT/s, Width x1, ASPM L0s L1, Latency L0 &lt;4us, L1 unlimited ClockPM+ Surprise- LLActRep- BwNot- LnkCtl: ASPM Disabled; RCB 64 bytes Disabled- Retrain- CommClk+ ExtSynch- ClockPM- AutWidDis- BWInt- AutBWInt- LnkSta: Speed 5GT/s, Width x1, TrErr- Train- SlotClk+ DLActive- BWMgmt- ABWMgmt- DevCap2: Completion Timeout: Not Supported, TimeoutDis+, LTR+, OBFF Not Supported DevCtl2: Completion Timeout: 50us to 50ms, TimeoutDis-, LTR-, OBFF Disabled LnkCtl2: Target Link Speed: 5GT/s, EnterCompliance- SpeedDis- Transmit Margin: Normal Operating Range, EnterModifiedCompliance- ComplianceSOS- Compliance De-emphasis: -6dB LnkSta2: Current De-emphasis Level: -3.5dB, EqualizationComplete-, EqualizationPhase1- EqualizationPhase2-, EqualizationPhase3-, LinkEqualizationRequest- Capabilities: [100 v1] Advanced Error Reporting UESta: DLP- SDES- TLP- FCP- CmpltTO- CmpltAbrt- UnxCmplt- RxOF- MalfTLP- ECRC- UnsupReq- ACSViol- UEMsk: DLP- SDES- TLP- FCP- CmpltTO- CmpltAbrt- UnxCmplt- RxOF- MalfTLP- ECRC- UnsupReq- ACSViol- UESvrt: DLP+ SDES+ TLP- FCP+ CmpltTO- CmpltAbrt- UnxCmplt- RxOF+ MalfTLP+ ECRC- UnsupReq- ACSViol- CESta: RxErr- BadTLP- BadDLLP- Rollover- Timeout- NonFatalErr- CEMsk: RxErr- BadTLP- BadDLLP- Rollover- Timeout- NonFatalErr- AERCap: First Error Pointer: 00, GenCap- CGenEn- ChkCap- ChkEn- Capabilities: [140 v1] Device Serial Number ff-ff-ff-ff-ff-ff-ff-ff Capabilities: [150 v1] Latency Tolerance Reporting Max snoop latency: 0ns Max no snoop latency: 0ns Kernel driver in use: vfio-pci</code></pre></div><br /><p>00:00.0 Host bridge should be using a driver?</p><div class="codebox"><pre class="vscroll"><code>00:00.0 Host bridge: Advanced Micro Devices [AMD] nee ATI RD890 PCI to PCI bridge (external gfx0 port B) (rev 02) Subsystem: Micro-Star International Co., Ltd. Device 7640 Control: I/O- Mem+ BusMaster- SpecCycle- MemWINV- VGASnoop- ParErr- Stepping- SERR- FastB2B- DisINTx- Status: Cap+ 66MHz- UDF- FastB2B- ParErr- DEVSEL=fast &gt;TAbort- &lt;TAbort- &lt;MAbort+ &gt;SERR- &lt;PERR- INTx- Capabilities: [f0] HyperTransport: MSI Mapping Enable+ Fixed+ Capabilities: [c4] HyperTransport: Slave or Primary Interface Command: BaseUnitID=0 UnitCnt=20 MastHost- DefDir- DUL- Link Control 0: CFlE- CST- CFE- &lt;LkFail- Init+ EOC- TXO- &lt;CRCErr=0 IsocEn- LSEn- ExtCTL- 64b+ Link Config 0: MLWI=16bit DwFcIn- MLWO=16bit DwFcOut- LWI=16bit DwFcInEn- LWO=16bit DwFcOutEn- Link Control 1: CFlE- CST- CFE- &lt;LkFail+ Init- EOC+ TXO+ &lt;CRCErr=0 IsocEn- LSEn- ExtCTL- 64b- Link Config 1: MLWI=8bit DwFcIn- MLWO=8bit DwFcOut- LWI=8bit DwFcInEn- LWO=8bit DwFcOutEn- Revision ID: 3.00 Link Frequency 0: [c] Link Error 0: &lt;Prot- &lt;Ovfl- &lt;EOC- CTLTm- Link Frequency Capability 0: 200MHz+ 300MHz- 400MHz+ 500MHz- 600MHz+ 800MHz+ 1.0GHz+ 1.2GHz+ 1.4GHz- 1.6GHz- Vend- Feature Capability: IsocFC+ LDTSTOP+ CRCTM- ECTLT- 64bA+ UIDRD- Link Frequency 1: 200MHz Link Error 1: &lt;Prot- &lt;Ovfl- &lt;EOC- CTLTm- Link Frequency Capability 1: 200MHz- 300MHz- 400MHz- 500MHz- 600MHz- 800MHz- 1.0GHz- 1.2GHz- 1.4GHz- 1.6GHz- Vend- Error Handling: PFlE- OFlE- PFE- OFE- EOCFE- RFE- CRCFE- SERRFE- CF- RE- PNFE- ONFE- EOCNFE- RNFE- CRCNFE- SERRNFE- Prefetchable memory behind bridge Upper: 00-00 Bus Number: 00 Capabilities: [40] HyperTransport: Retry Mode Capabilities: [54] HyperTransport: UnitID Clumping Capabilities: [9c] HyperTransport: #1a Capabilities: [70] MSI: Enable- Count=1/4 Maskable- 64bit- Address: 00000000 Data: 0000 00:00.2 IOMMU: Advanced Micro Devices [AMD] nee ATI RD990 I/O Memory Management Unit (IOMMU) Subsystem: Micro-Star International Co., Ltd. Device 7640 Control: I/O- Mem- BusMaster- SpecCycle- MemWINV- VGASnoop- ParErr- Stepping- SERR- FastB2B- DisINTx+ Status: Cap+ 66MHz- UDF- FastB2B- ParErr- DEVSEL=fast &gt;TAbort- &lt;TAbort- &lt;MAbort- &gt;SERR- &lt;PERR- INTx- Interrupt: pin A routed to IRQ 72 Capabilities: [40] Secure device &lt;?&gt; Capabilities: [54] MSI: Enable+ Count=1/1 Maskable- 64bit+ Address: 00000000fee0f00c Data: 41a1 Capabilities: [64] HyperTransport: MSI Mapping Enable+ Fixed+ 00:02.0 PCI bridge: Advanced Micro Devices [AMD] nee ATI RD890 PCI to PCI bridge (PCI express gpp port B) (prog-if 00 [Normal decode]) Control: I/O+ Mem+ BusMaster+ SpecCycle- MemWINV- VGASnoop- ParErr- Stepping- SERR- FastB2B- DisINTx- Status: Cap+ 66MHz- UDF- FastB2B- ParErr- DEVSEL=fast &gt;TAbort- &lt;TAbort- &lt;MAbort- &gt;SERR- &lt;PERR- INTx- Latency: 0, Cache Line Size: 64 bytes Bus: primary=00, secondary=01, subordinate=01, sec-latency=0 I/O behind bridge: 0000e000-0000efff Memory behind bridge: f4000000-f70fffff Prefetchable memory behind bridge: 00000000d0000000-00000000dfffffff Secondary status: 66MHz- FastB2B- ParErr- DEVSEL=fast &gt;TAbort- &lt;TAbort- &lt;MAbort- &lt;SERR- &lt;PERR- BridgeCtl: Parity- SERR- NoISA- VGA+ MAbort- &gt;Reset- FastB2B- PriDiscTmr- SecDiscTmr- DiscTmrStat- DiscTmrSERREn- Capabilities: [50] Power Management version 3 Flags: PMEClk- DSI- D1- D2- AuxCurrent=0mA PME(D0+,D1-,D2-,D3hot+,D3cold+) Status: D0 NoSoftRst- PME-Enable- DSel=0 DScale=0 PME- Capabilities: [58] Express (v2) Root Port (Slot+), MSI 00 DevCap: MaxPayload 128 bytes, PhantFunc 0, Latency L0s &lt;64ns, L1 &lt;1us ExtTag+ RBE+ FLReset- DevCtl: Report errors: Correctable- Non-Fatal- Fatal- Unsupported- RlxdOrd- ExtTag- PhantFunc- AuxPwr- NoSnoop+ MaxPayload 128 bytes, MaxReadReq 128 bytes DevSta: CorrErr- UncorrErr- FatalErr- UnsuppReq- AuxPwr- TransPend- LnkCap: Port #0, Speed 5GT/s, Width x16, ASPM L0s L1, Latency L0 &lt;1us, L1 &lt;8us ClockPM- Surprise- LLActRep+ BwNot+ LnkCtl: ASPM Disabled; RCB 64 bytes Disabled- Retrain- CommClk+ ExtSynch- ClockPM- AutWidDis- BWInt- AutBWInt- LnkSta: Speed 2.5GT/s, Width x16, TrErr- Train- SlotClk+ DLActive+ BWMgmt+ ABWMgmt- SltCap: AttnBtn- PwrCtrl- MRL- AttnInd- PwrInd- HotPlug- Surprise- Slot #2, PowerLimit 75.000W; Interlock- NoCompl+ SltCtl: Enable: AttnBtn- PwrFlt- MRL- PresDet- CmdCplt- HPIrq- LinkChg- Control: AttnInd Unknown, PwrInd Unknown, Power- Interlock- SltSta: Status: AttnBtn- PowerFlt- MRL- CmdCplt- PresDet+ Interlock- Changed: MRL- PresDet- LinkState- RootCtl: ErrCorrectable- ErrNon-Fatal- ErrFatal- PMEIntEna- CRSVisible- RootCap: CRSVisible- RootSta: PME ReqID 0000, PMEStatus- PMEPending- DevCap2: Completion Timeout: Range ABCD, TimeoutDis+, LTR-, OBFF Not Supported ARIFwd+ DevCtl2: Completion Timeout: 65ms to 210ms, TimeoutDis-, LTR-, OBFF Disabled ARIFwd- LnkCtl2: Target Link Speed: 5GT/s, EnterCompliance- SpeedDis- Transmit Margin: Normal Operating Range, EnterModifiedCompliance- ComplianceSOS- Compliance De-emphasis: -6dB LnkSta2: Current De-emphasis Level: -3.5dB, EqualizationComplete-, EqualizationPhase1- EqualizationPhase2-, EqualizationPhase3-, LinkEqualizationRequest- Capabilities: [a0] MSI: Enable- Count=1/1 Maskable- 64bit- Address: 00000000 Data: 0000 Capabilities: [b0] Subsystem: Micro-Star International Co., Ltd. Device 7640 Capabilities: [b8] HyperTransport: MSI Mapping Enable+ Fixed+ Capabilities: [100 v1] Vendor Specific Information: ID=0001 Rev=1 Len=010 &lt;?&gt; Capabilities: [190 v1] Access Control Services ACSCap: SrcValid+ TransBlk+ ReqRedir+ CmpltRedir+ UpstreamFwd+ EgressCtrl- DirectTrans+ ACSCtl: SrcValid+ TransBlk- ReqRedir+ CmpltRedir+ UpstreamFwd+ EgressCtrl- DirectTrans- Kernel driver in use: pcieport</code></pre></div><p>libvirt dom</p><div class="codebox"><pre class="vscroll"><code>&lt;domain type=&#039;kvm&#039; xmlns:qemu=&#039;http://libvirt.org/schemas/domain/qemu/1.0&#039;&gt; &lt;name&gt;dcdcdcd&lt;/name&gt; &lt;uuid&gt;34bbd363-5c7a-9147-dff1-c04d90d335eb&lt;/uuid&gt; &lt;memory unit=&#039;KiB&#039;&gt;4088608&lt;/memory&gt; &lt;currentMemory unit=&#039;KiB&#039;&gt;4088608&lt;/currentMemory&gt; &lt;memoryBacking&gt; &lt;nosharepages/&gt; &lt;locked/&gt; &lt;/memoryBacking&gt; &lt;vcpu placement=&#039;static&#039;&gt;2&lt;/vcpu&gt; &lt;cputune&gt; &lt;vcpupin vcpu=&#039;0&#039; cpuset=&#039;2&#039;/&gt; &lt;vcpupin vcpu=&#039;1&#039; cpuset=&#039;1&#039;/&gt; &lt;emulatorpin cpuset=&#039;0-1,2-3&#039;/&gt; &lt;/cputune&gt; &lt;resource&gt; &lt;partition&gt;/machine&lt;/partition&gt; &lt;/resource&gt; &lt;os&gt; &lt;type arch=&#039;x86_64&#039; machine=&#039;pc-q35-1.6&#039;&gt;hvm&lt;/type&gt; &lt;boot dev=&#039;cdrom&#039;/&gt; &lt;boot dev=&#039;hd&#039;/&gt; &lt;bootmenu enable=&#039;yes&#039;/&gt; &lt;/os&gt; &lt;cpu mode=&#039;host-passthrough&#039;&gt; &lt;topology sockets=&#039;1&#039; cores=&#039;3&#039; threads=&#039;1&#039;/&gt; &lt;/cpu&gt; &lt;clock offset=&#039;localtime&#039;/&gt; &lt;on_poweroff&gt;destroy&lt;/on_poweroff&gt; &lt;on_reboot&gt;restart&lt;/on_reboot&gt; &lt;on_crash&gt;destroy&lt;/on_crash&gt; &lt;devices&gt; &lt;emulator&gt;/usr/bin/qemu-system-x86_64&lt;/emulator&gt; &lt;disk type=&#039;file&#039; device=&#039;cdrom&#039;&gt; &lt;driver name=&#039;qemu&#039; type=&#039;raw&#039;/&gt; &lt;source file=&#039;/var/lib/libvirt/images/virtio-win-0.1-65.iso&#039;/&gt; &lt;target dev=&#039;vda&#039; bus=&#039;ide&#039;/&gt; &lt;alias name=&#039;virtio-disk0&#039;/&gt; &lt;address type=&#039;drive&#039; controller=&#039;0&#039; bus=&#039;0&#039; target=&#039;0&#039; unit=&#039;0&#039;/&gt; &lt;/disk&gt; &lt;disk type=&#039;block&#039; device=&#039;disk&#039;&gt; &lt;driver name=&#039;qemu&#039; type=&#039;raw&#039;/&gt; &lt;source dev=&#039;/dev/mapper/350014ee00384381d&#039;/&gt; &lt;target dev=&#039;vdb&#039; bus=&#039;sata&#039;/&gt; &lt;alias name=&#039;virtio-disk1&#039;/&gt; &lt;/disk&gt; &lt;controller type=&#039;sata&#039; index=&#039;0&#039;&gt; &lt;alias name=&#039;sata0&#039;/&gt; &lt;address type=&#039;pci&#039; domain=&#039;0x0000&#039; bus=&#039;0x00&#039; slot=&#039;0x1f&#039; function=&#039;0x2&#039;/&gt; &lt;/controller&gt; &lt;controller type=&#039;pci&#039; index=&#039;0&#039; model=&#039;pcie-root&#039;&gt; &lt;alias name=&#039;pcie.0&#039;/&gt; &lt;/controller&gt; &lt;controller type=&#039;pci&#039; index=&#039;1&#039; model=&#039;dmi-to-pci-bridge&#039;&gt; &lt;alias name=&#039;pci.1&#039;/&gt; &lt;address type=&#039;pci&#039; domain=&#039;0x0000&#039; bus=&#039;0x00&#039; slot=&#039;0x02&#039; function=&#039;0x0&#039;/&gt; &lt;/controller&gt; &lt;controller type=&#039;pci&#039; index=&#039;2&#039; model=&#039;pci-bridge&#039;&gt; &lt;alias name=&#039;pci.2&#039;/&gt; &lt;address type=&#039;pci&#039; domain=&#039;0x0000&#039; bus=&#039;0x01&#039; slot=&#039;0x01&#039; function=&#039;0x0&#039;/&gt; &lt;/controller&gt; &lt;controller type=&#039;usb&#039; index=&#039;0&#039;&gt; &lt;address type=&#039;pci&#039; domain=&#039;0x0000&#039; bus=&#039;0x02&#039; slot=&#039;0x01&#039; function=&#039;0x0&#039;/&gt; &lt;/controller&gt; &lt;hostdev mode=&#039;subsystem&#039; type=&#039;usb&#039; managed=&#039;yes&#039;&gt; &lt;source&gt; &lt;vendor id=&#039;0x1b1c&#039;/&gt; &lt;product id=&#039;0x1ab1&#039;/&gt; &lt;/source&gt; &lt;/hostdev&gt; &lt;hostdev mode=&#039;subsystem&#039; type=&#039;usb&#039; managed=&#039;yes&#039;&gt; &lt;source&gt; &lt;vendor id=&#039;0x04d9&#039;/&gt; &lt;product id=&#039;0x1702&#039;/&gt; &lt;/source&gt; &lt;/hostdev&gt; &lt;hostdev mode=&#039;subsystem&#039; type=&#039;usb&#039; managed=&#039;yes&#039;&gt; &lt;source&gt; &lt;vendor id=&#039;0x192f&#039;/&gt; &lt;product id=&#039;0x0416&#039;/&gt; &lt;/source&gt; &lt;/hostdev&gt; &lt;interface type=&#039;network&#039;&gt; &lt;mac address=&#039;52:54:00:58:63:38&#039;/&gt; &lt;source network=&#039;default&#039;/&gt; &lt;model type=&#039;virtio&#039;/&gt; &lt;address type=&#039;pci&#039; domain=&#039;0x0000&#039; bus=&#039;0x02&#039; slot=&#039;0x02&#039; function=&#039;0x0&#039;/&gt; &lt;/interface&gt; &lt;controller type=&#039;ide&#039; index=&#039;0&#039;/&gt; &lt;memballoon model=&#039;none&#039;&gt; &lt;alias name=&#039;balloon0&#039;/&gt; &lt;/memballoon&gt; &lt;/devices&gt; &lt;seclabel type=&#039;none&#039;/&gt; &lt;qemu:commandline&gt; &lt;qemu:arg value=&#039;-bios&#039;/&gt; &lt;qemu:arg value=&#039;/usr/share/seabios/bios.bin&#039;/&gt; &lt;qemu:arg value=&#039;-vga&#039;/&gt; &lt;qemu:arg value=&#039;none&#039;/&gt; &lt;qemu:arg value=&#039;-device&#039;/&gt; &lt;qemu:arg value=&#039;ioh3420,bus=pcie.0,addr=1c.0,multifunction=on,port=1,chassis=1,id=root.1&#039;/&gt; &lt;qemu:arg value=&#039;-device&#039;/&gt; &lt;qemu:arg value=&#039;vfio-pci,host=06:00.0,bus=root.1,addr=00.0,multifunction=on,x-vga=on,rombar=0,romfile=/usr/share/qemu/vbios.rom&#039;/&gt; &lt;qemu:arg value=&#039;-device&#039;/&gt; &lt;qemu:arg value=&#039;vfio-pci,host=06:00.1,bus=root.1,addr=00.1&#039;/&gt; &lt;qemu:arg value=&#039;-device&#039;/&gt; &lt;qemu:arg value=&#039;vfio-pci,host=04:00.0,bus=pcie.0&#039;/&gt; &lt;qemu:arg value=&#039;-device&#039;/&gt; &lt;qemu:arg value=&#039;vfio-pci,host=05:00.0,bus=pcie.0&#039;/&gt; &lt;/qemu:commandline&gt; &lt;/domain&gt;</code></pre></div><br /><p>another question I try to pass the sound card but does not feel good</p> <p class="postedit"><em>Last edited by mafferri (2013-11-18 00:27:23)</em></p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1350839">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1351232" class="blockpost roweven"> <h2><span><span class="conr">#797</span> <a href="viewtopic.php?pid=1351232#p1351232">2013-11-18 20:27:58</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=73990">juhe</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2013-08-10</span></dd> <dd><span>Posts: 2</span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <p>Just wanted to let you know I was able to get the thing working on following HW configurations:</p><p>AMD Platform:</p><ul><li><p>Motherboard: SABERTOOTH 990FX R20 (BIOS rev. 2005)</p></li><li><p>CPU: AMD FX-8350 @4Ghz </p></li><li><p>Primary VGA: Radeon HD 5850</p></li><li><p>Secondary (passed through) VGA: Radeon HD 7870</p></li></ul><p>Intel Platform:</p><ul><li><p>Motherboard: P9X79 DELUXE (BIOS rev. 4502)</p></li><li><p>CPU: Intel i7-3930K</p></li><li><p>Primary VGA: Radeon HD 6670</p></li><li><p>Secondary (passed through) VGA: Radeon HD 7850</p></li></ul><p>Both platform have also passed one internal USB HUB for keyboard / mouse and internal Intel HDA audio for sound. Network and disk use virtio interface.</p><p>Host OS (on both machines) is Archlinux with recent stock 3.12 kernel, qemu (1.7.r29424.g964668b) and seabios (1.7.3.2) from <em>nbhs&#039;</em> first post.</p><p>AMD platform worked basically out of the box, because <em>nbhs</em> has very similar setup (chipset is the same).&#160; Intel, however, was a bit tougher to get working because of Catalyst 13.9 atikmpag.sys&#039; code 116 BSOD which was finally solved thanks to recent posts from <em>aw</em> and <em>gentoo-nut</em> by simply ommiting the HDMI Audio completely (or adding it to pcie.0 bus works as well).</p><p>I would like to Thank <em>nbhs</em>, <em>aw</em> and all you guys who share the information about setups, related issues and their solutions on this thread.&#160; I wouldn&#039;t be able to get the thing working without you :-).</p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1351232">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1351243" class="blockpost rowodd"> <h2><span><span class="conr">#798</span> <a href="viewtopic.php?pid=1351243#p1351243">2013-11-18 21:20:51</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=76794">ilya80</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2013-11-12</span></dd> <dd><span>Posts: 34</span></dd> <dd class="usercontacts"><span class="email"><a href="misc.php?email=76794">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>juhe wrote:</cite><blockquote><div><p>Just wanted to let you know I was able to get the thing working</p></div></blockquote></div><p>Congrats! I envy you <img src="https://bbs.archlinux.org/img/smilies/smile.png" width="15" height="15" alt="smile" /></p><div class="quotebox"><cite>juhe wrote:</cite><blockquote><div><p>CPU: Intel i7-3930K</p></div></blockquote></div><p>Are you sure that was a K model? Those are not supposed to have VT-d.</p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1351243">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1351248" class="blockpost roweven"> <h2><span><span class="conr">#799</span> <a href="viewtopic.php?pid=1351248#p1351248">2013-11-18 21:37:00</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=75590">aw</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2013-10-04</span></dd> <dd><span>Posts: 921</span></dd> <dd class="usercontacts"><span class="email"><a href="misc.php?email=75590">Email</a></span> <span class="website"><a href="http://vfio.blogspot.com/" rel="nofollow">Website</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>ilya80 wrote:</cite><blockquote><div><div class="quotebox"><cite>juhe wrote:</cite><blockquote><div><p>CPU: Intel i7-3930K</p></div></blockquote></div><p>Are you sure that was a K model? Those are not supposed to have VT-d.</p></div></blockquote></div><p>Never assume you&#039;ve figured out Intel&#039;s naming convention:</p><p><a href="http://ark.intel.com/products/63697/Intel-Core-i7-3930K-Processor-12M-Cache-up-to-3_80-GHz?q=3930" rel="nofollow">http://ark.intel.com/products/63697/Int … GHz?q=3930</a></p><p>VT-d: yes</p> </div> <div class="postsignature postmsg"><hr /><p><a href="http://vfio.blogspot.com" rel="nofollow">http://vfio.blogspot.com</a><br />Looking for a more open forum to discuss vfio related uses?&#160; Try <a href="https://www.redhat.com/mailman/listinfo/vfio-users" rel="nofollow">https://www.redhat.com/mailman/listinfo/vfio-users</a></p></div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1351248">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1351375" class="blockpost rowodd"> <h2><span><span class="conr">#800</span> <a href="viewtopic.php?pid=1351375#p1351375">2013-11-19 07:24:40</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=77014">mangobot</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2013-11-19</span></dd> <dd><span>Posts: 1</span></dd> <dd class="usercontacts"><span class="email"><a href="misc.php?email=77014">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <p>Hey guys,</p><p>Thanks for the awesome writeup. My basic hardware is:</p><p>cpu: amd FX-6300<br />gpu: amd 7970<br />mb: ASUS M5A99FX PRO R2.0 (2005 bios)</p><p>I previously used this walkthrough to set up fully working passthrough using two graphics cards (using the 7970 as secondary and a really basic ati card as primary), but I just managed to get it working on my primary card alone, using pci_stub. <img src="https://bbs.archlinux.org/img/smilies/smile.png" width="15" height="15" alt="smile" /> I do see boot graphics and console output from the gfx card (I run all my monitors off of it), but when I run qemu it seems to switch over fine.<br />I hadn&#039;t seen much success with this/had heard a lot about primary passthrough not being possible, but since I&#039;m looking at it, I thought I&#039;d throw my experience into the ring. Now I have more space in my box so I can avoid the Realtek ethernet card!</p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1351375">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div class="postlinksb"> <div class="inbox crumbsplus"> <div class="pagepost"> <p class="pagelink conl"><span class="pages-label">Pages: </span><a rel="prev" class="item1" href="viewtopic.php?id=162768&amp;p=31">Previous</a> <a href="viewtopic.php?id=162768">1</a> <span class="spacer">…</span> <a href="viewtopic.php?id=162768&amp;p=30">30</a> <a href="viewtopic.php?id=162768&amp;p=31">31</a> <strong>32</strong> <a href="viewtopic.php?id=162768&amp;p=33">33</a> <a href="viewtopic.php?id=162768&amp;p=34">34</a> <span class="spacer">…</span> <a href="viewtopic.php?id=162768&amp;p=234">234</a> <a rel="next" href="viewtopic.php?id=162768&amp;p=33">Next</a></p> <p class="postlink conr">Topic closed</p> </div> <ul class="crumbs"> <li><a href="index.php">Index</a></li> <li><span>»&#160;</span><a href="viewforum.php?id=48">Topics Going Nowhere</a></li> <li><span>»&#160;</span><strong><a href="viewtopic.php?id=162768">KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</a></strong></li> </ul> <p class="subscribelink clearb"><a href="misc.php?action=subscribe&amp;tid=162768">Subscribe to this topic</a></p> <div class="clearer"></div> </div> </div> </div> <div id="brdfooter" class="block"> <h2><span>Board footer</span></h2> <div class="box"> <div id="brdfooternav" class="inbox"> <div class="conl"> <form id="qjump" method="get" action="viewforum.php"> <div><label><span>Jump to<br /></span> <select name="id" onchange="window.location=('viewforum.php?id='+this.options[this.selectedIndex].value)"> <optgroup label="Technical Issues and Assistance"> <option value="23">Newbie Corner</option> <option value="17">Installation</option> <option value="22">Kernel &amp; Hardware</option> <option value="18">Applications &amp; Desktop Environments</option> <option value="31">Laptop Issues</option> <option value="8">Networking, Server, and Protection</option> <option value="32">Multimedia and Games</option> <option value="50">System Administration</option> <option value="35">Other Architectures</option> </optgroup> <optgroup label="Arch-centric"> <option value="24">Announcements, Package &amp; Security Advisories</option> <option value="1">Arch Discussion</option> <option value="13">Forum &amp; Wiki discussion</option> </optgroup> <optgroup label="Pacman Upgrades, Packaging &amp; AUR"> <option value="44">Pacman &amp; Package Upgrade Issues</option> <option value="49">[testing] Repo Forum</option> <option value="4">Creating &amp; Modifying Packages</option> <option value="38">AUR Issues, Discussion &amp; PKGBUILD Requests</option> </optgroup> <optgroup label="Contributions &amp; Discussion"> <option value="20">GNU/Linux Discussion</option> <option value="27">Community Contributions</option> <option value="33">Programming &amp; Scripting</option> <option value="30">Other Languages</option> <option value="47">Artwork and Screenshots</option> <option value="42">Try This</option> </optgroup> <optgroup label="/dev/null"> <option value="29">Off-Topic</option> <option value="48" selected="selected">Topics Going Nowhere</option> <option value="36">Dustbin</option> </optgroup> </select></label> <input type="submit" value=" Go " accesskey="g" /> </div> </form> </div> <div class="conr"> <p id="feedlinks"><span class="atom"><a href="extern.php?action=feed&amp;tid=162768&amp;type=atom">Atom topic feed</a></span></p> <p id="poweredby">Powered by <a href="http://fluxbb.org/">FluxBB</a></p> </div> <div class="clearer"></div> </div> </div> </div> </div> <div class="end-box"></div> </div> </body> </html>
