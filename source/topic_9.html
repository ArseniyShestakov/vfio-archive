<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"> <html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en" dir="ltr"> <head> <meta http-equiv="Content-Type" content="text/html; charset=utf-8" /> <title>KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9 (Page 9) / Topics Going Nowhere / Arch Linux Forums</title> <link rel="stylesheet" type="text/css" href="style/ArchLinux.css" /> <link rel="canonical" href="viewtopic.php?id=162768&amp;p=9" title="Page 9" /> <link rel="prev" href="viewtopic.php?id=162768&amp;p=8" title="Page 8" /> <link rel="next" href="viewtopic.php?id=162768&amp;p=10" title="Page 10" /> <link rel="alternate" type="application/atom+xml" href="extern.php?action=feed&amp;tid=162768&amp;type=atom" title="Atom topic feed" /> <link rel="stylesheet" media="screen" href="style/ArchLinux/arch.css?v=3" /> <link rel="stylesheet" media="screen" href="style/ArchLinux/archnavbar.css?v=2" /> <link rel="shortcut icon" href="style/ArchLinux/favicon.ico" /> </head> <body> <div id="archnavbar" class="anb-forum"> <div id="archnavbarlogo"><h1><a href="http://www.archlinux.org/">Arch Linux</a></h1></div> <div id="archnavbarmenu"> <ul id="archnavbarlist"> <li id="anb-home"><a href="http://www.archlinux.org/">Home</a></li><li id="anb-packages"><a href="http://www.archlinux.org/packages/">Packages</a></li><li id="anb-forums" class="anb-selected"><a href="https://bbs.archlinux.org/">Forums</a></li><li id="anb-wiki"><a href="https://wiki.archlinux.org/">Wiki</a></li><li id="anb-bugs"><a href="https://bugs.archlinux.org/">Bugs</a></li><li id="anb-aur"><a href="https://aur.archlinux.org/">AUR</a></li><li id="anb-download"><a href="http://www.archlinux.org/download/">Download</a></li> </ul> </div> </div> <div id="punviewtopic" class="pun"> <div class="top-box"></div> <div class="punwrap"> <div id="brdheader" class="block"> <div class="box"> <div id="brdmenu" class="inbox"> <ul> <li id="navindex" class="isactive"><a href="index.php">Index</a></li> <li id="navuserlist"><a href="userlist.php">User list</a></li> <li id="navsearch"><a href="search.php">Search</a></li> <li id="navprofile"><a href="profile.php?id=80749">Profile</a></li> <li id="navlogout"><a href="login.php?action=out&amp;id=80749&amp;csrf_token=5c20501ec397bb45ef8ee8c84db232c8d8e421c6">Logout</a></li> </ul> </div> <div id="brdwelcome" class="inbox"> <ul class="conl"> <li><span>Logged in as <strong>SXX</strong></span></li> <li><span>Last visit: 2015-08-16 12:20:09</span></li> </ul> <ul class="conr"> <li><span>Topics: <a href="search.php?action=show_replies" title="Find topics you have posted to.">Posted</a> | <a href="search.php?action=show_new" title="Find topics with new posts since your last visit.">New</a> | <a href="search.php?action=show_recent" title="Find topics with recent posts.">Active</a> | <a href="search.php?action=show_unanswered" title="Find topics with no replies.">Unanswered</a></span></li> </ul> <div class="clearer"></div> </div> </div> </div> <div id="brdmain"> <div class="linkst"> <div class="inbox crumbsplus"> <ul class="crumbs"> <li><a href="index.php">Index</a></li> <li><span>»&#160;</span><a href="viewforum.php?id=48">Topics Going Nowhere</a></li> <li><span>»&#160;</span><strong><a href="viewtopic.php?id=162768">KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</a></strong></li> </ul> <div class="pagepost"> <p class="pagelink conl"><span class="pages-label">Pages: </span><a rel="prev" class="item1" href="viewtopic.php?id=162768&amp;p=8">Previous</a> <a href="viewtopic.php?id=162768">1</a> <span class="spacer">…</span> <a href="viewtopic.php?id=162768&amp;p=7">7</a> <a href="viewtopic.php?id=162768&amp;p=8">8</a> <strong>9</strong> <a href="viewtopic.php?id=162768&amp;p=10">10</a> <a href="viewtopic.php?id=162768&amp;p=11">11</a> <span class="spacer">…</span> <a href="viewtopic.php?id=162768&amp;p=234">234</a> <a rel="next" href="viewtopic.php?id=162768&amp;p=10">Next</a></p> <p class="postlink conr">Topic closed</p> </div> <div class="clearer"></div> </div> </div> <div id="p1295823" class="blockpost rowodd blockpost1"> <h2><span><span class="conr">#201</span> <a href="viewtopic.php?pid=1295823#p1295823">2013-07-03 14:04:15</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=53621">teekay</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2011-10-26</span></dd> <dd><span>Posts: 267</span></dd> <dd class="usercontacts"><span class="email"><a href="misc.php?email=53621">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>andy123 wrote:</cite><blockquote><div><p>Hi,<br />I use a setup with KVM switch and it&#039;s not that complicated, assuming you have multiple usb controllers on your mainboard (are there boards that don&#039;t?). You simply have to pass one through to the guest as a PCI device. The host will ignore the input on those, since it doesn&#039;t load a driver for it and it&#039;ll appear as a normal usb controller to the guest.<br />I don&#039;t thik I get what you mean by &quot;usual KVM VNC window&quot;, so no idea about that one.<br />I hope this helps…</p></div></blockquote></div><p>With the KVM VNC window stuff I mean the classical way of having a window with the VM running in it, and switching the input between host and guest by moving the mouse over the window border, or pressing ctrl+alt - something like that.<br />But forget about it. A KVM switch is the way to go I guess.</p><p>Your idea of picking one of the motherboard&#039;s USB controllers is great, just a matter of finding out if the 8 ports on the backpanel all use the same controller or multiple<br />Thanks!</p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1295823">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1295829" class="blockpost roweven"> <h2><span><span class="conr">#202</span> <a href="viewtopic.php?pid=1295829#p1295829">2013-07-03 14:14:00</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=53953">andy123</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2011-11-04</span></dd> <dd><span>Posts: 169</span></dd> <dd class="usercontacts"><span class="email"><a href="misc.php?email=53953">Email</a></span> <span class="website"><a href="http://ajs124.de" rel="nofollow">Website</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>teekay wrote:</cite><blockquote><div><div class="quotebox"><cite>andy123 wrote:</cite><blockquote><div><p>Hi,<br />I use a setup with KVM switch and it&#039;s not that complicated, assuming you have multiple usb controllers on your mainboard (are there boards that don&#039;t?). You simply have to pass one through to the guest as a PCI device. The host will ignore the input on those, since it doesn&#039;t load a driver for it and it&#039;ll appear as a normal usb controller to the guest.<br />I don&#039;t thik I get what you mean by &quot;usual KVM VNC window&quot;, so no idea about that one.<br />I hope this helps…</p></div></blockquote></div><p>With the KVM VNC window stuff I mean the classical way of having a window with the VM running in it, and switching the input between host and guest by moving the mouse over the window border, or pressing ctrl+alt - something like that.<br />But forget about it. A KVM switch is the way to go I guess.</p><p>Your idea of picking one of the motherboard&#039;s USB controllers is great, just a matter of finding out if the 8 ports on the backpanel all use the same controller or multiple<br />Thanks!</p></div></blockquote></div><p>Ah, now I get it. I did that first, trying to get this set up. I still had the emulated graphics card enabled, but the other one takes over at some point and there is this black window you can click into and use ctrl+alt to get out of. I can&#039;t really tell what&#039;s more &quot;elegant&quot; or better in general. I&#039;m not a qemu expert, so this may be possible without an emulated graphics card.<br />KVM switches aren&#039;t cheap though and I know I wouldn&#039;t have bought one for this.</p> </div> <div class="postsignature postmsg"><hr /><p>i&#039;m sorry for my poor english wirting skills…</p></div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1295829">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1296035" class="blockpost rowodd"> <h2><span><span class="conr">#203</span> <a href="viewtopic.php?pid=1296035#p1296035">2013-07-04 00:37:14</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=68201">rabcor</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2013-02-09</span></dd> <dd><span>Posts: 457</span></dd> <dd class="usercontacts"><span class="email"><a href="misc.php?email=68201">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>alphaniner wrote:</cite><blockquote><div><p>@rabcor</p><p>You still have a rogue space after the first <strong>-device vfio-pci</strong>.</p><div class="codebox"><pre><code># qemu-system-x86_64 ... -device vfio-pci, host=01:00.0,...</code></pre></div><p>I put a space in a working command and got a &quot;could not open disk image&quot; error, so that could be it.</p></div></blockquote></div><p>i&#039;m&#160; pretty sure this should be correct, but it doesn&#039;t seem to be starting up <img src="https://bbs.archlinux.org/img/smilies/sad.png" width="15" height="15" alt="sad" /></p><div class="codebox"><pre><code>qemu-system-x86_64 -enable-kvm -M q35 -cpu host \ -smp 6,sockets=1,cores=6,threads=1 \ -bios /usr/share/qemu/bios.bin -vga none \ -device ioh3420,bus=pcie.0,addr=1c.0,multifunction=on,port=1,chassis=1,id=root.1 \ -device vfio-pci,host=01:00.0,bus=root.1,addr=00.0,multifunction=on,x-vga=on \ -device vfio-pci,host=01:00.1,bus=root.1,addr=00.1</code></pre></div><p>tidied up version</p><div class="codebox"><pre><code>qemu-system-x86_64 -enable-kvm -M q35 -cpu host \ -smp 6,sockets=1,cores=6,threads=1 \ -bios /usr/share/qemu/bios.bin -vga none \ -device ioh3420,bus=pcie.0,addr=1c.0,multifunction=on,port=1,chassis=1,id=root.1 \ -device vfio-pci,host=01:00.0,bus=root.1,addr=00.0,multifunction=on,x-vga=on \ -device vfio-pci,host=01:00.1,bus=root.1,addr=00.1</code></pre></div><p>This stuff is driving me nuts!</p><p>it gives this</p><div class="codebox"><pre><code>qemu-system-x86_64: -cpu host: could not open disk image -smp: No such file or directory</code></pre></div><p>if i move the backslashes (\) it gives me different results, for example &quot;-cpu host \-smp 6...&quot;</p><div class="codebox"><pre><code>qemu-system-x86_64: -smp 6,sockets=1,cores=6,threads=1: could not open disk image -bios: No such file or directory</code></pre></div><p>i tried messing around with it a bit but i couldn&#039;t find any way to make it work.</p><p>I took a break from this for a while, but my windows installation on the dual boot got wrecked by some random virus which apparently infected me on a day i didn&#039;t even use the computer. So i wanna see how far i get with this before i go into reinstalling windows, i&#039;d like to get rid of the dual boot anyways. I&#039;m tired now but tomorrow if nobody has any suggestions for fixing the code i will try reinstalling qemu and seabios. (speaking of which what happened to the qemu source from the OP?)</p> <p class="postedit"><em>Last edited by rabcor (2013-07-04 01:15:58)</em></p> </div> <div class="postsignature postmsg"><hr /><p><a href="https://bbs.archlinux.org/viewtopic.php?pid=1421825" rel="nofollow">Making Logitech G510 Work on Linux!</a></p></div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1296035">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1296069" class="blockpost roweven"> <h2><span><span class="conr">#204</span> <a href="viewtopic.php?pid=1296069#p1296069">2013-07-04 03:11:44</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=70922">nbhs</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd class="postavatar"><img src="https://bbs.archlinux.org/img/avatars/70922.jpg?m=1367773811" width="80" height="80" alt="" /></dd> <dd><span>From: Montevideo, Uruguay</span></dd> <dd><span>Registered: 2013-05-02</span></dd> <dd><span>Posts: 402</span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>rabcor wrote:</cite><blockquote><div><div class="quotebox"><cite>alphaniner wrote:</cite><blockquote><div><p>@rabcor</p><p>You still have a rogue space after the first <strong>-device vfio-pci</strong>.</p><div class="codebox"><pre><code># qemu-system-x86_64 ... -device vfio-pci, host=01:00.0,...</code></pre></div><p>I put a space in a working command and got a &quot;could not open disk image&quot; error, so that could be it.</p></div></blockquote></div><p>i&#039;m&#160; pretty sure this should be correct, but it doesn&#039;t seem to be starting up <img src="https://bbs.archlinux.org/img/smilies/sad.png" width="15" height="15" alt="sad" /></p><div class="codebox"><pre><code>qemu-system-x86_64 -enable-kvm -M q35 -cpu host \ -smp 6,sockets=1,cores=6,threads=1 \ -bios /usr/share/qemu/bios.bin -vga none \ -device ioh3420,bus=pcie.0,addr=1c.0,multifunction=on,port=1,chassis=1,id=root.1 \ -device vfio-pci,host=01:00.0,bus=root.1,addr=00.0,multifunction=on,x-vga=on \ -device vfio-pci,host=01:00.1,bus=root.1,addr=00.1</code></pre></div><p>tidied up version</p><div class="codebox"><pre><code>qemu-system-x86_64 -enable-kvm -M q35 -cpu host \ -smp 6,sockets=1,cores=6,threads=1 \ -bios /usr/share/qemu/bios.bin -vga none \ -device ioh3420,bus=pcie.0,addr=1c.0,multifunction=on,port=1,chassis=1,id=root.1 \ -device vfio-pci,host=01:00.0,bus=root.1,addr=00.0,multifunction=on,x-vga=on \ -device vfio-pci,host=01:00.1,bus=root.1,addr=00.1</code></pre></div><p>This stuff is driving me nuts!</p><p>it gives this</p><div class="codebox"><pre><code>qemu-system-x86_64: -cpu host: could not open disk image -smp: No such file or directory</code></pre></div><p>if i move the backslashes (\) it gives me different results, for example &quot;-cpu host \-smp 6...&quot;</p><div class="codebox"><pre><code>qemu-system-x86_64: -smp 6,sockets=1,cores=6,threads=1: could not open disk image -bios: No such file or directory</code></pre></div><p>i tried messing around with it a bit but i couldn&#039;t find any way to make it work.</p><p>I took a break from this for a while, but my windows installation on the dual boot got wrecked by some random virus which apparently infected me on a day i didn&#039;t even use the computer. So i wanna see how far i get with this before i go into reinstalling windows, i&#039;d like to get rid of the dual boot anyways. I&#039;m tired now but tomorrow if nobody has any suggestions for fixing the code i will try reinstalling qemu and seabios. (speaking of which what happened to the qemu source from the OP?)</p></div></blockquote></div><p>Try:</p><div class="codebox"><pre><code>-cpu qemu64</code></pre></div><p>and remove the -smp line</p><p>If that worked you might have built qemu without kvm support</p> <p class="postedit"><em>Last edited by nbhs (2013-07-04 03:20:39)</em></p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1296069">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1296155" class="blockpost rowodd"> <h2><span><span class="conr">#205</span> <a href="viewtopic.php?pid=1296155#p1296155">2013-07-04 06:58:24</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=70922">nbhs</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd class="postavatar"><img src="https://bbs.archlinux.org/img/avatars/70922.jpg?m=1367773811" width="80" height="80" alt="" /></dd> <dd><span>From: Montevideo, Uruguay</span></dd> <dd><span>Registered: 2013-05-02</span></dd> <dd><span>Posts: 402</span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>teekay wrote:</cite><blockquote><div><div class="quotebox"><cite>andy123 wrote:</cite><blockquote><div><p>Hi,<br />I use a setup with KVM switch and it&#039;s not that complicated, assuming you have multiple usb controllers on your mainboard (are there boards that don&#039;t?). You simply have to pass one through to the guest as a PCI device. The host will ignore the input on those, since it doesn&#039;t load a driver for it and it&#039;ll appear as a normal usb controller to the guest.<br />I don&#039;t thik I get what you mean by &quot;usual KVM VNC window&quot;, so no idea about that one.<br />I hope this helps…</p></div></blockquote></div><p>With the KVM VNC window stuff I mean the classical way of having a window with the VM running in it, and switching the input between host and guest by moving the mouse over the window border, or pressing ctrl+alt - something like that.<br />But forget about it. A KVM switch is the way to go I guess.</p><p>Your idea of picking one of the motherboard&#039;s USB controllers is great, just a matter of finding out if the 8 ports on the backpanel all use the same controller or multiple<br />Thanks!</p></div></blockquote></div><p>I think its still possible to capture the mouse and keyboard on the qemu window, i havent tried though, i do recommend a kvm switch, i dont have one unfortunately, i do have 4 frontal usb ports, of which 2 are usb3, so i just switch my keyboard and mouse by changing from usb2 (host) to usb3(guest)</p> <p class="postedit"><em>Last edited by nbhs (2013-07-04 07:00:10)</em></p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1296155">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1296508" class="blockpost roweven"> <h2><span><span class="conr">#206</span> <a href="viewtopic.php?pid=1296508#p1296508">2013-07-05 02:37:28</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=71645">apocolypse600</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2013-05-26</span></dd> <dd><span>Posts: 4</span></dd> <dd class="usercontacts"><span class="email"><a href="misc.php?email=71645">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>teekay wrote:</cite><blockquote><div><p>I&#039;m going to try this with my Gigabyte 990FXA-UD5, a Nvidia GT-430 (host), and some older Geforce 7xxx which currently rotting in the cellar. (If I can use it for that: great)<br />The display panel has two inputs, so I&#039;m planning to switch video between host and guest by simply pressing the source button.</p><p>But I wonder if it&#039;s possible to use a single keyboard and mouse for both host and guest? Not at the same time of course, more like in usual KVM VNC window.<br />And if so, how&#039;s the handling of the focus (vm or host)?<br />Or would it be better to get a separate PCIe USB controller and use a KVM switch?</p><p>Sorry for the maybe stupid question.</p></div></blockquote></div><p>Another option is to use <a href="http://synergy-foss.org/" rel="nofollow">Synergy</a>. I&#039;m using it at the moment to share a keyboard and mouse between a desktop and laptop and it works perfectly. A few people have reported using it for sharing the keyboard and mouse between host and guest in a setup like this aswell. It&#039;s in the arch repositories under &#039;synergy&#039;. It supports clipboard sharing and allows you to lock focus to a computer with a keypress, so as far as I can tell, it should work pretty well (it&#039;s what I plan to use when I eventually try to set this all up).</p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1296508">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1296649" class="blockpost rowodd"> <h2><span><span class="conr">#207</span> <a href="viewtopic.php?pid=1296649#p1296649">2013-07-05 13:18:27</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=68201">rabcor</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2013-02-09</span></dd> <dd><span>Posts: 457</span></dd> <dd class="usercontacts"><span class="email"><a href="misc.php?email=68201">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>nbhs wrote:</cite><blockquote><div><p>Try:</p><div class="codebox"><pre><code>-cpu qemu64</code></pre></div><p>and remove the -smp line</p><p>If that worked you might have built qemu without kvm support</p></div></blockquote></div><div class="codebox"><pre><code>#qemu-system-x86_64 -enable-kvm -M q35 -cpu qemu64 \ -bios /usr/share/qemu/bios.bin -vga none \ -device ioh3420,bus=pcie.0,addr=1c.0,multifunction=on,port=1,chassis=1,id=root.1 \ -device vfio-pci,host=01:00.0,bus=root.1,addr=00.0,multifunction=on,x-vga=on \ -device vfio-pci,host=01:00.1,bus=root.1,addr=00.1 qemu-system-x86_64: -cpu qemu64: could not open disk image -bios: No such file or directory</code></pre></div><p>I&#039;m looking into reinstalling qemu but like i said, you removed the link from your original post and i don&#039;t have any different source to build from than my current one except the git one, which is v 1.6 and has seabios intergrated, and i don&#039;t know how to patch the intergrated seabios, i couldn&#039;t find out how (but otherwise that is what i would do).</p><p>i tried removing the backslashes and the VM will start if i run it from X.</p><div class="codebox"><pre><code>qemu-system-x86_64 -enable-kvm -M q35 -cpu host -smp 6,sockets=1,cores=6,threads=1 -bios /usr/share/qemu/bios.bin -vga none -device ioh3420,bus=pcie.0,addr=1c.0,multifunction=on,port=1,chassis=1,id=root.1 -device vfio-pci,host=01:00.0,bus=root.1,addr=00.0,multifunction=on,x-vga=on -device vfio-pci,host=01:00.1,bus=root.1,addr=00.1 qemu-system-x86_64: -device vfio-pci,host=01:00.0,bus=root.1,addr=00.0,multifunction=on,x-vga=on: Warning, device 0000:01:00.0 does not support reset qemu-system-x86_64: -device vfio-pci,host=01:00.1,bus=root.1,addr=00.1: Warning, device 0000:01:00.1 does not support reset qemu-system-x86_64: Attempt to reset PCI bus for VGA support failed (Inappropriate ioctl for device). VGA may not work.</code></pre></div><p>if not running from x (terminal) then i get</p><div class="codebox"><pre><code>Could not initialize SDL(No available video device) - exiting</code></pre></div><p>instead of</p><div class="codebox"><pre><code>qemu-system-x86_64: Attempt to reset PCI bus for VGA support failed (Inappropriate ioctl for device). VGA may not work.</code></pre></div> <p class="postedit"><em>Last edited by rabcor (2013-07-05 13:28:33)</em></p> </div> <div class="postsignature postmsg"><hr /><p><a href="https://bbs.archlinux.org/viewtopic.php?pid=1421825" rel="nofollow">Making Logitech G510 Work on Linux!</a></p></div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1296649">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1296919" class="blockpost roweven"> <h2><span><span class="conr">#208</span> <a href="viewtopic.php?pid=1296919#p1296919">2013-07-05 22:12:12</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=70922">nbhs</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd class="postavatar"><img src="https://bbs.archlinux.org/img/avatars/70922.jpg?m=1367773811" width="80" height="80" alt="" /></dd> <dd><span>From: Montevideo, Uruguay</span></dd> <dd><span>Registered: 2013-05-02</span></dd> <dd><span>Posts: 402</span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>rabcor wrote:</cite><blockquote><div><div class="quotebox"><cite>nbhs wrote:</cite><blockquote><div><p>Try:</p><div class="codebox"><pre><code>-cpu qemu64</code></pre></div><p>and remove the -smp line</p><p>If that worked you might have built qemu without kvm support</p></div></blockquote></div><div class="codebox"><pre><code>#qemu-system-x86_64 -enable-kvm -M q35 -cpu qemu64 \ -bios /usr/share/qemu/bios.bin -vga none \ -device ioh3420,bus=pcie.0,addr=1c.0,multifunction=on,port=1,chassis=1,id=root.1 \ -device vfio-pci,host=01:00.0,bus=root.1,addr=00.0,multifunction=on,x-vga=on \ -device vfio-pci,host=01:00.1,bus=root.1,addr=00.1 qemu-system-x86_64: -cpu qemu64: could not open disk image -bios: No such file or directory</code></pre></div><p>I&#039;m looking into reinstalling qemu but like i said, you removed the link from your original post and i don&#039;t have any different source to build from than my current one except the git one, which is v 1.6 and has seabios intergrated, and i don&#039;t know how to patch the intergrated seabios, i couldn&#039;t find out how (but otherwise that is what i would do).</p><p>i tried removing the backslashes and the VM will start if i run it from X.</p><div class="codebox"><pre><code>qemu-system-x86_64 -enable-kvm -M q35 -cpu host -smp 6,sockets=1,cores=6,threads=1 -bios /usr/share/qemu/bios.bin -vga none -device ioh3420,bus=pcie.0,addr=1c.0,multifunction=on,port=1,chassis=1,id=root.1 -device vfio-pci,host=01:00.0,bus=root.1,addr=00.0,multifunction=on,x-vga=on -device vfio-pci,host=01:00.1,bus=root.1,addr=00.1 qemu-system-x86_64: -device vfio-pci,host=01:00.0,bus=root.1,addr=00.0,multifunction=on,x-vga=on: Warning, device 0000:01:00.0 does not support reset qemu-system-x86_64: -device vfio-pci,host=01:00.1,bus=root.1,addr=00.1: Warning, device 0000:01:00.1 does not support reset qemu-system-x86_64: Attempt to reset PCI bus for VGA support failed (Inappropriate ioctl for device). VGA may not work.</code></pre></div><p>if not running from x (terminal) then i get</p><div class="codebox"><pre><code>Could not initialize SDL(No available video device) - exiting</code></pre></div><p>instead of</p><div class="codebox"><pre><code>qemu-system-x86_64: Attempt to reset PCI bus for VGA support failed (Inappropriate ioctl for device). VGA may not work.</code></pre></div></div></blockquote></div><br /><p>Qemu by default creates a sdl window, if you want to lauch qemu without X launch qemu with this option</p><div class="codebox"><pre><code>-nographic</code></pre></div><p>Are you using a patched kernel with vfio-reset patches?</p><p>EDIT: i re-uploaded qemu and linux-mainline builds on the main page</p><p>qemu 1.5.1 <a href="http://www.fileswap.com/dl/wzFxm2ltkJ" rel="nofollow">http://www.fileswap.com/dl/wzFxm2ltkJ</a><br />linux-mainline 3.10 <a href="http://www.fileswap.com/dl/9HpoqHLeBJ" rel="nofollow">http://www.fileswap.com/dl/9HpoqHLeBJ</a></p> <p class="postedit"><em>Last edited by nbhs (2013-07-05 22:31:27)</em></p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1296919">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1297140" class="blockpost rowodd"> <h2><span><span class="conr">#209</span> <a href="viewtopic.php?pid=1297140#p1297140">2013-07-06 13:18:23</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=68201">rabcor</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2013-02-09</span></dd> <dd><span>Posts: 457</span></dd> <dd class="usercontacts"><span class="email"><a href="misc.php?email=68201">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <p>the qemu link says the file is not available.</p><p>If i use the -nographic option in terminal it just gives me the same error as in X.</p><p>I&#039;m trying to passthrough an nvidia card.</p><p>my kernel has these options</p><p>CONFIG_VFIO_IOMMU_TYPE1=y<br />CONFIG_VFIO=y<br />CONFIG_VFIO_PCI=y<br />CONFIG_VFIO_PCI_VGA=y<br />INTEL_IOMMU_DEFAULT_ON=y</p><p>Since i don&#039;t have radeon i shouldn&#039;t need the vga-reset patches right? i&#039;ve got nvidia GTX 600 series card.</p> </div> <div class="postsignature postmsg"><hr /><p><a href="https://bbs.archlinux.org/viewtopic.php?pid=1421825" rel="nofollow">Making Logitech G510 Work on Linux!</a></p></div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1297140">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1297251" class="blockpost roweven"> <h2><span><span class="conr">#210</span> <a href="viewtopic.php?pid=1297251#p1297251">2013-07-06 19:03:07</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=70922">nbhs</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd class="postavatar"><img src="https://bbs.archlinux.org/img/avatars/70922.jpg?m=1367773811" width="80" height="80" alt="" /></dd> <dd><span>From: Montevideo, Uruguay</span></dd> <dd><span>Registered: 2013-05-02</span></dd> <dd><span>Posts: 402</span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>rabcor wrote:</cite><blockquote><div><p>the qemu link says the file is not available.</p><p>If i use the -nographic option in terminal it just gives me the same error as in X.</p><p>I&#039;m trying to passthrough an nvidia card.</p><p>my kernel has these options</p><p>CONFIG_VFIO_IOMMU_TYPE1=y<br />CONFIG_VFIO=y<br />CONFIG_VFIO_PCI=y<br />CONFIG_VFIO_PCI_VGA=y<br />INTEL_IOMMU_DEFAULT_ON=y</p><p>Since i don&#039;t have radeon i shouldn&#039;t need the vga-reset patches right? i&#039;ve got nvidia GTX 600 series card.</p></div></blockquote></div><p>Yeah sorry here&#039;s the qemu build: <a href="http://www.fileswap.com/dl/qDG531EyVy" rel="nofollow">http://www.fileswap.com/dl/qDG531EyVy</a></p><p>In my experience using a 470gtx i didnt need the patches im not sure about the gtx 600</p><p>You should launch qemu like this:</p><div class="codebox"><pre><code>qemu-system-x86_64 ... -vga none -nographic ...</code></pre></div> <p class="postedit"><em>Last edited by nbhs (2013-07-06 19:05:23)</em></p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1297251">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1297506" class="blockpost rowodd"> <h2><span><span class="conr">#211</span> <a href="viewtopic.php?pid=1297506#p1297506">2013-07-07 11:08:14</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=62629">Silencement</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>From: France</span></dd> <dd><span>Registered: 2012-08-06</span></dd> <dd><span>Posts: 12</span></dd> <dd class="usercontacts"><span class="email"><a href="misc.php?email=62629">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <p>Hi,</p><p>I&#039;m currently using Xen 4.2 and a Windows 7 domU with VGA passthrough, and everything works perfectly. I saw your guide and thought I would try KVM.</p><p>I have installed Linux Mint (didn&#039;t really have the time to perform a full install of Arch), built kernel 3.10 with :</p><div class="codebox"><pre><code>CONFIG_VFIO_IOMMU_TYPE1=y CONFIG_VFIO=y CONFIG_VFIO_PCI=y CONFIG_VFIO_PCI_VGA=y</code></pre></div><p>I also built qemu 1.5 and seabios 1.7.2 with the patch you provided, and added this to grub :</p><div class="codebox"><pre><code>intel_iommu=on pci-stub.ids=1002:6738,1002:aa88 vfio_iommu_type1.allow_unsafe_interrupts=1</code></pre></div><p>I can start a Windows VM but can&#039;t get VGA passthrough to work :</p><ul><li><p>with -vga none, i have &quot;qemu 1.5.0 monitor&quot; in VNC and the VM does not start</p></li><li><p>with -vga cirrus or -vga std, and pci-assign, I have &quot;the device cannot start&quot; in W7 device manager</p></li><li><p>with vfio-pci, I have &quot;the device cannot find enough free resources that it can use&quot;</p></li></ul><p>Here is how I start the VM :</p><div class="codebox"><pre><code>qemu-system-x86_64 -enable-kvm \ -M q35 -nodefconfig -readconfig q35.cfg \ -m 4096 \ -cpu host -smp 2,sockets=1,cores=2,threads=1 \ -bios /usr/share/seabios/bios.bin \ -vga none \ -device vfio-pci,host=01:00.0,bus=ich9-pcie-port-1,addr=0.0,multifunction=on,x-vga=on \ -device vfio-pci,host=01:00.1,bus=ich9-pcie-port-1,addr=0.1 \ -device ahci,id=drives \ -drive id=hda,format=raw,file=/dev/LVM/test \ -device ide-hd,drive=hda</code></pre></div><p>And my PCI devices :</p><div class="codebox"><pre><code># lspci | grep AMD 01:00.0 VGA compatible controller: Advanced Micro Devices [AMD] nee ATI Barts XT [Radeon HD 6870] 01:00.1 Audio device: Advanced Micro Devices [AMD] nee ATI Barts HDMI Audio [Radeon HD 6800 Series]</code></pre></div><p>Any help would be appreciated !</p><p>Also, I have a question : would it be possible to VGA passthrough the Intel integrated graphics ? I know it&#039;s partially possible with Xen (works fine in Windows domU but black screen in Linux domU), is it possible with KVM ?</p> </div> <div class="postsignature postmsg"><hr /><p>Derpy Hooves is best pony.</p></div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1297506">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1298252" class="blockpost roweven"> <h2><span><span class="conr">#212</span> <a href="viewtopic.php?pid=1298252#p1298252">2013-07-09 10:57:17</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=53621">teekay</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2011-10-26</span></dd> <dd><span>Posts: 267</span></dd> <dd class="usercontacts"><span class="email"><a href="misc.php?email=53621">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>apocolypse600 wrote:</cite><blockquote><div><div class="quotebox"><cite>teekay wrote:</cite><blockquote><div><p>I&#039;m going to try this with my Gigabyte 990FXA-UD5, a Nvidia GT-430 (host), and some older Geforce 7xxx which currently rotting in the cellar. (If I can use it for that: great)<br />The display panel has two inputs, so I&#039;m planning to switch video between host and guest by simply pressing the source button.</p><p>But I wonder if it&#039;s possible to use a single keyboard and mouse for both host and guest? Not at the same time of course, more like in usual KVM VNC window.<br />And if so, how&#039;s the handling of the focus (vm or host)?<br />Or would it be better to get a separate PCIe USB controller and use a KVM switch?</p><p>Sorry for the maybe stupid question.</p></div></blockquote></div><p>Another option is to use <a href="http://synergy-foss.org/" rel="nofollow">Synergy</a>. I&#039;m using it at the moment to share a keyboard and mouse between a desktop and laptop and it works perfectly. A few people have reported using it for sharing the keyboard and mouse between host and guest in a setup like this aswell. It&#039;s in the arch repositories under &#039;synergy&#039;. It supports clipboard sharing and allows you to lock focus to a computer with a keypress, so as far as I can tell, it should work pretty well (it&#039;s what I plan to use when I eventually try to set this all up).</p></div></blockquote></div><p>This looks interesting for multi-screen, indeed. Thanks!</p><div class="quotebox"><cite>nbhs wrote:</cite><blockquote><div><p>I think its still possible to capture the mouse and keyboard on the qemu window, i havent tried though, i do recommend a kvm switch, i dont have one unfortunately, i do have 4 frontal usb ports, of which 2 are usb3, so i just switch my keyboard and mouse by changing from usb2 (host) to usb3(guest)</p></div></blockquote></div><p>I went for a KVM switch - an el cheapo Aten CS682. Only issue so far is the crappy Etron USB3 host controller on the 990FXA-UD5 - the driver causes BSOD in Windows when trying to install it. Works fine in linux, though.<br />Other than that, everything works great so far. Thanks a lot for the HowTo!</p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1298252">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1298390" class="blockpost rowodd"> <h2><span><span class="conr">#213</span> <a href="viewtopic.php?pid=1298390#p1298390">2013-07-09 19:14:11</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=70922">nbhs</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd class="postavatar"><img src="https://bbs.archlinux.org/img/avatars/70922.jpg?m=1367773811" width="80" height="80" alt="" /></dd> <dd><span>From: Montevideo, Uruguay</span></dd> <dd><span>Registered: 2013-05-02</span></dd> <dd><span>Posts: 402</span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>teekay wrote:</cite><blockquote><div><div class="quotebox"><cite>apocolypse600 wrote:</cite><blockquote><div><div class="quotebox"><cite>teekay wrote:</cite><blockquote><div><p>I&#039;m going to try this with my Gigabyte 990FXA-UD5, a Nvidia GT-430 (host), and some older Geforce 7xxx which currently rotting in the cellar. (If I can use it for that: great)<br />The display panel has two inputs, so I&#039;m planning to switch video between host and guest by simply pressing the source button.</p><p>But I wonder if it&#039;s possible to use a single keyboard and mouse for both host and guest? Not at the same time of course, more like in usual KVM VNC window.<br />And if so, how&#039;s the handling of the focus (vm or host)?<br />Or would it be better to get a separate PCIe USB controller and use a KVM switch?</p><p>Sorry for the maybe stupid question.</p></div></blockquote></div><p>Another option is to use <a href="http://synergy-foss.org/" rel="nofollow">Synergy</a>. I&#039;m using it at the moment to share a keyboard and mouse between a desktop and laptop and it works perfectly. A few people have reported using it for sharing the keyboard and mouse between host and guest in a setup like this aswell. It&#039;s in the arch repositories under &#039;synergy&#039;. It supports clipboard sharing and allows you to lock focus to a computer with a keypress, so as far as I can tell, it should work pretty well (it&#039;s what I plan to use when I eventually try to set this all up).</p></div></blockquote></div><p>This looks interesting for multi-screen, indeed. Thanks!</p><div class="quotebox"><cite>nbhs wrote:</cite><blockquote><div><p>I think its still possible to capture the mouse and keyboard on the qemu window, i havent tried though, i do recommend a kvm switch, i dont have one unfortunately, i do have 4 frontal usb ports, of which 2 are usb3, so i just switch my keyboard and mouse by changing from usb2 (host) to usb3(guest)</p></div></blockquote></div><p>I went for a KVM switch - an el cheapo Aten CS682. Only issue so far is the crappy Etron USB3 host controller on the 990FXA-UD5 - the driver causes BSOD in Windows when trying to install it. Works fine in linux, though.<br />Other than that, everything works great so far. Thanks a lot for the HowTo!</p></div></blockquote></div><p>I think i read some post mentioning it working out of the box with windows 8</p><p>EDIT: do you mind if i ask what card did you got it working with?</p> <p class="postedit"><em>Last edited by nbhs (2013-07-09 19:52:29)</em></p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1298390">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1298392" class="blockpost roweven"> <h2><span><span class="conr">#214</span> <a href="viewtopic.php?pid=1298392#p1298392">2013-07-09 19:21:01</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=70922">nbhs</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd class="postavatar"><img src="https://bbs.archlinux.org/img/avatars/70922.jpg?m=1367773811" width="80" height="80" alt="" /></dd> <dd><span>From: Montevideo, Uruguay</span></dd> <dd><span>Registered: 2013-05-02</span></dd> <dd><span>Posts: 402</span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>Silencement wrote:</cite><blockquote><div><p>Hi,</p><p>I&#039;m currently using Xen 4.2 and a Windows 7 domU with VGA passthrough, and everything works perfectly. I saw your guide and thought I would try KVM.</p><p>I have installed Linux Mint (didn&#039;t really have the time to perform a full install of Arch), built kernel 3.10 with :</p><div class="codebox"><pre><code>CONFIG_VFIO_IOMMU_TYPE1=y CONFIG_VFIO=y CONFIG_VFIO_PCI=y CONFIG_VFIO_PCI_VGA=y</code></pre></div><p>I also built qemu 1.5 and seabios 1.7.2 with the patch you provided, and added this to grub :</p><div class="codebox"><pre><code>intel_iommu=on pci-stub.ids=1002:6738,1002:aa88 vfio_iommu_type1.allow_unsafe_interrupts=1</code></pre></div><p>I can start a Windows VM but can&#039;t get VGA passthrough to work :</p><ul><li><p>with -vga none, i have &quot;qemu 1.5.0 monitor&quot; in VNC and the VM does not start</p></li><li><p>with -vga cirrus or -vga std, and pci-assign, I have &quot;the device cannot start&quot; in W7 device manager</p></li><li><p>with vfio-pci, I have &quot;the device cannot find enough free resources that it can use&quot;</p></li></ul><p>Here is how I start the VM :</p><div class="codebox"><pre><code>qemu-system-x86_64 -enable-kvm \ -M q35 -nodefconfig -readconfig q35.cfg \ -m 4096 \ -cpu host -smp 2,sockets=1,cores=2,threads=1 \ -bios /usr/share/seabios/bios.bin \ -vga none \ -device vfio-pci,host=01:00.0,bus=ich9-pcie-port-1,addr=0.0,multifunction=on,x-vga=on \ -device vfio-pci,host=01:00.1,bus=ich9-pcie-port-1,addr=0.1 \ -device ahci,id=drives \ -drive id=hda,format=raw,file=/dev/LVM/test \ -device ide-hd,drive=hda</code></pre></div><p>And my PCI devices :</p><div class="codebox"><pre><code># lspci | grep AMD 01:00.0 VGA compatible controller: Advanced Micro Devices [AMD] nee ATI Barts XT [Radeon HD 6870] 01:00.1 Audio device: Advanced Micro Devices [AMD] nee ATI Barts HDMI Audio [Radeon HD 6800 Series]</code></pre></div><p>Any help would be appreciated !</p><p>Also, I have a question : would it be possible to VGA passthrough the Intel integrated graphics ? I know it&#039;s partially possible with Xen (works fine in Windows domU but black screen in Linux domU), is it possible with KVM ?</p></div></blockquote></div><p>Right now there seems to be some problems using this guide on intel boards, the redhat dev mentioned that he got it working on his intel setup, and some users on the mailing list also reported success but with the igp disabled, but for most people on this thread the only solution was doing a secondary passthrough, im confident this will get worked out eventually. You can do it with standard mint packages for it you dont need vfio and/or a patched kernel (for secondary ), and no, its not possible right now to passthrough the igp with kvm.</p><p>EDIT: here&#039;s the mailing list discussion <a href="http://lists.gnu.org/archive/html/qemu-devel/2013-05/msg01722.html" rel="nofollow">http://lists.gnu.org/archive/html/qemu- … 01722.html</a>, and this patch might be of use <a href="http://lists.gnu.org/archive/html/qemu-devel/2013-05/msg01722.html" rel="nofollow">http://lists.gnu.org/archive/html/qemu- … 01722.html</a></p> <p class="postedit"><em>Last edited by nbhs (2013-07-09 19:27:40)</em></p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1298392">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1298419" class="blockpost rowodd"> <h2><span><span class="conr">#215</span> <a href="viewtopic.php?pid=1298419#p1298419">2013-07-09 20:50:52</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=53621">teekay</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2011-10-26</span></dd> <dd><span>Posts: 267</span></dd> <dd class="usercontacts"><span class="email"><a href="misc.php?email=53621">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>nbhs wrote:</cite><blockquote><div><div class="quotebox"><cite>teekay wrote:</cite><blockquote><div><p>I went for a KVM switch - an el cheapo Aten CS682. Only issue so far is the crappy Etron USB3 host controller on the 990FXA-UD5 - the driver causes BSOD in Windows when trying to install it. Works fine in linux, though.<br />Other than that, everything works great so far. Thanks a lot for the HowTo!</p></div></blockquote></div><p>I think i read some post mentioning it working out of the box with windows 8</p><p>EDIT: do you mind if i ask what card did you got it working with?</p></div></blockquote></div><p>Sure thing. It&#039;s a GT430 for the host, and a 8500GT for the guest. Had to use pci-stub so the host nvidia driver ignores it, and I&#039;m using the patched nvidia-driver.</p> <p class="postedit"><em>Last edited by teekay (2013-07-09 20:51:33)</em></p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1298419">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1298462" class="blockpost roweven"> <h2><span><span class="conr">#216</span> <a href="viewtopic.php?pid=1298462#p1298462">2013-07-09 22:38:57</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=70922">nbhs</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd class="postavatar"><img src="https://bbs.archlinux.org/img/avatars/70922.jpg?m=1367773811" width="80" height="80" alt="" /></dd> <dd><span>From: Montevideo, Uruguay</span></dd> <dd><span>Registered: 2013-05-02</span></dd> <dd><span>Posts: 402</span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>teekay wrote:</cite><blockquote><div><div class="quotebox"><cite>nbhs wrote:</cite><blockquote><div><div class="quotebox"><cite>teekay wrote:</cite><blockquote><div><p>I went for a KVM switch - an el cheapo Aten CS682. Only issue so far is the crappy Etron USB3 host controller on the 990FXA-UD5 - the driver causes BSOD in Windows when trying to install it. Works fine in linux, though.<br />Other than that, everything works great so far. Thanks a lot for the HowTo!</p></div></blockquote></div><p>I think i read some post mentioning it working out of the box with windows 8</p><p>EDIT: do you mind if i ask what card did you got it working with?</p></div></blockquote></div><p>Sure thing. It&#039;s a GT430 for the host, and a 8500GT for the guest. Had to use pci-stub so the host nvidia driver ignores it, and I&#039;m using the patched nvidia-driver.</p></div></blockquote></div><p>Thanks a lot, its good to know a lot nvidia cards are working</p> <p class="postedit"><em>Last edited by nbhs (2013-07-09 22:45:59)</em></p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1298462">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1298537" class="blockpost rowodd"> <h2><span><span class="conr">#217</span> <a href="viewtopic.php?pid=1298537#p1298537">2013-07-10 05:36:19</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=73066">Eldak</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2013-07-10</span></dd> <dd><span>Posts: 4</span></dd> <dd class="usercontacts"><span class="email"><a href="mailto:patrick.stueck@gmail.com">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <p>Great writeup!&#160; I&#039;ve gotten most the way through this, but I&#039;m running into a BSoD on Windows 7 (0xA5 -- The BIOS in this system is not fully ACPI compliant.)</p><p>I am using the latest SeaBIOS from the git repository, I&#039;ve checked the &quot;make menuconfig&quot; and it does appear to be compiling this with ACPI support.&#160; I have a Gigabyte 990XA-UD3 motherboard, which from what I can tell another use has gotten this to work. </p><p>=== EDIT ===<br />It looks like I was using the wrong SeaBIOS version (1.7.3 instead of 1.7.2 with the patch).&#160; Windows 7 now attempts to install without throwing the ACPI Error.&#160; However, during the Windows 7 installation, it finishes the &quot;Copying Windows files&quot; stage, but gets stuck on starting the &quot;Expanding Windows files&quot;.&#160; &#160;It does this using raw .img disk images and LVMs.&#160; Any suggestions?</p> <p class="postedit"><em>Last edited by Eldak (2013-07-10 06:55:52)</em></p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1298537">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1298544" class="blockpost roweven"> <h2><span><span class="conr">#218</span> <a href="viewtopic.php?pid=1298544#p1298544">2013-07-10 07:34:59</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=53621">teekay</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2011-10-26</span></dd> <dd><span>Posts: 267</span></dd> <dd class="usercontacts"><span class="email"><a href="misc.php?email=53621">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>Eldak wrote:</cite><blockquote><div><p>=== EDIT ===<br />It looks like I was using the wrong SeaBIOS version (1.7.3 instead of 1.7.2 with the patch).&#160; Windows 7 now attempts to install without throwing the ACPI Error.&#160; However, during the Windows 7 installation, it finishes the &quot;Copying Windows files&quot; stage, but gets stuck on starting the &quot;Expanding Windows files&quot;.&#160; &#160;It does this using raw .img disk images and LVMs.&#160; Any suggestions?</p></div></blockquote></div><p>Are you using an IDE bus for the disk or the legacy AHCI SATA as explained by nbhs in the howto? The IDE bus is _dead slow_ when installing Windows. I haven&#039;t tried SATA, so I can&#039;t say if it&#039;s better there. (I did the install in VirtualBox which takes only some minutes, and used VBoxManage clonehd to convert the .vdi to .raw, then created a 2GB fake qcow2 image and attached both in Qemu, so the system boots from the cloned raw image with IDE, and detects the VirtIO SCSI bus with the fake image, then installed virtio drivers for it.)</p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1298544">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1298645" class="blockpost rowodd"> <h2><span><span class="conr">#219</span> <a href="viewtopic.php?pid=1298645#p1298645">2013-07-10 15:00:39</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=70922">nbhs</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd class="postavatar"><img src="https://bbs.archlinux.org/img/avatars/70922.jpg?m=1367773811" width="80" height="80" alt="" /></dd> <dd><span>From: Montevideo, Uruguay</span></dd> <dd><span>Registered: 2013-05-02</span></dd> <dd><span>Posts: 402</span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>Eldak wrote:</cite><blockquote><div><p>Great writeup!&#160; I&#039;ve gotten most the way through this, but I&#039;m running into a BSoD on Windows 7 (0xA5 -- The BIOS in this system is not fully ACPI compliant.)</p><p>I am using the latest SeaBIOS from the git repository, I&#039;ve checked the &quot;make menuconfig&quot; and it does appear to be compiling this with ACPI support.&#160; I have a Gigabyte 990XA-UD3 motherboard, which from what I can tell another use has gotten this to work.</p></div></blockquote></div><p>I get BSOD&#039;S too using the lastest seabios from git with windows 7, this does not happen on windows 8, but that&#039;s why i recommend using the stable 1.7.2 branch + the patch i provided.</p><br /><div class="quotebox"><cite>Eldak wrote:</cite><blockquote><div><p>=== EDIT ===<br />It looks like I was using the wrong SeaBIOS version (1.7.3 instead of 1.7.2 with the patch).&#160; Windows 7 now attempts to install without throwing the ACPI Error.&#160; However, during the Windows 7 installation, it finishes the &quot;Copying Windows files&quot; stage, but gets stuck on starting the &quot;Expanding Windows files&quot;.&#160; &#160;It does this using raw .img disk images and LVMs.&#160; Any suggestions?</p></div></blockquote></div><p>Perhaps the image is corrupt?</p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1298645">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1298745" class="blockpost roweven"> <h2><span><span class="conr">#220</span> <a href="viewtopic.php?pid=1298745#p1298745">2013-07-10 19:50:05</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=73066">Eldak</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2013-07-10</span></dd> <dd><span>Posts: 4</span></dd> <dd class="usercontacts"><span class="email"><a href="mailto:patrick.stueck@gmail.com">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <p>I installed Windows 7 to an LVM using QEMU/virt-manager, then tried to start it up using the command given on page 1 of this thread to start the VM, enable the passthrough, etc, and then Windows blue screens.&#160; I am able to boot the LVM up from a normal libvirt session, so the image is not corrupt.</p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1298745">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1298796" class="blockpost rowodd"> <h2><span><span class="conr">#221</span> <a href="viewtopic.php?pid=1298796#p1298796">2013-07-10 22:28:28</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=70922">nbhs</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd class="postavatar"><img src="https://bbs.archlinux.org/img/avatars/70922.jpg?m=1367773811" width="80" height="80" alt="" /></dd> <dd><span>From: Montevideo, Uruguay</span></dd> <dd><span>Registered: 2013-05-02</span></dd> <dd><span>Posts: 402</span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>Eldak wrote:</cite><blockquote><div><p>I installed Windows 7 to an LVM using QEMU/virt-manager, then tried to start it up using the command given on page 1 of this thread to start the VM, enable the passthrough, etc, and then Windows blue screens.&#160; I am able to boot the LVM up from a normal libvirt session, so the image is not corrupt.</p></div></blockquote></div><p>Could you provide:</p><p>-whats your setup<br />-what card are you trying to passthrough <br />-which version of seabios, qemu, kernel are you using <br />-cmdline to launch qemu<br />-bsod info</p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1298796">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1298869" class="blockpost roweven"> <h2><span><span class="conr">#222</span> <a href="viewtopic.php?pid=1298869#p1298869">2013-07-11 03:38:54</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=73066">Eldak</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2013-07-10</span></dd> <dd><span>Posts: 4</span></dd> <dd class="usercontacts"><span class="email"><a href="mailto:patrick.stueck@gmail.com">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <p>BSOD 0x7B<br />SeaBIOS: 1.7.2 + Patch provided here<br />QEMU 1.5.1<br />Kernel 3.10<br />ATI Radeon HD6870</p><p>Motherboard is a Gigabyte GA-990XA-UD3 with BIOS F13.</p><p>Everything works when I attach the LVM to a VM within virt-manager, but BSOD&#039;s when starting with the following command line:</p><div class="codebox"><pre><code>sudo qemu-system-x86_64 -enable-kvm -M q35 -m 1024 -cpu host -smp 6,sockets=1,cores=6,threads=1 -bios /home/patrick/seabios-1.7.2/seabios-1.7.2/out/bios.bin -vga none -device ioh3420,bus=pcie.0,addr=1c.0,multifunction=on,port=1,chassis=1,id=root.1 -device vfio-pci,host=02:00.0,bus=root.1,addr=00.0,multifunction=on,x-vga=on -device vfio-pci,host=02:00.1,bus=root.1,addr=00.1 -device ahci,bus=pcie.0,id=ahci -drive file=/media/patrick/Storage/data/Operating\ Systems/Windows\ 7/Win7Pro.iso,id=isocd -device ide-cd,bus=ahci.1,drive=isocd -drive file=/dev/mapper/kvmspace-win7,id=disk,format=raw -device ide-hd,bus=ahci.0,drive=disk -boot menu=on &amp;</code></pre></div><p>Looking up the BSOD, It&#039;s referencing invalid boot device:&#160; <a href="http://msdn.microsoft.com/en-us/library/windows/hardware/ff559218(v=vs.85).aspx" rel="nofollow">http://msdn.microsoft.com/en-us/library … s.85).aspx</a></p><p>The passthrough, etc, is working as intended as everything is displaying on my second video card that&#039;s being passed through.&#160; I should also that, that with this configuration, command, etc, when I create a &quot;new&quot; win7 LVM and attempt to install Windows 7, the installation freezes before it starts to extract windows files.</p> <p class="postedit"><em>Last edited by Eldak (2013-07-11 03:59:54)</em></p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1298869">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1298880" class="blockpost rowodd"> <h2><span><span class="conr">#223</span> <a href="viewtopic.php?pid=1298880#p1298880">2013-07-11 04:39:14</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=70922">nbhs</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd class="postavatar"><img src="https://bbs.archlinux.org/img/avatars/70922.jpg?m=1367773811" width="80" height="80" alt="" /></dd> <dd><span>From: Montevideo, Uruguay</span></dd> <dd><span>Registered: 2013-05-02</span></dd> <dd><span>Posts: 402</span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>Eldak wrote:</cite><blockquote><div><p>BSOD 0x7B<br />SeaBIOS: 1.7.2 + Patch provided here<br />QEMU 1.5.1<br />Kernel 3.10<br />ATI Radeon HD6870</p><p>Motherboard is a Gigabyte GA-990XA-UD3 with BIOS F13.</p><p>Everything works when I attach the LVM to a VM within virt-manager, but BSOD&#039;s when starting with the following command line:</p><div class="codebox"><pre><code>sudo qemu-system-x86_64 -enable-kvm -M q35 -m 1024 -cpu host -smp 6,sockets=1,cores=6,threads=1 -bios /home/patrick/seabios-1.7.2/seabios-1.7.2/out/bios.bin -vga none -device ioh3420,bus=pcie.0,addr=1c.0,multifunction=on,port=1,chassis=1,id=root.1 -device vfio-pci,host=02:00.0,bus=root.1,addr=00.0,multifunction=on,x-vga=on -device vfio-pci,host=02:00.1,bus=root.1,addr=00.1 -device ahci,bus=pcie.0,id=ahci -drive file=/media/patrick/Storage/data/Operating\ Systems/Windows\ 7/Win7Pro.iso,id=isocd -device ide-cd,bus=ahci.1,drive=isocd -drive file=/dev/mapper/kvmspace-win7,id=disk,format=raw -device ide-hd,bus=ahci.0,drive=disk -boot menu=on &amp;</code></pre></div><p>Looking up the BSOD, It&#039;s referencing invalid boot device:&#160; <a href="http://msdn.microsoft.com/en-us/library/windows/hardware/ff559218(v=vs.85).aspx" rel="nofollow">http://msdn.microsoft.com/en-us/library … s.85).aspx</a></p><p>The passthrough, etc, is working as intended as everything is displaying on my second video card that&#039;s being passed through.&#160; I should also that, that with this configuration, command, etc, when I create a &quot;new&quot; win7 LVM and attempt to install Windows 7, the installation freezes before it starts to extract windows files.</p></div></blockquote></div><p>Did you install windows with virt manager using an ahci or ide controller? if you installed windows with the ide controller (which i believe virt-manager uses by default) you&#039;ll need to change some registry keys to make it boot on ahci, see this post: <a href="http://www.neowin.net/forum/topic/987378-how-to-switch-from-ide-to-ahci-without-repairingreinstalling-windows/" rel="nofollow">http://www.neowin.net/forum/topic/98737 … g-windows/</a></p><p>Also, If you&#039;re using vanilla kernel + qemu you might experience crashes, i posted some solutions on the guide, the most relieable one is using a patched kernel + patched qemu</p> <p class="postedit"><em>Last edited by nbhs (2013-07-11 04:45:25)</em></p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1298880">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1298881" class="blockpost roweven"> <h2><span><span class="conr">#224</span> <a href="viewtopic.php?pid=1298881#p1298881">2013-07-11 05:25:36</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=73066">Eldak</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2013-07-10</span></dd> <dd><span>Posts: 4</span></dd> <dd class="usercontacts"><span class="email"><a href="mailto:patrick.stueck@gmail.com">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>nbhs wrote:</cite><blockquote><div><p>Did you install windows with virt manager using an ahci or ide controller? if you installed windows with the ide controller (which i believe virt-manager uses by default) you&#039;ll need to change some registry keys to make it boot on ahci, see this post: <a href="http://www.neowin.net/forum/topic/987378-how-to-switch-from-ide-to-ahci-without-repairingreinstalling-windows/" rel="nofollow">http://www.neowin.net/forum/topic/98737 … g-windows/</a></p><p>Also, If you&#039;re using vanilla kernel + qemu you might experience crashes, i posted some solutions on the guide, the most relieable one is using a patched kernel + patched qemu</p></div></blockquote></div><p>That helped it get past the BSoD, Thanks!&#160; Now, it&#039;s acting like it&#039;s freezing up, but it&#039;s not frozen.&#160; The Starting Windows screen, with the fading in/out brightness to the Windows logo, just sitting their.&#160; I&#039;ll do some more research on this tomorrow.</p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1298881">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1298937" class="blockpost rowodd"> <h2><span><span class="conr">#225</span> <a href="viewtopic.php?pid=1298937#p1298937">2013-07-11 10:16:24</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=73099">naythuwin</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2013-07-11</span></dd> <dd><span>Posts: 1</span></dd> <dd class="usercontacts"><span class="email"><a href="misc.php?email=73099">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <p>[abcd@unknow ~]$ qemu-system-x86_64 -enable-kvm -m 2048 -cpu host -smp 2 -device vfio-pci,host=05:00.0,x-vga=on -bios /usr/share/qemu/bios.bin -vga none<br />KVM internal error. Suberror: 1<br />emulation failure<br />EAX=00000000 EBX=00000000 ECX=0000a19e EDX=000003d4<br />ESI=00009e48 EDI=0000823c EBP=0000c58a ESP=00008232<br />EIP=0009ffff EFL=00010006 [-----P-] CPL=0 II=0 A20=1 SMM=0 HLT=0<br />ES =0000 00000000 ffffffff 00809300<br />CS =0000 00000000 ffffffff 00809b00<br />SS =0000 00000000 ffffffff 00809300<br />DS =0000 00000000 ffffffff 00809300<br />FS =0000 00000000 ffffffff 00809300<br />GS =0000 00000000 ffffffff 00809300<br />LDT=0000 00000000 0000ffff 00008200<br />TR =0000 00000000 0000ffff 00008b00<br />GDT=&#160; &#160; &#160;000fd808 00000037<br />IDT=&#160; &#160; &#160;00000000 000003ff<br />CR0=00000010 CR2=00000000 CR3=00000000 CR4=00000000<br />DR0=0000000000000000 DR1=0000000000000000 DR2=0000000000000000 DR3=0000000000000000 <br />DR6=00000000ffff0ff0 DR7=0000000000000400<br />EFER=0000000000000000<br />Code=00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 &lt;00&gt; ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff</p><p>cpu : intel core i7<br />mobo : foxconn h61ap<br />kernel : Linux abcdef 3.10.0-1-mainline #1 SMP PREEMPT Wed Jul 10 23:38:07 MMT 2013 x86_64 GNU/Linux<br />graphic : onboard intel and pny geforce 8400gs pci 512M low profile</p><p>lspci | grep VGA<br />00:02.0 VGA compatible controller: Intel Corporation 2nd Generation Core Processor Family Integrated Graphics Controller (rev 09)<br />05:00.0 VGA compatible controller: NVIDIA Corporation G98 [GeForce 8400 GS Rev. 2] (rev a1)</p><p>secondery passthrough is work for me but primary is not<br />help me!</p> <p class="postedit"><em>Last edited by naythuwin (2013-07-11 10:24:57)</em></p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1298937">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div class="postlinksb"> <div class="inbox crumbsplus"> <div class="pagepost"> <p class="pagelink conl"><span class="pages-label">Pages: </span><a rel="prev" class="item1" href="viewtopic.php?id=162768&amp;p=8">Previous</a> <a href="viewtopic.php?id=162768">1</a> <span class="spacer">…</span> <a href="viewtopic.php?id=162768&amp;p=7">7</a> <a href="viewtopic.php?id=162768&amp;p=8">8</a> <strong>9</strong> <a href="viewtopic.php?id=162768&amp;p=10">10</a> <a href="viewtopic.php?id=162768&amp;p=11">11</a> <span class="spacer">…</span> <a href="viewtopic.php?id=162768&amp;p=234">234</a> <a rel="next" href="viewtopic.php?id=162768&amp;p=10">Next</a></p> <p class="postlink conr">Topic closed</p> </div> <ul class="crumbs"> <li><a href="index.php">Index</a></li> <li><span>»&#160;</span><a href="viewforum.php?id=48">Topics Going Nowhere</a></li> <li><span>»&#160;</span><strong><a href="viewtopic.php?id=162768">KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</a></strong></li> </ul> <p class="subscribelink clearb"><a href="misc.php?action=subscribe&amp;tid=162768">Subscribe to this topic</a></p> <div class="clearer"></div> </div> </div> </div> <div id="brdfooter" class="block"> <h2><span>Board footer</span></h2> <div class="box"> <div id="brdfooternav" class="inbox"> <div class="conl"> <form id="qjump" method="get" action="viewforum.php"> <div><label><span>Jump to<br /></span> <select name="id" onchange="window.location=('viewforum.php?id='+this.options[this.selectedIndex].value)"> <optgroup label="Technical Issues and Assistance"> <option value="23">Newbie Corner</option> <option value="17">Installation</option> <option value="22">Kernel &amp; Hardware</option> <option value="18">Applications &amp; Desktop Environments</option> <option value="31">Laptop Issues</option> <option value="8">Networking, Server, and Protection</option> <option value="32">Multimedia and Games</option> <option value="50">System Administration</option> <option value="35">Other Architectures</option> </optgroup> <optgroup label="Arch-centric"> <option value="24">Announcements, Package &amp; Security Advisories</option> <option value="1">Arch Discussion</option> <option value="13">Forum &amp; Wiki discussion</option> </optgroup> <optgroup label="Pacman Upgrades, Packaging &amp; AUR"> <option value="44">Pacman &amp; Package Upgrade Issues</option> <option value="49">[testing] Repo Forum</option> <option value="4">Creating &amp; Modifying Packages</option> <option value="38">AUR Issues, Discussion &amp; PKGBUILD Requests</option> </optgroup> <optgroup label="Contributions &amp; Discussion"> <option value="20">GNU/Linux Discussion</option> <option value="27">Community Contributions</option> <option value="33">Programming &amp; Scripting</option> <option value="30">Other Languages</option> <option value="47">Artwork and Screenshots</option> <option value="42">Try This</option> </optgroup> <optgroup label="/dev/null"> <option value="29">Off-Topic</option> <option value="48" selected="selected">Topics Going Nowhere</option> <option value="36">Dustbin</option> </optgroup> </select></label> <input type="submit" value=" Go " accesskey="g" /> </div> </form> </div> <div class="conr"> <p id="feedlinks"><span class="atom"><a href="extern.php?action=feed&amp;tid=162768&amp;type=atom">Atom topic feed</a></span></p> <p id="poweredby">Powered by <a href="http://fluxbb.org/">FluxBB</a></p> </div> <div class="clearer"></div> </div> </div> </div> </div> <div class="end-box"></div> </div> </body> </html>
