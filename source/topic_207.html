<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"> <html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en" dir="ltr"> <head> <meta http-equiv="Content-Type" content="text/html; charset=utf-8" /> <title>KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9 (Page 207) / Topics Going Nowhere / Arch Linux Forums</title> <link rel="stylesheet" type="text/css" href="style/ArchLinux.css" /> <link rel="canonical" href="viewtopic.php?id=162768&amp;p=207" title="Page 207" /> <link rel="prev" href="viewtopic.php?id=162768&amp;p=206" title="Page 206" /> <link rel="next" href="viewtopic.php?id=162768&amp;p=208" title="Page 208" /> <link rel="alternate" type="application/atom+xml" href="extern.php?action=feed&amp;tid=162768&amp;type=atom" title="Atom topic feed" /> <link rel="stylesheet" media="screen" href="style/ArchLinux/arch.css?v=3" /> <link rel="stylesheet" media="screen" href="style/ArchLinux/archnavbar.css?v=2" /> <link rel="shortcut icon" href="style/ArchLinux/favicon.ico" /> </head> <body> <div id="archnavbar" class="anb-forum"> <div id="archnavbarlogo"><h1><a href="http://www.archlinux.org/">Arch Linux</a></h1></div> <div id="archnavbarmenu"> <ul id="archnavbarlist"> <li id="anb-home"><a href="http://www.archlinux.org/">Home</a></li><li id="anb-packages"><a href="http://www.archlinux.org/packages/">Packages</a></li><li id="anb-forums" class="anb-selected"><a href="https://bbs.archlinux.org/">Forums</a></li><li id="anb-wiki"><a href="https://wiki.archlinux.org/">Wiki</a></li><li id="anb-bugs"><a href="https://bugs.archlinux.org/">Bugs</a></li><li id="anb-aur"><a href="https://aur.archlinux.org/">AUR</a></li><li id="anb-download"><a href="http://www.archlinux.org/download/">Download</a></li> </ul> </div> </div> <div id="punviewtopic" class="pun"> <div class="top-box"></div> <div class="punwrap"> <div id="brdheader" class="block"> <div class="box"> <div id="brdmenu" class="inbox"> <ul> <li id="navindex" class="isactive"><a href="index.php">Index</a></li> <li id="navuserlist"><a href="userlist.php">User list</a></li> <li id="navsearch"><a href="search.php">Search</a></li> <li id="navprofile"><a href="profile.php?id=80749">Profile</a></li> <li id="navlogout"><a href="login.php?action=out&amp;id=80749&amp;csrf_token=5c20501ec397bb45ef8ee8c84db232c8d8e421c6">Logout</a></li> </ul> </div> <div id="brdwelcome" class="inbox"> <ul class="conl"> <li><span>Logged in as <strong>SXX</strong></span></li> <li><span>Last visit: 2015-08-16 12:20:09</span></li> </ul> <ul class="conr"> <li><span>Topics: <a href="search.php?action=show_replies" title="Find topics you have posted to.">Posted</a> | <a href="search.php?action=show_new" title="Find topics with new posts since your last visit.">New</a> | <a href="search.php?action=show_recent" title="Find topics with recent posts.">Active</a> | <a href="search.php?action=show_unanswered" title="Find topics with no replies.">Unanswered</a></span></li> </ul> <div class="clearer"></div> </div> </div> </div> <div id="brdmain"> <div class="linkst"> <div class="inbox crumbsplus"> <ul class="crumbs"> <li><a href="index.php">Index</a></li> <li><span>»&#160;</span><a href="viewforum.php?id=48">Topics Going Nowhere</a></li> <li><span>»&#160;</span><strong><a href="viewtopic.php?id=162768">KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</a></strong></li> </ul> <div class="pagepost"> <p class="pagelink conl"><span class="pages-label">Pages: </span><a rel="prev" class="item1" href="viewtopic.php?id=162768&amp;p=206">Previous</a> <a href="viewtopic.php?id=162768">1</a> <span class="spacer">…</span> <a href="viewtopic.php?id=162768&amp;p=205">205</a> <a href="viewtopic.php?id=162768&amp;p=206">206</a> <strong>207</strong> <a href="viewtopic.php?id=162768&amp;p=208">208</a> <a href="viewtopic.php?id=162768&amp;p=209">209</a> <span class="spacer">…</span> <a href="viewtopic.php?id=162768&amp;p=234">234</a> <a rel="next" href="viewtopic.php?id=162768&amp;p=208">Next</a></p> <p class="postlink conr">Topic closed</p> </div> <div class="clearer"></div> </div> </div> <div id="p1530848" class="blockpost rowodd blockpost1"> <h2><span><span class="conr">#5151</span> <a href="viewtopic.php?pid=1530848#p1530848">2015-05-22 07:45:12</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=91096">corna</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2015-05-13</span></dd> <dd><span>Posts: 12</span></dd> <dd class="usercontacts"><span class="email"><a href="mailto:nicola@corna.info">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>Duelist wrote:</cite><blockquote><div><p>1. What windows do you use? Win 7? Have you followed the instructions from <a href="http://people.redhat.com/~lersek/ovmf-whitepaper-c770f8c.txt" rel="nofollow">OVMF whitepaper?</a> Win 8? Win 8 won&#039;t need QXL at all.<br />2. ISA debug console, like</p><div class="codebox"><pre><code>-debugcon file:debug.log -global isa-debugcon.iobase=0x402 </code></pre></div><p> should produce debug.log with OVMF logging.<br />Have you tried installing windows with QXL and then installing the drivers despite seeing code 12? Maybe QXL will fall off(windows will disable it) and the GPU will fire up nicely(like it happened on my setup).</p></div></blockquote></div><p>I&#039;m using Windows 7 (look at my previous posts). If I use -M q35 I get an error 12, while if I use -M pc-i440fx-2.2 it reports an error 43 (even if I&#039;m using kvm=off and no hyper-v enlightments)<br />A simple workaround for all the DRI problems is to use Wayland: in Wayland DRI works and the current status on gnome 3.14 is quite good.<br />I haven&#039;t read the OVMF whitepaper, I&#039;m reading it right now thanks</p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1530848">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1530872" class="blockpost roweven"> <h2><span><span class="conr">#5152</span> <a href="viewtopic.php?pid=1530872#p1530872">2015-05-22 11:07:36</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=91334">crashtua</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2015-05-22</span></dd> <dd><span>Posts: 4</span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <p>Hello everyone.<br />I have following configuration:</p><div class="quotebox"><blockquote><div><p>sabertooth fx990 r2.0<br />fx 8320<br />gtx 980(vm)<br />gtx 750ti(host)</p></div></blockquote></div><p>kvm modules options:</p><div class="quotebox"><blockquote><div><p>cat /etc/modprobe.d/kvm*<br />options kvm-amd npt=0<br />options kvm ignore_msrs=1</p></div></blockquote></div><p>vm command line:</p><div class="quotebox"><blockquote><div><p>sudo qemu-system-x86_64 \<br />-name qwerty_nosound \<br />-machine pc-i440fx-2.0,accel=kvm,usb=off \<br />-cpu host,kvm=off \<br />-m 8192 \<br />-mem-path /dev/hugepages \<br />-realtime mlock=off \<br />-smp 8,sockets=1,cores=8,threads=1 \<br />-uuid d616d9cd-aa9d-564a-7999-704787e5ea6c \<br />-no-user-config \<br />-nodefaults \<br />-rtc base=localtime \<br />-usb \<br />-boot menu=off,strict=on \<br />-msg timestamp=on \<br />-device vfio-pci,host=06:00.0,multifunction=on,x-vga=on \<br />-device vfio-pci,host=06:00.1 \<br />-device virtio-scsi-pci,id=scsi \<br />-device AC97,id=sound0,bus=pci.0,addr=0x6 \<br />-drive file=/home/eugene/Downloads/ru_windows_7_professional_with_sp1_vl_build_x64_dvd_u_677774.iso,id=isocd,if=none -device scsi-cd,drive=isocd \<br />-drive file=/home/dev/windows.img,id=disk,format=raw,if=none -device scsi-hd,drive=disk \<br />-drive file=/home/eugene/Downloads/virtio-win-0.1.96.iso,id=virtiocd,if=none -device ide-cd,bus=ide.1,drive=virtiocd \<br />-drive file=/home/eugene/dota.img,id=disk1,format=raw,if=none -device scsi-hd,drive=disk1 \<br />-netdev user,id=inet \<br />-device e1000,netdev=inet \<br />-netdev tap,id=hoa,script=/usr/qemu-ifup \<br />-device e1000,netdev=hoa,mac=DE:AD:BE:EF:68:98 \<br />-nographic \<br />-monitor stdio</p></div></blockquote></div><p>Everything works fine, but every 10-15 seconds during gaming fps drops to 0 for 1 second and then back to normal. Can someone tell how this lags can be removed?</p> <p class="postedit"><em>Last edited by crashtua (2015-05-22 12:31:55)</em></p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1530872">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1530897" class="blockpost rowodd"> <h2><span><span class="conr">#5153</span> <a href="viewtopic.php?pid=1530897#p1530897">2015-05-22 13:17:43</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=85314">Duelist</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2014-09-22</span></dd> <dd><span>Posts: 358</span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>corna wrote:</cite><blockquote><div><div class="quotebox"><cite>Duelist wrote:</cite><blockquote><div><p>1. What windows do you use? Win 7? Have you followed the instructions from <a href="http://people.redhat.com/~lersek/ovmf-whitepaper-c770f8c.txt" rel="nofollow">OVMF whitepaper?</a> Win 8? Win 8 won&#039;t need QXL at all.<br />2. ISA debug console, like</p><div class="codebox"><pre><code>-debugcon file:debug.log -global isa-debugcon.iobase=0x402 </code></pre></div><p> should produce debug.log with OVMF logging.<br />Have you tried installing windows with QXL and then installing the drivers despite seeing code 12? Maybe QXL will fall off(windows will disable it) and the GPU will fire up nicely(like it happened on my setup).</p></div></blockquote></div><p>I&#039;m using Windows 7 (look at my previous posts). If I use -M q35 I get an error 12, while if I use -M pc-i440fx-2.2 it reports an error 43 (even if I&#039;m using kvm=off and no hyper-v enlightments)<br />A simple workaround for all the DRI problems is to use Wayland: in Wayland DRI works and the current status on gnome 3.14 is quite good.<br />I haven&#039;t read the OVMF whitepaper, I&#039;m reading it right now thanks</p></div></blockquote></div><p>Use 440FX because q35 gives you <a href="https://awilliam.github.io/presentations/KVM-Forum-2014/#/5/1" rel="nofollow">no advantages</a>. Breeze through the OVMF whitepaper, you should be able to find something that you&#039;ve missed, because i can&#039;t see the problem right now. Also, seems like you forgot about the ISA debug console...</p><br /><div class="quotebox"><cite>crashtua wrote:</cite><blockquote><div><p>Everything works fine, but every 10-15 seconds during gaming fps drops to 0 for 1 second and then back to normal. Can someone tell how this lags can be removed?</p></div></blockquote></div><p>Well, first you&#039;ll need to clear up your config.</p><div class="codebox"><pre><code>-machine pc-i440fx-2.0,accel=kvm,usb=off \</code></pre></div><p>Are you sure about that line? accel=kvm is soooo &quot;old school&quot;, that it&#039;s not needed anymore.<br />Turning off USB looks strange, especially having &quot;-usb \&quot; later on.</p><div class="codebox"><pre><code>-mem-path /dev/hugepages \ </code></pre></div><p>That may be the problematic place, as hugepages and npt may work not-so-well on AMD platforms, try toggling that and NPT.</p><div class="codebox"><pre><code>-realtime mlock=off \</code></pre></div><p>Now THAT&#039;s a strange thing to do. Back in the day, i&#039;ve forced mlock=on only to find out it&#039;s default on.<br />Are you sure you know why you&#039;ve turned it off and what that option does?</p><div class="codebox"><pre><code>-device AC97,id=sound0,bus=pci.0,addr=0x6 \</code></pre></div><p>I can see a soundcard device, but no sound output options, do you have sound on your VM?..</p><div class="codebox"><pre><code>-netdev user,id=inet \ -device e1000,netdev=inet \ -netdev tap,id=hoa,script=/usr/qemu-ifup \ -device e1000,netdev=hoa,mac=DE:AD:BE:EF:68:98 \</code></pre></div><p>Since you&#039;re obviously playing DotA, do you really need a user-mode networking AND a tap interface simultaneously? User mode networking can be very CPU consuming.</p><p>The general advice:<br />Monitor your CPU load. You&#039;re using 8 cores out of 8 available ones, maybe the host system does something strange.</p> </div> <div class="postsignature postmsg"><hr /><p><span class="bbs">The forum rules prohibit requesting support for distributions other than arch.</span><br /><a href="https://bbs.archlinux.org/viewtopic.php?pid=1551460#p1551460" rel="nofollow">I gave up.</a><a href="https://bbs.archlinux.org/viewtopic.php?id=162768" rel="nofollow"> It was too late.</a><br /><a href="http://pastebin.com/B3fL84bq" rel="nofollow">What I was trying to do</a>.<br /><a href="http://vfio.blogspot.com/" rel="nofollow">The reference about VFIO and KVM VGA passthrough.</a></p></div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1530897">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1530903" class="blockpost roweven"> <h2><span><span class="conr">#5154</span> <a href="viewtopic.php?pid=1530903#p1530903">2015-05-22 13:59:34</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=91334">crashtua</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2015-05-22</span></dd> <dd><span>Posts: 4</span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>Duelist wrote:</cite><blockquote><div><p>That may be the problematic place, as hugepages and npt may work not-so-well on AMD platforms, try toggling that and NPT.</p></div></blockquote></div><p>You mean set kvm-amd.npt to 1 and leave -mem-path /dev/hugepages? </p><div class="quotebox"><cite>Duelist wrote:</cite><blockquote><div><p>Now THAT&#039;s a strange thing to do. Back in the day, i&#039;ve forced mlock=on only to find out it&#039;s default on.<br />Are you sure you know why you&#039;ve turned it off and what that option does?</p></div></blockquote></div><p>No, I am not. Just grabbed some qemu execute string from internet, and it worked for me, but as you can see, not as good as I expected:)<br />And thanks for reply, because it is really hard to follow up this 200-page topic.</p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1530903">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1530914" class="blockpost rowodd"> <h2><span><span class="conr">#5155</span> <a href="viewtopic.php?pid=1530914#p1530914">2015-05-22 14:57:17</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=78620">mostlyharmless</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2014-01-16</span></dd> <dd><span>Posts: 50</span></dd> <dd class="usercontacts"><span class="email"><a href="misc.php?email=78620">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <p>@aw<br />Thanks for the suggestion about the vmx setting and looking at the qemu command line. (beginning p. 206, end of p 205)&#160; However, the problem persists.&#160; Unfortunately, I didn&#039;t check the functioning of XP Mode every step of the way in going from qemu-script q35 with SeaBios to libvirt 440fx with OVMF and UEFI, so I don&#039;t know which part of the transition made it stop working. <br />This is the command line from /var/log/libvirt/qemu:</p><div class="codebox"><pre><code>LC_ALL=C PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin QEMU_AUDIO_DRV=none /usr/sbin/qemu-system-x86_64 -name Windows7 -S -machine pc-i440fx-2.2,accel=kvm,usb=off -cpu SandyBridge,+vmx,kvm=off -drive file=/usr/share/edk2.git/ovmf-x64/OVMF_CODE-pure-efi.fd,if=pflash,format=raw,unit=0,readonly=on -drive file=/var/lib/libvirt/qemu/nvram/Windows7_VARS.fd,if=pflash,format=raw,unit=1 -m 8192 -mem-prealloc -mem-path /dev/hugepages/libvirt/qemu -realtime mlock=off -smp 6,sockets=6,cores=1,threads=1 -uuid f63ea610-45ae-4daa-bc14-4e2204XXXXX -nographic -no-user-config -nodefaults -chardev socket,id=charmonitor,path=/var/lib/libvirt/qemu/Windows7.monitor,server,nowait -mon chardev=charmonitor,id=monitor,mode=control -rtc base=utc,driftfix=slew -global kvm-pit.lost_tick_policy=discard -no-hpet -no-shutdown -global PIIX4_PM.disable_s3=1 -global PIIX4_PM.disable_s4=1 -boot strict=on -device ich9-usb-ehci1,id=usb,bus=pci.0,addr=0x6.0x7 -device ich9-usb-uhci1,masterbus=usb.0,firstport=0,bus=pci.0,multifunction=on,addr=0x6 -device ich9-usb-uhci2,masterbus=usb.0,firstport=2,bus=pci.0,addr=0x6.0x1 -device ich9-usb-uhci3,masterbus=usb.0,firstport=4,bus=pci.0,addr=0x6.0x2 -device virtio-serial-pci,id=virtio-serial0,bus=pci.0,addr=0x5 -drive file=/dev/sr0,if=none,id=drive-ide0-0-1,readonly=on,format=raw -device ide-cd,bus=ide.0,unit=1,drive=drive-ide0-0-1,id=ide0-0-1 -drive file=/home/me/virtio-win-0.1-100.iso,if=none,id=drive-ide0-1-0,readonly=on,format=raw -device ide-cd,bus=ide.1,unit=0,drive=drive-ide0-1-0,id=ide0-1-0 -drive file=/dev/cryptvg2/win7,if=none,id=drive-virtio-disk0,format=raw,cache=none,aio=native -device virtio-blk-pci,scsi=off,bus=pci.0,addr=0xa,drive=drive-virtio-disk0,id=virtio-disk0,bootindex=1 -netdev tap,fd=23,id=hostnet0,vhost=on,vhostfd=24 -device virtio-net-pci,netdev=hostnet0,id=net0,mac=52:54:XX:XX:XX:XX,bus=pci.0,addr=0x3 -device intel-hda,id=sound0,bus=pci.0,addr=0x4 -device hda-duplex,id=sound0-codec0,bus=sound0.0,cad=0 -device vfio-pci,host=03:00.0,id=hostdev0,bus=pci.0,addr=0x8 -device vfio-pci,host=03:00.1,id=hostdev1,bus=pci.0,addr=0x9 -device usb-host,hostbus=4,hostaddr=4,id=hostdev2 -device virtio-balloon-pci,id=balloon0,bus=pci.0,addr=0x7 -msg timestamp=on </code></pre></div><p>This is the old version:</p><div class="codebox"><pre><code>QEMU_AUDIO_TIMER_PERIOD=0 QEMU_AUDIO_DRV=alsa \ sudo qemu-system-x86_64 -enable-kvm -M q35 -m 8192 \ -cpu host,hv-time,hv_relaxed,hv_vapic,hv_spinlocks=0x1000 -smp 6,sockets=1,cores=6,threads=1 \ -bios /usr/share/qemu/bios.bin -vga none -nographic \ -device ioh3420,bus=pcie.0,addr=1c.0,multifunction=on,port=1,chassis=1,id=root.1 \ -device vfio-pci,host=03:00.0,bus=root.1,addr=00.0,multifunction=on,x-vga=on \ -device vfio-pci,host=03:00.1,bus=root.1,addr=00.1 \ -usbdevice tablet -usbdevice host:0803:3095 -usbdevice host:0461:4d22 \ -usbdevice host:1131:1001 -usbdevice host:2304:023f \ -drive file=/dev/mapper/cryptvg2-win7,id=disk,if=virtio \ -device piix4-ide,bus=pcie.0,id=piix4-ide \ -drive file=/dev/cdrom,id=cddisk -device ide-cd,bus=piix4-ide.1,drive=cddisk \ -net vde,vlan=0 -net nic,vlan=0,macaddr=52:45:4d:XX:XX:XX,model=virtio \ -device ich9-intel-hda,bus=pcie.0,addr=1b.0,id=sound0 \ -device hda-duplex,id=sound0-codec0,bus=sound0.0,cad=0 \ -rtc base=localtime \ -monitor unix:/home/me/monitor,server,nowait</code></pre></div><p>I got rid of the hv stuff and upgraded the Nvidia drivers after converting to OVMF.&#160; Obviously the cpu has changed form &quot;host&quot; to &quot;SandyBridge&quot; (there was no host option when I made the new version using VMM), and some of the usb devices have been changed around.&#160; I suspect the main difference is libvirt.</p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1530914">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1530925" class="blockpost roweven"> <h2><span><span class="conr">#5156</span> <a href="viewtopic.php?pid=1530925#p1530925">2015-05-22 15:39:24</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=75590">aw</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2013-10-04</span></dd> <dd><span>Posts: 921</span></dd> <dd class="usercontacts"><span class="email"><a href="misc.php?email=75590">Email</a></span> <span class="website"><a href="http://vfio.blogspot.com/" rel="nofollow">Website</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>mostlyharmless wrote:</cite><blockquote><div><p>I got rid of the hv stuff and upgraded the Nvidia drivers after converting to OVMF.&#160; Obviously the cpu has changed form &quot;host&quot; to &quot;SandyBridge&quot; (there was no host option when I made the new version using VMM), and some of the usb devices have been changed around.&#160; I suspect the main difference is libvirt.</p></div></blockquote></div><p>libvirt is just a mechanism for managing the VM, it&#039;s still just using QEMU in the end, so if XP mode can be done via QEMU commandline, it should be possible to do it with libvirt.&#160; To get the &quot;host&quot; CPU option, just manually type &quot;host-passthrough&quot; in the virt-manager drop-down box.&#160; It&#039;s not listed as a select-able option, but it works.&#160; You can also manually edit the xml to something like:</p><div class="codebox"><pre><code> &lt;cpu mode=&#039;host-passthrough&#039;&gt; &lt;topology sockets=&#039;1&#039; cores=&#039;4&#039; threads=&#039;1&#039;/&gt; &lt;/cpu&gt;</code></pre></div> </div> <div class="postsignature postmsg"><hr /><p><a href="http://vfio.blogspot.com" rel="nofollow">http://vfio.blogspot.com</a><br />Looking for a more open forum to discuss vfio related uses?&#160; Try <a href="https://www.redhat.com/mailman/listinfo/vfio-users" rel="nofollow">https://www.redhat.com/mailman/listinfo/vfio-users</a></p></div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1530925">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1530927" class="blockpost rowodd"> <h2><span><span class="conr">#5157</span> <a href="viewtopic.php?pid=1530927#p1530927">2015-05-22 15:43:45</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=75590">aw</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2013-10-04</span></dd> <dd><span>Posts: 921</span></dd> <dd class="usercontacts"><span class="email"><a href="misc.php?email=75590">Email</a></span> <span class="website"><a href="http://vfio.blogspot.com/" rel="nofollow">Website</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>crashtua wrote:</cite><blockquote><div><p>Everything works fine, but every 10-15 seconds during gaming fps drops to 0 for 1 second and then back to normal. Can someone tell how this lags can be removed?</p></div></blockquote></div><p>Perhaps something to do with leaving no cores available for the host?&#160; You have an 8-core host and you&#039;ve created an 8-core guest.&#160; How is the normal running of the host supposed to not interfere with the VM?&#160; It&#039;s gotta get CPU time somehow.</p> </div> <div class="postsignature postmsg"><hr /><p><a href="http://vfio.blogspot.com" rel="nofollow">http://vfio.blogspot.com</a><br />Looking for a more open forum to discuss vfio related uses?&#160; Try <a href="https://www.redhat.com/mailman/listinfo/vfio-users" rel="nofollow">https://www.redhat.com/mailman/listinfo/vfio-users</a></p></div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1530927">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1530945" class="blockpost roweven"> <h2><span><span class="conr">#5158</span> <a href="viewtopic.php?pid=1530945#p1530945">2015-05-22 16:47:15</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=78620">mostlyharmless</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2014-01-16</span></dd> <dd><span>Posts: 50</span></dd> <dd class="usercontacts"><span class="email"><a href="misc.php?email=78620">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <p>@aw Thanks, I&#039;ll give it a try.&#160; &lt;rant&gt; There&#039;s only so much reconfiguration one can do.&#160; I&#039;m concerned that Windows will once again decide that I have changed machines and that I have 3 days to activate. The last two times the automatic version didn&#039;t work and I had to call the Microsoft number, still semiautomatic.&#160; Sooner or later I assume that won&#039;t work either and they&#039;ll insist I buy a new licence.&#160; Rather annoying since I&#039;ve had only one installation and am merely trying to optimize the VM.&#160; Since that takes time (witness the last 200+ pages), activation is necessary at some point. Oi &lt;rant/&gt;</p><p>Re libvirt, surely there&#039;s more to it than that.&#160; Libvirt uses virsh to attach devices; I use to just use vfio-bind. Also, I tried passing the qemu command line from /var/log/libvirt to the command line in a script, and get nothing, black screen, no VM.</p> <p class="postedit"><em>Last edited by mostlyharmless (2015-05-22 17:07:11)</em></p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1530945">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1530961" class="blockpost rowodd"> <h2><span><span class="conr">#5159</span> <a href="viewtopic.php?pid=1530961#p1530961">2015-05-22 17:18:36</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=75590">aw</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2013-10-04</span></dd> <dd><span>Posts: 921</span></dd> <dd class="usercontacts"><span class="email"><a href="misc.php?email=75590">Email</a></span> <span class="website"><a href="http://vfio.blogspot.com/" rel="nofollow">Website</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>mostlyharmless wrote:</cite><blockquote><div><p>Re libvirt, surely there&#039;s more to it than that.&#160; Libvirt uses virsh to attach devices; I use to just use vfio-bind. Also, I tried passing the qemu command line from /var/log/libvirt to the command line in a script, and get nothing, black screen, no VM.</p></div></blockquote></div><p>libvirt passes various file descriptors by number rather than letting QEMU open things on its own, it also configures networks and passes tap devices, so you can&#039;t simply cut and paste the command line to a shell prompt and expect it to work.&#160; You can however re-parse it into something that will work by hand, I&#039;ve done this many times in debugging issues.&#160; Why do you think that <em>virsh nodedev-detach</em> is really all that much different from vfio-bind?&#160; libvirt knows how to manipulate devices and drivers via sysfs too.&#160; If anything, the vfio-bind script is the path to avoid.</p> </div> <div class="postsignature postmsg"><hr /><p><a href="http://vfio.blogspot.com" rel="nofollow">http://vfio.blogspot.com</a><br />Looking for a more open forum to discuss vfio related uses?&#160; Try <a href="https://www.redhat.com/mailman/listinfo/vfio-users" rel="nofollow">https://www.redhat.com/mailman/listinfo/vfio-users</a></p></div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1530961">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1530970" class="blockpost roweven"> <h2><span><span class="conr">#5160</span> <a href="viewtopic.php?pid=1530970#p1530970">2015-05-22 17:33:20</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=78620">mostlyharmless</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2014-01-16</span></dd> <dd><span>Posts: 50</span></dd> <dd class="usercontacts"><span class="email"><a href="misc.php?email=78620">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <p>Yeah, I removed the network stuff, I assume the rest could run; I&#039;ll do more trimming if the cpu change doesn&#039;t do it.&#160; I don&#039;t know about virsh vs vfio-bind; I only know what I&#039;ve read here, and switched to virsh accordingly when I switched to libvirt.&#160; But, as you point out, there are subtle differences, else one would not be preferable to the other.&#160; </p><p>Before I switched to libvirt, I tried using virsh instead of vfio-bind with my old script and got the dreaded Windows 7B error every time. Switched back to vfio-bind, it disappeared again.&#160; So there&#039;s something Windows detects differently between the two.&#160; I have no idea whether it&#039;s part of the current XP mode problem.</p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1530970">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1531003" class="blockpost rowodd"> <h2><span><span class="conr">#5161</span> <a href="viewtopic.php?pid=1531003#p1531003">2015-05-22 18:48:13</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=85314">Duelist</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2014-09-22</span></dd> <dd><span>Posts: 358</span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>crashtua wrote:</cite><blockquote><div><div class="quotebox"><cite>Duelist wrote:</cite><blockquote><div><p>That may be the problematic place, as hugepages and npt may work not-so-well on AMD platforms, try toggling that and NPT.</p></div></blockquote></div><p>You mean set kvm-amd.npt to 1 and leave -mem-path /dev/hugepages? </p><div class="quotebox"><cite>Duelist wrote:</cite><blockquote><div><p>Now THAT&#039;s a strange thing to do. Back in the day, i&#039;ve forced mlock=on only to find out it&#039;s default on.<br />Are you sure you know why you&#039;ve turned it off and what that option does?</p></div></blockquote></div><p>No, I am not. Just grabbed some qemu execute string from internet, and it worked for me, but as you can see, not as good as I expected:)<br />And thanks for reply, because it is really hard to follow up this 200-page topic.</p></div></blockquote></div><p>As i&#039;ve been suggested on IRC: man 3 mlock. Basically, by saying &quot;mlock=off&quot; you&#039;re saying &quot;HA! Let that VM memory be swapped!&quot;. Which is a very strange thing to do, considering our system being more or less realtime. So chop off that line. Also, using VFIO pins the memory in one place, preventing it from being moved around in the system memory, so, as i understand it, it will never actually be swapped, and that option won&#039;t do anything useful.</p><p>Test the VM performance with all combinations of npt=1 or npt=0 and hugepages enabled/disabled. That&#039;s all. You might eventually get better performance with npt=1 and hugepages enabled, or it may do the opposite thing due to AMD problems, as was noted two years old in the op-post.</p><p>And regarding your CPU usage, as aw suggests... I have 4 cores, of which i&#039;m allowing VM to use all 4 cores, and i haven&#039;t observed anything alike to your problems <span class="bbu">when neither host nor guest system is doing something very cpu intensive</span>. When the host loads all four cores with some stuff - the VM struggles and lags, and vice versa.<br />A generally good idea would be to isolate some(maybe all seven, leaving host with one core) CPU cores from host usage and dedicate them to the VM. Usually this helps a lot when pursuiting latency issues. You could set those cores to NoHZ mode(or something like that, i don&#039;t quite remember) or doing cpuset.</p><p>And there&#039;s a good in-depth manual available from <a href="https://access.redhat.com/documentation/en-US/Red_Hat_Enterprise_Linux/7/html/Virtualization_Tuning_and_Optimization_Guide/index.html" rel="nofollow">redhat</a>.</p><p>P.S.<br />Я не помню чтобы даже на хабре была эта mlock=off. Откуда?..</p> <p class="postedit"><em>Last edited by Duelist (2015-05-22 18:48:30)</em></p> </div> <div class="postsignature postmsg"><hr /><p><span class="bbs">The forum rules prohibit requesting support for distributions other than arch.</span><br /><a href="https://bbs.archlinux.org/viewtopic.php?pid=1551460#p1551460" rel="nofollow">I gave up.</a><a href="https://bbs.archlinux.org/viewtopic.php?id=162768" rel="nofollow"> It was too late.</a><br /><a href="http://pastebin.com/B3fL84bq" rel="nofollow">What I was trying to do</a>.<br /><a href="http://vfio.blogspot.com/" rel="nofollow">The reference about VFIO and KVM VGA passthrough.</a></p></div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1531003">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1531020" class="blockpost roweven"> <h2><span><span class="conr">#5162</span> <a href="viewtopic.php?pid=1531020#p1531020">2015-05-22 19:38:32</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=91334">crashtua</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2015-05-22</span></dd> <dd><span>Posts: 4</span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>Duelist wrote:</cite><blockquote><div><p>P.S.<br />Я не помню чтобы даже на хабре была эта mlock=off. Откуда?..</p></div></blockquote></div><p>Честно? Я хз откуда я это взял хДД</p><p>Thanks everyone for reply, have good points for optimization. With leaving 2 cores for host and npt=1+hugepages i have constant, but 60 fps in dota(0-110 before changes), so most likely I am on right track.</p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1531020">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1531021" class="blockpost rowodd"> <h2><span><span class="conr">#5163</span> <a href="viewtopic.php?pid=1531021#p1531021">2015-05-22 19:39:52</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=75590">aw</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2013-10-04</span></dd> <dd><span>Posts: 921</span></dd> <dd class="usercontacts"><span class="email"><a href="misc.php?email=75590">Email</a></span> <span class="website"><a href="http://vfio.blogspot.com/" rel="nofollow">Website</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>crashtua wrote:</cite><blockquote><div><div class="quotebox"><cite>Duelist wrote:</cite><blockquote><div><p>P.S.<br />Я не помню чтобы даже на хабре была эта mlock=off. Откуда?..</p></div></blockquote></div><p>Честно? Я хз откуда я это взял хДД</p><p>Thanks everyone for reply, have good points for optimization. With leaving 2 cores for host and npt=1+hugepages i have constant, but 60 fps in dota(0-110 before changes), so most likely I am on right track.</p></div></blockquote></div><p>60fps sounds suspiciously like an in-game limitter</p> </div> <div class="postsignature postmsg"><hr /><p><a href="http://vfio.blogspot.com" rel="nofollow">http://vfio.blogspot.com</a><br />Looking for a more open forum to discuss vfio related uses?&#160; Try <a href="https://www.redhat.com/mailman/listinfo/vfio-users" rel="nofollow">https://www.redhat.com/mailman/listinfo/vfio-users</a></p></div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1531021">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1531028" class="blockpost roweven"> <h2><span><span class="conr">#5164</span> <a href="viewtopic.php?pid=1531028#p1531028">2015-05-22 19:47:06</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=90340">paperinick</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2015-04-14</span></dd> <dd><span>Posts: 8</span></dd> <dd class="usercontacts"><span class="email"><a href="misc.php?email=90340">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>Duelist wrote:</cite><blockquote><div><p>I was too lazy to fix the paths, so i just did</p></div></blockquote></div><p>that&#039;s good enough, many thanks! I will experiment next week and hopefully see some progress!!</p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1531028">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1531044" class="blockpost rowodd"> <h2><span><span class="conr">#5165</span> <a href="viewtopic.php?pid=1531044#p1531044">2015-05-22 20:49:52</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=85314">Duelist</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2014-09-22</span></dd> <dd><span>Posts: 358</span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>aw wrote:</cite><blockquote><div><div class="quotebox"><cite>crashtua wrote:</cite><blockquote><div><div class="quotebox"><cite>Duelist wrote:</cite><blockquote><div><p>P.S.<br />Я не помню чтобы даже на хабре была эта mlock=off. Откуда?..</p></div></blockquote></div><p>Честно? Я хз откуда я это взял хДД</p><p>Thanks everyone for reply, have good points for optimization. With leaving 2 cores for host and npt=1+hugepages i have constant, but 60 fps in dota(0-110 before changes), so most likely I am on right track.</p></div></blockquote></div><p>60fps sounds suspiciously like an in-game limitter</p></div></blockquote></div><p>Assuming it&#039;s still a source-based <span class="bbs">stuff</span>game, there&#039;s a variable called fps_max which, well, sets the limit.</p> </div> <div class="postsignature postmsg"><hr /><p><span class="bbs">The forum rules prohibit requesting support for distributions other than arch.</span><br /><a href="https://bbs.archlinux.org/viewtopic.php?pid=1551460#p1551460" rel="nofollow">I gave up.</a><a href="https://bbs.archlinux.org/viewtopic.php?id=162768" rel="nofollow"> It was too late.</a><br /><a href="http://pastebin.com/B3fL84bq" rel="nofollow">What I was trying to do</a>.<br /><a href="http://vfio.blogspot.com/" rel="nofollow">The reference about VFIO and KVM VGA passthrough.</a></p></div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1531044">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1531122" class="blockpost roweven"> <h2><span><span class="conr">#5166</span> <a href="viewtopic.php?pid=1531122#p1531122">2015-05-23 04:15:28</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=83959">Jodaco</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2014-07-30</span></dd> <dd><span>Posts: 3</span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <p>So in general my config has been working great for me, but I do have random lockups of the guest and host with no information in the logs whatsoever or any pattern to when they happen. I am just using qemu with command line parameters rather than libvirt. I am on an intel platform.&#160; &#160;I was wondering if anyone has any suggestions as to what kernel debugging options or other possible flags to pass to qemu for extra information so that I might track this down.</p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1531122">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1531144" class="blockpost rowodd"> <h2><span><span class="conr">#5167</span> <a href="viewtopic.php?pid=1531144#p1531144">2015-05-23 07:14:59</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=90593">mqddb</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2015-04-24</span></dd> <dd><span>Posts: 5</span></dd> <dd class="usercontacts"><span class="email"><a href="mailto:maqiang@shencloudtech.com">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <p>Hi ALL:<br />&#160; &#160; &#160;If CPU Integrated Graphics can passthrough to VM?</p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1531144">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1531145" class="blockpost roweven"> <h2><span><span class="conr">#5168</span> <a href="viewtopic.php?pid=1531145#p1531145">2015-05-23 07:15:02</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=91334">crashtua</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2015-05-22</span></dd> <dd><span>Posts: 4</span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>aw wrote:</cite><blockquote><div><p>60fps sounds suspiciously like an in-game limitter</p></div></blockquote></div><div class="quotebox"><cite>Duelist wrote:</cite><blockquote><div><p>Assuming it&#039;s still a source-based stuffgame, there&#039;s a variable called fps_max which, well, sets the limit.</p></div></blockquote></div><p>Doublechecked, no limit and no vsync enabled. But anyway, it is stable fps, even new witcher performs on stable 40, and ocasional freezes cant break normal gameplay. And older games, like tomb rider, works on constant 60(everything max, vsync enabled).</p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1531145">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1531333" class="blockpost rowodd"> <h2><span><span class="conr">#5169</span> <a href="viewtopic.php?pid=1531333#p1531333">2015-05-23 18:53:32</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=75590">aw</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2013-10-04</span></dd> <dd><span>Posts: 921</span></dd> <dd class="usercontacts"><span class="email"><a href="misc.php?email=75590">Email</a></span> <span class="website"><a href="http://vfio.blogspot.com/" rel="nofollow">Website</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>mqddb wrote:</cite><blockquote><div><p>Hi ALL:<br />&#160; &#160; &#160;If CPU Integrated Graphics can passthrough to VM?</p></div></blockquote></div><p>Intel, no, not yet.&#160; AMD, maybe.</p> </div> <div class="postsignature postmsg"><hr /><p><a href="http://vfio.blogspot.com" rel="nofollow">http://vfio.blogspot.com</a><br />Looking for a more open forum to discuss vfio related uses?&#160; Try <a href="https://www.redhat.com/mailman/listinfo/vfio-users" rel="nofollow">https://www.redhat.com/mailman/listinfo/vfio-users</a></p></div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1531333">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1531550" class="blockpost roweven"> <h2><span><span class="conr">#5170</span> <a href="viewtopic.php?pid=1531550#p1531550">2015-05-24 13:28:13</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=85004">protake</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2014-09-09</span></dd> <dd><span>Posts: 6</span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <p>Finally found some time to set up everything properly a few days ago and it works pretty well. The only thing that&#039;s bugging me is the mouse/keyboard. When passing them through, of course they aren&#039;t accessible from the host any more. Is there any way to make them accessible to both the guest and host? It&#039;d be nice for the guest to be &quot;escapable&quot;.</p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1531550">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1531551" class="blockpost rowodd"> <h2><span><span class="conr">#5171</span> <a href="viewtopic.php?pid=1531551#p1531551">2015-05-24 13:31:15</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=78620">mostlyharmless</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2014-01-16</span></dd> <dd><span>Posts: 50</span></dd> <dd class="usercontacts"><span class="email"><a href="misc.php?email=78620">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <p>Synergy works great for mouse and keyboard.</p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1531551">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1531641" class="blockpost roweven"> <h2><span><span class="conr">#5172</span> <a href="viewtopic.php?pid=1531641#p1531641">2015-05-24 19:59:40</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=85314">Duelist</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2014-09-22</span></dd> <dd><span>Posts: 358</span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>protake wrote:</cite><blockquote><div><p>Finally found some time to set up everything properly a few days ago and it works pretty well. The only thing that&#039;s bugging me is the mouse/keyboard. When passing them through, of course they aren&#039;t accessible from the host any more. Is there any way to make them accessible to both the guest and host? It&#039;d be nice for the guest to be &quot;escapable&quot;.</p></div></blockquote></div><p>I use libvirt&#039;s graphics window(doing win7+QXL being disabled), which looks like this:<br /><span class="postimg"><img src="http://i.imgur.com/pQ9FrlH.png" alt="A quick screenshot" /></span><br />(Due to HDD hardware migration process, i can&#039;t run the guest right now).<br />When the system starts, VM starts to emulate QXL graphics, and that provides me a window where keyboard and mouse input can be grabbed. To escape the guest, i must push ctrl-shift-alt which happens very rarely in normal VM use(not doing emacs stuff, for example).<br />So far - so good, input latency is low enough to play quake 3 arena competitively.<br />Before moving to libvirt i did almost the same thing, adding -device qxl to my qemu commandline and running without -nographics to have a small window where input may be grabbed.</p> </div> <div class="postsignature postmsg"><hr /><p><span class="bbs">The forum rules prohibit requesting support for distributions other than arch.</span><br /><a href="https://bbs.archlinux.org/viewtopic.php?pid=1551460#p1551460" rel="nofollow">I gave up.</a><a href="https://bbs.archlinux.org/viewtopic.php?id=162768" rel="nofollow"> It was too late.</a><br /><a href="http://pastebin.com/B3fL84bq" rel="nofollow">What I was trying to do</a>.<br /><a href="http://vfio.blogspot.com/" rel="nofollow">The reference about VFIO and KVM VGA passthrough.</a></p></div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1531641">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1531673" class="blockpost rowodd"> <h2><span><span class="conr">#5173</span> <a href="viewtopic.php?pid=1531673#p1531673">2015-05-24 21:52:37</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=91279">ghormoon</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2015-05-20</span></dd> <dd><span>Posts: 17</span></dd> <dd class="usercontacts"><span class="email"><a href="misc.php?email=91279">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <p>hi, I&#039;ve got into state where I actually see windows booting (the logo). after that, screen goes black. I can rdp into it and it says device works OK. maybe it remembers something wrong from the previous (cirrus) setup <img src="https://bbs.archlinux.org/img/smilies/sad.png" width="15" height="15" alt="sad" /><br />I&#039;ll try to reinstall it, if I figure out how to make it boot from CD without pressing &quot;any key&quot;, since usb keyboard doesn&#039;t work at that point <img src="https://bbs.archlinux.org/img/smilies/sad.png" width="15" height="15" alt="sad" /></p><p>another (maybe related, maybe not) problem I have is that when shutting down the domain, I get crash on &quot;kernel tried to execute NX-protected page - exploit attempt?&quot;, I can&#039;t even halt the host after that ...<br />dmesg: <a href="http://pastebin.com/c3bRQQFe" rel="nofollow">http://pastebin.com/c3bRQQFe</a></p><p>any ideas on any of those problems? <img src="https://bbs.archlinux.org/img/smilies/smile.png" width="15" height="15" alt="smile" /></p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1531673">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1531685" class="blockpost roweven"> <h2><span><span class="conr">#5174</span> <a href="viewtopic.php?pid=1531685#p1531685">2015-05-24 22:30:10</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=85314">Duelist</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2014-09-22</span></dd> <dd><span>Posts: 358</span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>ghormoon wrote:</cite><blockquote><div><p>hi, I&#039;ve got into state where I actually see windows booting (the logo). after that, screen goes black. I can rdp into it and it says device works OK. maybe it remembers something wrong from the previous (cirrus) setup <img src="https://bbs.archlinux.org/img/smilies/sad.png" width="15" height="15" alt="sad" /><br />I&#039;ll try to reinstall it, if I figure out how to make it boot from CD without pressing &quot;any key&quot;, since usb keyboard doesn&#039;t work at that point <img src="https://bbs.archlinux.org/img/smilies/sad.png" width="15" height="15" alt="sad" /></p><p>another (maybe related, maybe not) problem I have is that when shutting down the domain, I get crash on &quot;kernel tried to execute NX-protected page - exploit attempt?&quot;, I can&#039;t even halt the host after that ...<br />dmesg: <a href="http://pastebin.com/c3bRQQFe" rel="nofollow">http://pastebin.com/c3bRQQFe</a></p><p>any ideas on any of those problems? <img src="https://bbs.archlinux.org/img/smilies/smile.png" width="15" height="15" alt="smile" /></p></div></blockquote></div><p>You&#039;re not using OVMF, right? If so...<br />What the mess you have with your hardware?<br />What devices do you have and what are you trying to pass-through?<br />I see that you have kernel modesetting enabled and radeon module enabled, and that just attracts problems.</p><div class="codebox"><pre><code> [ 9.016962] fb: switching to radeondrmfb from VESA VGA</code></pre></div><p>Framebuffer thingie works via VGA, and you&#039;re trying to isolate VGA access and use it from vfio(and the VM) doing x-vga=on...</p><p>...</p><p>How the hell this thing is supposed to work? That&#039;s a notebook, it has one screen only! Are you trying to do secondary pass-through or throw a VNC connection from-guest-to-host to have a small window with windows(sic!) running 3D stuff in it? Or what?</p><p>Seems like you unbind the device from radeon and attach it to vfio-pci... but the device isn&#039;t properly returned to it&#039;s un-enabled state:</p><div class="codebox"><pre><code> [ 218.594123] [drm:rv770_stop_dpm [radeon]] *ERROR* Could not force DPM to low.</code></pre></div><p><span class="bbs">and something hints me that you&#039;ll have trouble with ROM, assuming 03:00.0 is actually the GPU in question(you haven&#039;t showed us lspci output yet), because...</span><br />AHAHAHAHA I AM GOING INSANE, THAT&#039;S AN SD CONTROLLER! WHICH IS BROKEN TOO!</p><div class="codebox"><pre><code> [ 227.044242] vfio-pci 0000:03:00.0: Invalid ROM contents</code></pre></div><br /><p>And then even more weird <span class="bbs">cra</span> <span class="bbs">shi</span> things happen:</p><div class="codebox"><pre><code>[ 227.054680] dmar: DRHD: handling fault status reg 3 [ 227.054688] dmar: DMAR:[DMA Read] Request device [00:1d.0] fault addr ef000 DMAR:[fault reason 06] PTE Read access is not set</code></pre></div><p>THAT looks very bad, what the hell is that 00:1d.0 device? Looks like you&#039;re trying to pass-through it too.</p><p>OH WELL, just give me the LSPCI output and tell me what are you trying to do, all i see now is a mess of hardware and virtualization everywhere.<br />Please, list iommu_groups too.</p><p>...</p><div class="codebox"><pre><code>[ 1150.557220] mmc0: SDHCI controller on PCI [0000:03:00.0] using DMA [ 1150.639153] vfio_pci_disable: Failed to reset device 0000:05:00.0 (-11)</code></pre></div><p>Seems like somewhere there you&#039;ve shutdown your VM, and...<br />Your system just <span class="bbu">exploded with errors</span>:</p><div class="codebox"><pre><code>[ 1159.834105] [drm:uvd_v1_0_start [radeon]] *ERROR* UVD not responding, trying to reset the VCPU!!! eight more lines alike [ 1169.050536] [drm:uvd_v1_0_start [radeon]] *ERROR* UVD not responding, trying to reset the VCPU!!! [ 1169.070551] [drm:uvd_v1_0_start [radeon]] *ERROR* UVD not responding, giving up!!! [ 1169.070572] [drm:evergreen_startup [radeon]] *ERROR* radeon: error initializing UVD (-1).</code></pre></div><p>I have absolutely no clue what that means, but three exclamation marks and &quot;trying to reset the VCPU&quot; looks very serious.<br />But nevertheless, it tries to continue and...</p><div class="codebox"><pre><code>[ 1170.117249] radeon 0000:01:00.0: fb0: radeondrmfb frame buffer device [ 1170.117251] radeon 0000:01:00.0: registered panic notifier [ 1170.135759] [drm] Initialized radeon 2.41.0 20080528 for 0000:01:00.0 on minor 0 [ 1170.136029] kernel tried to execute NX-protected page - exploit attempt? (uid: 0) [ 1170.136065] BUG: unable to handle kernel paging request at ffff880429522c40</code></pre></div> </div> <div class="postsignature postmsg"><hr /><p><span class="bbs">The forum rules prohibit requesting support for distributions other than arch.</span><br /><a href="https://bbs.archlinux.org/viewtopic.php?pid=1551460#p1551460" rel="nofollow">I gave up.</a><a href="https://bbs.archlinux.org/viewtopic.php?id=162768" rel="nofollow"> It was too late.</a><br /><a href="http://pastebin.com/B3fL84bq" rel="nofollow">What I was trying to do</a>.<br /><a href="http://vfio.blogspot.com/" rel="nofollow">The reference about VFIO and KVM VGA passthrough.</a></p></div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1531685">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1531693" class="blockpost rowodd"> <h2><span><span class="conr">#5175</span> <a href="viewtopic.php?pid=1531693#p1531693">2015-05-24 22:45:50</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=91279">ghormoon</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2015-05-20</span></dd> <dd><span>Posts: 17</span></dd> <dd class="usercontacts"><span class="email"><a href="misc.php?email=91279">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <p>lspci:<br />00:00.0 Host bridge: Intel Corporation 2nd Generation Core Processor Family DRAM Controller (rev 09)<br />00:01.0 PCI bridge: Intel Corporation Xeon E3-1200/2nd Generation Core Processor Family PCI Express Root Port (rev 09)<br />00:16.0 Communication controller: Intel Corporation 6 Series/C200 Series Chipset Family MEI Controller #1 (rev 04)<br />00:16.3 Serial controller: Intel Corporation 6 Series/C200 Series Chipset Family KT Controller (rev 04)<br />00:19.0 Ethernet controller: Intel Corporation 82579LM Gigabit Network Connection (rev 04)<br />00:1a.0 USB controller: Intel Corporation 6 Series/C200 Series Chipset Family USB Enhanced Host Controller #2 (rev 04)<br />00:1b.0 Audio device: Intel Corporation 6 Series/C200 Series Chipset Family High Definition Audio Controller (rev 04)<br />00:1c.0 PCI bridge: Intel Corporation 6 Series/C200 Series Chipset Family PCI Express Root Port 1 (rev b4)<br />00:1c.2 PCI bridge: Intel Corporation 6 Series/C200 Series Chipset Family PCI Express Root Port 3 (rev b4)<br />00:1c.3 PCI bridge: Intel Corporation 6 Series/C200 Series Chipset Family PCI Express Root Port 4 (rev b4)<br />00:1c.7 PCI bridge: Intel Corporation 6 Series/C200 Series Chipset Family PCI Express Root Port 8 (rev b4)<br />00:1d.0 USB controller: Intel Corporation 6 Series/C200 Series Chipset Family USB Enhanced Host Controller #1 (rev 04)<br />00:1f.0 ISA bridge: Intel Corporation QM67 Express Chipset Family LPC Controller (rev 04)<br />00:1f.2 SATA controller: Intel Corporation 6 Series/C200 Series Chipset Family 6 port SATA AHCI Controller (rev 04)<br />01:00.0 VGA compatible controller: Advanced Micro Devices, Inc. [AMD/ATI] Seymour [Radeon HD 6400M/7400M Series]<br />01:00.1 Audio device: Advanced Micro Devices, Inc. [AMD/ATI] Caicos HDMI Audio [Radeon HD 6400 Series]<br />03:00.0 System peripheral: JMicron Technology Corp. SD/MMC Host Controller (rev 30)<br />03:00.2 SD Host controller: JMicron Technology Corp. Standard SD Host Controller (rev 30)<br />04:00.0 Network controller: Intel Corporation Centrino Advanced-N 6205 [Taylor Peak] (rev 34)<br />05:00.0 USB controller: NEC Corporation uPD720200 USB 3.0 Host Controller (rev 04)</p><p>virt manager xml: <a href="http://pastebin.com/6PqWB18r" rel="nofollow">http://pastebin.com/6PqWB18r</a> (note that x-vga=on is added in the qemu-wrapper)</p><p>as for the questions asked:<br />OVMF: no, it seems to be unsupported on my HW.</p><p>I&#039;m passing in 00:1a.0 00:1b.0 00:1d.0 03:00.0 03:00.2 01:00.0 01:00.1 05:00.0 i.e. basically everything, that is not a pci/sata conroller or a network card.</p><p>true I&#039;ve let the radeon to load, I&#039;ll try next time without it. linux vm (almost the same config) pickes it ok though <img src="https://bbs.archlinux.org/img/smilies/smile.png" width="15" height="15" alt="smile" /></p><p>how is it supposed to work - to have vga and all the periphetals passed in, host will be headless.&#160; most of the work I&#039;ll do on the vm with VGA passed in with some other VMs&#160; around for testing, services and such.</p><p>SD controller is broken by default <img src="https://bbs.archlinux.org/img/smilies/smile.png" width="15" height="15" alt="smile" /> interesting though that it works in the vm <img src="https://bbs.archlinux.org/img/smilies/big_smile.png" width="15" height="15" alt="big_smile" /></p><p>as for the crash in the end, that happens in the linux VM too, though until shutdown that works ok.</p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1531693">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div class="postlinksb"> <div class="inbox crumbsplus"> <div class="pagepost"> <p class="pagelink conl"><span class="pages-label">Pages: </span><a rel="prev" class="item1" href="viewtopic.php?id=162768&amp;p=206">Previous</a> <a href="viewtopic.php?id=162768">1</a> <span class="spacer">…</span> <a href="viewtopic.php?id=162768&amp;p=205">205</a> <a href="viewtopic.php?id=162768&amp;p=206">206</a> <strong>207</strong> <a href="viewtopic.php?id=162768&amp;p=208">208</a> <a href="viewtopic.php?id=162768&amp;p=209">209</a> <span class="spacer">…</span> <a href="viewtopic.php?id=162768&amp;p=234">234</a> <a rel="next" href="viewtopic.php?id=162768&amp;p=208">Next</a></p> <p class="postlink conr">Topic closed</p> </div> <ul class="crumbs"> <li><a href="index.php">Index</a></li> <li><span>»&#160;</span><a href="viewforum.php?id=48">Topics Going Nowhere</a></li> <li><span>»&#160;</span><strong><a href="viewtopic.php?id=162768">KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</a></strong></li> </ul> <p class="subscribelink clearb"><a href="misc.php?action=subscribe&amp;tid=162768">Subscribe to this topic</a></p> <div class="clearer"></div> </div> </div> </div> <div id="brdfooter" class="block"> <h2><span>Board footer</span></h2> <div class="box"> <div id="brdfooternav" class="inbox"> <div class="conl"> <form id="qjump" method="get" action="viewforum.php"> <div><label><span>Jump to<br /></span> <select name="id" onchange="window.location=('viewforum.php?id='+this.options[this.selectedIndex].value)"> <optgroup label="Technical Issues and Assistance"> <option value="23">Newbie Corner</option> <option value="17">Installation</option> <option value="22">Kernel &amp; Hardware</option> <option value="18">Applications &amp; Desktop Environments</option> <option value="31">Laptop Issues</option> <option value="8">Networking, Server, and Protection</option> <option value="32">Multimedia and Games</option> <option value="50">System Administration</option> <option value="35">Other Architectures</option> </optgroup> <optgroup label="Arch-centric"> <option value="24">Announcements, Package &amp; Security Advisories</option> <option value="1">Arch Discussion</option> <option value="13">Forum &amp; Wiki discussion</option> </optgroup> <optgroup label="Pacman Upgrades, Packaging &amp; AUR"> <option value="44">Pacman &amp; Package Upgrade Issues</option> <option value="49">[testing] Repo Forum</option> <option value="4">Creating &amp; Modifying Packages</option> <option value="38">AUR Issues, Discussion &amp; PKGBUILD Requests</option> </optgroup> <optgroup label="Contributions &amp; Discussion"> <option value="20">GNU/Linux Discussion</option> <option value="27">Community Contributions</option> <option value="33">Programming &amp; Scripting</option> <option value="30">Other Languages</option> <option value="47">Artwork and Screenshots</option> <option value="42">Try This</option> </optgroup> <optgroup label="/dev/null"> <option value="29">Off-Topic</option> <option value="48" selected="selected">Topics Going Nowhere</option> <option value="36">Dustbin</option> </optgroup> </select></label> <input type="submit" value=" Go " accesskey="g" /> </div> </form> </div> <div class="conr"> <p id="feedlinks"><span class="atom"><a href="extern.php?action=feed&amp;tid=162768&amp;type=atom">Atom topic feed</a></span></p> <p id="poweredby">Powered by <a href="http://fluxbb.org/">FluxBB</a></p> </div> <div class="clearer"></div> </div> </div> </div> </div> <div class="end-box"></div> </div> </body> </html>
