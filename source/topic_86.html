<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"> <html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en" dir="ltr"> <head> <meta http-equiv="Content-Type" content="text/html; charset=utf-8" /> <title>KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9 (Page 86) / Topics Going Nowhere / Arch Linux Forums</title> <link rel="stylesheet" type="text/css" href="style/ArchLinux.css" /> <link rel="canonical" href="viewtopic.php?id=162768&amp;p=86" title="Page 86" /> <link rel="prev" href="viewtopic.php?id=162768&amp;p=85" title="Page 85" /> <link rel="next" href="viewtopic.php?id=162768&amp;p=87" title="Page 87" /> <link rel="alternate" type="application/atom+xml" href="extern.php?action=feed&amp;tid=162768&amp;type=atom" title="Atom topic feed" /> <link rel="stylesheet" media="screen" href="style/ArchLinux/arch.css?v=3" /> <link rel="stylesheet" media="screen" href="style/ArchLinux/archnavbar.css?v=2" /> <link rel="shortcut icon" href="style/ArchLinux/favicon.ico" /> </head> <body> <div id="archnavbar" class="anb-forum"> <div id="archnavbarlogo"><h1><a href="http://www.archlinux.org/">Arch Linux</a></h1></div> <div id="archnavbarmenu"> <ul id="archnavbarlist"> <li id="anb-home"><a href="http://www.archlinux.org/">Home</a></li><li id="anb-packages"><a href="http://www.archlinux.org/packages/">Packages</a></li><li id="anb-forums" class="anb-selected"><a href="https://bbs.archlinux.org/">Forums</a></li><li id="anb-wiki"><a href="https://wiki.archlinux.org/">Wiki</a></li><li id="anb-bugs"><a href="https://bugs.archlinux.org/">Bugs</a></li><li id="anb-aur"><a href="https://aur.archlinux.org/">AUR</a></li><li id="anb-download"><a href="http://www.archlinux.org/download/">Download</a></li> </ul> </div> </div> <div id="punviewtopic" class="pun"> <div class="top-box"></div> <div class="punwrap"> <div id="brdheader" class="block"> <div class="box"> <div id="brdmenu" class="inbox"> <ul> <li id="navindex" class="isactive"><a href="index.php">Index</a></li> <li id="navuserlist"><a href="userlist.php">User list</a></li> <li id="navsearch"><a href="search.php">Search</a></li> <li id="navprofile"><a href="profile.php?id=80749">Profile</a></li> <li id="navlogout"><a href="login.php?action=out&amp;id=80749&amp;csrf_token=5c20501ec397bb45ef8ee8c84db232c8d8e421c6">Logout</a></li> </ul> </div> <div id="brdwelcome" class="inbox"> <ul class="conl"> <li><span>Logged in as <strong>SXX</strong></span></li> <li><span>Last visit: 2015-08-16 12:20:09</span></li> </ul> <ul class="conr"> <li><span>Topics: <a href="search.php?action=show_replies" title="Find topics you have posted to.">Posted</a> | <a href="search.php?action=show_new" title="Find topics with new posts since your last visit.">New</a> | <a href="search.php?action=show_recent" title="Find topics with recent posts.">Active</a> | <a href="search.php?action=show_unanswered" title="Find topics with no replies.">Unanswered</a></span></li> </ul> <div class="clearer"></div> </div> </div> </div> <div id="brdmain"> <div class="linkst"> <div class="inbox crumbsplus"> <ul class="crumbs"> <li><a href="index.php">Index</a></li> <li><span>»&#160;</span><a href="viewforum.php?id=48">Topics Going Nowhere</a></li> <li><span>»&#160;</span><strong><a href="viewtopic.php?id=162768">KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</a></strong></li> </ul> <div class="pagepost"> <p class="pagelink conl"><span class="pages-label">Pages: </span><a rel="prev" class="item1" href="viewtopic.php?id=162768&amp;p=85">Previous</a> <a href="viewtopic.php?id=162768">1</a> <span class="spacer">…</span> <a href="viewtopic.php?id=162768&amp;p=84">84</a> <a href="viewtopic.php?id=162768&amp;p=85">85</a> <strong>86</strong> <a href="viewtopic.php?id=162768&amp;p=87">87</a> <a href="viewtopic.php?id=162768&amp;p=88">88</a> <span class="spacer">…</span> <a href="viewtopic.php?id=162768&amp;p=234">234</a> <a rel="next" href="viewtopic.php?id=162768&amp;p=87">Next</a></p> <p class="postlink conr">Topic closed</p> </div> <div class="clearer"></div> </div> </div> <div id="p1427040" class="blockpost rowodd blockpost1"> <h2><span><span class="conr">#2126</span> <a href="viewtopic.php?pid=1427040#p1427040">2014-06-17 20:56:47</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=82818">lojsar</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2014-06-16</span></dd> <dd><span>Posts: 7</span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>belliash wrote:</cite><blockquote><div><div class="quotebox"><cite>lojsar wrote:</cite><blockquote><div><p>...</p></div></blockquote></div><p>Most probably you nvidia gpu is not connected to HDMI, but to igp. Thats why it thinks it has CRT-0 connected.</p></div></blockquote></div><p>I see my post was not very clear. The HDMI output works. It&#039;s just that I get a CRT-0 output too, that I have to disable to get a sane resolution. I tried to clarify this in my post now.</p><div class="quotebox"><cite>belliash wrote:</cite><blockquote><div><p>BTW: I&#039;m also fighting with passing through my nVidia GPU, but I always got error 43 and 10/12 (cant remember) before installing nvidia driver in windows.<br />Can you tell sth more about what you done? Maybe some instruction please?</p></div></blockquote></div><p>I haven&#039;t figured out how to make it work in Windows yet. When I tried Windows I only got Code 10, so I changed to Linux to get more error messages (I recommend NVreg_ResmanDebugLevel=0)</p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1427040">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1427046" class="blockpost roweven"> <h2><span><span class="conr">#2127</span> <a href="viewtopic.php?pid=1427046#p1427046">2014-06-17 21:08:30</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=81541">belliash</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2014-04-25</span></dd> <dd><span>Posts: 16</span></dd> <dd class="usercontacts"><span class="email"><a href="mailto:belliash@asiotec.eu.org">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>lojsar wrote:</cite><blockquote><div><div class="quotebox"><cite>belliash wrote:</cite><blockquote><div><div class="quotebox"><cite>lojsar wrote:</cite><blockquote><div><p>...</p></div></blockquote></div><p>Most probably you nvidia gpu is not connected to HDMI, but to igp. Thats why it thinks it has CRT-0 connected.</p></div></blockquote></div><p>I see my post was not very clear. The HDMI output works. It&#039;s just that I get a CRT-0 output too, that I have to disable to get a sane resolution. I tried to clarify this in my post now.</p><div class="quotebox"><cite>belliash wrote:</cite><blockquote><div><p>BTW: I&#039;m also fighting with passing through my nVidia GPU, but I always got error 43 and 10/12 (cant remember) before installing nvidia driver in windows.<br />Can you tell sth more about what you done? Maybe some instruction please?</p></div></blockquote></div><p>I haven&#039;t figured out how to make it work in Windows yet. When I tried Windows I only got Code 10, so I changed to Linux to get more error messages (I recommend NVreg_ResmanDebugLevel=0)</p></div></blockquote></div><p>Can you check one thing?<br />Please pass your nvidia gpu as a second card to VM (use also a cirrus/vmware/etc) and install Windows. Then please install binary nvidia drivers and reboot host.<br />Finally launch guest and if you see you nvidia card detected properly but with exclamation mark, please check error code. If it will be 43, please disable and reenable GPU from device manager.</p><p>These steps help to get dgpu working in guest windows os. However it remains secondary gpu, so its useless. I wonder if your problem is the same is mine...</p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1427046">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1427185" class="blockpost rowodd"> <h2><span><span class="conr">#2128</span> <a href="viewtopic.php?pid=1427185#p1427185">2014-06-18 10:43:27</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=58583">Nesousx</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2012-03-27</span></dd> <dd><span>Posts: 46</span></dd> <dd class="usercontacts"><span class="email"><a href="misc.php?email=58583">Email</a></span> <span class="website"><a href="https://www.kodi-xbmc.com/" rel="nofollow">Website</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <p>Hi all,</p><p>First of all, thanks OP for the tutorial.</p><p>I am running Ubuntu 14.04 and trying to run KVM VGA passthrough. I have successfully done several VGA passthrough with various distros and with Xen too. I always use IGP as main card for my Linux rig, and PCIe card as my Windows GPU. Everything works fine. I even got it working with 2 ATI cards, a 6450 in 1st PCie for the Linux host and a 7950 in 2nd PCIe slot for Windows guest. However, gaming performance are really poor since the 2nd PCIe slot is limited to 1x, and that I don&#039;t have enough physical space in my case to plug the cards differently.</p><p>I&#039;d like to get a WQHD compliant setup. Now, what I want to do and can&#039;t seem to get working is to have my Linux rig use my 2nd PCIe (ATI 6450) card as GPU and my Windows rig use the first PCIe card (ATI 7950). The best I could get is a working and accelerated Linux desktop environnement on second GPU, pci-stub claimed the corrrect devices, vfio module and kvm loaded, etc. When I start my Windows guest with PCI devices attached to it, it starts but I have no display on guest and my qemu logfile is literraly spammed (until the /var parition is full) with something like:</p><div class="codebox"><pre><code>qemu-system-x86_64: vfio_bar_write failed: Device or resourc e busy</code></pre></div><p>I am not providing much log atm, because it might not be needed. Indeed, I remember reading that I can not pass the secondary video adapter to guest. So is it possible to get the 2nd PCIe card passed to guest and the 1st PCIe card for host?</p><p>Thanks in avance,</p><p>NB: if I absolutely want to pass the 2nd to guest, it is because I have no choice with my current case / motherboard.</p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1427185">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1427189" class="blockpost roweven"> <h2><span><span class="conr">#2129</span> <a href="viewtopic.php?pid=1427189#p1427189">2014-06-18 10:50:07</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=82238">sinny</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2014-05-24</span></dd> <dd><span>Posts: 75</span></dd> <dd class="usercontacts"><span class="email"><a href="misc.php?email=82238">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>Nesousx wrote:</cite><blockquote><div><p>Hi all,</p><p>First of all, thanks OP for the tutorial.</p><p>I am running Ubuntu 14.04 and trying to run KVM VGA passthrough. I have successfully done several VGA passthrough with various distros and with Xen too. I always use IGP as main card for my Linux rig, and PCIe card as my Windows GPU. Everything works fine. I even got it working with 2 ATI cards, a 6450 in 1st PCie for the Linux host and a 7950 in 2nd PCIe slot for Windows guest. However, gaming performance are really poor since the 2nd PCIe slot is limited to 1x, and that I don&#039;t have enough physical space in my case to plug the cards differently.</p><p>I&#039;d like to get a WQHD compliant setup. Now, what I want to do and can&#039;t seem to get working is to have my Linux rig use my 2nd PCIe (ATI 6450) card as GPU and my Windows rig use the first PCIe card (ATI 7950). The best I could get is a working and accelerated Linux desktop environnement on second GPU, pci-stub claimed the corrrect devices, vfio module and kvm loaded, etc. When I start my Windows guest with PCI devices attached to it, it starts but I have no display on guest and my qemu logfile is literraly spammed (until the /var parition is full) with something like:</p><div class="codebox"><pre><code>qemu-system-x86_64: vfio_bar_write failed: Device or resourc e busy</code></pre></div><p>I am not providing much log atm, because it might not be needed. Indeed, I remember reading that I can not pass the secondary video adapter to guest. So is it possible to get the 2nd PCIe card passed to guest and the 1st PCIe card for host?</p><p>Thanks in avance,</p><p>NB: if I absolutely want to pass the 2nd to guest, it is because I have no choice with my current case / motherboard.</p></div></blockquote></div><p>what card is used by bios? are you sure you are not getting hit by lack of bios configurability in terms of what non-integrated GPU is used as primary adapter?<br />using IGP for host os is not an option?</p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1427189">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1427192" class="blockpost rowodd"> <h2><span><span class="conr">#2130</span> <a href="viewtopic.php?pid=1427192#p1427192">2014-06-18 11:14:30</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=58583">Nesousx</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2012-03-27</span></dd> <dd><span>Posts: 46</span></dd> <dd class="usercontacts"><span class="email"><a href="misc.php?email=58583">Email</a></span> <span class="website"><a href="https://www.kodi-xbmc.com/" rel="nofollow">Website</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>sinny wrote:</cite><blockquote><div><p>what card is used by bios? are you sure you are not getting hit by lack of bios configurability in terms of what non-integrated GPU is used as primary adapter?<br />using IGP for host os is not an option?</p></div></blockquote></div><p>Card used by bios is the 1st PCIe card (aka 7950, the one I want passed to Windows).</p><p>My bios kinda sucks (Asrock Z77 Pro 4M); since I can only select from IGP or 1st PCIe card. I wish I could use my 2nd PCIe card as &quot;main GPU&quot;.</p><p>IGP for host is no longer an option since I plan on buying a WQHD screen and IGP doesn&#039;t support that resolution. <img src="https://bbs.archlinux.org/img/smilies/sad.png" width="15" height="15" alt="sad" /></p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1427192">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1427202" class="blockpost roweven"> <h2><span><span class="conr">#2131</span> <a href="viewtopic.php?pid=1427202#p1427202">2014-06-18 11:45:30</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=70922">nbhs</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd class="postavatar"><img src="https://bbs.archlinux.org/img/avatars/70922.jpg?m=1367773811" width="80" height="80" alt="" /></dd> <dd><span>From: Montevideo, Uruguay</span></dd> <dd><span>Registered: 2013-05-02</span></dd> <dd><span>Posts: 402</span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>Nesousx wrote:</cite><blockquote><div><div class="quotebox"><cite>sinny wrote:</cite><blockquote><div><p>what card is used by bios? are you sure you are not getting hit by lack of bios configurability in terms of what non-integrated GPU is used as primary adapter?<br />using IGP for host os is not an option?</p></div></blockquote></div><p>Card used by bios is the 1st PCIe card (aka 7950, the one I want passed to Windows).</p><p>My bios kinda sucks (Asrock Z77 Pro 4M); since I can only select from IGP or 1st PCIe card. I wish I could use my 2nd PCIe card as &quot;main GPU&quot;.</p><p>IGP for host is no longer an option since I plan on buying a WQHD screen and IGP doesn&#039;t support that resolution. <img src="https://bbs.archlinux.org/img/smilies/sad.png" width="15" height="15" alt="sad" /></p></div></blockquote></div><p>Using UEFI i&#039;m able to passthrough my primary card by disabling efifb with video=efifb:off as a kernel parameter</p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1427202">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1427280" class="blockpost rowodd"> <h2><span><span class="conr">#2132</span> <a href="viewtopic.php?pid=1427280#p1427280">2014-06-18 14:59:09</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=58583">Nesousx</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2012-03-27</span></dd> <dd><span>Posts: 46</span></dd> <dd class="usercontacts"><span class="email"><a href="misc.php?email=58583">Email</a></span> <span class="website"><a href="https://www.kodi-xbmc.com/" rel="nofollow">Website</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>nbhs wrote:</cite><blockquote><div><p>Using UEFI i&#039;m able to passthrough my primary card by disabling efifb with video=efifb:off as a kernel parameter</p></div></blockquote></div><p>Great news, if it works for you then I might get something working too.</p><p>So far the kernel parameter didin&#039;t doo anything, but I believe I have to fix that libvirtd error first. Just curious, did you anything special with UEFI to make it work?</p><p>And if it helps anyone, the error I&#039;am getting spammed with in my guest domain&#039;s log is:</p><div class="codebox"><pre><code>qemu-system-x86_64: vfio_bar_write(,0xf7bf4e0, 0x0, 4) failed: Device or resource busy</code></pre></div> <p class="postedit"><em>Last edited by Nesousx (2014-06-18 15:49:41)</em></p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1427280">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1427343" class="blockpost roweven"> <h2><span><span class="conr">#2133</span> <a href="viewtopic.php?pid=1427343#p1427343">2014-06-18 17:02:16</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=82442">slis</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2014-06-02</span></dd> <dd><span>Posts: 125</span></dd> <dd class="usercontacts"><span class="email"><a href="mailto:xslisx@gmail.com">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <p>lil update on my progress...</p><br /><p>got gigabyte g1 sniper 3...<br />4-way sli</p><p>i7 2600s</p><p>it works with 4 gpu-s...</p><p>2x 560ti<br />1x 660<br />1x 8800gt</p><p>all working... debian, linux-vfio 3.15, acs=downstream</p><p>ill post benchs latter with better gpu-s...<br /><a href="http://imgur.com/Yj9Eg0U" rel="nofollow"><span class="postimg"><img src="http://i.imgur.com/Yj9Eg0Us.jpg" alt="Yj9Eg0Us.jpg" /></span></a> <a href="http://imgur.com/N1ROzj5" rel="nofollow"><span class="postimg"><img src="http://i.imgur.com/N1ROzj5s.jpg" alt="N1ROzj5s.jpg" /></span></a></p> <p class="postedit"><em>Last edited by slis (2014-06-18 17:07:31)</em></p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1427343">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1427363" class="blockpost rowodd"> <h2><span><span class="conr">#2134</span> <a href="viewtopic.php?pid=1427363#p1427363">2014-06-18 17:42:35</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=82818">lojsar</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2014-06-16</span></dd> <dd><span>Posts: 7</span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>aw wrote:</cite><blockquote><div><div class="quotebox"><cite>lojsar wrote:</cite><blockquote><div><p>When I open the nVidia device, the driver complains that it can&#039;t load the VBIOS. I suspected that it wanted to find it in ACPI, so I modified the nvidia driver, replacing the function that reads VBIOS from ACPI with one that reads it from my dumpfile. This worked!<br />Is there a way I can avoid modifying the driver? I would like to launch Windows too! Is it &quot;written&quot; somewhere on the GPU that VBIOS is located in ACPI?</p></div></blockquote></div><p>Is the VBIOS you extracted actually a PCI ROM?&#160; Run &#039;xxd nouveau-vbios.rom | less&#039; and you should see these important markers:</p></div></blockquote></div><p>You were of course correct! At some point I mistyped a character into the romfile= parameter, which apparently wasn&#039;t fatal for qemu, it just started without a ROM since the file didn&#039;t exist. Now I don&#039;t need my driver modification anymore. Thank you again! and sorry for being such an idiot :(</p><p>Furthermore, I had great success modifying the VBIOS. Using a program called &quot;nvbios&quot; from &quot;envytools&quot; together with nVidia&#039;s documentation of the DCB ( <a href="ftp://download.nvidia.com/open-gpu-doc/DCB/1/DCB-4.0-Specification.html#_dcb_flags" rel="nofollow">ftp://download.nvidia.com/open-gpu-doc/ … _dcb_flags</a> ), I was able to replace the VGA output. After this, I see BIOS output on my monitor! I was also able to run Windows (with -vga none), and install the nVidia drivers!</p><p>Rebooting the guest VM doesn&#039;t seem to work tho. I&#039;ve observed the same behavior when rebooting inside the guest, and shutting down the guest and starting it again. It stays a few second at &quot;Running option rom at ce00:0003&quot;, and if I don&#039;t kill qemu fast enough the whole (host) computer freezes. I will look into this now, as rebooting seems to be an important part of Windows.</p><div class="quotebox"><blockquote><div><p>Can you check one thing?<br />Please pass your nvidia gpu as a second card to VM (use also a cirrus/vmware/etc) and install Windows. Then please install binary nvidia drivers and reboot host.<br />Finally launch guest and if you see you nvidia card detected properly but with exclamation mark, please check error code. If it will be 43, please disable and reenable GPU from device manager.</p><p>These steps help to get dgpu working in guest windows os. However it remains secondary gpu, so its useless. I wonder if your problem is the same is mine...</p></div></blockquote></div><p>I didn&#039;t try this since it worked as primary GPU. My only modifications to qemu now is the kvm=off patch. You could perhaps check the DCB of your card. I assumed the VGA stuff only used the first output, which in my case wasn&#039;t really connected.</p> <p class="postedit"><em>Last edited by lojsar (2014-06-18 19:04:47)</em></p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1427363">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1427366" class="blockpost roweven"> <h2><span><span class="conr">#2135</span> <a href="viewtopic.php?pid=1427366#p1427366">2014-06-18 17:56:38</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=82866">jajacomp</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2014-06-18</span></dd> <dd><span>Posts: 5</span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <p>Hi! I have problem. I use:<br /> - motherboard Asus z87pro<br /> - first VGA - nvidia gtx 650 (HOST)<br /> - second VGA - ATI 7770 (GUEST)</p><p>If i use first vga for system then i can&#039;t passthrough second card to virtual machine (Error = vfio: error, group 1 is not viable, please ensure all devices within the iommu_group are bound to their vfio bus driver)<br />if i use integrated video card (Intel hd 4600) for system and passthrough both video card (vfio-bind 0000:01:00.0 0000:01:00.1 0000:02:00.0 0000:02:00.1) then i can use ATI card without problems.</p><p>version qemu is latest from git<br />kernel 3.15.0<br />GRUB_CMDLINE_LINUX_DEFAULT=&quot;intel_iommu=on pci-stub.ids=1002:683d,1002:aab0,8086:0c05 vfio_iommu_type1.allow_unsafe_interrupts=1 pcie_acs_override=downstream&quot;</p><br /><p>Please! Help! I want use nvidia for main system</p> <p class="postedit"><em>Last edited by jajacomp (2014-06-18 17:58:48)</em></p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1427366">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1427384" class="blockpost rowodd"> <h2><span><span class="conr">#2136</span> <a href="viewtopic.php?pid=1427384#p1427384">2014-06-18 18:56:01</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=81541">belliash</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2014-04-25</span></dd> <dd><span>Posts: 16</span></dd> <dd class="usercontacts"><span class="email"><a href="mailto:belliash@asiotec.eu.org">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>lojsar wrote:</cite><blockquote><div><p>I didn&#039;t try this since it worked as primary GPU. My only modifications to qemu now is the kvm=off patch. You could perhaps check the DCB of your card. I assumed the VGA stuff only used the first output, which in my case wasn&#039;t really connected.</p></div></blockquote></div><p>Can you tell me exactly how and what should I check?</p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1427384">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1427386" class="blockpost roweven"> <h2><span><span class="conr">#2137</span> <a href="viewtopic.php?pid=1427386#p1427386">2014-06-18 18:59:10</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=82238">sinny</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2014-05-24</span></dd> <dd><span>Posts: 75</span></dd> <dd class="usercontacts"><span class="email"><a href="misc.php?email=82238">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>jajacomp wrote:</cite><blockquote><div><p>Hi! I have problem. I use:<br /> - motherboard Asus z87pro<br /> - first VGA - nvidia gtx 650 (HOST)<br /> - second VGA - ATI 7770 (GUEST)</p><p>If i use first vga for system then i can&#039;t passthrough second card to virtual machine (Error = vfio: error, group 1 is not viable, please ensure all devices within the iommu_group are bound to their vfio bus driver)<br />if i use integrated video card (Intel hd 4600) for system and passthrough both video card (vfio-bind 0000:01:00.0 0000:01:00.1 0000:02:00.0 0000:02:00.1) then i can use ATI card without problems.</p><p>version qemu is latest from git<br />kernel 3.15.0<br />GRUB_CMDLINE_LINUX_DEFAULT=&quot;intel_iommu=on pci-stub.ids=1002:683d,1002:aab0,8086:0c05 vfio_iommu_type1.allow_unsafe_interrupts=1 pcie_acs_override=downstream&quot;</p><br /><p>Please! Help! I want use nvidia for main system</p></div></blockquote></div><p>is it just me seeing things or there are no nvidia devices in pci-stub.ids kernel parameter (amd and intel only; why intel btw?)?</p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1427386">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1427389" class="blockpost rowodd"> <h2><span><span class="conr">#2138</span> <a href="viewtopic.php?pid=1427389#p1427389">2014-06-18 19:09:47</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=82818">lojsar</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2014-06-16</span></dd> <dd><span>Posts: 7</span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>belliash wrote:</cite><blockquote><div><div class="quotebox"><cite>lojsar wrote:</cite><blockquote><div><p>I didn&#039;t try this since it worked as primary GPU. My only modifications to qemu now is the kvm=off patch. You could perhaps check the DCB of your card. I assumed the VGA stuff only used the first output, which in my case wasn&#039;t really connected.</p></div></blockquote></div><p>Can you tell me exactly how and what should I check?</p></div></blockquote></div><p>Run nvbios (from <a href="https://github.com/envytools/envytools/" rel="nofollow">https://github.com/envytools/envytools/</a> ) on your VBIOS dump. Then check the DCB section.<br />Do you also have a laptop with Optimus btw? If it&#039;s a normal desktop computer I don&#039;t think you will have the same problem.</p><p>Maybe you could try Linux as a guest instead. I found it easier to debug.</p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1427389">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1427390" class="blockpost roweven"> <h2><span><span class="conr">#2139</span> <a href="viewtopic.php?pid=1427390#p1427390">2014-06-18 19:11:15</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=75590">aw</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2013-10-04</span></dd> <dd><span>Posts: 921</span></dd> <dd class="usercontacts"><span class="email"><a href="misc.php?email=75590">Email</a></span> <span class="website"><a href="http://vfio.blogspot.com/" rel="nofollow">Website</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>jajacomp wrote:</cite><blockquote><div><p>kernel 3.15.0<br />GRUB_CMDLINE_LINUX_DEFAULT=&quot;intel_iommu=on pci-stub.ids=1002:683d,1002:aab0,8086:0c05 vfio_iommu_type1.allow_unsafe_interrupts=1 pcie_acs_override=downstream&quot;</p></div></blockquote></div><p>The ACS override option requires a kernel patch, did you apply it?</p> </div> <div class="postsignature postmsg"><hr /><p><a href="http://vfio.blogspot.com" rel="nofollow">http://vfio.blogspot.com</a><br />Looking for a more open forum to discuss vfio related uses?&#160; Try <a href="https://www.redhat.com/mailman/listinfo/vfio-users" rel="nofollow">https://www.redhat.com/mailman/listinfo/vfio-users</a></p></div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1427390">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1427391" class="blockpost rowodd"> <h2><span><span class="conr">#2140</span> <a href="viewtopic.php?pid=1427391#p1427391">2014-06-18 19:13:14</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=81541">belliash</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2014-04-25</span></dd> <dd><span>Posts: 16</span></dd> <dd class="usercontacts"><span class="email"><a href="mailto:belliash@asiotec.eu.org">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>lojsar wrote:</cite><blockquote><div><div class="quotebox"><cite>belliash wrote:</cite><blockquote><div><div class="quotebox"><cite>lojsar wrote:</cite><blockquote><div><p>I didn&#039;t try this since it worked as primary GPU. My only modifications to qemu now is the kvm=off patch. You could perhaps check the DCB of your card. I assumed the VGA stuff only used the first output, which in my case wasn&#039;t really connected.</p></div></blockquote></div><p>Can you tell me exactly how and what should I check?</p></div></blockquote></div><p>Run nvbios (from <a href="https://github.com/envytools/envytools/" rel="nofollow">https://github.com/envytools/envytools/</a> ) on your VBIOS dump. Then check the DCB section.<br />Do you also have a laptop with Optimus btw? If it&#039;s a normal desktop computer I don&#039;t think you will have the same problem.</p><p>Maybe you could try Linux as a guest instead. I found it easier to debug.</p></div></blockquote></div><p>Yes, It&#039;s notebook equipped with gtx770m</p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1427391">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1427395" class="blockpost roweven"> <h2><span><span class="conr">#2141</span> <a href="viewtopic.php?pid=1427395#p1427395">2014-06-18 19:19:14</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=79237">mbroemme</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>From: Cologne</span></dd> <dd><span>Registered: 2014-02-05</span></dd> <dd><span>Posts: 39</span></dd> <dd class="usercontacts"><span class="email"><a href="misc.php?email=79237">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <p>aw: Do you know if <a href="https://lkml.org/lkml/2014/5/25/94" rel="nofollow">https://lkml.org/lkml/2014/5/25/94</a> is already in 3.16-rc1?</p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1427395">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1427398" class="blockpost rowodd"> <h2><span><span class="conr">#2142</span> <a href="viewtopic.php?pid=1427398#p1427398">2014-06-18 19:22:26</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=75590">aw</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2013-10-04</span></dd> <dd><span>Posts: 921</span></dd> <dd class="usercontacts"><span class="email"><a href="misc.php?email=75590">Email</a></span> <span class="website"><a href="http://vfio.blogspot.com/" rel="nofollow">Website</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>mbroemme wrote:</cite><blockquote><div><p>aw: Do you know if <a href="https://lkml.org/lkml/2014/5/25/94" rel="nofollow">https://lkml.org/lkml/2014/5/25/94</a> is already in 3.16-rc1?</p></div></blockquote></div><p>It is not <a href="https://git.kernel.org/cgit/linux/kernel/git/torvalds/linux.git/log/drivers/gpu/vga/vgaarb.c" rel="nofollow">https://git.kernel.org/cgit/linux/kerne … a/vgaarb.c</a></p> </div> <div class="postsignature postmsg"><hr /><p><a href="http://vfio.blogspot.com" rel="nofollow">http://vfio.blogspot.com</a><br />Looking for a more open forum to discuss vfio related uses?&#160; Try <a href="https://www.redhat.com/mailman/listinfo/vfio-users" rel="nofollow">https://www.redhat.com/mailman/listinfo/vfio-users</a></p></div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1427398">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1427405" class="blockpost roweven"> <h2><span><span class="conr">#2143</span> <a href="viewtopic.php?pid=1427405#p1427405">2014-06-18 19:42:29</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=81541">belliash</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2014-04-25</span></dd> <dd><span>Posts: 16</span></dd> <dd class="usercontacts"><span class="email"><a href="mailto:belliash@asiotec.eu.org">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <p>@lojsar: All I got about DCB is:</p><p>Unknown DCB table version 7.13<br />Failed to parse DCB table at 0xffff version 7.13</p><br /><p>Im not sure if i done it correctly, but I used vbios image ready to flash to card.</p> <p class="postedit"><em>Last edited by belliash (2014-06-18 19:44:33)</em></p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1427405">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1427425" class="blockpost rowodd"> <h2><span><span class="conr">#2144</span> <a href="viewtopic.php?pid=1427425#p1427425">2014-06-18 20:10:58</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=82866">jajacomp</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2014-06-18</span></dd> <dd><span>Posts: 5</span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>sinny wrote:</cite><blockquote><div><div class="quotebox"><cite>jajacomp wrote:</cite><blockquote><div><p>Hi! I have problem. I use:<br /> - motherboard Asus z87pro<br /> - first VGA - nvidia gtx 650 (HOST)<br /> - second VGA - ATI 7770 (GUEST)</p><p>If i use first vga for system then i can&#039;t passthrough second card to virtual machine (Error = vfio: error, group 1 is not viable, please ensure all devices within the iommu_group are bound to their vfio bus driver)<br />if i use integrated video card (Intel hd 4600) for system and passthrough both video card (vfio-bind 0000:01:00.0 0000:01:00.1 0000:02:00.0 0000:02:00.1) then i can use ATI card without problems.</p><p>version qemu is latest from git<br />kernel 3.15.0<br />GRUB_CMDLINE_LINUX_DEFAULT=&quot;intel_iommu=on pci-stub.ids=1002:683d,1002:aab0,8086:0c05 vfio_iommu_type1.allow_unsafe_interrupts=1 pcie_acs_override=downstream&quot;</p><br /><p>Please! Help! I want use nvidia for main system</p></div></blockquote></div><p>is it just me seeing things or there are no nvidia devices in pci-stub.ids kernel parameter (amd and intel only; why intel btw?)?</p></div></blockquote></div><p>I add to pci-stub this:<br />02:00.0 VGA compatible controller [0300]: Advanced Micro Devices, Inc. [AMD/ATI] Cape Verde XT [Radeon HD 7770/8760 / R7 250X] [1002:683d]<br />02:00.1 Audio device [0403]: Advanced Micro Devices, Inc. [AMD/ATI] Cape Verde/Pitcairn HDMI Audio [Radeon HD 7700/7800 Series] [1002:aab0]<br />and this <br />00:01.1 PCI bridge [0604]: Intel Corporation Xeon E3-1200 v3/4th Gen Core Processor PCI Express x8 Controller [8086:0c05] (rev 06)</p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1427425">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1427426" class="blockpost roweven"> <h2><span><span class="conr">#2145</span> <a href="viewtopic.php?pid=1427426#p1427426">2014-06-18 20:11:32</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=82866">jajacomp</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2014-06-18</span></dd> <dd><span>Posts: 5</span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>aw wrote:</cite><blockquote><div><div class="quotebox"><cite>jajacomp wrote:</cite><blockquote><div><p>kernel 3.15.0<br />GRUB_CMDLINE_LINUX_DEFAULT=&quot;intel_iommu=on pci-stub.ids=1002:683d,1002:aab0,8086:0c05 vfio_iommu_type1.allow_unsafe_interrupts=1 pcie_acs_override=downstream&quot;</p></div></blockquote></div><p>The ACS override option requires a kernel patch, did you apply it?</p></div></blockquote></div><p>Hm, no. It can help?</p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1427426">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1427428" class="blockpost rowodd"> <h2><span><span class="conr">#2146</span> <a href="viewtopic.php?pid=1427428#p1427428">2014-06-18 20:13:14</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=75590">aw</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2013-10-04</span></dd> <dd><span>Posts: 921</span></dd> <dd class="usercontacts"><span class="email"><a href="misc.php?email=75590">Email</a></span> <span class="website"><a href="http://vfio.blogspot.com/" rel="nofollow">Website</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>jajacomp wrote:</cite><blockquote><div><div class="quotebox"><cite>sinny wrote:</cite><blockquote><div><div class="quotebox"><cite>jajacomp wrote:</cite><blockquote><div><p>Hi! I have problem. I use:<br /> - motherboard Asus z87pro<br /> - first VGA - nvidia gtx 650 (HOST)<br /> - second VGA - ATI 7770 (GUEST)</p><p>If i use first vga for system then i can&#039;t passthrough second card to virtual machine (Error = vfio: error, group 1 is not viable, please ensure all devices within the iommu_group are bound to their vfio bus driver)<br />if i use integrated video card (Intel hd 4600) for system and passthrough both video card (vfio-bind 0000:01:00.0 0000:01:00.1 0000:02:00.0 0000:02:00.1) then i can use ATI card without problems.</p><p>version qemu is latest from git<br />kernel 3.15.0<br />GRUB_CMDLINE_LINUX_DEFAULT=&quot;intel_iommu=on pci-stub.ids=1002:683d,1002:aab0,8086:0c05 vfio_iommu_type1.allow_unsafe_interrupts=1 pcie_acs_override=downstream&quot;</p><br /><p>Please! Help! I want use nvidia for main system</p></div></blockquote></div><p>is it just me seeing things or there are no nvidia devices in pci-stub.ids kernel parameter (amd and intel only; why intel btw?)?</p></div></blockquote></div><p>I add to pci-stub this:<br />02:00.0 VGA compatible controller [0300]: Advanced Micro Devices, Inc. [AMD/ATI] Cape Verde XT [Radeon HD 7770/8760 / R7 250X] [1002:683d]<br />02:00.1 Audio device [0403]: Advanced Micro Devices, Inc. [AMD/ATI] Cape Verde/Pitcairn HDMI Audio [Radeon HD 7700/7800 Series] [1002:aab0]<br />and this <br />00:01.1 PCI bridge [0604]: Intel Corporation Xeon E3-1200 v3/4th Gen Core Processor PCI Express x8 Controller [8086:0c05] (rev 06)</p></div></blockquote></div><p>Forcing root ports or bridges to bind to pci-stub is a really bad idea.&#160; They should also not be bound to vfio-pci.&#160; Leave them alone.</p> </div> <div class="postsignature postmsg"><hr /><p><a href="http://vfio.blogspot.com" rel="nofollow">http://vfio.blogspot.com</a><br />Looking for a more open forum to discuss vfio related uses?&#160; Try <a href="https://www.redhat.com/mailman/listinfo/vfio-users" rel="nofollow">https://www.redhat.com/mailman/listinfo/vfio-users</a></p></div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1427428">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1427435" class="blockpost roweven"> <h2><span><span class="conr">#2147</span> <a href="viewtopic.php?pid=1427435#p1427435">2014-06-18 20:33:05</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=82866">jajacomp</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2014-06-18</span></dd> <dd><span>Posts: 5</span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>aw wrote:</cite><blockquote><div><div class="quotebox"><cite>jajacomp wrote:</cite><blockquote><div><div class="quotebox"><cite>sinny wrote:</cite><blockquote><div><p>is it just me seeing things or there are no nvidia devices in pci-stub.ids kernel parameter (amd and intel only; why intel btw?)?</p></div></blockquote></div><p>I add to pci-stub this:<br />02:00.0 VGA compatible controller [0300]: Advanced Micro Devices, Inc. [AMD/ATI] Cape Verde XT [Radeon HD 7770/8760 / R7 250X] [1002:683d]<br />02:00.1 Audio device [0403]: Advanced Micro Devices, Inc. [AMD/ATI] Cape Verde/Pitcairn HDMI Audio [Radeon HD 7700/7800 Series] [1002:aab0]<br />and this <br />00:01.1 PCI bridge [0604]: Intel Corporation Xeon E3-1200 v3/4th Gen Core Processor PCI Express x8 Controller [8086:0c05] (rev 06)</p></div></blockquote></div><p>Forcing root ports or bridges to bind to pci-stub is a really bad idea.&#160; They should also not be bound to vfio-pci.&#160; Leave them alone.</p></div></blockquote></div><p>Ok. I delete it. Where i can find ACS patch for 3.15 kernel?</p><p>Perfect!!! I apply patch and all work! Thank!!!</p> <p class="postedit"><em>Last edited by jajacomp (2014-06-18 21:05:35)</em></p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1427435">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1427465" class="blockpost rowodd"> <h2><span><span class="conr">#2148</span> <a href="viewtopic.php?pid=1427465#p1427465">2014-06-18 21:31:51</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=82818">lojsar</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2014-06-16</span></dd> <dd><span>Posts: 7</span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <p>Do you know how to make rebooting work?</p><p>If I boot Windows 7 now, and<br />a) restart it from Windows<br />b) shut down from Windows, and start qemu again<br />the <strong>host</strong> will freeze when seabios is &quot;Running option rom at c000:0003&quot;.</p><p>I tried to search around in this thread, and found a post on howto reset the PCI bus by oring 0x40 into a register. After doing this the host doesn&#039;t freeze anymore, but I still doesn&#039;t get past &quot;Running option rom at c000:0003&quot;. I attached some lspci output.</p><p>Are there any more tricks? :</p><p>After booting the laptop and running vfio-bind.sh</p><div class="codebox"><pre class="vscroll"><code>00:01.0 PCI bridge [0604]: Intel Corporation Xeon E3-1200/2nd Generation Core Processor Family PCI Express Root Port [8086:0101] (rev 09) (prog-if 00 [Normal decode]) Control: I/O+ Mem+ BusMaster- SpecCycle- MemWINV- VGASnoop- ParErr- Stepping- SERR- FastB2B- DisINTx- Status: Cap+ 66MHz- UDF- FastB2B- ParErr- DEVSEL=fast &gt;TAbort- &lt;TAbort- &lt;MAbort- &gt;SERR- &lt;PERR- INTx- Bus: primary=00, secondary=01, subordinate=01, sec-latency=0 I/O behind bridge: 00003000-00003fff Memory behind bridge: f0000000-f10fffff Prefetchable memory behind bridge: 00000000c0000000-00000000d1ffffff Secondary status: 66MHz- FastB2B- ParErr- DEVSEL=fast &gt;TAbort- &lt;TAbort- &lt;MAbort+ &lt;SERR- &lt;PERR- BridgeCtl: Parity- SERR- NoISA- VGA- MAbort- &gt;Reset- FastB2B- PriDiscTmr- SecDiscTmr- DiscTmrStat- DiscTmrSERREn- Capabilities: [88] Subsystem: Intel Corporation Device [8086:2010] Capabilities: [80] Power Management version 3 Flags: PMEClk- DSI- D1- D2- AuxCurrent=0mA PME(D0+,D1-,D2-,D3hot+,D3cold+) Status: D0 NoSoftRst+ PME-Enable- DSel=0 DScale=0 PME- Capabilities: [90] MSI: Enable- Count=1/1 Maskable- 64bit- Address: fee002f8 Data: 0000 Capabilities: [a0] Express (v2) Root Port (Slot+), MSI 00 DevCap: MaxPayload 128 bytes, PhantFunc 0, Latency L0s &lt;64ns, L1 &lt;1us ExtTag- RBE+ FLReset- DevCtl: Report errors: Correctable- Non-Fatal- Fatal- Unsupported- RlxdOrd- ExtTag- PhantFunc- AuxPwr- NoSnoop- MaxPayload 128 bytes, MaxReadReq 128 bytes DevSta: CorrErr- UncorrErr- FatalErr- UnsuppReq- AuxPwr- TransPend- LnkCap: Port #2, Speed 5GT/s, Width x16, ASPM L0s L1, Latency L0 &lt;256ns, L1 &lt;4us ClockPM- Surprise- LLActRep- BwNot+ LnkCtl: ASPM L1 Enabled; RCB 64 bytes Disabled- Retrain- CommClk+ ExtSynch- ClockPM- AutWidDis- BWInt- AutBWInt- LnkSta: Speed 5GT/s, Width x16, TrErr- Train- SlotClk+ DLActive- BWMgmt+ ABWMgmt- SltCap: AttnBtn- PwrCtrl- MRL- AttnInd- PwrInd- HotPlug- Surprise- Slot #1, PowerLimit 75.000W; Interlock- NoCompl+ SltCtl: Enable: AttnBtn- PwrFlt- MRL- PresDet- CmdCplt- HPIrq- LinkChg- Control: AttnInd Unknown, PwrInd Unknown, Power- Interlock- SltSta: Status: AttnBtn- PowerFlt- MRL- CmdCplt- PresDet+ Interlock- Changed: MRL- PresDet+ LinkState- RootCtl: ErrCorrectable- ErrNon-Fatal- ErrFatal- PMEIntEna- CRSVisible- RootCap: CRSVisible- RootSta: PME ReqID 0000, PMEStatus- PMEPending- DevCap2: Completion Timeout: Not Supported, TimeoutDis-, LTR+, OBFF Not Supported ARIFwd- DevCtl2: Completion Timeout: 50us to 50ms, TimeoutDis-, LTR-, OBFF Disabled ARIFwd- LnkCtl2: Target Link Speed: 5GT/s, EnterCompliance- SpeedDis- Transmit Margin: Normal Operating Range, EnterModifiedCompliance- ComplianceSOS- Compliance De-emphasis: -6dB LnkSta2: Current De-emphasis Level: -3.5dB, EqualizationComplete-, EqualizationPhase1- EqualizationPhase2-, EqualizationPhase3-, LinkEqualizationRequest- Capabilities: [100 v1] Virtual Channel Caps: LPEVC=0 RefClk=100ns PATEntryBits=1 Arb: Fixed- WRR32- WRR64- WRR128- Ctrl: ArbSelect=Fixed Status: InProgress- VC0: Caps: PATOffset=00 MaxTimeSlots=1 RejSnoopTrans- Arb: Fixed+ WRR32- WRR64- WRR128- TWRR128- WRR256- Ctrl: Enable+ ID=0 ArbSelect=Fixed TC/VC=ff Status: NegoPending- InProgress- Capabilities: [140 v1] Root Complex Link Desc: PortNumber=02 ComponentID=01 EltType=Config Link0: Desc: TargetPort=00 TargetComponent=01 AssocRCRB- LinkType=MemMapped LinkValid+ Addr: 00000000fed19000 Kernel driver in use: vfio-pci 01:00.0 VGA compatible controller [0300]: NVIDIA Corporation GF108M [GeForce GT 525M] [10de:0df5] (rev a1) (prog-if 00 [VGA controller]) Subsystem: Dell Device [1028:04b6] Control: I/O- Mem+ BusMaster+ SpecCycle- MemWINV- VGASnoop- ParErr- Stepping- SERR- FastB2B- DisINTx- Status: Cap+ 66MHz- UDF- FastB2B- ParErr- DEVSEL=fast &gt;TAbort- &lt;TAbort- &lt;MAbort- &gt;SERR- &lt;PERR- INTx- Latency: 0, Cache Line Size: 64 bytes Interrupt: pin A routed to IRQ 11 Region 0: Memory at f0000000 (32-bit, non-prefetchable) [size=16M] Region 1: Memory at c0000000 (64-bit, prefetchable) [size=256M] Region 3: Memory at d0000000 (64-bit, prefetchable) [size=32M] Region 5: I/O ports at 3000 [disabled] [size=128] Expansion ROM at f1000000 [disabled] [size=512K] Capabilities: [60] Power Management version 3 Flags: PMEClk- DSI- D1- D2- AuxCurrent=0mA PME(D0-,D1-,D2-,D3hot-,D3cold-) Status: D0 NoSoftRst+ PME-Enable- DSel=0 DScale=0 PME- Capabilities: [68] MSI: Enable- Count=1/1 Maskable- 64bit+ Address: 0000000000000000 Data: 0000 Capabilities: [78] Express (v2) Endpoint, MSI 00 DevCap: MaxPayload 128 bytes, PhantFunc 0, Latency L0s &lt;4us, L1 &lt;64us ExtTag+ AttnBtn- AttnInd- PwrInd- RBE+ FLReset- DevCtl: Report errors: Correctable- Non-Fatal- Fatal- Unsupported- RlxdOrd+ ExtTag- PhantFunc- AuxPwr- NoSnoop+ MaxPayload 128 bytes, MaxReadReq 512 bytes DevSta: CorrErr- UncorrErr- FatalErr- UnsuppReq- AuxPwr- TransPend- LnkCap: Port #0, Speed 5GT/s, Width x16, ASPM L0s L1, Latency L0 &lt;256ns, L1 &lt;4us ClockPM+ Surprise- LLActRep- BwNot- LnkCtl: ASPM L1 Enabled; RCB 128 bytes Disabled- Retrain- CommClk+ ExtSynch- ClockPM- AutWidDis- BWInt- AutBWInt- LnkSta: Speed 5GT/s, Width x16, TrErr- Train- SlotClk+ DLActive- BWMgmt- ABWMgmt- DevCap2: Completion Timeout: Not Supported, TimeoutDis+, LTR-, OBFF Not Supported DevCtl2: Completion Timeout: 50us to 50ms, TimeoutDis-, LTR-, OBFF Disabled LnkCtl2: Target Link Speed: 5GT/s, EnterCompliance- SpeedDis- Transmit Margin: Normal Operating Range, EnterModifiedCompliance- ComplianceSOS- Compliance De-emphasis: -6dB LnkSta2: Current De-emphasis Level: -6dB, EqualizationComplete-, EqualizationPhase1- EqualizationPhase2-, EqualizationPhase3-, LinkEqualizationRequest- Capabilities: [b4] Vendor Specific Information: Len=14 &lt;?&gt; Capabilities: [100 v1] Virtual Channel Caps: LPEVC=0 RefClk=100ns PATEntryBits=1 Arb: Fixed- WRR32- WRR64- WRR128- Ctrl: ArbSelect=Fixed Status: InProgress- VC0: Caps: PATOffset=00 MaxTimeSlots=1 RejSnoopTrans- Arb: Fixed- WRR32- WRR64- WRR128- TWRR128- WRR256- Ctrl: Enable+ ID=0 ArbSelect=Fixed TC/VC=ff Status: NegoPending- InProgress- Capabilities: [128 v1] Power Budgeting &lt;?&gt; Capabilities: [600 v1] Vendor Specific Information: ID=0001 Rev=1 Len=024 &lt;?&gt; Kernel driver in use: vfio-pci Kernel modules: nouveau, nvidia</code></pre></div><p>After running Windows 7 in qemu and shutting down (all the BARs are [disabled] + many more changes)</p><div class="codebox"><pre class="vscroll"><code>00:01.0 PCI bridge [0604]: Intel Corporation Xeon E3-1200/2nd Generation Core Processor Family PCI Express Root Port [8086:0101] (rev 09) (prog-if 00 [Normal decode]) Control: I/O+ Mem+ BusMaster+ SpecCycle- MemWINV- VGASnoop- ParErr- Stepping- SERR- FastB2B- DisINTx- Status: Cap+ 66MHz- UDF- FastB2B- ParErr- DEVSEL=fast &gt;TAbort- &lt;TAbort- &lt;MAbort- &gt;SERR- &lt;PERR- INTx- Latency: 0, Cache Line Size: 64 bytes Bus: primary=00, secondary=01, subordinate=01, sec-latency=0 I/O behind bridge: 00003000-00003fff Memory behind bridge: f0000000-f10fffff Prefetchable memory behind bridge: 00000000c0000000-00000000d1ffffff Secondary status: 66MHz- FastB2B- ParErr- DEVSEL=fast &gt;TAbort- &lt;TAbort- &lt;MAbort+ &lt;SERR- &lt;PERR- BridgeCtl: Parity- SERR- NoISA- VGA- MAbort- &gt;Reset- FastB2B- PriDiscTmr- SecDiscTmr- DiscTmrStat- DiscTmrSERREn- Capabilities: [88] Subsystem: Intel Corporation Device [8086:2010] Capabilities: [80] Power Management version 3 Flags: PMEClk- DSI- D1- D2- AuxCurrent=0mA PME(D0+,D1-,D2-,D3hot+,D3cold+) Status: D0 NoSoftRst+ PME-Enable- DSel=0 DScale=0 PME- Capabilities: [90] MSI: Enable- Count=1/1 Maskable- 64bit- Address: fee002f8 Data: 0000 Capabilities: [a0] Express (v2) Root Port (Slot+), MSI 00 DevCap: MaxPayload 128 bytes, PhantFunc 0, Latency L0s &lt;64ns, L1 &lt;1us ExtTag- RBE+ FLReset- DevCtl: Report errors: Correctable- Non-Fatal- Fatal- Unsupported- RlxdOrd- ExtTag- PhantFunc- AuxPwr- NoSnoop- MaxPayload 128 bytes, MaxReadReq 128 bytes DevSta: CorrErr- UncorrErr- FatalErr- UnsuppReq- AuxPwr- TransPend- LnkCap: Port #2, Speed 5GT/s, Width x16, ASPM L0s L1, Latency L0 &lt;256ns, L1 &lt;4us ClockPM- Surprise- LLActRep- BwNot+ LnkCtl: ASPM L1 Enabled; RCB 64 bytes Disabled- Retrain- CommClk+ ExtSynch- ClockPM- AutWidDis- BWInt- AutBWInt- LnkSta: Speed 2.5GT/s, Width x16, TrErr- Train- SlotClk+ DLActive- BWMgmt+ ABWMgmt- SltCap: AttnBtn- PwrCtrl- MRL- AttnInd- PwrInd- HotPlug- Surprise- Slot #1, PowerLimit 75.000W; Interlock- NoCompl+ SltCtl: Enable: AttnBtn- PwrFlt- MRL- PresDet- CmdCplt- HPIrq- LinkChg- Control: AttnInd Unknown, PwrInd Unknown, Power- Interlock- SltSta: Status: AttnBtn- PowerFlt- MRL- CmdCplt- PresDet+ Interlock- Changed: MRL- PresDet+ LinkState- RootCtl: ErrCorrectable- ErrNon-Fatal- ErrFatal- PMEIntEna- CRSVisible- RootCap: CRSVisible- RootSta: PME ReqID 0000, PMEStatus- PMEPending- DevCap2: Completion Timeout: Not Supported, TimeoutDis-, LTR+, OBFF Not Supported ARIFwd- DevCtl2: Completion Timeout: 50us to 50ms, TimeoutDis-, LTR-, OBFF Disabled ARIFwd- LnkCtl2: Target Link Speed: 5GT/s, EnterCompliance- SpeedDis- Transmit Margin: Normal Operating Range, EnterModifiedCompliance- ComplianceSOS- Compliance De-emphasis: -6dB LnkSta2: Current De-emphasis Level: -6dB, EqualizationComplete-, EqualizationPhase1- EqualizationPhase2-, EqualizationPhase3-, LinkEqualizationRequest- Capabilities: [100 v1] Virtual Channel Caps: LPEVC=0 RefClk=100ns PATEntryBits=1 Arb: Fixed- WRR32- WRR64- WRR128- Ctrl: ArbSelect=Fixed Status: InProgress- VC0: Caps: PATOffset=00 MaxTimeSlots=1 RejSnoopTrans- Arb: Fixed+ WRR32- WRR64- WRR128- TWRR128- WRR256- Ctrl: Enable+ ID=0 ArbSelect=Fixed TC/VC=ff Status: NegoPending- InProgress- Capabilities: [140 v1] Root Complex Link Desc: PortNumber=02 ComponentID=01 EltType=Config Link0: Desc: TargetPort=00 TargetComponent=01 AssocRCRB- LinkType=MemMapped LinkValid+ Addr: 00000000fed19000 Kernel driver in use: vfio-pci 01:00.0 VGA compatible controller [0300]: NVIDIA Corporation GF108M [GeForce GT 525M] [10de:0df5] (rev a1) (prog-if 00 [VGA controller]) Subsystem: Dell Device [1028:04b6] Control: I/O- Mem- BusMaster- SpecCycle- MemWINV- VGASnoop- ParErr- Stepping- SERR- FastB2B- DisINTx+ Status: Cap+ 66MHz- UDF- FastB2B- ParErr- DEVSEL=fast &gt;TAbort- &lt;TAbort- &lt;MAbort- &gt;SERR- &lt;PERR- INTx- Interrupt: pin A routed to IRQ 16 Region 0: Memory at f0000000 (32-bit, non-prefetchable) [disabled] [size=16M] Region 1: Memory at c0000000 (64-bit, prefetchable) [disabled] [size=256M] Region 3: Memory at d0000000 (64-bit, prefetchable) [disabled] [size=32M] Region 5: I/O ports at 3000 [disabled] [size=128] Expansion ROM at f1000000 [disabled] [size=512K] Capabilities: [60] Power Management version 3 Flags: PMEClk- DSI- D1- D2- AuxCurrent=0mA PME(D0-,D1-,D2-,D3hot-,D3cold-) Status: D0 NoSoftRst+ PME-Enable- DSel=0 DScale=0 PME- Capabilities: [68] MSI: Enable- Count=1/1 Maskable- 64bit+ Address: 0000000000000000 Data: 0000 Capabilities: [78] Express (v2) Endpoint, MSI 00 DevCap: MaxPayload 128 bytes, PhantFunc 0, Latency L0s unlimited, L1 &lt;64us ExtTag+ AttnBtn- AttnInd- PwrInd- RBE+ FLReset- DevCtl: Report errors: Correctable- Non-Fatal- Fatal- Unsupported- RlxdOrd+ ExtTag+ PhantFunc- AuxPwr- NoSnoop+ MaxPayload 128 bytes, MaxReadReq 512 bytes DevSta: CorrErr- UncorrErr- FatalErr- UnsuppReq- AuxPwr- TransPend- LnkCap: Port #0, Speed 5GT/s, Width x16, ASPM L0s L1, Latency L0 &lt;256ns, L1 &lt;4us ClockPM+ Surprise- LLActRep- BwNot- LnkCtl: ASPM L1 Enabled; RCB 128 bytes Disabled- Retrain- CommClk+ ExtSynch- ClockPM- AutWidDis- BWInt- AutBWInt- LnkSta: Speed 2.5GT/s, Width x16, TrErr- Train- SlotClk+ DLActive- BWMgmt- ABWMgmt- DevCap2: Completion Timeout: Not Supported, TimeoutDis+, LTR-, OBFF Not Supported DevCtl2: Completion Timeout: 50us to 50ms, TimeoutDis-, LTR-, OBFF Disabled LnkCtl2: Target Link Speed: 5GT/s, EnterCompliance- SpeedDis- Transmit Margin: Normal Operating Range, EnterModifiedCompliance- ComplianceSOS- Compliance De-emphasis: -6dB LnkSta2: Current De-emphasis Level: -6dB, EqualizationComplete-, EqualizationPhase1- EqualizationPhase2-, EqualizationPhase3-, LinkEqualizationRequest- Capabilities: [b4] Vendor Specific Information: Len=14 &lt;?&gt; Capabilities: [100 v1] Virtual Channel Caps: LPEVC=0 RefClk=100ns PATEntryBits=1 Arb: Fixed- WRR32- WRR64- WRR128- Ctrl: ArbSelect=Fixed Status: InProgress- VC0: Caps: PATOffset=00 MaxTimeSlots=1 RejSnoopTrans- Arb: Fixed- WRR32- WRR64- WRR128- TWRR128- WRR256- Ctrl: Enable+ ID=0 ArbSelect=Fixed TC/VC=ff Status: NegoPending- InProgress- Capabilities: [128 v1] Power Budgeting &lt;?&gt; Capabilities: [600 v1] Vendor Specific Information: ID=0001 Rev=1 Len=024 &lt;?&gt; Kernel driver in use: vfio-pci Kernel modules: nouveau, nvidia</code></pre></div><p>After running vfio-unbind.sh (I didn&#039;t see any interesting changes)</p><div class="codebox"><pre class="vscroll"><code>00:01.0 PCI bridge [0604]: Intel Corporation Xeon E3-1200/2nd Generation Core Processor Family PCI Express Root Port [8086:0101] (rev 09) (prog-if 00 [Normal decode]) Control: I/O+ Mem+ BusMaster+ SpecCycle- MemWINV- VGASnoop- ParErr- Stepping- SERR- FastB2B- DisINTx- Status: Cap+ 66MHz- UDF- FastB2B- ParErr- DEVSEL=fast &gt;TAbort- &lt;TAbort- &lt;MAbort- &gt;SERR- &lt;PERR- INTx- Latency: 0, Cache Line Size: 64 bytes Bus: primary=00, secondary=01, subordinate=01, sec-latency=0 I/O behind bridge: 00003000-00003fff Memory behind bridge: f0000000-f10fffff Prefetchable memory behind bridge: 00000000c0000000-00000000d1ffffff Secondary status: 66MHz- FastB2B- ParErr- DEVSEL=fast &gt;TAbort- &lt;TAbort- &lt;MAbort+ &lt;SERR- &lt;PERR- BridgeCtl: Parity- SERR- NoISA- VGA- MAbort- &gt;Reset- FastB2B- PriDiscTmr- SecDiscTmr- DiscTmrStat- DiscTmrSERREn- Capabilities: [88] Subsystem: Intel Corporation Device [8086:2010] Capabilities: [80] Power Management version 3 Flags: PMEClk- DSI- D1- D2- AuxCurrent=0mA PME(D0+,D1-,D2-,D3hot+,D3cold+) Status: D0 NoSoftRst+ PME-Enable- DSel=0 DScale=0 PME- Capabilities: [90] MSI: Enable- Count=1/1 Maskable- 64bit- Address: fee002f8 Data: 0000 Capabilities: [a0] Express (v2) Root Port (Slot+), MSI 00 DevCap: MaxPayload 128 bytes, PhantFunc 0, Latency L0s &lt;64ns, L1 &lt;1us ExtTag- RBE+ FLReset- DevCtl: Report errors: Correctable- Non-Fatal- Fatal- Unsupported- RlxdOrd- ExtTag- PhantFunc- AuxPwr- NoSnoop- MaxPayload 128 bytes, MaxReadReq 128 bytes DevSta: CorrErr- UncorrErr- FatalErr- UnsuppReq- AuxPwr- TransPend- LnkCap: Port #2, Speed 5GT/s, Width x16, ASPM L0s L1, Latency L0 &lt;256ns, L1 &lt;4us ClockPM- Surprise- LLActRep- BwNot+ LnkCtl: ASPM L1 Enabled; RCB 64 bytes Disabled- Retrain- CommClk+ ExtSynch- ClockPM- AutWidDis- BWInt- AutBWInt- LnkSta: Speed 2.5GT/s, Width x16, TrErr- Train- SlotClk+ DLActive- BWMgmt+ ABWMgmt- SltCap: AttnBtn- PwrCtrl- MRL- AttnInd- PwrInd- HotPlug- Surprise- Slot #1, PowerLimit 75.000W; Interlock- NoCompl+ SltCtl: Enable: AttnBtn- PwrFlt- MRL- PresDet- CmdCplt- HPIrq- LinkChg- Control: AttnInd Unknown, PwrInd Unknown, Power- Interlock- SltSta: Status: AttnBtn- PowerFlt- MRL- CmdCplt- PresDet+ Interlock- Changed: MRL- PresDet+ LinkState- RootCtl: ErrCorrectable- ErrNon-Fatal- ErrFatal- PMEIntEna- CRSVisible- RootCap: CRSVisible- RootSta: PME ReqID 0000, PMEStatus- PMEPending- DevCap2: Completion Timeout: Not Supported, TimeoutDis-, LTR+, OBFF Not Supported ARIFwd- DevCtl2: Completion Timeout: 50us to 50ms, TimeoutDis-, LTR-, OBFF Disabled ARIFwd- LnkCtl2: Target Link Speed: 5GT/s, EnterCompliance- SpeedDis- Transmit Margin: Normal Operating Range, EnterModifiedCompliance- ComplianceSOS- Compliance De-emphasis: -6dB LnkSta2: Current De-emphasis Level: -6dB, EqualizationComplete-, EqualizationPhase1- EqualizationPhase2-, EqualizationPhase3-, LinkEqualizationRequest- Capabilities: [100 v1] Virtual Channel Caps: LPEVC=0 RefClk=100ns PATEntryBits=1 Arb: Fixed- WRR32- WRR64- WRR128- Ctrl: ArbSelect=Fixed Status: InProgress- VC0: Caps: PATOffset=00 MaxTimeSlots=1 RejSnoopTrans- Arb: Fixed+ WRR32- WRR64- WRR128- TWRR128- WRR256- Ctrl: Enable+ ID=0 ArbSelect=Fixed TC/VC=ff Status: NegoPending- InProgress- Capabilities: [140 v1] Root Complex Link Desc: PortNumber=02 ComponentID=01 EltType=Config Link0: Desc: TargetPort=00 TargetComponent=01 AssocRCRB- LinkType=MemMapped LinkValid+ Addr: 00000000fed19000 01:00.0 VGA compatible controller [0300]: NVIDIA Corporation GF108M [GeForce GT 525M] [10de:0df5] (rev a1) (prog-if 00 [VGA controller]) Subsystem: Dell Device [1028:04b6] Control: I/O- Mem- BusMaster- SpecCycle- MemWINV- VGASnoop- ParErr- Stepping- SERR- FastB2B- DisINTx+ Status: Cap+ 66MHz- UDF- FastB2B- ParErr- DEVSEL=fast &gt;TAbort- &lt;TAbort- &lt;MAbort- &gt;SERR- &lt;PERR- INTx- Interrupt: pin A routed to IRQ 16 Region 0: Memory at f0000000 (32-bit, non-prefetchable) [disabled] [size=16M] Region 1: Memory at c0000000 (64-bit, prefetchable) [disabled] [size=256M] Region 3: Memory at d0000000 (64-bit, prefetchable) [disabled] [size=32M] Region 5: I/O ports at 3000 [disabled] [size=128] Expansion ROM at f1000000 [disabled] [size=512K] Capabilities: [60] Power Management version 3 Flags: PMEClk- DSI- D1- D2- AuxCurrent=0mA PME(D0-,D1-,D2-,D3hot-,D3cold-) Status: D0 NoSoftRst+ PME-Enable- DSel=0 DScale=0 PME- Capabilities: [68] MSI: Enable- Count=1/1 Maskable- 64bit+ Address: 0000000000000000 Data: 0000 Capabilities: [78] Express (v2) Endpoint, MSI 00 DevCap: MaxPayload 128 bytes, PhantFunc 0, Latency L0s unlimited, L1 &lt;64us ExtTag+ AttnBtn- AttnInd- PwrInd- RBE+ FLReset- DevCtl: Report errors: Correctable- Non-Fatal- Fatal- Unsupported- RlxdOrd+ ExtTag+ PhantFunc- AuxPwr- NoSnoop+ MaxPayload 128 bytes, MaxReadReq 512 bytes DevSta: CorrErr- UncorrErr- FatalErr- UnsuppReq- AuxPwr- TransPend- LnkCap: Port #0, Speed 5GT/s, Width x16, ASPM L0s L1, Latency L0 &lt;256ns, L1 &lt;4us ClockPM+ Surprise- LLActRep- BwNot- LnkCtl: ASPM L1 Enabled; RCB 128 bytes Disabled- Retrain- CommClk+ ExtSynch- ClockPM- AutWidDis- BWInt- AutBWInt- LnkSta: Speed 2.5GT/s, Width x16, TrErr- Train- SlotClk+ DLActive- BWMgmt- ABWMgmt- DevCap2: Completion Timeout: Not Supported, TimeoutDis+, LTR-, OBFF Not Supported DevCtl2: Completion Timeout: 50us to 50ms, TimeoutDis-, LTR-, OBFF Disabled LnkCtl2: Target Link Speed: 5GT/s, EnterCompliance- SpeedDis- Transmit Margin: Normal Operating Range, EnterModifiedCompliance- ComplianceSOS- Compliance De-emphasis: -6dB LnkSta2: Current De-emphasis Level: -6dB, EqualizationComplete-, EqualizationPhase1- EqualizationPhase2-, EqualizationPhase3-, LinkEqualizationRequest- Capabilities: [b4] Vendor Specific Information: Len=14 &lt;?&gt; Capabilities: [100 v1] Virtual Channel Caps: LPEVC=0 RefClk=100ns PATEntryBits=1 Arb: Fixed- WRR32- WRR64- WRR128- Ctrl: ArbSelect=Fixed Status: InProgress- VC0: Caps: PATOffset=00 MaxTimeSlots=1 RejSnoopTrans- Arb: Fixed- WRR32- WRR64- WRR128- TWRR128- WRR256- Ctrl: Enable+ ID=0 ArbSelect=Fixed TC/VC=ff Status: NegoPending- InProgress- Capabilities: [128 v1] Power Budgeting &lt;?&gt; Capabilities: [600 v1] Vendor Specific Information: ID=0001 Rev=1 Len=024 &lt;?&gt; Kernel modules: nouveau, nvidia</code></pre></div><p>After running setpci on the bridge, writing 0x40 and clearing. Now the BARs are back! IO ports have also been enabled (they weren&#039;t after booting)</p><div class="codebox"><pre class="vscroll"><code>00:01.0 PCI bridge [0604]: Intel Corporation Xeon E3-1200/2nd Generation Core Processor Family PCI Express Root Port [8086:0101] (rev 09) (prog-if 00 [Normal decode]) Control: I/O+ Mem+ BusMaster+ SpecCycle- MemWINV- VGASnoop- ParErr- Stepping- SERR- FastB2B- DisINTx- Status: Cap+ 66MHz- UDF- FastB2B- ParErr- DEVSEL=fast &gt;TAbort- &lt;TAbort- &lt;MAbort- &gt;SERR- &lt;PERR- INTx- Latency: 0, Cache Line Size: 64 bytes Bus: primary=00, secondary=01, subordinate=01, sec-latency=0 I/O behind bridge: 00003000-00003fff Memory behind bridge: f0000000-f10fffff Prefetchable memory behind bridge: 00000000c0000000-00000000d1ffffff Secondary status: 66MHz- FastB2B- ParErr- DEVSEL=fast &gt;TAbort- &lt;TAbort- &lt;MAbort+ &lt;SERR- &lt;PERR- BridgeCtl: Parity- SERR- NoISA- VGA- MAbort- &gt;Reset- FastB2B- PriDiscTmr- SecDiscTmr- DiscTmrStat- DiscTmrSERREn- Capabilities: [88] Subsystem: Intel Corporation Device [8086:2010] Capabilities: [80] Power Management version 3 Flags: PMEClk- DSI- D1- D2- AuxCurrent=0mA PME(D0+,D1-,D2-,D3hot+,D3cold+) Status: D0 NoSoftRst+ PME-Enable- DSel=0 DScale=0 PME- Capabilities: [90] MSI: Enable- Count=1/1 Maskable- 64bit- Address: fee002f8 Data: 0000 Capabilities: [a0] Express (v2) Root Port (Slot+), MSI 00 DevCap: MaxPayload 128 bytes, PhantFunc 0, Latency L0s &lt;64ns, L1 &lt;1us ExtTag- RBE+ FLReset- DevCtl: Report errors: Correctable- Non-Fatal- Fatal- Unsupported- RlxdOrd- ExtTag- PhantFunc- AuxPwr- NoSnoop- MaxPayload 128 bytes, MaxReadReq 128 bytes DevSta: CorrErr- UncorrErr- FatalErr- UnsuppReq- AuxPwr- TransPend- LnkCap: Port #2, Speed 5GT/s, Width x16, ASPM L0s L1, Latency L0 &lt;256ns, L1 &lt;4us ClockPM- Surprise- LLActRep- BwNot+ LnkCtl: ASPM L1 Enabled; RCB 64 bytes Disabled- Retrain- CommClk+ ExtSynch- ClockPM- AutWidDis- BWInt- AutBWInt- LnkSta: Speed 2.5GT/s, Width x16, TrErr- Train- SlotClk+ DLActive- BWMgmt+ ABWMgmt- SltCap: AttnBtn- PwrCtrl- MRL- AttnInd- PwrInd- HotPlug- Surprise- Slot #1, PowerLimit 75.000W; Interlock- NoCompl+ SltCtl: Enable: AttnBtn- PwrFlt- MRL- PresDet- CmdCplt- HPIrq- LinkChg- Control: AttnInd Unknown, PwrInd Unknown, Power- Interlock- SltSta: Status: AttnBtn- PowerFlt- MRL- CmdCplt- PresDet+ Interlock- Changed: MRL- PresDet+ LinkState- RootCtl: ErrCorrectable- ErrNon-Fatal- ErrFatal- PMEIntEna- CRSVisible- RootCap: CRSVisible- RootSta: PME ReqID 0000, PMEStatus- PMEPending- DevCap2: Completion Timeout: Not Supported, TimeoutDis-, LTR+, OBFF Not Supported ARIFwd- DevCtl2: Completion Timeout: 50us to 50ms, TimeoutDis-, LTR-, OBFF Disabled ARIFwd- LnkCtl2: Target Link Speed: 5GT/s, EnterCompliance- SpeedDis- Transmit Margin: Normal Operating Range, EnterModifiedCompliance- ComplianceSOS- Compliance De-emphasis: -6dB LnkSta2: Current De-emphasis Level: -6dB, EqualizationComplete-, EqualizationPhase1- EqualizationPhase2-, EqualizationPhase3-, LinkEqualizationRequest- Capabilities: [100 v1] Virtual Channel Caps: LPEVC=0 RefClk=100ns PATEntryBits=1 Arb: Fixed- WRR32- WRR64- WRR128- Ctrl: ArbSelect=Fixed Status: InProgress- VC0: Caps: PATOffset=00 MaxTimeSlots=1 RejSnoopTrans- Arb: Fixed+ WRR32- WRR64- WRR128- TWRR128- WRR256- Ctrl: Enable+ ID=0 ArbSelect=Fixed TC/VC=ff Status: NegoPending- InProgress- Capabilities: [140 v1] Root Complex Link Desc: PortNumber=02 ComponentID=01 EltType=Config Link0: Desc: TargetPort=00 TargetComponent=01 AssocRCRB- LinkType=MemMapped LinkValid+ Addr: 00000000fed19000 01:00.0 VGA compatible controller [0300]: NVIDIA Corporation GF108M [GeForce GT 525M] [10de:0df5] (rev a1) (prog-if 00 [VGA controller]) Subsystem: Dell Device [1028:04b6] Control: I/O- Mem- BusMaster- SpecCycle- MemWINV- VGASnoop- ParErr- Stepping- SERR- FastB2B- DisINTx- Status: Cap+ 66MHz- UDF- FastB2B- ParErr- DEVSEL=fast &gt;TAbort- &lt;TAbort- &lt;MAbort- &gt;SERR- &lt;PERR- INTx- Interrupt: pin A routed to IRQ 16 Region 0: [virtual] Memory at f0000000 (32-bit, non-prefetchable) [size=16M] Region 1: Memory at c0000000 (64-bit, prefetchable) [size=256M] Region 3: Memory at d0000000 (64-bit, prefetchable) [size=32M] Region 5: I/O ports at 3000 [size=128] [virtual] Expansion ROM at f1000000 [disabled] [size=512K] Capabilities: [60] Power Management version 3 Flags: PMEClk- DSI- D1- D2- AuxCurrent=0mA PME(D0-,D1-,D2-,D3hot-,D3cold-) Status: D0 NoSoftRst+ PME-Enable- DSel=0 DScale=0 PME- Capabilities: [68] MSI: Enable- Count=1/1 Maskable- 64bit+ Address: 0000000000000000 Data: 0000 Capabilities: [78] Express (v2) Endpoint, MSI 00 DevCap: MaxPayload 128 bytes, PhantFunc 0, Latency L0s unlimited, L1 &lt;64us ExtTag+ AttnBtn- AttnInd- PwrInd- RBE+ FLReset- DevCtl: Report errors: Correctable- Non-Fatal- Fatal- Unsupported- RlxdOrd+ ExtTag- PhantFunc- AuxPwr- NoSnoop+ MaxPayload 128 bytes, MaxReadReq 512 bytes DevSta: CorrErr- UncorrErr- FatalErr- UnsuppReq- AuxPwr- TransPend- LnkCap: Port #0, Speed 5GT/s, Width x16, ASPM L0s L1, Latency L0 &lt;1us, L1 &lt;4us ClockPM+ Surprise- LLActRep- BwNot- LnkCtl: ASPM Disabled; RCB 128 bytes Disabled- Retrain- CommClk- ExtSynch- ClockPM- AutWidDis- BWInt- AutBWInt- LnkSta: Speed 2.5GT/s, Width x16, TrErr- Train- SlotClk+ DLActive- BWMgmt- ABWMgmt- DevCap2: Completion Timeout: Not Supported, TimeoutDis+, LTR-, OBFF Not Supported DevCtl2: Completion Timeout: 50us to 50ms, TimeoutDis-, LTR-, OBFF Disabled LnkCtl2: Target Link Speed: 5GT/s, EnterCompliance- SpeedDis- Transmit Margin: Normal Operating Range, EnterModifiedCompliance- ComplianceSOS- Compliance De-emphasis: -6dB LnkSta2: Current De-emphasis Level: -6dB, EqualizationComplete-, EqualizationPhase1- EqualizationPhase2-, EqualizationPhase3-, LinkEqualizationRequest- Capabilities: [b4] Vendor Specific Information: Len=14 &lt;?&gt; Capabilities: [100 v1] Virtual Channel Caps: LPEVC=0 RefClk=100ns PATEntryBits=1 Arb: Fixed- WRR32- WRR64- WRR128- Ctrl: ArbSelect=Fixed Status: InProgress- VC0: Caps: PATOffset=00 MaxTimeSlots=1 RejSnoopTrans- Arb: Fixed- WRR32- WRR64- WRR128- TWRR128- WRR256- Ctrl: Enable+ ID=0 ArbSelect=Fixed TC/VC=ff Status: NegoPending- InProgress- Capabilities: [128 v1] Power Budgeting &lt;?&gt; Capabilities: [600 v1] Vendor Specific Information: ID=0001 Rev=1 Len=024 &lt;?&gt; Kernel modules: nouveau, nvidia</code></pre></div><p>After running vfio-bind.sh again (I didn&#039;t see any interesting changes)</p><div class="codebox"><pre class="vscroll"><code>00:01.0 PCI bridge [0604]: Intel Corporation Xeon E3-1200/2nd Generation Core Processor Family PCI Express Root Port [8086:0101] (rev 09) (prog-if 00 [Normal decode]) Control: I/O+ Mem+ BusMaster+ SpecCycle- MemWINV- VGASnoop- ParErr- Stepping- SERR- FastB2B- DisINTx- Status: Cap+ 66MHz- UDF- FastB2B- ParErr- DEVSEL=fast &gt;TAbort- &lt;TAbort- &lt;MAbort- &gt;SERR- &lt;PERR- INTx- Latency: 0, Cache Line Size: 64 bytes Bus: primary=00, secondary=01, subordinate=01, sec-latency=0 I/O behind bridge: 00003000-00003fff Memory behind bridge: f0000000-f10fffff Prefetchable memory behind bridge: 00000000c0000000-00000000d1ffffff Secondary status: 66MHz- FastB2B- ParErr- DEVSEL=fast &gt;TAbort- &lt;TAbort- &lt;MAbort+ &lt;SERR- &lt;PERR- BridgeCtl: Parity- SERR- NoISA- VGA- MAbort- &gt;Reset- FastB2B- PriDiscTmr- SecDiscTmr- DiscTmrStat- DiscTmrSERREn- Capabilities: [88] Subsystem: Intel Corporation Device [8086:2010] Capabilities: [80] Power Management version 3 Flags: PMEClk- DSI- D1- D2- AuxCurrent=0mA PME(D0+,D1-,D2-,D3hot+,D3cold+) Status: D0 NoSoftRst+ PME-Enable- DSel=0 DScale=0 PME- Capabilities: [90] MSI: Enable- Count=1/1 Maskable- 64bit- Address: fee002f8 Data: 0000 Capabilities: [a0] Express (v2) Root Port (Slot+), MSI 00 DevCap: MaxPayload 128 bytes, PhantFunc 0, Latency L0s &lt;64ns, L1 &lt;1us ExtTag- RBE+ FLReset- DevCtl: Report errors: Correctable- Non-Fatal- Fatal- Unsupported- RlxdOrd- ExtTag- PhantFunc- AuxPwr- NoSnoop- MaxPayload 128 bytes, MaxReadReq 128 bytes DevSta: CorrErr- UncorrErr- FatalErr- UnsuppReq- AuxPwr- TransPend- LnkCap: Port #2, Speed 5GT/s, Width x16, ASPM L0s L1, Latency L0 &lt;256ns, L1 &lt;4us ClockPM- Surprise- LLActRep- BwNot+ LnkCtl: ASPM L1 Enabled; RCB 64 bytes Disabled- Retrain- CommClk+ ExtSynch- ClockPM- AutWidDis- BWInt- AutBWInt- LnkSta: Speed 2.5GT/s, Width x16, TrErr- Train- SlotClk+ DLActive- BWMgmt+ ABWMgmt- SltCap: AttnBtn- PwrCtrl- MRL- AttnInd- PwrInd- HotPlug- Surprise- Slot #1, PowerLimit 75.000W; Interlock- NoCompl+ SltCtl: Enable: AttnBtn- PwrFlt- MRL- PresDet- CmdCplt- HPIrq- LinkChg- Control: AttnInd Unknown, PwrInd Unknown, Power- Interlock- SltSta: Status: AttnBtn- PowerFlt- MRL- CmdCplt- PresDet+ Interlock- Changed: MRL- PresDet+ LinkState- RootCtl: ErrCorrectable- ErrNon-Fatal- ErrFatal- PMEIntEna- CRSVisible- RootCap: CRSVisible- RootSta: PME ReqID 0000, PMEStatus- PMEPending- DevCap2: Completion Timeout: Not Supported, TimeoutDis-, LTR+, OBFF Not Supported ARIFwd- DevCtl2: Completion Timeout: 50us to 50ms, TimeoutDis-, LTR-, OBFF Disabled ARIFwd- LnkCtl2: Target Link Speed: 5GT/s, EnterCompliance- SpeedDis- Transmit Margin: Normal Operating Range, EnterModifiedCompliance- ComplianceSOS- Compliance De-emphasis: -6dB LnkSta2: Current De-emphasis Level: -6dB, EqualizationComplete-, EqualizationPhase1- EqualizationPhase2-, EqualizationPhase3-, LinkEqualizationRequest- Capabilities: [100 v1] Virtual Channel Caps: LPEVC=0 RefClk=100ns PATEntryBits=1 Arb: Fixed- WRR32- WRR64- WRR128- Ctrl: ArbSelect=Fixed Status: InProgress- VC0: Caps: PATOffset=00 MaxTimeSlots=1 RejSnoopTrans- Arb: Fixed+ WRR32- WRR64- WRR128- TWRR128- WRR256- Ctrl: Enable+ ID=0 ArbSelect=Fixed TC/VC=ff Status: NegoPending- InProgress- Capabilities: [140 v1] Root Complex Link Desc: PortNumber=02 ComponentID=01 EltType=Config Link0: Desc: TargetPort=00 TargetComponent=01 AssocRCRB- LinkType=MemMapped LinkValid+ Addr: 00000000fed19000 Kernel driver in use: vfio-pci 01:00.0 VGA compatible controller [0300]: NVIDIA Corporation GF108M [GeForce GT 525M] [10de:0df5] (rev a1) (prog-if 00 [VGA controller]) Subsystem: Dell Device [1028:04b6] Control: I/O- Mem- BusMaster- SpecCycle- MemWINV- VGASnoop- ParErr- Stepping- SERR- FastB2B- DisINTx- Status: Cap+ 66MHz- UDF- FastB2B- ParErr- DEVSEL=fast &gt;TAbort- &lt;TAbort- &lt;MAbort- &gt;SERR- &lt;PERR- INTx- Interrupt: pin A routed to IRQ 16 Region 0: [virtual] Memory at f0000000 (32-bit, non-prefetchable) [size=16M] Region 1: Memory at c0000000 (64-bit, prefetchable) [size=256M] Region 3: Memory at d0000000 (64-bit, prefetchable) [size=32M] Region 5: I/O ports at 3000 [size=128] [virtual] Expansion ROM at f1000000 [disabled] [size=512K] Capabilities: [60] Power Management version 3 Flags: PMEClk- DSI- D1- D2- AuxCurrent=0mA PME(D0-,D1-,D2-,D3hot-,D3cold-) Status: D0 NoSoftRst+ PME-Enable- DSel=0 DScale=0 PME- Capabilities: [68] MSI: Enable- Count=1/1 Maskable- 64bit+ Address: 0000000000000000 Data: 0000 Capabilities: [78] Express (v2) Endpoint, MSI 00 DevCap: MaxPayload 128 bytes, PhantFunc 0, Latency L0s unlimited, L1 &lt;64us ExtTag+ AttnBtn- AttnInd- PwrInd- RBE+ FLReset- DevCtl: Report errors: Correctable- Non-Fatal- Fatal- Unsupported- RlxdOrd+ ExtTag- PhantFunc- AuxPwr- NoSnoop+ MaxPayload 128 bytes, MaxReadReq 512 bytes DevSta: CorrErr- UncorrErr- FatalErr- UnsuppReq- AuxPwr- TransPend- LnkCap: Port #0, Speed 5GT/s, Width x16, ASPM L0s L1, Latency L0 &lt;1us, L1 &lt;4us ClockPM+ Surprise- LLActRep- BwNot- LnkCtl: ASPM Disabled; RCB 128 bytes Disabled- Retrain- CommClk- ExtSynch- ClockPM- AutWidDis- BWInt- AutBWInt- LnkSta: Speed 2.5GT/s, Width x16, TrErr- Train- SlotClk+ DLActive- BWMgmt- ABWMgmt- DevCap2: Completion Timeout: Not Supported, TimeoutDis+, LTR-, OBFF Not Supported DevCtl2: Completion Timeout: 50us to 50ms, TimeoutDis-, LTR-, OBFF Disabled LnkCtl2: Target Link Speed: 5GT/s, EnterCompliance- SpeedDis- Transmit Margin: Normal Operating Range, EnterModifiedCompliance- ComplianceSOS- Compliance De-emphasis: -6dB LnkSta2: Current De-emphasis Level: -6dB, EqualizationComplete-, EqualizationPhase1- EqualizationPhase2-, EqualizationPhase3-, LinkEqualizationRequest- Capabilities: [b4] Vendor Specific Information: Len=14 &lt;?&gt; Capabilities: [100 v1] Virtual Channel Caps: LPEVC=0 RefClk=100ns PATEntryBits=1 Arb: Fixed- WRR32- WRR64- WRR128- Ctrl: ArbSelect=Fixed Status: InProgress- VC0: Caps: PATOffset=00 MaxTimeSlots=1 RejSnoopTrans- Arb: Fixed- WRR32- WRR64- WRR128- TWRR128- WRR256- Ctrl: Enable+ ID=0 ArbSelect=Fixed TC/VC=ff Status: NegoPending- InProgress- Capabilities: [128 v1] Power Budgeting &lt;?&gt; Capabilities: [600 v1] Vendor Specific Information: ID=0001 Rev=1 Len=024 &lt;?&gt; Kernel driver in use: vfio-pci Kernel modules: nouveau, nvidia</code></pre></div><div class="quotebox"><cite>belliash wrote:</cite><blockquote><div><p>@lojsar: All I got about DCB is:</p><p>Unknown DCB table version 7.13<br />Failed to parse DCB table at 0xffff version 7.13</p><br /><p>Im not sure if i done it correctly, but I used vbios image ready to flash to card.</p></div></blockquote></div><p>That looks completely wrong since the latest version is 4.0. Maybe you can upload the VBIOS. Do you use the same file as romfile= when starting qemu?</p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1427465">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1427492" class="blockpost roweven"> <h2><span><span class="conr">#2149</span> <a href="viewtopic.php?pid=1427492#p1427492">2014-06-18 22:22:23</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=82643">abdullah</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2014-06-10</span></dd> <dd><span>Posts: 33</span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <p>I compiled the kernel 3.16-rc1 with VFIO,<br />Installed <br />Qemu 2.0.0<br />LibVirt 1.2.2</p><p>intel_immou=on was added to grub and updated.<br />changed the privileges in qemu.conf.<br />Now, when running virt-manager I get the error &quot;vfio group&quot;.</p><p>Still testing...<br />I will be grateful for any attempt to help</p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1427492">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1427504" class="blockpost rowodd"> <h2><span><span class="conr">#2150</span> <a href="viewtopic.php?pid=1427504#p1427504">2014-06-18 22:54:21</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=82866">jajacomp</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2014-06-18</span></dd> <dd><span>Posts: 5</span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <p>I have problem with screen size on monitor. If i set resolution 1080 - then image don&#039;t fill all screen, just 80%. How fix if? Thank!</p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1427504">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div class="postlinksb"> <div class="inbox crumbsplus"> <div class="pagepost"> <p class="pagelink conl"><span class="pages-label">Pages: </span><a rel="prev" class="item1" href="viewtopic.php?id=162768&amp;p=85">Previous</a> <a href="viewtopic.php?id=162768">1</a> <span class="spacer">…</span> <a href="viewtopic.php?id=162768&amp;p=84">84</a> <a href="viewtopic.php?id=162768&amp;p=85">85</a> <strong>86</strong> <a href="viewtopic.php?id=162768&amp;p=87">87</a> <a href="viewtopic.php?id=162768&amp;p=88">88</a> <span class="spacer">…</span> <a href="viewtopic.php?id=162768&amp;p=234">234</a> <a rel="next" href="viewtopic.php?id=162768&amp;p=87">Next</a></p> <p class="postlink conr">Topic closed</p> </div> <ul class="crumbs"> <li><a href="index.php">Index</a></li> <li><span>»&#160;</span><a href="viewforum.php?id=48">Topics Going Nowhere</a></li> <li><span>»&#160;</span><strong><a href="viewtopic.php?id=162768">KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</a></strong></li> </ul> <p class="subscribelink clearb"><a href="misc.php?action=subscribe&amp;tid=162768">Subscribe to this topic</a></p> <div class="clearer"></div> </div> </div> </div> <div id="brdfooter" class="block"> <h2><span>Board footer</span></h2> <div class="box"> <div id="brdfooternav" class="inbox"> <div class="conl"> <form id="qjump" method="get" action="viewforum.php"> <div><label><span>Jump to<br /></span> <select name="id" onchange="window.location=('viewforum.php?id='+this.options[this.selectedIndex].value)"> <optgroup label="Technical Issues and Assistance"> <option value="23">Newbie Corner</option> <option value="17">Installation</option> <option value="22">Kernel &amp; Hardware</option> <option value="18">Applications &amp; Desktop Environments</option> <option value="31">Laptop Issues</option> <option value="8">Networking, Server, and Protection</option> <option value="32">Multimedia and Games</option> <option value="50">System Administration</option> <option value="35">Other Architectures</option> </optgroup> <optgroup label="Arch-centric"> <option value="24">Announcements, Package &amp; Security Advisories</option> <option value="1">Arch Discussion</option> <option value="13">Forum &amp; Wiki discussion</option> </optgroup> <optgroup label="Pacman Upgrades, Packaging &amp; AUR"> <option value="44">Pacman &amp; Package Upgrade Issues</option> <option value="49">[testing] Repo Forum</option> <option value="4">Creating &amp; Modifying Packages</option> <option value="38">AUR Issues, Discussion &amp; PKGBUILD Requests</option> </optgroup> <optgroup label="Contributions &amp; Discussion"> <option value="20">GNU/Linux Discussion</option> <option value="27">Community Contributions</option> <option value="33">Programming &amp; Scripting</option> <option value="30">Other Languages</option> <option value="47">Artwork and Screenshots</option> <option value="42">Try This</option> </optgroup> <optgroup label="/dev/null"> <option value="29">Off-Topic</option> <option value="48" selected="selected">Topics Going Nowhere</option> <option value="36">Dustbin</option> </optgroup> </select></label> <input type="submit" value=" Go " accesskey="g" /> </div> </form> </div> <div class="conr"> <p id="feedlinks"><span class="atom"><a href="extern.php?action=feed&amp;tid=162768&amp;type=atom">Atom topic feed</a></span></p> <p id="poweredby">Powered by <a href="http://fluxbb.org/">FluxBB</a></p> </div> <div class="clearer"></div> </div> </div> </div> </div> <div class="end-box"></div> </div> </body> </html>
