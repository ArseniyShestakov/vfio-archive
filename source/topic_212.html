<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"> <html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en" dir="ltr"> <head> <meta http-equiv="Content-Type" content="text/html; charset=utf-8" /> <title>KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9 (Page 212) / Topics Going Nowhere / Arch Linux Forums</title> <link rel="stylesheet" type="text/css" href="style/ArchLinux.css" /> <link rel="canonical" href="viewtopic.php?id=162768&amp;p=212" title="Page 212" /> <link rel="prev" href="viewtopic.php?id=162768&amp;p=211" title="Page 211" /> <link rel="next" href="viewtopic.php?id=162768&amp;p=213" title="Page 213" /> <link rel="alternate" type="application/atom+xml" href="extern.php?action=feed&amp;tid=162768&amp;type=atom" title="Atom topic feed" /> <link rel="stylesheet" media="screen" href="style/ArchLinux/arch.css?v=3" /> <link rel="stylesheet" media="screen" href="style/ArchLinux/archnavbar.css?v=2" /> <link rel="shortcut icon" href="style/ArchLinux/favicon.ico" /> </head> <body> <div id="archnavbar" class="anb-forum"> <div id="archnavbarlogo"><h1><a href="http://www.archlinux.org/">Arch Linux</a></h1></div> <div id="archnavbarmenu"> <ul id="archnavbarlist"> <li id="anb-home"><a href="http://www.archlinux.org/">Home</a></li><li id="anb-packages"><a href="http://www.archlinux.org/packages/">Packages</a></li><li id="anb-forums" class="anb-selected"><a href="https://bbs.archlinux.org/">Forums</a></li><li id="anb-wiki"><a href="https://wiki.archlinux.org/">Wiki</a></li><li id="anb-bugs"><a href="https://bugs.archlinux.org/">Bugs</a></li><li id="anb-aur"><a href="https://aur.archlinux.org/">AUR</a></li><li id="anb-download"><a href="http://www.archlinux.org/download/">Download</a></li> </ul> </div> </div> <div id="punviewtopic" class="pun"> <div class="top-box"></div> <div class="punwrap"> <div id="brdheader" class="block"> <div class="box"> <div id="brdmenu" class="inbox"> <ul> <li id="navindex" class="isactive"><a href="index.php">Index</a></li> <li id="navuserlist"><a href="userlist.php">User list</a></li> <li id="navsearch"><a href="search.php">Search</a></li> <li id="navprofile"><a href="profile.php?id=80749">Profile</a></li> <li id="navlogout"><a href="login.php?action=out&amp;id=80749&amp;csrf_token=5c20501ec397bb45ef8ee8c84db232c8d8e421c6">Logout</a></li> </ul> </div> <div id="brdwelcome" class="inbox"> <ul class="conl"> <li><span>Logged in as <strong>SXX</strong></span></li> <li><span>Last visit: 2015-08-16 12:20:09</span></li> </ul> <ul class="conr"> <li><span>Topics: <a href="search.php?action=show_replies" title="Find topics you have posted to.">Posted</a> | <a href="search.php?action=show_new" title="Find topics with new posts since your last visit.">New</a> | <a href="search.php?action=show_recent" title="Find topics with recent posts.">Active</a> | <a href="search.php?action=show_unanswered" title="Find topics with no replies.">Unanswered</a></span></li> </ul> <div class="clearer"></div> </div> </div> </div> <div id="brdmain"> <div class="linkst"> <div class="inbox crumbsplus"> <ul class="crumbs"> <li><a href="index.php">Index</a></li> <li><span>»&#160;</span><a href="viewforum.php?id=48">Topics Going Nowhere</a></li> <li><span>»&#160;</span><strong><a href="viewtopic.php?id=162768">KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</a></strong></li> </ul> <div class="pagepost"> <p class="pagelink conl"><span class="pages-label">Pages: </span><a rel="prev" class="item1" href="viewtopic.php?id=162768&amp;p=211">Previous</a> <a href="viewtopic.php?id=162768">1</a> <span class="spacer">…</span> <a href="viewtopic.php?id=162768&amp;p=210">210</a> <a href="viewtopic.php?id=162768&amp;p=211">211</a> <strong>212</strong> <a href="viewtopic.php?id=162768&amp;p=213">213</a> <a href="viewtopic.php?id=162768&amp;p=214">214</a> <span class="spacer">…</span> <a href="viewtopic.php?id=162768&amp;p=234">234</a> <a rel="next" href="viewtopic.php?id=162768&amp;p=213">Next</a></p> <p class="postlink conr">Topic closed</p> </div> <div class="clearer"></div> </div> </div> <div id="p1534698" class="blockpost rowodd blockpost1"> <h2><span><span class="conr">#5276</span> <a href="viewtopic.php?pid=1534698#p1534698">2015-06-05 20:10:59</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=75590">aw</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2013-10-04</span></dd> <dd><span>Posts: 921</span></dd> <dd class="usercontacts"><span class="email"><a href="misc.php?email=75590">Email</a></span> <span class="website"><a href="http://vfio.blogspot.com/" rel="nofollow">Website</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>garnerlogan65 wrote:</cite><blockquote><div><p>Should I start from Part 3 and proceed from there? It will be a tad difficult since I cannot boot into a graphical environment, I think i just need to remove pci-stub from the initramfs, and boot without loading the systemd service and kernel module (pci_stub).</p></div></blockquote></div><p>You could have skimmed parts 1 &amp; 2 in the time you&#039;ve been waiting for a reply...</p> </div> <div class="postsignature postmsg"><hr /><p><a href="http://vfio.blogspot.com" rel="nofollow">http://vfio.blogspot.com</a><br />Looking for a more open forum to discuss vfio related uses?&#160; Try <a href="https://www.redhat.com/mailman/listinfo/vfio-users" rel="nofollow">https://www.redhat.com/mailman/listinfo/vfio-users</a></p></div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1534698">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1534701" class="blockpost roweven"> <h2><span><span class="conr">#5277</span> <a href="viewtopic.php?pid=1534701#p1534701">2015-06-05 20:25:53</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=86845">garnerlogan65</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2014-11-22</span></dd> <dd><span>Posts: 26</span></dd> <dd class="usercontacts"><span class="email"><a href="mailto:garnerlogan65@gmail.com">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <p>That&#039;s what I&#039;m about to do. I got my system working again, by undoing all of my changes. Hopefully your method works.</p> <p class="postedit"><em>Last edited by garnerlogan65 (2015-06-05 20:46:29)</em></p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1534701">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1534703" class="blockpost rowodd"> <h2><span><span class="conr">#5278</span> <a href="viewtopic.php?pid=1534703#p1534703">2015-06-05 20:43:15</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=75590">aw</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2013-10-04</span></dd> <dd><span>Posts: 921</span></dd> <dd class="usercontacts"><span class="email"><a href="misc.php?email=75590">Email</a></span> <span class="website"><a href="http://vfio.blogspot.com/" rel="nofollow">Website</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>garnerlogan65 wrote:</cite><blockquote><div><p>That&#039;s what I&#039;m about to do. I got my system working again, by undoing all of my changes. Hopefully your method works.</p><p>EDIT: i have an i7 4960X/Asus Rampage IV Extreme, do I need the ACS patch?</p></div></blockquote></div><p>Read part 1 again</p> </div> <div class="postsignature postmsg"><hr /><p><a href="http://vfio.blogspot.com" rel="nofollow">http://vfio.blogspot.com</a><br />Looking for a more open forum to discuss vfio related uses?&#160; Try <a href="https://www.redhat.com/mailman/listinfo/vfio-users" rel="nofollow">https://www.redhat.com/mailman/listinfo/vfio-users</a></p></div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1534703">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1534708" class="blockpost roweven"> <h2><span><span class="conr">#5279</span> <a href="viewtopic.php?pid=1534708#p1534708">2015-06-05 20:50:29</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=86845">garnerlogan65</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2014-11-22</span></dd> <dd><span>Posts: 26</span></dd> <dd class="usercontacts"><span class="email"><a href="mailto:garnerlogan65@gmail.com">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <p>It seems like it should work fine. I&#039;ll let you know what happens.</p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1534708">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1534710" class="blockpost rowodd"> <h2><span><span class="conr">#5280</span> <a href="viewtopic.php?pid=1534710#p1534710">2015-06-05 20:56:31</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=86845">garnerlogan65</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2014-11-22</span></dd> <dd><span>Posts: 26</span></dd> <dd class="usercontacts"><span class="email"><a href="mailto:garnerlogan65@gmail.com">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <p>I&#039;m on part 3. A little confused, how do I get this: options vfio-pci ids=1002:ffffffff:ffffffff:ffffffff:00030000:ffff00ff,1002:ffffffff:ffffffff:ffffffff:00040300:ffffffff,10de:ffffffff:ffffffff:ffffffff:00030000:ffff00ff,10de:ffffffff:ffffffff:ffffffff:00040300:fffffff, I know how to get the vendor IDs but I&#039;m confused on how to get this.</p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1534710">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1534711" class="blockpost roweven"> <h2><span><span class="conr">#5281</span> <a href="viewtopic.php?pid=1534711#p1534711">2015-06-05 21:03:52</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=75590">aw</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2013-10-04</span></dd> <dd><span>Posts: 921</span></dd> <dd class="usercontacts"><span class="email"><a href="misc.php?email=75590">Email</a></span> <span class="website"><a href="http://vfio.blogspot.com/" rel="nofollow">Website</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>garnerlogan65 wrote:</cite><blockquote><div><p>I&#039;m on part 3. A little confused, how do I get this: options vfio-pci ids=1002:ffffffff:ffffffff:ffffffff:00030000:ffff00ff,1002:ffffffff:ffffffff:ffffffff:00040300:ffffffff,10de:ffffffff:ffffffff:ffffffff:00030000:ffff00ff,10de:ffffffff:ffffffff:ffffffff:00040300:fffffff, I know how to get the vendor IDs but I&#039;m confused on how to get this.</p></div></blockquote></div><p>If pci-stub is a module you can run <em>modinfo pci-stub</em>, otherwise you can look at the code and find this:</p><div class="codebox"><pre><code>Initial PCI IDs to add to the stub driver, format is vendor:device[:subvendor[:subdevice[:class[:class_mask]]]] and multiple comma separated entries can be specified</code></pre></div><p>So vendor:device are the minimum required.&#160; ffffffff is the kernel definition for PCI_ANY_ID, so it matches anything.&#160; So we match any device ID, any subsystem vendor ID and device ID for AMD or Nvidia, then we go on to filter a little further with class codes for multimedia for VGA devices.&#160; You should not need to do anything but possibly use this directly.&#160; If you have two identical 780s with only one to be used by the guest, you probably want to concentrate on the initramfs scripts using the driver_override option.&#160; If they&#039;re not identical (different subsystem vendors), then pci-stub is an option.</p> </div> <div class="postsignature postmsg"><hr /><p><a href="http://vfio.blogspot.com" rel="nofollow">http://vfio.blogspot.com</a><br />Looking for a more open forum to discuss vfio related uses?&#160; Try <a href="https://www.redhat.com/mailman/listinfo/vfio-users" rel="nofollow">https://www.redhat.com/mailman/listinfo/vfio-users</a></p></div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1534711">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1534712" class="blockpost rowodd"> <h2><span><span class="conr">#5282</span> <a href="viewtopic.php?pid=1534712#p1534712">2015-06-05 21:06:04</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=86845">garnerlogan65</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2014-11-22</span></dd> <dd><span>Posts: 26</span></dd> <dd class="usercontacts"><span class="email"><a href="mailto:garnerlogan65@gmail.com">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <p>They are identical. So don&#039;t use pci_stub? I still need to use vfio-pci with ids right? I don&#039;t understand all the different number types. </p><p>EDIT: Arch doesn&#039;t have 4.1 yet, so I guess I have to make do with pci-stub.</p> <p class="postedit"><em>Last edited by garnerlogan65 (2015-06-05 21:35:28)</em></p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1534712">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1534726" class="blockpost roweven"> <h2><span><span class="conr">#5283</span> <a href="viewtopic.php?pid=1534726#p1534726">2015-06-05 22:40:05</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=75590">aw</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2013-10-04</span></dd> <dd><span>Posts: 921</span></dd> <dd class="usercontacts"><span class="email"><a href="misc.php?email=75590">Email</a></span> <span class="website"><a href="http://vfio.blogspot.com/" rel="nofollow">Website</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>garnerlogan65 wrote:</cite><blockquote><div><p>They are identical. So don&#039;t use pci_stub? I still need to use vfio-pci with ids right? I don&#039;t understand all the different number types. </p><p>EDIT: Arch doesn&#039;t have 4.1 yet, so I guess I have to make do with pci-stub.</p></div></blockquote></div><p>Start here:</p><div class="quotebox"><blockquote><div><p>Another issue that users encounter when sequestering devices is what to do when there are multiple devices with the same vendor:device ID and some are intended to be used for the host...</p></div></blockquote></div><p>That does not rely on anything new in 4.1, the driver_override interface has been available for some time.</p> </div> <div class="postsignature postmsg"><hr /><p><a href="http://vfio.blogspot.com" rel="nofollow">http://vfio.blogspot.com</a><br />Looking for a more open forum to discuss vfio related uses?&#160; Try <a href="https://www.redhat.com/mailman/listinfo/vfio-users" rel="nofollow">https://www.redhat.com/mailman/listinfo/vfio-users</a></p></div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1534726">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1534752" class="blockpost rowodd"> <h2><span><span class="conr">#5284</span> <a href="viewtopic.php?pid=1534752#p1534752">2015-06-06 00:29:11</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=86845">garnerlogan65</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2014-11-22</span></dd> <dd><span>Posts: 26</span></dd> <dd class="usercontacts"><span class="email"><a href="mailto:garnerlogan65@gmail.com">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <p>Followed the rest of part 3. Here are the contents of /etc/dracut.conf.d/local.conf (<a href="http://pastebin.com/B7TcbCeF" rel="nofollow">http://pastebin.com/B7TcbCeF</a>), and my /etc/modprobe.d/local.conf (<a href="http://pastebin.com/1qCFMacS" rel="nofollow">http://pastebin.com/1qCFMacS</a>), I had to make the vfio script in the /etc/ folder since I do not have an /sbin directory for some reason. Obviously as your instructions state dracut creates &quot;initramfs-uname -r.img,&quot; am I supposed to replace the other initramfs in my bootloader with this one? Also, upon generating the new initramfs, dracut threw some errors &quot;Failed to install module vfio&quot; and it also failed to install vfio_iommu_type1. Did I do something wrong here?</p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1534752">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1534754" class="blockpost roweven"> <h2><span><span class="conr">#5285</span> <a href="viewtopic.php?pid=1534754#p1534754">2015-06-06 01:00:44</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=75590">aw</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2013-10-04</span></dd> <dd><span>Posts: 921</span></dd> <dd class="usercontacts"><span class="email"><a href="misc.php?email=75590">Email</a></span> <span class="website"><a href="http://vfio.blogspot.com/" rel="nofollow">Website</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>garnerlogan65 wrote:</cite><blockquote><div><p>Followed the rest of part 3. Here are the contents of /etc/dracut.conf.d/local.conf (<a href="http://pastebin.com/B7TcbCeF" rel="nofollow">http://pastebin.com/B7TcbCeF</a>), and my /etc/modprobe.d/local.conf (<a href="http://pastebin.com/1qCFMacS" rel="nofollow">http://pastebin.com/1qCFMacS</a>), I had to make the vfio script in the /etc/ folder since I do not have an /sbin directory for some reason. Obviously as your instructions state dracut creates &quot;initramfs-uname -r.img,&quot; am I supposed to replace the other initramfs in my bootloader with this one? Also, upon generating the new initramfs, dracut threw some errors &quot;Failed to install module vfio&quot; and it also failed to install vfio_iommu_type1. Did I do something wrong here?</p></div></blockquote></div><p>Yes, you&#039;re building an initramfs to replace the original.&#160; Is vfio built as a module or static?&#160; (grep VFIO /boot/config-`uname -r`)&#160; I generally wouldn&#039;t recommend it static, we&#039;ll need to find some other way to get the script to run in the initramfs if it&#039;s not a module.</p> </div> <div class="postsignature postmsg"><hr /><p><a href="http://vfio.blogspot.com" rel="nofollow">http://vfio.blogspot.com</a><br />Looking for a more open forum to discuss vfio related uses?&#160; Try <a href="https://www.redhat.com/mailman/listinfo/vfio-users" rel="nofollow">https://www.redhat.com/mailman/listinfo/vfio-users</a></p></div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1534754">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1534774" class="blockpost rowodd"> <h2><span><span class="conr">#5286</span> <a href="viewtopic.php?pid=1534774#p1534774">2015-06-06 02:58:20</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=86845">garnerlogan65</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2014-11-22</span></dd> <dd><span>Posts: 26</span></dd> <dd class="usercontacts"><span class="email"><a href="mailto:garnerlogan65@gmail.com">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <p>Doing &quot;grep VFIO&quot; on the normal initramfs, returns no output. It is built as a module (modinfo vfio), didn&#039;t realize you were the author <img src="https://bbs.archlinux.org/img/smilies/smile.png" width="15" height="15" alt="smile" /> I literally thought the image was supposed to be called &quot;initramfs-uname -r&quot;, I have since fixed it. Should I try booting with it?</p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1534774">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1534908" class="blockpost roweven"> <h2><span><span class="conr">#5287</span> <a href="viewtopic.php?pid=1534908#p1534908">2015-06-06 17:31:50</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=85963">Rommy</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2014-10-17</span></dd> <dd><span>Posts: 22</span></dd> <dd class="usercontacts"><span class="email"><a href="misc.php?email=85963">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>aw wrote:</cite><blockquote><div><p>There are no non-working versions.&#160; Follow the guide series in my blog below for what I think is the current best setup.</p></div></blockquote></div><p>Thank you very much :-)</p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1534908">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1534914" class="blockpost rowodd"> <h2><span><span class="conr">#5288</span> <a href="viewtopic.php?pid=1534914#p1534914">2015-06-06 18:06:17</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=79471">Bronek</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>From: London</span></dd> <dd><span>Registered: 2014-02-14</span></dd> <dd><span>Posts: 90</span></dd> <dd class="usercontacts"><span class="email"><a href="misc.php?email=79471">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>aw wrote:</cite><blockquote><div><p>In the first post of my recent how-to series I talk about the hardware I use, not that I&#039;d recommend it, but to talk about why it works for my config - <a href="http://vfio.blogspot.com/2015/05/vfio-gpu-how-to-series-part-1-hardware.html" rel="nofollow">http://vfio.blogspot.com/2015/05/vfio-g … dware.html</a></p><p>I won&#039;t be as generous as Duelist, skip AMD platforms.&#160; They&#039;ve admittedly given up on the single core performance race, you don&#039;t know what you&#039;re getting on an APU system for isolation, and their latest performance/workstation class chipset is quickly coming up on its four year anniversary since launch.<br />. . .</p><p>If you really want to assign a disk controller to a VM, you&#039;re into risky territory, mostly because the cheap ones are all crap.&#160; If you try to assign an integrated controller, the boot ROM for it may be integrated into the system BIOS, so you&#039;ll have no way to boot the VM unless you can extract it... and hope it supports UEFI if you&#039;re going the OVMF route with the VM.&#160; You may have better luck with a discrete HBA, but you&#039;re still in the unknown/crap space.&#160; Personally I find virtio-scsi w/ multi-queue and a fast backing setup to meet my needs.</p></div></blockquote></div><p>Sorry for slight off-topic; I&#039;m planning to build a kvm VM running large ZFS filesystem; this filesystem works best when it has direct access to backing storage. The idea is to use vfio and pass an LSI HBA (either build into SuperMicro motherboard, or a discrete one) to VM, and attach all ZFS disks to it. Guest would be using mpt2sas driver. However for boot and root filesystem of guest I would use regular block device with virtio driver, rather than passed-through HBA. I suppose in this case there should be no need to worry about BIOS of HBA (no boot device) and my only worry should about tuning the machine for ZFS? BTW, apparently only little effort is required to use ZFS under kvm, e.g. <a href="https://github.com/zfsonlinux/zfs/issues/3448#issuecomment-106493033" rel="nofollow">https://github.com/zfsonlinux/zfs/issue … -106493033</a></p> </div> <div class="postsignature postmsg"><hr /><p>Sorry about&#160; &quot;KVM VGA-Passthrough ...&quot; thread <img src="https://bbs.archlinux.org/img/smilies/sad.png" width="15" height="15" alt="sad" /> Anyone interested in continuing this discussion elsewhere, please contact me privately. I might be able to find it a new home.</p></div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1534914">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1534967" class="blockpost roweven"> <h2><span><span class="conr">#5289</span> <a href="viewtopic.php?pid=1534967#p1534967">2015-06-06 20:29:56</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=85252">emacsomancer</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd class="postavatar"><img src="https://bbs.archlinux.org/img/avatars/85252.jpg?m=1416507459" width="80" height="80" alt="" /></dd> <dd><span>Registered: 2014-09-20</span></dd> <dd><span>Posts: 103</span></dd> <dd class="usercontacts"><span class="email"><a href="misc.php?email=85252">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <p>My relevant computer specs:</p><ul><li><p>ASRock Z97 Anniversary motherboard (<a href="https://www.manualowl.com/m/ASRock/Z97-Anniversary/Manual/425058?page=78" rel="nofollow">manual lists it as VT-d capable</a>) </p></li><li><p>Intel Core i5-4460</p></li><li><p>EVGA NVIDIA GeForce GTX 960</p></li><li><p>16G ram</p></li></ul><p>I&#039;m considering getting either another GTX 960 or else a GTX 970 (of some sort). (Or else getting a 720, 730, 750 for use with the Linux host, and move the GTX 960 for use by Windows]. For the purpose of running games in a Windows VM within an Arch host.</p><p>As far as I can tell all of my parts of VT-d capable/enabled. (I can enable VT-d in my motherboard bios, I noticed).&#160; &#160;</p><p>Before I buy another GPU I wanted to check to make sure it is likely I would be able to get GPU passthrough to a Windows VM working with this setup. (Any concerns with GTX 960 or 970? or recommendations?)</p><p>[I&#039;m assuming there&#039;s no easy way to dynamically switch from NVIDIA to integrated video to free up my NVIDIA card when I want to run Windows.]</p> <p class="postedit"><em>Last edited by emacsomancer (2015-06-06 21:04:45)</em></p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1534967">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1534973" class="blockpost rowodd"> <h2><span><span class="conr">#5290</span> <a href="viewtopic.php?pid=1534973#p1534973">2015-06-06 20:55:01</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=89552">lersek</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2015-03-15</span></dd> <dd><span>Posts: 34</span></dd> <dd class="usercontacts"><span class="email"><a href="misc.php?email=89552">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>Duelist wrote:</cite><blockquote><div><p>... UEFI GOP can&#039;t go beyond 1024x768</p></div></blockquote></div><p>This is false in general.</p><div class="quotebox"><blockquote><div><p>without device-specific drivers.</p></div></blockquote></div><p>This is self-contradictory :)</p><div class="quotebox"><blockquote><div><p>How does gigabyte Z87X-UD3H output 1920x1080 in UEFI setup? Intel-specific hacks?</p></div></blockquote></div><p>GOP is shorthand for GRAPHICS_OUTPUT_PROTOCOL. It is an interface (an abstraction) that is defined by the UEFI specification. UEFI fimware video drivers produce it. It can flexibly express any mode list that the actual driver decides to expose, based on video RAM and any other internal sw &amp; hw factors. So this is why the first quote is false.</p><p>The second quote makes no sense because GOPs are exposed by, and are the standard interface of, device-specific UEFI video drivers. A UEFI GOP does not exist without a device-specific UEFI driver; at worst you can say that the actual driver is low quality or generic, because, while it recognizes the video card, it cannot utilize its full capabilities.</p><p>One nice bit about the GOP design is that the runtime OS (a UEFI OS) can inherit the linear framebuffer characteristics (start address, size, pixel format, resolution etc; just writing from memory, not checking the spec) from the GOP, and continue using the video mode that has been last selected while in UEFI. There won&#039;t be any acceleration, but you can have a nice (fixed) color depth and (fixed) resolution in the UEFI runtime OS without device-specific drivers. (In order to select a different video mode, you have to reboot into UEFI, or install the OS-level device-specific video driver.)</p><p>The three occurrences of the word &quot;inherit&quot; in the OVMF whitepaper all relate to this matter.</p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1534973">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1535091" class="blockpost roweven"> <h2><span><span class="conr">#5291</span> <a href="viewtopic.php?pid=1535091#p1535091">2015-06-07 11:30:51</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=91715">WildyLion</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2015-06-07</span></dd> <dd><span>Posts: 4</span></dd> <dd class="usercontacts"><span class="email"><a href="misc.php?email=91715">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <p>Hi.</p><p>I&#039;m kinda new here, but I managed to set up KVM VGA passthrough using VFIO with Windows 8.1 as a guest. The thing is, my VM seems to have some timing issues despite all the hyper-v enlightenments turned on.<br />E.g. I&#039;m able to play Witcher 3, but with post-processing settings turned down a notch from what I&#039;m usually playing on bare metal at. I&#039;m passing through a Xonar U7 audio card via USB controller passthrough and the sound seems to click sometimes, indicating something is wrong with the timing.<br />I&#039;m also passing a USB hub containing my mouse, trackball and keyboard to the same guest using a hardware ATEN KVM device that switches the USB ports to the needed root hub.</p><p>My configuration is:</p><p> 1.sh topic_100.html topic_101.html topic_102.html topic_103.html topic_104.html topic_105.html topic_106.html topic_107.html topic_108.html topic_109.html topic_10.html topic_110.html topic_111.html topic_112.html topic_113.html topic_114.html topic_115.html topic_116.html topic_117.html topic_118.html topic_119.html topic_11.html topic_120.html topic_121.html topic_122.html topic_123.html topic_124.html topic_125.html topic_126.html topic_127.html topic_128.html topic_129.html topic_12.html topic_130.html topic_131.html topic_132.html topic_133.html topic_134.html topic_135.html topic_136.html topic_137.html topic_138.html topic_139.html topic_13.html topic_140.html topic_141.html topic_142.html topic_143.html topic_144.html topic_145.html topic_146.html topic_147.html topic_148.html topic_149.html topic_14.html topic_150.html topic_151.html topic_152.html topic_153.html topic_154.html topic_155.html topic_156.html topic_157.html topic_158.html topic_159.html topic_15.html topic_160.html topic_161.html topic_162.html topic_163.html topic_164.html topic_165.html topic_166.html topic_167.html topic_168.html topic_169.html topic_16.html topic_170.html topic_171.html topic_172.html topic_173.html topic_174.html topic_175.html topic_176.html topic_177.html topic_178.html topic_179.html topic_17.html topic_180.html topic_181.html topic_182.html topic_183.html topic_184.html topic_185.html topic_186.html topic_187.html topic_188.html topic_189.html topic_18.html topic_190.html topic_191.html topic_192.html topic_193.html topic_194.html topic_195.html topic_196.html topic_197.html topic_198.html topic_199.html topic_19.html topic_1.html topic_200.html topic_201.html topic_202.html topic_203.html topic_204.html topic_205.html topic_206.html topic_207.html topic_208.html topic_209.html topic_20.html topic_210.html topic_211.html topic_21.html topic_22.html topic_23.html topic_24.html topic_25.html topic_26.html topic_27.html topic_28.html topic_29.html topic_2.html topic_30.html topic_31.html topic_32.html topic_33.html topic_34.html topic_35.html topic_36.html topic_37.html topic_38.html topic_39.html topic_3.html topic_40.html topic_41.html topic_42.html topic_43.html topic_44.html topic_45.html topic_46.html topic_47.html topic_48.html topic_49.html topic_4.html topic_50.html topic_51.html topic_52.html topic_53.html topic_54.html topic_55.html topic_56.html topic_57.html topic_58.html topic_59.html topic_5.html topic_60.html topic_61.html topic_62.html topic_63.html topic_64.html topic_65.html topic_66.html topic_67.html topic_68.html topic_69.html topic_6.html topic_70.html topic_71.html topic_72.html topic_73.html topic_74.html topic_75.html topic_76.html topic_77.html topic_78.html topic_79.html topic_7.html topic_80.html topic_81.html topic_82.html topic_83.html topic_84.html topic_85.html topic_86.html topic_87.html topic_88.html topic_89.html topic_8.html topic_90.html topic_91.html topic_92.html topic_93.html topic_94.html topic_95.html topic_96.html topic_97.html topic_98.html topic_99.html topic_9.html AMD FX-8350<br /> 1.sh topic_100.html topic_101.html topic_102.html topic_103.html topic_104.html topic_105.html topic_106.html topic_107.html topic_108.html topic_109.html topic_10.html topic_110.html topic_111.html topic_112.html topic_113.html topic_114.html topic_115.html topic_116.html topic_117.html topic_118.html topic_119.html topic_11.html topic_120.html topic_121.html topic_122.html topic_123.html topic_124.html topic_125.html topic_126.html topic_127.html topic_128.html topic_129.html topic_12.html topic_130.html topic_131.html topic_132.html topic_133.html topic_134.html topic_135.html topic_136.html topic_137.html topic_138.html topic_139.html topic_13.html topic_140.html topic_141.html topic_142.html topic_143.html topic_144.html topic_145.html topic_146.html topic_147.html topic_148.html topic_149.html topic_14.html topic_150.html topic_151.html topic_152.html topic_153.html topic_154.html topic_155.html topic_156.html topic_157.html topic_158.html topic_159.html topic_15.html topic_160.html topic_161.html topic_162.html topic_163.html topic_164.html topic_165.html topic_166.html topic_167.html topic_168.html topic_169.html topic_16.html topic_170.html topic_171.html topic_172.html topic_173.html topic_174.html topic_175.html topic_176.html topic_177.html topic_178.html topic_179.html topic_17.html topic_180.html topic_181.html topic_182.html topic_183.html topic_184.html topic_185.html topic_186.html topic_187.html topic_188.html topic_189.html topic_18.html topic_190.html topic_191.html topic_192.html topic_193.html topic_194.html topic_195.html topic_196.html topic_197.html topic_198.html topic_199.html topic_19.html topic_1.html topic_200.html topic_201.html topic_202.html topic_203.html topic_204.html topic_205.html topic_206.html topic_207.html topic_208.html topic_209.html topic_20.html topic_210.html topic_211.html topic_21.html topic_22.html topic_23.html topic_24.html topic_25.html topic_26.html topic_27.html topic_28.html topic_29.html topic_2.html topic_30.html topic_31.html topic_32.html topic_33.html topic_34.html topic_35.html topic_36.html topic_37.html topic_38.html topic_39.html topic_3.html topic_40.html topic_41.html topic_42.html topic_43.html topic_44.html topic_45.html topic_46.html topic_47.html topic_48.html topic_49.html topic_4.html topic_50.html topic_51.html topic_52.html topic_53.html topic_54.html topic_55.html topic_56.html topic_57.html topic_58.html topic_59.html topic_5.html topic_60.html topic_61.html topic_62.html topic_63.html topic_64.html topic_65.html topic_66.html topic_67.html topic_68.html topic_69.html topic_6.html topic_70.html topic_71.html topic_72.html topic_73.html topic_74.html topic_75.html topic_76.html topic_77.html topic_78.html topic_79.html topic_7.html topic_80.html topic_81.html topic_82.html topic_83.html topic_84.html topic_85.html topic_86.html topic_87.html topic_88.html topic_89.html topic_8.html topic_90.html topic_91.html topic_92.html topic_93.html topic_94.html topic_95.html topic_96.html topic_97.html topic_98.html topic_99.html topic_9.html ASUS M5A99FX PRO R 2.0<br /> 1.sh topic_100.html topic_101.html topic_102.html topic_103.html topic_104.html topic_105.html topic_106.html topic_107.html topic_108.html topic_109.html topic_10.html topic_110.html topic_111.html topic_112.html topic_113.html topic_114.html topic_115.html topic_116.html topic_117.html topic_118.html topic_119.html topic_11.html topic_120.html topic_121.html topic_122.html topic_123.html topic_124.html topic_125.html topic_126.html topic_127.html topic_128.html topic_129.html topic_12.html topic_130.html topic_131.html topic_132.html topic_133.html topic_134.html topic_135.html topic_136.html topic_137.html topic_138.html topic_139.html topic_13.html topic_140.html topic_141.html topic_142.html topic_143.html topic_144.html topic_145.html topic_146.html topic_147.html topic_148.html topic_149.html topic_14.html topic_150.html topic_151.html topic_152.html topic_153.html topic_154.html topic_155.html topic_156.html topic_157.html topic_158.html topic_159.html topic_15.html topic_160.html topic_161.html topic_162.html topic_163.html topic_164.html topic_165.html topic_166.html topic_167.html topic_168.html topic_169.html topic_16.html topic_170.html topic_171.html topic_172.html topic_173.html topic_174.html topic_175.html topic_176.html topic_177.html topic_178.html topic_179.html topic_17.html topic_180.html topic_181.html topic_182.html topic_183.html topic_184.html topic_185.html topic_186.html topic_187.html topic_188.html topic_189.html topic_18.html topic_190.html topic_191.html topic_192.html topic_193.html topic_194.html topic_195.html topic_196.html topic_197.html topic_198.html topic_199.html topic_19.html topic_1.html topic_200.html topic_201.html topic_202.html topic_203.html topic_204.html topic_205.html topic_206.html topic_207.html topic_208.html topic_209.html topic_20.html topic_210.html topic_211.html topic_21.html topic_22.html topic_23.html topic_24.html topic_25.html topic_26.html topic_27.html topic_28.html topic_29.html topic_2.html topic_30.html topic_31.html topic_32.html topic_33.html topic_34.html topic_35.html topic_36.html topic_37.html topic_38.html topic_39.html topic_3.html topic_40.html topic_41.html topic_42.html topic_43.html topic_44.html topic_45.html topic_46.html topic_47.html topic_48.html topic_49.html topic_4.html topic_50.html topic_51.html topic_52.html topic_53.html topic_54.html topic_55.html topic_56.html topic_57.html topic_58.html topic_59.html topic_5.html topic_60.html topic_61.html topic_62.html topic_63.html topic_64.html topic_65.html topic_66.html topic_67.html topic_68.html topic_69.html topic_6.html topic_70.html topic_71.html topic_72.html topic_73.html topic_74.html topic_75.html topic_76.html topic_77.html topic_78.html topic_79.html topic_7.html topic_80.html topic_81.html topic_82.html topic_83.html topic_84.html topic_85.html topic_86.html topic_87.html topic_88.html topic_89.html topic_8.html topic_90.html topic_91.html topic_92.html topic_93.html topic_94.html topic_95.html topic_96.html topic_97.html topic_98.html topic_99.html topic_9.html 16 GB RAM<br /> 1.sh topic_100.html topic_101.html topic_102.html topic_103.html topic_104.html topic_105.html topic_106.html topic_107.html topic_108.html topic_109.html topic_10.html topic_110.html topic_111.html topic_112.html topic_113.html topic_114.html topic_115.html topic_116.html topic_117.html topic_118.html topic_119.html topic_11.html topic_120.html topic_121.html topic_122.html topic_123.html topic_124.html topic_125.html topic_126.html topic_127.html topic_128.html topic_129.html topic_12.html topic_130.html topic_131.html topic_132.html topic_133.html topic_134.html topic_135.html topic_136.html topic_137.html topic_138.html topic_139.html topic_13.html topic_140.html topic_141.html topic_142.html topic_143.html topic_144.html topic_145.html topic_146.html topic_147.html topic_148.html topic_149.html topic_14.html topic_150.html topic_151.html topic_152.html topic_153.html topic_154.html topic_155.html topic_156.html topic_157.html topic_158.html topic_159.html topic_15.html topic_160.html topic_161.html topic_162.html topic_163.html topic_164.html topic_165.html topic_166.html topic_167.html topic_168.html topic_169.html topic_16.html topic_170.html topic_171.html topic_172.html topic_173.html topic_174.html topic_175.html topic_176.html topic_177.html topic_178.html topic_179.html topic_17.html topic_180.html topic_181.html topic_182.html topic_183.html topic_184.html topic_185.html topic_186.html topic_187.html topic_188.html topic_189.html topic_18.html topic_190.html topic_191.html topic_192.html topic_193.html topic_194.html topic_195.html topic_196.html topic_197.html topic_198.html topic_199.html topic_19.html topic_1.html topic_200.html topic_201.html topic_202.html topic_203.html topic_204.html topic_205.html topic_206.html topic_207.html topic_208.html topic_209.html topic_20.html topic_210.html topic_211.html topic_21.html topic_22.html topic_23.html topic_24.html topic_25.html topic_26.html topic_27.html topic_28.html topic_29.html topic_2.html topic_30.html topic_31.html topic_32.html topic_33.html topic_34.html topic_35.html topic_36.html topic_37.html topic_38.html topic_39.html topic_3.html topic_40.html topic_41.html topic_42.html topic_43.html topic_44.html topic_45.html topic_46.html topic_47.html topic_48.html topic_49.html topic_4.html topic_50.html topic_51.html topic_52.html topic_53.html topic_54.html topic_55.html topic_56.html topic_57.html topic_58.html topic_59.html topic_5.html topic_60.html topic_61.html topic_62.html topic_63.html topic_64.html topic_65.html topic_66.html topic_67.html topic_68.html topic_69.html topic_6.html topic_70.html topic_71.html topic_72.html topic_73.html topic_74.html topic_75.html topic_76.html topic_77.html topic_78.html topic_79.html topic_7.html topic_80.html topic_81.html topic_82.html topic_83.html topic_84.html topic_85.html topic_86.html topic_87.html topic_88.html topic_89.html topic_8.html topic_90.html topic_91.html topic_92.html topic_93.html topic_94.html topic_95.html topic_96.html topic_97.html topic_98.html topic_99.html topic_9.html Sapphire R9 290 Vapor-X as a passthrough card (Slot 3), hosts a Dell 2415 via DP<br /> 1.sh topic_100.html topic_101.html topic_102.html topic_103.html topic_104.html topic_105.html topic_106.html topic_107.html topic_108.html topic_109.html topic_10.html topic_110.html topic_111.html topic_112.html topic_113.html topic_114.html topic_115.html topic_116.html topic_117.html topic_118.html topic_119.html topic_11.html topic_120.html topic_121.html topic_122.html topic_123.html topic_124.html topic_125.html topic_126.html topic_127.html topic_128.html topic_129.html topic_12.html topic_130.html topic_131.html topic_132.html topic_133.html topic_134.html topic_135.html topic_136.html topic_137.html topic_138.html topic_139.html topic_13.html topic_140.html topic_141.html topic_142.html topic_143.html topic_144.html topic_145.html topic_146.html topic_147.html topic_148.html topic_149.html topic_14.html topic_150.html topic_151.html topic_152.html topic_153.html topic_154.html topic_155.html topic_156.html topic_157.html topic_158.html topic_159.html topic_15.html topic_160.html topic_161.html topic_162.html topic_163.html topic_164.html topic_165.html topic_166.html topic_167.html topic_168.html topic_169.html topic_16.html topic_170.html topic_171.html topic_172.html topic_173.html topic_174.html topic_175.html topic_176.html topic_177.html topic_178.html topic_179.html topic_17.html topic_180.html topic_181.html topic_182.html topic_183.html topic_184.html topic_185.html topic_186.html topic_187.html topic_188.html topic_189.html topic_18.html topic_190.html topic_191.html topic_192.html topic_193.html topic_194.html topic_195.html topic_196.html topic_197.html topic_198.html topic_199.html topic_19.html topic_1.html topic_200.html topic_201.html topic_202.html topic_203.html topic_204.html topic_205.html topic_206.html topic_207.html topic_208.html topic_209.html topic_20.html topic_210.html topic_211.html topic_21.html topic_22.html topic_23.html topic_24.html topic_25.html topic_26.html topic_27.html topic_28.html topic_29.html topic_2.html topic_30.html topic_31.html topic_32.html topic_33.html topic_34.html topic_35.html topic_36.html topic_37.html topic_38.html topic_39.html topic_3.html topic_40.html topic_41.html topic_42.html topic_43.html topic_44.html topic_45.html topic_46.html topic_47.html topic_48.html topic_49.html topic_4.html topic_50.html topic_51.html topic_52.html topic_53.html topic_54.html topic_55.html topic_56.html topic_57.html topic_58.html topic_59.html topic_5.html topic_60.html topic_61.html topic_62.html topic_63.html topic_64.html topic_65.html topic_66.html topic_67.html topic_68.html topic_69.html topic_6.html topic_70.html topic_71.html topic_72.html topic_73.html topic_74.html topic_75.html topic_76.html topic_77.html topic_78.html topic_79.html topic_7.html topic_80.html topic_81.html topic_82.html topic_83.html topic_84.html topic_85.html topic_86.html topic_87.html topic_88.html topic_89.html topic_8.html topic_90.html topic_91.html topic_92.html topic_93.html topic_94.html topic_95.html topic_96.html topic_97.html topic_98.html topic_99.html topic_9.html ATI Radeon HD 4650 as a boot VGA (Slot 1), hosts both of my monitors (Dell 2415 and 2412)<br /> 1.sh topic_100.html topic_101.html topic_102.html topic_103.html topic_104.html topic_105.html topic_106.html topic_107.html topic_108.html topic_109.html topic_10.html topic_110.html topic_111.html topic_112.html topic_113.html topic_114.html topic_115.html topic_116.html topic_117.html topic_118.html topic_119.html topic_11.html topic_120.html topic_121.html topic_122.html topic_123.html topic_124.html topic_125.html topic_126.html topic_127.html topic_128.html topic_129.html topic_12.html topic_130.html topic_131.html topic_132.html topic_133.html topic_134.html topic_135.html topic_136.html topic_137.html topic_138.html topic_139.html topic_13.html topic_140.html topic_141.html topic_142.html topic_143.html topic_144.html topic_145.html topic_146.html topic_147.html topic_148.html topic_149.html topic_14.html topic_150.html topic_151.html topic_152.html topic_153.html topic_154.html topic_155.html topic_156.html topic_157.html topic_158.html topic_159.html topic_15.html topic_160.html topic_161.html topic_162.html topic_163.html topic_164.html topic_165.html topic_166.html topic_167.html topic_168.html topic_169.html topic_16.html topic_170.html topic_171.html topic_172.html topic_173.html topic_174.html topic_175.html topic_176.html topic_177.html topic_178.html topic_179.html topic_17.html topic_180.html topic_181.html topic_182.html topic_183.html topic_184.html topic_185.html topic_186.html topic_187.html topic_188.html topic_189.html topic_18.html topic_190.html topic_191.html topic_192.html topic_193.html topic_194.html topic_195.html topic_196.html topic_197.html topic_198.html topic_199.html topic_19.html topic_1.html topic_200.html topic_201.html topic_202.html topic_203.html topic_204.html topic_205.html topic_206.html topic_207.html topic_208.html topic_209.html topic_20.html topic_210.html topic_211.html topic_21.html topic_22.html topic_23.html topic_24.html topic_25.html topic_26.html topic_27.html topic_28.html topic_29.html topic_2.html topic_30.html topic_31.html topic_32.html topic_33.html topic_34.html topic_35.html topic_36.html topic_37.html topic_38.html topic_39.html topic_3.html topic_40.html topic_41.html topic_42.html topic_43.html topic_44.html topic_45.html topic_46.html topic_47.html topic_48.html topic_49.html topic_4.html topic_50.html topic_51.html topic_52.html topic_53.html topic_54.html topic_55.html topic_56.html topic_57.html topic_58.html topic_59.html topic_5.html topic_60.html topic_61.html topic_62.html topic_63.html topic_64.html topic_65.html topic_66.html topic_67.html topic_68.html topic_69.html topic_6.html topic_70.html topic_71.html topic_72.html topic_73.html topic_74.html topic_75.html topic_76.html topic_77.html topic_78.html topic_79.html topic_7.html topic_80.html topic_81.html topic_82.html topic_83.html topic_84.html topic_85.html topic_86.html topic_87.html topic_88.html topic_89.html topic_8.html topic_90.html topic_91.html topic_92.html topic_93.html topic_94.html topic_95.html topic_96.html topic_97.html topic_98.html topic_99.html topic_9.html Boot options: pci-stub.ids=1002:67be,1002:aac8 iommu=pt iommu=1<br /> 1.sh topic_100.html topic_101.html topic_102.html topic_103.html topic_104.html topic_105.html topic_106.html topic_107.html topic_108.html topic_109.html topic_10.html topic_110.html topic_111.html topic_112.html topic_113.html topic_114.html topic_115.html topic_116.html topic_117.html topic_118.html topic_119.html topic_11.html topic_120.html topic_121.html topic_122.html topic_123.html topic_124.html topic_125.html topic_126.html topic_127.html topic_128.html topic_129.html topic_12.html topic_130.html topic_131.html topic_132.html topic_133.html topic_134.html topic_135.html topic_136.html topic_137.html topic_138.html topic_139.html topic_13.html topic_140.html topic_141.html topic_142.html topic_143.html topic_144.html topic_145.html topic_146.html topic_147.html topic_148.html topic_149.html topic_14.html topic_150.html topic_151.html topic_152.html topic_153.html topic_154.html topic_155.html topic_156.html topic_157.html topic_158.html topic_159.html topic_15.html topic_160.html topic_161.html topic_162.html topic_163.html topic_164.html topic_165.html topic_166.html topic_167.html topic_168.html topic_169.html topic_16.html topic_170.html topic_171.html topic_172.html topic_173.html topic_174.html topic_175.html topic_176.html topic_177.html topic_178.html topic_179.html topic_17.html topic_180.html topic_181.html topic_182.html topic_183.html topic_184.html topic_185.html topic_186.html topic_187.html topic_188.html topic_189.html topic_18.html topic_190.html topic_191.html topic_192.html topic_193.html topic_194.html topic_195.html topic_196.html topic_197.html topic_198.html topic_199.html topic_19.html topic_1.html topic_200.html topic_201.html topic_202.html topic_203.html topic_204.html topic_205.html topic_206.html topic_207.html topic_208.html topic_209.html topic_20.html topic_210.html topic_211.html topic_21.html topic_22.html topic_23.html topic_24.html topic_25.html topic_26.html topic_27.html topic_28.html topic_29.html topic_2.html topic_30.html topic_31.html topic_32.html topic_33.html topic_34.html topic_35.html topic_36.html topic_37.html topic_38.html topic_39.html topic_3.html topic_40.html topic_41.html topic_42.html topic_43.html topic_44.html topic_45.html topic_46.html topic_47.html topic_48.html topic_49.html topic_4.html topic_50.html topic_51.html topic_52.html topic_53.html topic_54.html topic_55.html topic_56.html topic_57.html topic_58.html topic_59.html topic_5.html topic_60.html topic_61.html topic_62.html topic_63.html topic_64.html topic_65.html topic_66.html topic_67.html topic_68.html topic_69.html topic_6.html topic_70.html topic_71.html topic_72.html topic_73.html topic_74.html topic_75.html topic_76.html topic_77.html topic_78.html topic_79.html topic_7.html topic_80.html topic_81.html topic_82.html topic_83.html topic_84.html topic_85.html topic_86.html topic_87.html topic_88.html topic_89.html topic_8.html topic_90.html topic_91.html topic_92.html topic_93.html topic_94.html topic_95.html topic_96.html topic_97.html topic_98.html topic_99.html topic_9.html Using libvirt 1.2.15, qemu 2.3.0 and stock kernel (4.0.4-2 at present)<br /> 1.sh topic_100.html topic_101.html topic_102.html topic_103.html topic_104.html topic_105.html topic_106.html topic_107.html topic_108.html topic_109.html topic_10.html topic_110.html topic_111.html topic_112.html topic_113.html topic_114.html topic_115.html topic_116.html topic_117.html topic_118.html topic_119.html topic_11.html topic_120.html topic_121.html topic_122.html topic_123.html topic_124.html topic_125.html topic_126.html topic_127.html topic_128.html topic_129.html topic_12.html topic_130.html topic_131.html topic_132.html topic_133.html topic_134.html topic_135.html topic_136.html topic_137.html topic_138.html topic_139.html topic_13.html topic_140.html topic_141.html topic_142.html topic_143.html topic_144.html topic_145.html topic_146.html topic_147.html topic_148.html topic_149.html topic_14.html topic_150.html topic_151.html topic_152.html topic_153.html topic_154.html topic_155.html topic_156.html topic_157.html topic_158.html topic_159.html topic_15.html topic_160.html topic_161.html topic_162.html topic_163.html topic_164.html topic_165.html topic_166.html topic_167.html topic_168.html topic_169.html topic_16.html topic_170.html topic_171.html topic_172.html topic_173.html topic_174.html topic_175.html topic_176.html topic_177.html topic_178.html topic_179.html topic_17.html topic_180.html topic_181.html topic_182.html topic_183.html topic_184.html topic_185.html topic_186.html topic_187.html topic_188.html topic_189.html topic_18.html topic_190.html topic_191.html topic_192.html topic_193.html topic_194.html topic_195.html topic_196.html topic_197.html topic_198.html topic_199.html topic_19.html topic_1.html topic_200.html topic_201.html topic_202.html topic_203.html topic_204.html topic_205.html topic_206.html topic_207.html topic_208.html topic_209.html topic_20.html topic_210.html topic_211.html topic_21.html topic_22.html topic_23.html topic_24.html topic_25.html topic_26.html topic_27.html topic_28.html topic_29.html topic_2.html topic_30.html topic_31.html topic_32.html topic_33.html topic_34.html topic_35.html topic_36.html topic_37.html topic_38.html topic_39.html topic_3.html topic_40.html topic_41.html topic_42.html topic_43.html topic_44.html topic_45.html topic_46.html topic_47.html topic_48.html topic_49.html topic_4.html topic_50.html topic_51.html topic_52.html topic_53.html topic_54.html topic_55.html topic_56.html topic_57.html topic_58.html topic_59.html topic_5.html topic_60.html topic_61.html topic_62.html topic_63.html topic_64.html topic_65.html topic_66.html topic_67.html topic_68.html topic_69.html topic_6.html topic_70.html topic_71.html topic_72.html topic_73.html topic_74.html topic_75.html topic_76.html topic_77.html topic_78.html topic_79.html topic_7.html topic_80.html topic_81.html topic_82.html topic_83.html topic_84.html topic_85.html topic_86.html topic_87.html topic_88.html topic_89.html topic_8.html topic_90.html topic_91.html topic_92.html topic_93.html topic_94.html topic_95.html topic_96.html topic_97.html topic_98.html topic_99.html topic_9.html VM config is here: <a href="http://pastebin.ca/3020403" rel="nofollow">http://pastebin.ca/3020403</a></p><p>Could anybody please give me a hint on where to look next?</p><p><strong>Edit:</strong> Maybe I should reinstall everything yet again and use Q35? Will that solve my issues?</p> <p class="postedit"><em>Last edited by WildyLion (2015-06-07 11:35:23)</em></p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1535091">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1535113" class="blockpost rowodd"> <h2><span><span class="conr">#5292</span> <a href="viewtopic.php?pid=1535113#p1535113">2015-06-07 13:14:10</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=91719">jurie</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2015-06-07</span></dd> <dd><span>Posts: 1</span></dd> <dd class="usercontacts"><span class="email"><a href="mailto:jurie.erwee@gmail.com">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <p>Hi there,</p><p>I&#039;m using ASRock Z97 Extreme6 and a Intel i5-4690K with an old GTX 670.<br />I followed the steps from <a href="https://www.youtube.com/watch?v=Tq345_v2-Ew" rel="nofollow">https://www.youtube.com/watch?v=Tq345_v2-Ew</a>&#160; but cant see to get it working?<br />My setup/ config is here <a href="http://pastebin.com/kp3ES6Sn" rel="nofollow">http://pastebin.com/kp3ES6Sn</a></p><p>The virtual machine boots, but I cant see any output on my GTX 670 card?<br />Should I just enable i915 VGA arbiter patch as a module &quot;i915&quot; ?</p><p>Could someone please point me in the right direction please?<br />Thanks</p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1535113">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1535178" class="blockpost roweven"> <h2><span><span class="conr">#5293</span> <a href="viewtopic.php?pid=1535178#p1535178">2015-06-07 16:39:31</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=58583">Nesousx</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2012-03-27</span></dd> <dd><span>Posts: 46</span></dd> <dd class="usercontacts"><span class="email"><a href="misc.php?email=58583">Email</a></span> <span class="website"><a href="https://www.kodi-xbmc.com/" rel="nofollow">Website</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <p>Hi,</p><p>I am having issues setting up sound in my Guest VM. Guest is running under Win 10, here is the &quot;launcher&quot;:</p><div class="codebox"><pre><code>qemu-system-x86_64 -name winten -enable-kvm -m 16384 -cpu host,kvm=off \ -smp 4,sockets=1,cores=4,threads=1 \ -drive if=pflash,format=raw,readonly,file=/usr/share/edk2.git/ovmf-x64/OVMF_CODE.fd \ -drive if=pflash,format=raw,file=/usr/share/edk2.git/ovmf-x64/OVMF_VARS.fd \ -device vfio-pci,host=01:00.0 -device vfio-pci,host=01:00.1 -device vfio-pci,host=00:1d.0 \ -vga none \ -device virtio-scsi-pci,id=scsi \ -drive file=/dev/guest/win10,id=win,format=raw,if=none -device scsi-hd,drive=win \ -drive file=/dev/guest/win7,id=data,format=raw,if=none -device scsi-hd,drive=data \ -net nic,model=virtio,macaddr=52:54:00:7c:3c:42 -net bridge,br=br0 \ -soundhw hda \ -nographic</code></pre></div><p>Everything seems OK. However, sounds is &quot;lagging&quot; / distorted. I have tried several stuff from first post, like :</p><p>QEMU_PA_SAMPLES=128 QEMU_AUDIO_DRV=pa qemu-system-x86_64...</p><p>.. changing sample size from 32 to 8192.. didn&#039;t help.</p><p>Please also note that I see the following message while running the launch script :</p><div class="codebox"><pre><code>pulseaudio: pa_context_connect() failed pulseaudio: Reason: Connection refused pulseaudio: Failed to initialize PA contextaudio: Could not init `pa&#039; audio driver</code></pre></div><p>And :</p><p>QEMU_ALSA_DAC_BUFFER_SIZE=512 QEMU_ALSA_DAC_PERIOD_SIZE=170 QEMU_AUDIO_DRV=alsa qemu-system-x86_64...</p><p>Also changing buffer size and period size from several values.</p><p>I always end up in lagging audio.</p><p>I remember having this issue months ago (on a Win 7 host), then I fixed it, but I can&#039;t recall what I did. Maybe it was something about using pulse system wide. But I am not willing to do it again unless I am really sure it comes from here.</p><p>Lately I have been using&#160; a USB sound card shared from Host to Guest and it worked fine. However, I had issue in the host, since I had to reselect sound card every time I plug it out / back in, which bored me.</p><p>If anyone has any insight on how to debug this, it would be gladly appreciated. Otherwise, it might be better to find a fix (such as this : <a href="http://alsa.opensrc.org/Udev" rel="nofollow">http://alsa.opensrc.org/Udev</a>, I believe) for the USB sound card on host, but this will be off topic.</p><p>Thanks a lot in advance</p> <p class="postedit"><em>Last edited by Nesousx (2015-06-07 16:39:53)</em></p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1535178">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1535181" class="blockpost rowodd"> <h2><span><span class="conr">#5294</span> <a href="viewtopic.php?pid=1535181#p1535181">2015-06-07 17:09:04</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=91723">supertrampx</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2015-06-07</span></dd> <dd><span>Posts: 11</span></dd> <dd class="usercontacts"><span class="email"><a href="mailto:joe.cayouette@gmail.com">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <p>Hello! <img src="https://bbs.archlinux.org/img/smilies/smile.png" width="15" height="15" alt="smile" /><br />I have successfully gotten VGA-passthrough with qemu working on my second monitor with my 970gtx on my Sr-2 classified. <br />Currently I am having troubles getting qemu to recognize a boot device, I have searched for MANY hours, so perhaps someone could point me in the right direction? Perhaps I am sleepy and missed something.<br />Currently using this vm script. I have left the disk and cd devices undefined here, as I have no clue what is wrong and would like to start from a clear slate. QEMU boots fine on my second card, and passthrough is working.</p><p>#!/bin/bash</p><p>configfile=/etc/vfio-pci1.cfg</p><p>vfiobind() {<br />&#160; &#160; dev=&quot;$1&quot;<br />&#160; &#160; &#160; &#160; vendor=$(cat /sys/bus/pci/devices/$dev/vendor)<br />&#160; &#160; &#160; &#160; device=$(cat /sys/bus/pci/devices/$dev/device)<br />&#160; &#160; &#160; &#160; if [ -e /sys/bus/pci/devices/$dev/driver ]; then<br />&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; echo $dev &gt; /sys/bus/pci/devices/$dev/driver/unbind<br />&#160; &#160; &#160; &#160; fi<br />&#160; &#160; &#160; &#160; echo $vendor $device &gt; /sys/bus/pci/drivers/vfio-pci/new_id</p><p>}</p><p>modprobe vfio-pci</p><p>cat $configfile | while read line;do<br />&#160; &#160; echo $line | grep ^# &gt;/dev/null 2&gt;&amp;1 &amp;&amp; continue<br />&#160; &#160; &#160; &#160; vfiobind $line<br />done</p><p>#Startup Windows 7 Guest with VGA-Passthrough<br />qemu-system-x86_64 -name win7 -enable-kvm -m 1024 -cpu host,kvm=off \<br />-smp 4,sockets=1,cores=4,threads=1 \<br />-bios /home/coyote/seabios/out/bios.bin \<br />-device vfio-pci,host=04:00.0,x-vga=on -device vfio-pci,host=04:00.1 \<br />-vga none \</p><p>exit 0</p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1535181">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1535182" class="blockpost roweven"> <h2><span><span class="conr">#5295</span> <a href="viewtopic.php?pid=1535182#p1535182">2015-06-07 17:18:08</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=58583">Nesousx</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2012-03-27</span></dd> <dd><span>Posts: 46</span></dd> <dd class="usercontacts"><span class="email"><a href="misc.php?email=58583">Email</a></span> <span class="website"><a href="https://www.kodi-xbmc.com/" rel="nofollow">Website</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>supertrampx wrote:</cite><blockquote><div><p>Hello! <img src="https://bbs.archlinux.org/img/smilies/smile.png" width="15" height="15" alt="smile" /><br />I have successfully gotten VGA-passthrough with qemu working on my second monitor with my 970gtx on my Sr-2 classified. <br />Currently I am having troubles getting qemu to recognize a boot device, I have searched for MANY hours, so perhaps someone could point me in the right direction? Perhaps I am sleepy and missed something.<br />Currently using this vm script. I have left the disk and cd devices undefined here, as I have no clue what is wrong and would like to start from a clear slate. QEMU boots fine on my second card, and passthrough is working.</p><p>#!/bin/bash</p><p>configfile=/etc/vfio-pci1.cfg</p><p>vfiobind() {<br />&#160; &#160; dev=&quot;$1&quot;<br />&#160; &#160; &#160; &#160; vendor=$(cat /sys/bus/pci/devices/$dev/vendor)<br />&#160; &#160; &#160; &#160; device=$(cat /sys/bus/pci/devices/$dev/device)<br />&#160; &#160; &#160; &#160; if [ -e /sys/bus/pci/devices/$dev/driver ]; then<br />&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; echo $dev &gt; /sys/bus/pci/devices/$dev/driver/unbind<br />&#160; &#160; &#160; &#160; fi<br />&#160; &#160; &#160; &#160; echo $vendor $device &gt; /sys/bus/pci/drivers/vfio-pci/new_id</p><p>}</p><p>modprobe vfio-pci</p><p>cat $configfile | while read line;do<br />&#160; &#160; echo $line | grep ^# &gt;/dev/null 2&gt;&amp;1 &amp;&amp; continue<br />&#160; &#160; &#160; &#160; vfiobind $line<br />done</p><p>#Startup Windows 7 Guest with VGA-Passthrough<br />qemu-system-x86_64 -name win7 -enable-kvm -m 1024 -cpu host,kvm=off \<br />-smp 4,sockets=1,cores=4,threads=1 \<br />-bios /home/coyote/seabios/out/bios.bin \<br />-device vfio-pci,host=04:00.0,x-vga=on -device vfio-pci,host=04:00.1 \<br />-vga none \</p><p>exit 0</p></div></blockquote></div><p>Hi,</p><p>You don&#039;t seem to be using any &quot;hard drive&quot; in your &quot;starter script&quot;. You should probably have a line like :</p><div class="codebox"><pre><code>-drive file=/dev/guest/win10,id=win,format=raw,if=none -device scsi-hd,drive=win</code></pre></div><p>Have you checked Aw&#039;s Blog (<a href="http://vfio.blogspot.fr/" rel="nofollow">http://vfio.blogspot.fr/</a>), especially the 5 parts tutorial on VFIO GPU? Plenty of advices there.</p><p>You might also want to re-read complety first post.</p><p>EDIT : you said, that you left the CD and HDD devices undefined. But I believe we actually want to see the full config file in order to help you.</p> <p class="postedit"><em>Last edited by Nesousx (2015-06-07 17:20:36)</em></p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1535182">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1535183" class="blockpost rowodd"> <h2><span><span class="conr">#5296</span> <a href="viewtopic.php?pid=1535183#p1535183">2015-06-07 17:20:11</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=91723">supertrampx</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2015-06-07</span></dd> <dd><span>Posts: 11</span></dd> <dd class="usercontacts"><span class="email"><a href="mailto:joe.cayouette@gmail.com">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <p>&quot;I have left the disk and cd devices undefined here, as I have no clue what is wrong&quot;</p><p>Thanks for reply but I said this already <img src="https://bbs.archlinux.org/img/smilies/tongue.png" width="15" height="15" alt="tongue" /> </p><p>I will check that link, thank you, other suggestions would be great!</p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1535183">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1535184" class="blockpost roweven"> <h2><span><span class="conr">#5297</span> <a href="viewtopic.php?pid=1535184#p1535184">2015-06-07 17:20:56</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=58583">Nesousx</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2012-03-27</span></dd> <dd><span>Posts: 46</span></dd> <dd class="usercontacts"><span class="email"><a href="misc.php?email=58583">Email</a></span> <span class="website"><a href="https://www.kodi-xbmc.com/" rel="nofollow">Website</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>supertrampx wrote:</cite><blockquote><div><p>&quot;I have left the disk and cd devices undefined here, as I have no clue what is wrong&quot;</p><p>Thanks for reply but I said this already <img src="https://bbs.archlinux.org/img/smilies/tongue.png" width="15" height="15" alt="tongue" /> </p><p>I will check that link, thank you, other suggestions would be great!</p></div></blockquote></div><p>Check my edit.</p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1535184">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1535190" class="blockpost rowodd"> <h2><span><span class="conr">#5298</span> <a href="viewtopic.php?pid=1535190#p1535190">2015-06-07 17:31:04</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=91723">supertrampx</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2015-06-07</span></dd> <dd><span>Posts: 11</span></dd> <dd class="usercontacts"><span class="email"><a href="mailto:joe.cayouette@gmail.com">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <p>Ok, well what is a very common way to set this up? Could I use an iso made from a windows cd? </p><p>Currently I have created a windows iso from the windows 7 ultimate disk. and prepared a raw windows img using the dd command.<br />do I need to specify a bus device? I have recieved no errors other than no bootable device found...</p><p>/home/coyote/windows7.iso<br />/home/coyote/win7.img<br />/home/coyote/virtio.iso &quot;windows drivers&quot;</p><p>Many thanks in advance.</p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1535190">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1535193" class="blockpost roweven"> <h2><span><span class="conr">#5299</span> <a href="viewtopic.php?pid=1535193#p1535193">2015-06-07 17:40:46</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=58583">Nesousx</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2012-03-27</span></dd> <dd><span>Posts: 46</span></dd> <dd class="usercontacts"><span class="email"><a href="misc.php?email=58583">Email</a></span> <span class="website"><a href="https://www.kodi-xbmc.com/" rel="nofollow">Website</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>supertrampx wrote:</cite><blockquote><div><p>Ok, well what is a very common way to set this up? Could I use an iso made from a windows cd? </p><p>Currently I have created a windows iso from the windows 7 ultimate disk. and prepared a raw windows img using the dd command.<br />do I need to specify a bus device? I have recieved no errors other than no bootable device found...</p><p>/home/coyote/windows7.iso<br />/home/coyote/win7.img<br />/home/coyote/virtio.iso &quot;windows drivers&quot;</p><p>Many thanks in advance.</p></div></blockquote></div><p>What you are posting doesn&#039;t look anything like it was suggested by OP and I have no idea how you are using this in your script.</p><p>Here is a working config, try to modify it to your needs (drives / disks part) :</p><div class="codebox"><pre><code>qemu-system-x86_64 -name winten -enable-kvm -m 16384 -cpu host,kvm=off \ -smp 4,sockets=1,cores=4,threads=1 \ -drive if=pflash,format=raw,readonly,file=/usr/share/edk2.git/ovmf-x64/OVMF_CODE.fd \ -drive if=pflash,format=raw,file=/usr/share/edk2.git/ovmf-x64/OVMF_VARS.fd \ -device vfio-pci,host=01:00.0 -device vfio-pci,host=01:00.1 -device vfio-pci,host=00:1d.0 \ -vga none \ -device virtio-scsi-pci,id=scsi \ -drive file=/dev/guest/win10,id=win,format=raw,if=none -device scsi-hd,drive=win \ -drive file=/dev/guest/win7,id=data,format=raw,if=none -device scsi-hd,drive=data \ -drive file=/home/nesousx/Isos/virtio-win-0.1-81.iso,id=virtiocd,if=none -device ide-cd,bus=ide.1,drive=virtiocd \ -drive file=/home/nesousx/Isos/Win_7_Pro_x64.iso,id=isocd,if=none -device scsi-cd,drive=isocd \ -net nic,model=virtio,macaddr=52:54:00:7c:3c:42 -net bridge,br=br0 \ -soundhw hda \ -nographic</code></pre></div><p>First 2 drives statements are &quot;system&quot; and &quot;data&quot; drives, they are LVM volumes. Then the 2 others are iso files (one for Win 7, one for the virtio drivers). Also, if you are using a &quot;just created&quot; iso, make sure it is a working and really boots.</p><p>Edit : try this from your original script :</p><div class="codebox"><pre><code>#Startup Windows 7 Guest with VGA-Passthrough qemu-system-x86_64 -name win7 -enable-kvm -m 1024 -cpu host,kvm=off \ -smp 4,sockets=1,cores=4,threads=1 \ -bios /home/coyote/seabios/out/bios.bin \ -device vfio-pci,host=04:00.0,x-vga=on -device vfio-pci,host=04:00.1 \ -drive file=/home/coyote/win7.img,id=win,format=raw,if=none -device scsi-hd,drive=win \ -drive file=/home/coyote/virtio.iso,id=virtiocd,if=none -device ide-cd,bus=ide.1,drive=virtiocd \ -drive file=/home/coyote/windows7.iso,id=isocd,if=none -device scsi-cd,drive=isocd \ -vga none</code></pre></div> <p class="postedit"><em>Last edited by Nesousx (2015-06-07 21:39:40)</em></p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1535193">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1535297" class="blockpost rowodd"> <h2><span><span class="conr">#5300</span> <a href="viewtopic.php?pid=1535297#p1535297">2015-06-08 00:45:48</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=85314">Duelist</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2014-09-22</span></dd> <dd><span>Posts: 358</span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>lersek wrote:</cite><blockquote><div><p>The second quote makes no sense because GOPs are exposed by, and are the standard interface of, device-specific UEFI video drivers. A UEFI GOP does not exist without a device-specific UEFI driver; at worst you can say that the actual driver is low quality or generic, because, while it recognizes the video card, it cannot utilize its full capabilities.</p></div></blockquote></div><p>Who writes those UEFI drivers? Firmware-engineers(ASUS, Gigabyte, guys who produce the motherboards, etc.), vendors of the devices(EVGA, Sapphire, guys that don&#039;t produce motherboards etc.) or AMD/Intel themselves? Where they are stored? Are they hidden somewhere in the firmware(UEFI), or in the device ROM? If it&#039;s an intel iGPU, where that ROM with the device driver is located, as i can&#039;t recall intel GPUs being listed as a regular PCI device?<br />And..<br />Why does emulated QXL can&#039;t go beyond 1024x768... even with an extended amount of VRAM given?</p> </div> <div class="postsignature postmsg"><hr /><p><span class="bbs">The forum rules prohibit requesting support for distributions other than arch.</span><br /><a href="https://bbs.archlinux.org/viewtopic.php?pid=1551460#p1551460" rel="nofollow">I gave up.</a><a href="https://bbs.archlinux.org/viewtopic.php?id=162768" rel="nofollow"> It was too late.</a><br /><a href="http://pastebin.com/B3fL84bq" rel="nofollow">What I was trying to do</a>.<br /><a href="http://vfio.blogspot.com/" rel="nofollow">The reference about VFIO and KVM VGA passthrough.</a></p></div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1535297">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div class="postlinksb"> <div class="inbox crumbsplus"> <div class="pagepost"> <p class="pagelink conl"><span class="pages-label">Pages: </span><a rel="prev" class="item1" href="viewtopic.php?id=162768&amp;p=211">Previous</a> <a href="viewtopic.php?id=162768">1</a> <span class="spacer">…</span> <a href="viewtopic.php?id=162768&amp;p=210">210</a> <a href="viewtopic.php?id=162768&amp;p=211">211</a> <strong>212</strong> <a href="viewtopic.php?id=162768&amp;p=213">213</a> <a href="viewtopic.php?id=162768&amp;p=214">214</a> <span class="spacer">…</span> <a href="viewtopic.php?id=162768&amp;p=234">234</a> <a rel="next" href="viewtopic.php?id=162768&amp;p=213">Next</a></p> <p class="postlink conr">Topic closed</p> </div> <ul class="crumbs"> <li><a href="index.php">Index</a></li> <li><span>»&#160;</span><a href="viewforum.php?id=48">Topics Going Nowhere</a></li> <li><span>»&#160;</span><strong><a href="viewtopic.php?id=162768">KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</a></strong></li> </ul> <p class="subscribelink clearb"><a href="misc.php?action=subscribe&amp;tid=162768">Subscribe to this topic</a></p> <div class="clearer"></div> </div> </div> </div> <div id="brdfooter" class="block"> <h2><span>Board footer</span></h2> <div class="box"> <div id="brdfooternav" class="inbox"> <div class="conl"> <form id="qjump" method="get" action="viewforum.php"> <div><label><span>Jump to<br /></span> <select name="id" onchange="window.location=('viewforum.php?id='+this.options[this.selectedIndex].value)"> <optgroup label="Technical Issues and Assistance"> <option value="23">Newbie Corner</option> <option value="17">Installation</option> <option value="22">Kernel &amp; Hardware</option> <option value="18">Applications &amp; Desktop Environments</option> <option value="31">Laptop Issues</option> <option value="8">Networking, Server, and Protection</option> <option value="32">Multimedia and Games</option> <option value="50">System Administration</option> <option value="35">Other Architectures</option> </optgroup> <optgroup label="Arch-centric"> <option value="24">Announcements, Package &amp; Security Advisories</option> <option value="1">Arch Discussion</option> <option value="13">Forum &amp; Wiki discussion</option> </optgroup> <optgroup label="Pacman Upgrades, Packaging &amp; AUR"> <option value="44">Pacman &amp; Package Upgrade Issues</option> <option value="49">[testing] Repo Forum</option> <option value="4">Creating &amp; Modifying Packages</option> <option value="38">AUR Issues, Discussion &amp; PKGBUILD Requests</option> </optgroup> <optgroup label="Contributions &amp; Discussion"> <option value="20">GNU/Linux Discussion</option> <option value="27">Community Contributions</option> <option value="33">Programming &amp; Scripting</option> <option value="30">Other Languages</option> <option value="47">Artwork and Screenshots</option> <option value="42">Try This</option> </optgroup> <optgroup label="/dev/null"> <option value="29">Off-Topic</option> <option value="48" selected="selected">Topics Going Nowhere</option> <option value="36">Dustbin</option> </optgroup> </select></label> <input type="submit" value=" Go " accesskey="g" /> </div> </form> </div> <div class="conr"> <p id="feedlinks"><span class="atom"><a href="extern.php?action=feed&amp;tid=162768&amp;type=atom">Atom topic feed</a></span></p> <p id="poweredby">Powered by <a href="http://fluxbb.org/">FluxBB</a></p> </div> <div class="clearer"></div> </div> </div> </div> </div> <div class="end-box"></div> </div> </body> </html>
