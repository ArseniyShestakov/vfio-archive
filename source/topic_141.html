<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"> <html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en" dir="ltr"> <head> <meta http-equiv="Content-Type" content="text/html; charset=utf-8" /> <title>KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9 (Page 141) / Topics Going Nowhere / Arch Linux Forums</title> <link rel="stylesheet" type="text/css" href="style/ArchLinux.css" /> <link rel="canonical" href="viewtopic.php?id=162768&amp;p=141" title="Page 141" /> <link rel="prev" href="viewtopic.php?id=162768&amp;p=140" title="Page 140" /> <link rel="next" href="viewtopic.php?id=162768&amp;p=142" title="Page 142" /> <link rel="alternate" type="application/atom+xml" href="extern.php?action=feed&amp;tid=162768&amp;type=atom" title="Atom topic feed" /> <link rel="stylesheet" media="screen" href="style/ArchLinux/arch.css?v=3" /> <link rel="stylesheet" media="screen" href="style/ArchLinux/archnavbar.css?v=2" /> <link rel="shortcut icon" href="style/ArchLinux/favicon.ico" /> </head> <body> <div id="archnavbar" class="anb-forum"> <div id="archnavbarlogo"><h1><a href="http://www.archlinux.org/">Arch Linux</a></h1></div> <div id="archnavbarmenu"> <ul id="archnavbarlist"> <li id="anb-home"><a href="http://www.archlinux.org/">Home</a></li><li id="anb-packages"><a href="http://www.archlinux.org/packages/">Packages</a></li><li id="anb-forums" class="anb-selected"><a href="https://bbs.archlinux.org/">Forums</a></li><li id="anb-wiki"><a href="https://wiki.archlinux.org/">Wiki</a></li><li id="anb-bugs"><a href="https://bugs.archlinux.org/">Bugs</a></li><li id="anb-aur"><a href="https://aur.archlinux.org/">AUR</a></li><li id="anb-download"><a href="http://www.archlinux.org/download/">Download</a></li> </ul> </div> </div> <div id="punviewtopic" class="pun"> <div class="top-box"></div> <div class="punwrap"> <div id="brdheader" class="block"> <div class="box"> <div id="brdmenu" class="inbox"> <ul> <li id="navindex" class="isactive"><a href="index.php">Index</a></li> <li id="navuserlist"><a href="userlist.php">User list</a></li> <li id="navsearch"><a href="search.php">Search</a></li> <li id="navprofile"><a href="profile.php?id=80749">Profile</a></li> <li id="navlogout"><a href="login.php?action=out&amp;id=80749&amp;csrf_token=5c20501ec397bb45ef8ee8c84db232c8d8e421c6">Logout</a></li> </ul> </div> <div id="brdwelcome" class="inbox"> <ul class="conl"> <li><span>Logged in as <strong>SXX</strong></span></li> <li><span>Last visit: 2015-08-16 12:20:09</span></li> </ul> <ul class="conr"> <li><span>Topics: <a href="search.php?action=show_replies" title="Find topics you have posted to.">Posted</a> | <a href="search.php?action=show_new" title="Find topics with new posts since your last visit.">New</a> | <a href="search.php?action=show_recent" title="Find topics with recent posts.">Active</a> | <a href="search.php?action=show_unanswered" title="Find topics with no replies.">Unanswered</a></span></li> </ul> <div class="clearer"></div> </div> </div> </div> <div id="brdmain"> <div class="linkst"> <div class="inbox crumbsplus"> <ul class="crumbs"> <li><a href="index.php">Index</a></li> <li><span>»&#160;</span><a href="viewforum.php?id=48">Topics Going Nowhere</a></li> <li><span>»&#160;</span><strong><a href="viewtopic.php?id=162768">KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</a></strong></li> </ul> <div class="pagepost"> <p class="pagelink conl"><span class="pages-label">Pages: </span><a rel="prev" class="item1" href="viewtopic.php?id=162768&amp;p=140">Previous</a> <a href="viewtopic.php?id=162768">1</a> <span class="spacer">…</span> <a href="viewtopic.php?id=162768&amp;p=139">139</a> <a href="viewtopic.php?id=162768&amp;p=140">140</a> <strong>141</strong> <a href="viewtopic.php?id=162768&amp;p=142">142</a> <a href="viewtopic.php?id=162768&amp;p=143">143</a> <span class="spacer">…</span> <a href="viewtopic.php?id=162768&amp;p=234">234</a> <a rel="next" href="viewtopic.php?id=162768&amp;p=142">Next</a></p> <p class="postlink conr">Topic closed</p> </div> <div class="clearer"></div> </div> </div> <div id="p1481212" class="blockpost rowodd blockpost1"> <h2><span><span class="conr">#3501</span> <a href="viewtopic.php?pid=1481212#p1481212">2014-12-03 16:19:19</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=87064">kidchunks</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2014-12-03</span></dd> <dd><span>Posts: 6</span></dd> <dd class="usercontacts"><span class="email"><a href="misc.php?email=87064">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>slis wrote:</cite><blockquote><div><p>try without -device vfio-pci,host=85:00.1,bus=root.1,addr=00.1 \ ?<br />i don&#039;t have amd, but reading this thread i think you need to remove amd audio device</p><p>edit: and try 440fx chipset not q35</p></div></blockquote></div><br /><p>I removed the audio device:</p><div class="codebox"><pre><code>qemu-system-x86_64 -enable-kvm -M pc -m 1024 -cpu host \ -smp 8,sockets=1,cores=4,threads=4 \ -bios /usr/share/seabios/bios.bin -vga none \ -device ioh3420,bus=pci.0,addr=1c.0,multifunction=on,port=1,chassis=1,id=root.1 \ -device vfio-pci,host=85:00.0,bus=root.1,addr=00.0,multifunction=on,x-vga=on \ -drive file=/root/qemu/win7.img,cache=none,if=virtio \ -usb -usbdevice host:046d:c068 \ -vnc :1 \ -usbdevice tablet \ -daemonize \ -no-reboot</code></pre></div><p>Still the same error:</p><div class="codebox"><pre><code>vfio-pci 0000:85:00.0: irq 89 for MSI/MSI-X</code></pre></div><p>I tried with pc (440fx) and got the same error.</p><div class="codebox"><pre><code>qemu-system-x86_64 -enable-kvm -M pc -m 1024 -cpu host \ -smp 8,sockets=1,cores=4,threads=4 \ -bios /usr/share/seabios/bios.bin -vga none \ -device ioh3420,bus=pci.0,addr=1c.0,multifunction=on,port=1,chassis=1,id=root.1 \ -device vfio-pci,host=85:00.0,bus=root.1,addr=00.0,multifunction=on,x-vga=on \ -drive file=/root/qemu/win7.img,cache=none,if=virtio \ -usb -usbdevice host:046d:c068 \ -vnc :1 \ -usbdevice tablet \ -daemonize \ -no-reboot</code></pre></div><br /><p>Here is pc with pci-assign (no vfio):<br />qemu-system-x86_64 -enable-kvm -M pc -m 1024 -cpu host \<br />-smp 8,sockets=1,cores=4,threads=4 \<br />-bios /usr/share/seabios/bios.bin -vga none \<br />-device pci-assign,host=85:00.0 \<br />-drive file=/root/qemu/win7.img,cache=none,if=virtio \<br />-usb -usbdevice host:046d:c068 \<br />-vnc :1 \<br />-usbdevice tablet \<br />-daemonize \<br />-no-reboot</p><p>Same error but this pci-stub throwing it.</p><div class="codebox"><pre><code>pci-stub 0000:85:00.0: irq 89 for MSI/MSI-X</code></pre></div> <p class="postedit"><em>Last edited by kidchunks (2014-12-03 16:20:23)</em></p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1481212">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1481216" class="blockpost roweven"> <h2><span><span class="conr">#3502</span> <a href="viewtopic.php?pid=1481216#p1481216">2014-12-03 16:26:33</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=75590">aw</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2013-10-04</span></dd> <dd><span>Posts: 921</span></dd> <dd class="usercontacts"><span class="email"><a href="misc.php?email=75590">Email</a></span> <span class="website"><a href="http://vfio.blogspot.com/" rel="nofollow">Website</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>kidchunks wrote:</cite><blockquote><div><div class="quotebox"><cite>slis wrote:</cite><blockquote><div><p>try without -device vfio-pci,host=85:00.1,bus=root.1,addr=00.1 \ ?<br />i don&#039;t have amd, but reading this thread i think you need to remove amd audio device</p><p>edit: and try 440fx chipset not q35</p></div></blockquote></div><br /><p>I removed the audio device:</p><div class="codebox"><pre><code>qemu-system-x86_64 -enable-kvm -M pc -m 1024 -cpu host \ -smp 8,sockets=1,cores=4,threads=4 \ -bios /usr/share/seabios/bios.bin -vga none \ -device ioh3420,bus=pci.0,addr=1c.0,multifunction=on,port=1,chassis=1,id=root.1 \ -device vfio-pci,host=85:00.0,bus=root.1,addr=00.0,multifunction=on,x-vga=on \ -drive file=/root/qemu/win7.img,cache=none,if=virtio \ -usb -usbdevice host:046d:c068 \ -vnc :1 \ -usbdevice tablet \ -daemonize \ -no-reboot</code></pre></div><p>Still the same error:</p><div class="codebox"><pre><code>vfio-pci 0000:85:00.0: irq 89 for MSI/MSI-X</code></pre></div></div></blockquote></div><p>This is not an error.&#160; Not everything the kernel prints is an error.&#160; This is simply indicating that the driver <em>vfio-pci</em> allocated irq 89 for the device for MSI/X.&#160; That&#039;s it.</p><div class="quotebox"><blockquote><div><p>I tried with pc (440fx) and got the same error.</p><div class="codebox"><pre><code>qemu-system-x86_64 -enable-kvm -M pc -m 1024 -cpu host \ -smp 8,sockets=1,cores=4,threads=4 \ -bios /usr/share/seabios/bios.bin -vga none \ -device ioh3420,bus=pci.0,addr=1c.0,multifunction=on,port=1,chassis=1,id=root.1 \ -device vfio-pci,host=85:00.0,bus=root.1,addr=00.0,multifunction=on,x-vga=on \ -drive file=/root/qemu/win7.img,cache=none,if=virtio \ -usb -usbdevice host:046d:c068 \ -vnc :1 \ -usbdevice tablet \ -daemonize \ -no-reboot</code></pre></div></div></blockquote></div><p>ioh3402 should not be mixed with 440FX, remove that line, remove the bus= on the vfio-pci line, and set addr to something like 9.0 since 0.0 won&#039;t be available on the host bridge.</p><div class="quotebox"><blockquote><div><p>Here is pc with pci-assign (no vfio):<br />qemu-system-x86_64 -enable-kvm -M pc -m 1024 -cpu host \<br />-smp 8,sockets=1,cores=4,threads=4 \<br />-bios /usr/share/seabios/bios.bin -vga none \<br />-device pci-assign,host=85:00.0 \<br />-drive file=/root/qemu/win7.img,cache=none,if=virtio \<br />-usb -usbdevice host:046d:c068 \<br />-vnc :1 \<br />-usbdevice tablet \<br />-daemonize \<br />-no-reboot</p><p>Same error but this pci-stub throwing it.</p><div class="codebox"><pre><code>pci-stub 0000:85:00.0: irq 89 for MSI/MSI-X</code></pre></div></div></blockquote></div><p>Again, not an error.</p> </div> <div class="postsignature postmsg"><hr /><p><a href="http://vfio.blogspot.com" rel="nofollow">http://vfio.blogspot.com</a><br />Looking for a more open forum to discuss vfio related uses?&#160; Try <a href="https://www.redhat.com/mailman/listinfo/vfio-users" rel="nofollow">https://www.redhat.com/mailman/listinfo/vfio-users</a></p></div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1481216">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1481279" class="blockpost rowodd"> <h2><span><span class="conr">#3503</span> <a href="viewtopic.php?pid=1481279#p1481279">2014-12-03 20:41:49</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=85314">Duelist</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2014-09-22</span></dd> <dd><span>Posts: 358</span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>aw wrote:</cite><blockquote><div><div class="quotebox"><cite>Duelist wrote:</cite><blockquote><div><p>You do know that xeon lacks integrated video core. <br />He may be needing it to get host output. However, sometimes buying a cheap-as-cardboard GT610 can be more profitable than buying i7 for integrated video.</p><p>Whoa, just noted that this post is #3499.</p></div></blockquote></div><p>Check ark, E3-1245v2 has HD P4000 video.</p></div></blockquote></div><p>Whoa! That was a surprise. There&#039;s only four versions in whole E3 v2 line-up, 1225, 1245 and 1275. And one with 2000 graphics.<br />Well, E3-1240v2 is a more popular choice, and it lacks graphics. Attention must be paid when choosing the CPU, as it more likely will not have it.</p> </div> <div class="postsignature postmsg"><hr /><p><span class="bbs">The forum rules prohibit requesting support for distributions other than arch.</span><br /><a href="https://bbs.archlinux.org/viewtopic.php?pid=1551460#p1551460" rel="nofollow">I gave up.</a><a href="https://bbs.archlinux.org/viewtopic.php?id=162768" rel="nofollow"> It was too late.</a><br /><a href="http://pastebin.com/B3fL84bq" rel="nofollow">What I was trying to do</a>.<br /><a href="http://vfio.blogspot.com/" rel="nofollow">The reference about VFIO and KVM VGA passthrough.</a></p></div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1481279">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1481325" class="blockpost roweven"> <h2><span><span class="conr">#3504</span> <a href="viewtopic.php?pid=1481325#p1481325">2014-12-04 00:45:27</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=87065">tatsu</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2014-12-03</span></dd> <dd><span>Posts: 3</span></dd> <dd class="usercontacts"><span class="email"><a href="misc.php?email=87065">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <p>Hi all!</p><p>I&#039;d like to know how to apply the kernel patches. the two links simply lead to a forum archive with text posts containing what seems to be some kernel files.</p><p>I have no idea how to use this. some help please?</p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1481325">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1481384" class="blockpost rowodd"> <h2><span><span class="conr">#3505</span> <a href="viewtopic.php?pid=1481384#p1481384">2014-12-04 07:33:18</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=79899">winie</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2014-03-01</span></dd> <dd><span>Posts: 17</span></dd> <dd class="usercontacts"><span class="email"><a href="mailto:alireza4051@yahoo.com">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>tatsu wrote:</cite><blockquote><div><p>Hi all!</p><p>I&#039;d like to know how to apply the kernel patches. the two links simply lead to a forum archive with text posts containing what seems to be some kernel files.</p><p>I have no idea how to use this. some help please?</p></div></blockquote></div><p>You don&#039;t need those; just the first file which is a .tar.gz file<br />Download and extract it a folder and go to that folder and run these lines:<br />sudo pacman -S base-devel<br />makepkg -s</p><p>After the kernel compile is finnished few .pkg.tar.xz files will be created. save them if you want for next time.<br />Install them by running:<br />sudo pacman -U *.pkg.tar.xz</p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1481384">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1481393" class="blockpost roweven"> <h2><span><span class="conr">#3506</span> <a href="viewtopic.php?pid=1481393#p1481393">2014-12-04 08:07:06</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=79899">winie</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2014-03-01</span></dd> <dd><span>Posts: 17</span></dd> <dd class="usercontacts"><span class="email"><a href="mailto:alireza4051@yahoo.com">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <p>The kvm version of intel vgt is out:<br /><a href="http://www.phoronix.com/vr.php?view=MTg1MzQ" rel="nofollow">http://www.phoronix.com/vr.php?view=MTg1MzQ</a></p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1481393">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1481414" class="blockpost rowodd"> <h2><span><span class="conr">#3507</span> <a href="viewtopic.php?pid=1481414#p1481414">2014-12-04 09:50:01</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=82442">slis</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2014-06-02</span></dd> <dd><span>Posts: 125</span></dd> <dd class="usercontacts"><span class="email"><a href="mailto:xslisx@gmail.com">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>winie wrote:</cite><blockquote><div><p>The kvm version of intel vgt is out:<br /><a href="http://www.phoronix.com/vr.php?view=MTg1MzQ" rel="nofollow">http://www.phoronix.com/vr.php?view=MTg1MzQ</a></p></div></blockquote></div><p>Good news. </p><p>Now only we need aw or someone smart enough to make it use each output for each vm&#160; (probably not possible <img src="https://bbs.archlinux.org/img/smilies/smile.png" width="15" height="15" alt="smile" />)</p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1481414">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1481447" class="blockpost roweven"> <h2><span><span class="conr">#3508</span> <a href="viewtopic.php?pid=1481447#p1481447">2014-12-04 11:37:40</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=79899">winie</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2014-03-01</span></dd> <dd><span>Posts: 17</span></dd> <dd class="usercontacts"><span class="email"><a href="mailto:alireza4051@yahoo.com">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>slis wrote:</cite><blockquote><div><div class="quotebox"><cite>winie wrote:</cite><blockquote><div><p>The kvm version of intel vgt is out:<br /><a href="http://www.phoronix.com/vr.php?view=MTg1MzQ" rel="nofollow">http://www.phoronix.com/vr.php?view=MTg1MzQ</a></p></div></blockquote></div><p>Good news. </p><p>Now only we need aw or someone smart enough to make it use each output for each vm&#160; (probably not possible <img src="https://bbs.archlinux.org/img/smilies/smile.png" width="15" height="15" alt="smile" />)</p></div></blockquote></div><p>Actually that&#039;s what they&#039;re doing. Each vm gets a virtual monitor which can be connected to a physical output or not.</p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1481447">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1481448" class="blockpost rowodd"> <h2><span><span class="conr">#3509</span> <a href="viewtopic.php?pid=1481448#p1481448">2014-12-04 11:38:55</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=82442">slis</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2014-06-02</span></dd> <dd><span>Posts: 125</span></dd> <dd class="usercontacts"><span class="email"><a href="mailto:xslisx@gmail.com">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <p>Hmm... i tried xen, and i couldn&#039;t get 2 vms at same time to output to different outputs at same time. Am i missing something?</p><p>Imagine if we could output 3 windows vm&#039;s to 3 different outputs at same time, so we could have 3 separate vm&#039;s with 3d acceleration on single host with igpu...</p> <p class="postedit"><em>Last edited by slis (2014-12-04 11:47:06)</em></p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1481448">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1481452" class="blockpost roweven"> <h2><span><span class="conr">#3510</span> <a href="viewtopic.php?pid=1481452#p1481452">2014-12-04 12:14:20</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=87065">tatsu</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2014-12-03</span></dd> <dd><span>Posts: 3</span></dd> <dd class="usercontacts"><span class="email"><a href="misc.php?email=87065">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>winie wrote:</cite><blockquote><div><p>The kvm version of intel vgt is out:<br /><a href="http://www.phoronix.com/vr.php?view=MTg1MzQ" rel="nofollow">http://www.phoronix.com/vr.php?view=MTg1MzQ</a></p></div></blockquote></div><p>OMG wow thanks for sharing the love, man!</p><div class="quotebox"><cite>winie wrote:</cite><blockquote><div><p>You don&#039;t need those; just the first file which is a .tar.gz file<br />Download and extract it a folder and go to that folder and run these lines:<br />sudo pacman -S base-devel<br />makepkg -s<br />After the kernel compile is finnished few .pkg.tar.xz files will be created. save them if you want for next time.<br />Install them by running:<br />sudo pacman -U *.pkg.tar.xz</p></div></blockquote></div><p>I installed a newer kernel? Do I really have to use his?</p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1481452">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1481484" class="blockpost rowodd"> <h2><span><span class="conr">#3511</span> <a href="viewtopic.php?pid=1481484#p1481484">2014-12-04 14:04:30</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=79899">winie</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2014-03-01</span></dd> <dd><span>Posts: 17</span></dd> <dd class="usercontacts"><span class="email"><a href="mailto:alireza4051@yahoo.com">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>tatsu wrote:</cite><blockquote><div><p>I installed a newer kernel? Do I really have to use his?</p></div></blockquote></div><p>If using ovmf then probably not. <br />The patches on the first post are for vga arbitration, acs override and radeon related fixes. <br />Booting vm with ovmf&#160; in efi mode solves the first one.&#160; <br />acs isn&#039;t an issue if you have only one pcie graphic card or you passthrough all to the same vm</p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1481484">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1481491" class="blockpost roweven"> <h2><span><span class="conr">#3512</span> <a href="viewtopic.php?pid=1481491#p1481491">2014-12-04 14:36:27</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=48315">TripleSpeeder</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2011-05-02</span></dd> <dd><span>Posts: 43</span></dd> <dd class="usercontacts"><span class="email"><a href="misc.php?email=48315">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>winie wrote:</cite><blockquote><div><div class="quotebox"><cite>slis wrote:</cite><blockquote><div><div class="quotebox"><cite>winie wrote:</cite><blockquote><div><p>The kvm version of intel vgt is out:<br /><a href="http://www.phoronix.com/vr.php?view=MTg1MzQ" rel="nofollow">http://www.phoronix.com/vr.php?view=MTg1MzQ</a></p></div></blockquote></div><p>Good news. </p><p>Now only we need aw or someone smart enough to make it use each output for each vm&#160; (probably not possible <img src="https://bbs.archlinux.org/img/smilies/smile.png" width="15" height="15" alt="smile" />)</p></div></blockquote></div><p>Actually that&#039;s what they&#039;re doing. Each vm gets a virtual monitor which can be connected to a physical output or not.</p></div></blockquote></div><p>Whoa, this is cool. I was just wondering exactly how this sharing of a GPU between different VMs would work, as there is only 1 physical screen attached. Being able to use the different outputs for different VMs seems so impossible <img src="https://bbs.archlinux.org/img/smilies/smile.png" width="15" height="15" alt="smile" /> Do you have any sources/pointers to more info on this topic?</p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1481491">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1481534" class="blockpost rowodd"> <h2><span><span class="conr">#3513</span> <a href="viewtopic.php?pid=1481534#p1481534">2014-12-04 17:55:41</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=85314">Duelist</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2014-09-22</span></dd> <dd><span>Posts: 358</span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>TripleSpeeder wrote:</cite><blockquote><div><p>Do you have any sources/pointers to more info on this topic?</p></div></blockquote></div><p><a href="http://lists.freedesktop.org/archives/intel-gfx/2014-December/056652.html" rel="nofollow">http://lists.freedesktop.org/archives/i … 56652.html</a><br />Check out the ending - there is links to the presentations and there&#039;s links for sources.<br />Sadly, i am unable to check out these sources myself, so i can&#039;t help you anymore further.</p><br /><p><span style="color: white">whole github is banned in my country for awesome reasons, and i haven&#039;t got a VPN up yet</span></p> </div> <div class="postsignature postmsg"><hr /><p><span class="bbs">The forum rules prohibit requesting support for distributions other than arch.</span><br /><a href="https://bbs.archlinux.org/viewtopic.php?pid=1551460#p1551460" rel="nofollow">I gave up.</a><a href="https://bbs.archlinux.org/viewtopic.php?id=162768" rel="nofollow"> It was too late.</a><br /><a href="http://pastebin.com/B3fL84bq" rel="nofollow">What I was trying to do</a>.<br /><a href="http://vfio.blogspot.com/" rel="nofollow">The reference about VFIO and KVM VGA passthrough.</a></p></div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1481534">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1481563" class="blockpost roweven"> <h2><span><span class="conr">#3514</span> <a href="viewtopic.php?pid=1481563#p1481563">2014-12-04 19:30:01</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=84905">zsph</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2014-09-04</span></dd> <dd><span>Posts: 9</span></dd> <dd class="usercontacts"><span class="email"><a href="misc.php?email=84905">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <p>Has anyone succeeded to use qemu + vfio without sudo/root? I tried to chown /dev/vfio/1 and /dev/vfio/vfio and increased ulimit to 9000000 (8GB dedicated to qemu + ~1GB for safety) but I&#039;m gettings such errors:</p><div class="codebox"><pre><code>qemu-system-x86_64: -device vfio-pci,host=01:00.0,bus=root.1,addr=00.0,multifunction=on,x-vga=on: vfio_dma_map(0x7f3b7ad1ce60, 0x0, 0x80000000, 0x7f3944000000) = -12 (Cannot allocate memory) qemu-system-x86_64: -device vfio-pci,host=01:00.0,bus=root.1,addr=00.0,multifunction=on,x-vga=on: vfio_dma_map(0x7f3b7ad1ce60, 0x100000000, 0x180000000, 0x7f39c4000000) = -12 (Cannot allocate memory) qemu-system-x86_64: -device vfio-pci,host=01:00.0,bus=root.1,addr=00.0,multifunction=on,x-vga=on: vfio: memory listener initialization failed for container</code></pre></div><p>I don&#039;t use libvirt btw, just qemu.</p> </div> <div class="postsignature postmsg"><hr /><p>Asus P8Z77-V LK, Core i7 3770, Asus NVIDIA GTX 770 DirectCU II OC, Debian x64, EFI, Kernel 3.16 + i915 arbiter patch. <br />3DMark11: bare metal <a href="http://www.3dmark.com/3dm11/8748717" rel="nofollow">P10231</a> vs vfio <a href="http://www.3dmark.com/3dm11/8754453" rel="nofollow">P10039</a>: 98% of performance!</p></div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1481563">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1481564" class="blockpost rowodd"> <h2><span><span class="conr">#3515</span> <a href="viewtopic.php?pid=1481564#p1481564">2014-12-04 19:36:27</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=75590">aw</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2013-10-04</span></dd> <dd><span>Posts: 921</span></dd> <dd class="usercontacts"><span class="email"><a href="misc.php?email=75590">Email</a></span> <span class="website"><a href="http://vfio.blogspot.com/" rel="nofollow">Website</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>zsph wrote:</cite><blockquote><div><p>Has anyone succeeded to use qemu + vfio without sudo/root? I tried to chown /dev/vfio/1 and /dev/vfio/vfio and increased ulimit to 9000000 (8GB dedicated to qemu + ~1GB for safety) but I&#039;m gettings such errors:</p><div class="codebox"><pre><code>qemu-system-x86_64: -device vfio-pci,host=01:00.0,bus=root.1,addr=00.0,multifunction=on,x-vga=on: vfio_dma_map(0x7f3b7ad1ce60, 0x0, 0x80000000, 0x7f3944000000) = -12 (Cannot allocate memory) qemu-system-x86_64: -device vfio-pci,host=01:00.0,bus=root.1,addr=00.0,multifunction=on,x-vga=on: vfio_dma_map(0x7f3b7ad1ce60, 0x100000000, 0x180000000, 0x7f39c4000000) = -12 (Cannot allocate memory) qemu-system-x86_64: -device vfio-pci,host=01:00.0,bus=root.1,addr=00.0,multifunction=on,x-vga=on: vfio: memory listener initialization failed for container</code></pre></div><p>I don&#039;t use libvirt btw, just qemu.</p></div></blockquote></div><p>How are you setting ulimit -l?&#160; It&#039;s rather tricky</p> </div> <div class="postsignature postmsg"><hr /><p><a href="http://vfio.blogspot.com" rel="nofollow">http://vfio.blogspot.com</a><br />Looking for a more open forum to discuss vfio related uses?&#160; Try <a href="https://www.redhat.com/mailman/listinfo/vfio-users" rel="nofollow">https://www.redhat.com/mailman/listinfo/vfio-users</a></p></div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1481564">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1481573" class="blockpost roweven"> <h2><span><span class="conr">#3516</span> <a href="viewtopic.php?pid=1481573#p1481573">2014-12-04 20:03:21</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=84905">zsph</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2014-09-04</span></dd> <dd><span>Posts: 9</span></dd> <dd class="usercontacts"><span class="email"><a href="misc.php?email=84905">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>aw wrote:</cite><blockquote><div><p>How are you setting ulimit -l?&#160; It&#039;s rather tricky</p></div></blockquote></div><p>First I calculated it as (8 1.sh topic_100.html topic_101.html topic_102.html topic_103.html topic_104.html topic_105.html topic_106.html topic_107.html topic_108.html topic_109.html topic_10.html topic_110.html topic_111.html topic_112.html topic_113.html topic_114.html topic_115.html topic_116.html topic_117.html topic_118.html topic_119.html topic_11.html topic_120.html topic_121.html topic_122.html topic_123.html topic_124.html topic_125.html topic_126.html topic_127.html topic_128.html topic_129.html topic_12.html topic_130.html topic_131.html topic_132.html topic_133.html topic_134.html topic_135.html topic_136.html topic_137.html topic_138.html topic_139.html topic_13.html topic_140.html topic_14.html topic_15.html topic_16.html topic_17.html topic_18.html topic_19.html topic_1.html topic_20.html topic_21.html topic_22.html topic_23.html topic_24.html topic_25.html topic_26.html topic_27.html topic_28.html topic_29.html topic_2.html topic_30.html topic_31.html topic_32.html topic_33.html topic_34.html topic_35.html topic_36.html topic_37.html topic_38.html topic_39.html topic_3.html topic_40.html topic_41.html topic_42.html topic_43.html topic_44.html topic_45.html topic_46.html topic_47.html topic_48.html topic_49.html topic_4.html topic_50.html topic_51.html topic_52.html topic_53.html topic_54.html topic_55.html topic_56.html topic_57.html topic_58.html topic_59.html topic_5.html topic_60.html topic_61.html topic_62.html topic_63.html topic_64.html topic_65.html topic_66.html topic_67.html topic_68.html topic_69.html topic_6.html topic_70.html topic_71.html topic_72.html topic_73.html topic_74.html topic_75.html topic_76.html topic_77.html topic_78.html topic_79.html topic_7.html topic_80.html topic_81.html topic_82.html topic_83.html topic_84.html topic_85.html topic_86.html topic_87.html topic_88.html topic_89.html topic_8.html topic_90.html topic_91.html topic_92.html topic_93.html topic_94.html topic_95.html topic_96.html topic_97.html topic_98.html topic_99.html topic_9.html 1024 + 20) 1.sh topic_100.html topic_101.html topic_102.html topic_103.html topic_104.html topic_105.html topic_106.html topic_107.html topic_108.html topic_109.html topic_10.html topic_110.html topic_111.html topic_112.html topic_113.html topic_114.html topic_115.html topic_116.html topic_117.html topic_118.html topic_119.html topic_11.html topic_120.html topic_121.html topic_122.html topic_123.html topic_124.html topic_125.html topic_126.html topic_127.html topic_128.html topic_129.html topic_12.html topic_130.html topic_131.html topic_132.html topic_133.html topic_134.html topic_135.html topic_136.html topic_137.html topic_138.html topic_139.html topic_13.html topic_140.html topic_14.html topic_15.html topic_16.html topic_17.html topic_18.html topic_19.html topic_1.html topic_20.html topic_21.html topic_22.html topic_23.html topic_24.html topic_25.html topic_26.html topic_27.html topic_28.html topic_29.html topic_2.html topic_30.html topic_31.html topic_32.html topic_33.html topic_34.html topic_35.html topic_36.html topic_37.html topic_38.html topic_39.html topic_3.html topic_40.html topic_41.html topic_42.html topic_43.html topic_44.html topic_45.html topic_46.html topic_47.html topic_48.html topic_49.html topic_4.html topic_50.html topic_51.html topic_52.html topic_53.html topic_54.html topic_55.html topic_56.html topic_57.html topic_58.html topic_59.html topic_5.html topic_60.html topic_61.html topic_62.html topic_63.html topic_64.html topic_65.html topic_66.html topic_67.html topic_68.html topic_69.html topic_6.html topic_70.html topic_71.html topic_72.html topic_73.html topic_74.html topic_75.html topic_76.html topic_77.html topic_78.html topic_79.html topic_7.html topic_80.html topic_81.html topic_82.html topic_83.html topic_84.html topic_85.html topic_86.html topic_87.html topic_88.html topic_89.html topic_8.html topic_90.html topic_91.html topic_92.html topic_93.html topic_94.html topic_95.html topic_96.html topic_97.html topic_98.html topic_99.html topic_9.html 1024 = 8409088, but I was getting same errors. So I though that extra 20mb was not enough and went with 9000000.</p><p>I do it as</p><div class="codebox"><pre><code>sudo -s ulimit -l 9000000</code></pre></div> </div> <div class="postsignature postmsg"><hr /><p>Asus P8Z77-V LK, Core i7 3770, Asus NVIDIA GTX 770 DirectCU II OC, Debian x64, EFI, Kernel 3.16 + i915 arbiter patch. <br />3DMark11: bare metal <a href="http://www.3dmark.com/3dm11/8748717" rel="nofollow">P10231</a> vs vfio <a href="http://www.3dmark.com/3dm11/8754453" rel="nofollow">P10039</a>: 98% of performance!</p></div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1481573">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1481576" class="blockpost rowodd"> <h2><span><span class="conr">#3517</span> <a href="viewtopic.php?pid=1481576#p1481576">2014-12-04 20:14:08</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=75590">aw</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2013-10-04</span></dd> <dd><span>Posts: 921</span></dd> <dd class="usercontacts"><span class="email"><a href="misc.php?email=75590">Email</a></span> <span class="website"><a href="http://vfio.blogspot.com/" rel="nofollow">Website</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>zsph wrote:</cite><blockquote><div><div class="quotebox"><cite>aw wrote:</cite><blockquote><div><p>How are you setting ulimit -l?&#160; It&#039;s rather tricky</p></div></blockquote></div><p>First I calculated it as (8 1.sh topic_100.html topic_101.html topic_102.html topic_103.html topic_104.html topic_105.html topic_106.html topic_107.html topic_108.html topic_109.html topic_10.html topic_110.html topic_111.html topic_112.html topic_113.html topic_114.html topic_115.html topic_116.html topic_117.html topic_118.html topic_119.html topic_11.html topic_120.html topic_121.html topic_122.html topic_123.html topic_124.html topic_125.html topic_126.html topic_127.html topic_128.html topic_129.html topic_12.html topic_130.html topic_131.html topic_132.html topic_133.html topic_134.html topic_135.html topic_136.html topic_137.html topic_138.html topic_139.html topic_13.html topic_140.html topic_14.html topic_15.html topic_16.html topic_17.html topic_18.html topic_19.html topic_1.html topic_20.html topic_21.html topic_22.html topic_23.html topic_24.html topic_25.html topic_26.html topic_27.html topic_28.html topic_29.html topic_2.html topic_30.html topic_31.html topic_32.html topic_33.html topic_34.html topic_35.html topic_36.html topic_37.html topic_38.html topic_39.html topic_3.html topic_40.html topic_41.html topic_42.html topic_43.html topic_44.html topic_45.html topic_46.html topic_47.html topic_48.html topic_49.html topic_4.html topic_50.html topic_51.html topic_52.html topic_53.html topic_54.html topic_55.html topic_56.html topic_57.html topic_58.html topic_59.html topic_5.html topic_60.html topic_61.html topic_62.html topic_63.html topic_64.html topic_65.html topic_66.html topic_67.html topic_68.html topic_69.html topic_6.html topic_70.html topic_71.html topic_72.html topic_73.html topic_74.html topic_75.html topic_76.html topic_77.html topic_78.html topic_79.html topic_7.html topic_80.html topic_81.html topic_82.html topic_83.html topic_84.html topic_85.html topic_86.html topic_87.html topic_88.html topic_89.html topic_8.html topic_90.html topic_91.html topic_92.html topic_93.html topic_94.html topic_95.html topic_96.html topic_97.html topic_98.html topic_99.html topic_9.html 1024 + 20) 1.sh topic_100.html topic_101.html topic_102.html topic_103.html topic_104.html topic_105.html topic_106.html topic_107.html topic_108.html topic_109.html topic_10.html topic_110.html topic_111.html topic_112.html topic_113.html topic_114.html topic_115.html topic_116.html topic_117.html topic_118.html topic_119.html topic_11.html topic_120.html topic_121.html topic_122.html topic_123.html topic_124.html topic_125.html topic_126.html topic_127.html topic_128.html topic_129.html topic_12.html topic_130.html topic_131.html topic_132.html topic_133.html topic_134.html topic_135.html topic_136.html topic_137.html topic_138.html topic_139.html topic_13.html topic_140.html topic_14.html topic_15.html topic_16.html topic_17.html topic_18.html topic_19.html topic_1.html topic_20.html topic_21.html topic_22.html topic_23.html topic_24.html topic_25.html topic_26.html topic_27.html topic_28.html topic_29.html topic_2.html topic_30.html topic_31.html topic_32.html topic_33.html topic_34.html topic_35.html topic_36.html topic_37.html topic_38.html topic_39.html topic_3.html topic_40.html topic_41.html topic_42.html topic_43.html topic_44.html topic_45.html topic_46.html topic_47.html topic_48.html topic_49.html topic_4.html topic_50.html topic_51.html topic_52.html topic_53.html topic_54.html topic_55.html topic_56.html topic_57.html topic_58.html topic_59.html topic_5.html topic_60.html topic_61.html topic_62.html topic_63.html topic_64.html topic_65.html topic_66.html topic_67.html topic_68.html topic_69.html topic_6.html topic_70.html topic_71.html topic_72.html topic_73.html topic_74.html topic_75.html topic_76.html topic_77.html topic_78.html topic_79.html topic_7.html topic_80.html topic_81.html topic_82.html topic_83.html topic_84.html topic_85.html topic_86.html topic_87.html topic_88.html topic_89.html topic_8.html topic_90.html topic_91.html topic_92.html topic_93.html topic_94.html topic_95.html topic_96.html topic_97.html topic_98.html topic_99.html topic_9.html 1024 = 8409088, but I was getting same errors. So I though that extra 20mb was not enough and went with 9000000.</p><p>I do it as</p><div class="codebox"><pre><code>sudo -s ulimit -l 9000000</code></pre></div></div></blockquote></div><p>And then what?&#160; At this point you either run qemu directly, which means your running it as root and the ulimit was unnecessary, you ^d back to yourself and you&#039;ve lost the ulimit, or you su back to yourself.&#160; The last option is the only one that keeps the ulimit.&#160; If you want to make a user that has elevated limits then look at /etc/security/limits.conf, or however your distro does it.</p> </div> <div class="postsignature postmsg"><hr /><p><a href="http://vfio.blogspot.com" rel="nofollow">http://vfio.blogspot.com</a><br />Looking for a more open forum to discuss vfio related uses?&#160; Try <a href="https://www.redhat.com/mailman/listinfo/vfio-users" rel="nofollow">https://www.redhat.com/mailman/listinfo/vfio-users</a></p></div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1481576">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1481594" class="blockpost roweven"> <h2><span><span class="conr">#3518</span> <a href="viewtopic.php?pid=1481594#p1481594">2014-12-04 21:49:06</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=76479">Norcoen</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>From: Norway</span></dd> <dd><span>Registered: 2013-11-02</span></dd> <dd><span>Posts: 23</span></dd> <dd class="usercontacts"><span class="email"><a href="mailto:frankmoll@gmx.net">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <p>Did someone try getting Intels GVT-g / KVMGT to work with KVM yet?<br />Heard it&#039;s ready now after already working in Xen for a while now.</p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1481594">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1481745" class="blockpost rowodd"> <h2><span><span class="conr">#3519</span> <a href="viewtopic.php?pid=1481745#p1481745">2014-12-05 12:14:01</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=84905">zsph</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2014-09-04</span></dd> <dd><span>Posts: 9</span></dd> <dd class="usercontacts"><span class="email"><a href="misc.php?email=84905">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>aw wrote:</cite><blockquote><div><p>And then what?</p></div></blockquote></div><p>That was my mistake perhaps, I was doing ^d. But then I also tried su - &lt;myusername&gt; and still received memory allocation error.</p><div class="quotebox"><cite>aw wrote:</cite><blockquote><div><p>If you want to make a user that has elevated limits then look at /etc/security/limits.conf, or however your distro does it.</p></div></blockquote></div><p>I will look, thanks.</p> </div> <div class="postsignature postmsg"><hr /><p>Asus P8Z77-V LK, Core i7 3770, Asus NVIDIA GTX 770 DirectCU II OC, Debian x64, EFI, Kernel 3.16 + i915 arbiter patch. <br />3DMark11: bare metal <a href="http://www.3dmark.com/3dm11/8748717" rel="nofollow">P10231</a> vs vfio <a href="http://www.3dmark.com/3dm11/8754453" rel="nofollow">P10039</a>: 98% of performance!</p></div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1481745">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1481772" class="blockpost roweven"> <h2><span><span class="conr">#3520</span> <a href="viewtopic.php?pid=1481772#p1481772">2014-12-05 14:16:02</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=75590">aw</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2013-10-04</span></dd> <dd><span>Posts: 921</span></dd> <dd class="usercontacts"><span class="email"><a href="misc.php?email=75590">Email</a></span> <span class="website"><a href="http://vfio.blogspot.com/" rel="nofollow">Website</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>zsph wrote:</cite><blockquote><div><div class="quotebox"><cite>aw wrote:</cite><blockquote><div><p>And then what?</p></div></blockquote></div><p>That was my mistake perhaps, I was doing ^d. But then I also tried su - &lt;myusername&gt; and still received memory allocation error.</p></div></blockquote></div><p>That should have worked if you set the limit high enough:</p><div class="codebox"><pre><code>$ sudo -s # ulimit -l 1000 # ulimit -l 1000 # su - alwillia $ ulimit -l 1000</code></pre></div> </div> <div class="postsignature postmsg"><hr /><p><a href="http://vfio.blogspot.com" rel="nofollow">http://vfio.blogspot.com</a><br />Looking for a more open forum to discuss vfio related uses?&#160; Try <a href="https://www.redhat.com/mailman/listinfo/vfio-users" rel="nofollow">https://www.redhat.com/mailman/listinfo/vfio-users</a></p></div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1481772">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1481933" class="blockpost rowodd"> <h2><span><span class="conr">#3521</span> <a href="viewtopic.php?pid=1481933#p1481933">2014-12-06 03:44:29</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=87064">kidchunks</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2014-12-03</span></dd> <dd><span>Posts: 6</span></dd> <dd class="usercontacts"><span class="email"><a href="misc.php?email=87064">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>aw wrote:</cite><blockquote><div><p>This is not an error.&#160; Not everything the kernel prints is an error.&#160; This is simply indicating that the driver <em>vfio-pci</em> allocated irq 89 for the device for MSI/X.&#160; That&#039;s it.</p></div></blockquote></div><p>Thanks for the clarification regarding irq! </p><div class="quotebox"><cite>aw wrote:</cite><blockquote><div><p>ioh3402 should not be mixed with 440FX, remove that line, remove the bus= on the vfio-pci line, and set addr to something like 9.0 since 0.0 won&#039;t be available on the host bridge.</p></div></blockquote></div><p>Removed ioh3402 and changed addr card:</p><div class="codebox"><pre><code>qemu-system-x86_64 -enable-kvm -M pc -m 4096 -cpu host \ -smp 8,sockets=1,cores=4,threads=4 \ -bios /usr/share/seabios/bios.bin -vga none \ -device vfio-pci,host=85:00.0,addr=08.0,multifunction=on,x-vga=on \ -device vfio-pci,host=85:00.0,addr=08.1 \ -drive file=/root/qemu/win7.img,cache=none,if=virtio \ -drive file=/root/qemu/win7.iso,index=0,media=cdrom \ -drive file=/root/qemu/virtio-win-0.1-81.iso,index=1,media=cdrom \ -usb -usbdevice host:046d:c068 \ -vnc :1 \ -usbdevice tablet \ -daemonize</code></pre></div><p>I was able to install the drivers but upon reboot, got stuck in a boot loop.</p><p>Figured it could be driver related so I tried the latest catalyst beta drivers (14.11.2) and it worked! Audio and video are passing through with no problems. <img src="https://bbs.archlinux.org/img/smilies/smile.png" width="15" height="15" alt="smile" /></p><p>The above also fixed an issue I had with video card freezing (stuck image) on reboot/shutdown so no need for no-reboot.</p><p>The only problem I have now is that I can&#039;t see the bios(seabios) screen but that&#039;s minor given it still boots into whatever drive is first. Strangely enough, OVMF(UEFI) works fine. Maybe something with the card.</p><p>In any case, glad to get it working after a week! </p><p>Thanks AW and others for the help.</p><p>To those running an r9 290x...use the 14.11.2 drivers!</p> <p class="postedit"><em>Last edited by kidchunks (2014-12-06 03:49:43)</em></p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1481933">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1482081" class="blockpost roweven"> <h2><span><span class="conr">#3522</span> <a href="viewtopic.php?pid=1482081#p1482081">2014-12-06 19:05:17</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=64462">mastersplinter777</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2012-10-09</span></dd> <dd><span>Posts: 8</span></dd> <dd class="usercontacts"><span class="email"><a href="misc.php?email=64462">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <p>Finally succeeded to passthrough my Zotac GT630 to OSX 10.9.5 with working 3D<br /><a href="https://imagizer.imageshack.us/v2/1152x648q90/538/u1Qwht.png" rel="nofollow">https://imagizer.imageshack.us/v2/1152x … u1Qwht.png</a></p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1482081">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1482191" class="blockpost rowodd"> <h2><span><span class="conr">#3523</span> <a href="viewtopic.php?pid=1482191#p1482191">2014-12-07 07:05:05</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=79899">winie</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2014-03-01</span></dd> <dd><span>Posts: 17</span></dd> <dd class="usercontacts"><span class="email"><a href="mailto:alireza4051@yahoo.com">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>mastersplinter777 wrote:</cite><blockquote><div><p>Finally succeeded to passthrough my Zotac GT630 to OSX 10.9.5 with working 3D<br /><a href="https://imagizer.imageshack.us/v2/1152x648q90/538/u1Qwht.png" rel="nofollow">https://imagizer.imageshack.us/v2/1152x … u1Qwht.png</a></p></div></blockquote></div><p>I didn&#039;t get os x 10.9.5 working in qemu. I get a fast bootloop from seabios. <br />Can you post your command line?</p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1482191">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1482194" class="blockpost roweven"> <h2><span><span class="conr">#3524</span> <a href="viewtopic.php?pid=1482194#p1482194">2014-12-07 07:18:45</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=87159">anthonym52</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2014-12-07</span></dd> <dd><span>Posts: 10</span></dd> <dd class="usercontacts"><span class="email"><a href="misc.php?email=87159">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>winie wrote:</cite><blockquote><div><div class="quotebox"><cite>mastersplinter777 wrote:</cite><blockquote><div><p>Finally succeeded to passthrough my Zotac GT630 to OSX 10.9.5 with working 3D<br /><a href="https://imagizer.imageshack.us/v2/1152x648q90/538/u1Qwht.png" rel="nofollow">https://imagizer.imageshack.us/v2/1152x … u1Qwht.png</a></p></div></blockquote></div><p>I didn&#039;t get os x 10.9.5 working in qemu. I get a fast bootloop from seabios. <br />Can you post your command line?</p></div></blockquote></div><p>I second this -- also, has anyone written an Ubuntu tutorial or pre-compiled everything for 14.04?</p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1482194">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1482195" class="blockpost rowodd"> <h2><span><span class="conr">#3525</span> <a href="viewtopic.php?pid=1482195#p1482195">2014-12-07 07:22:52</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=52029">risho</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2011-09-06</span></dd> <dd><span>Posts: 44</span></dd> <dd class="usercontacts"><span class="email"><a href="misc.php?email=52029">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <p>so i switched out my gtx 580 that was&#160; running via bios and vga which was running fine to a radeon r9 290x in hopes of being able to get it set up using ovmf. I can get it to output a display by using</p><div class="codebox"><pre><code>sudo vfio-bind 0000:01:00.0 0000:01:00.1 #0000:00:03.0 qemu-system-x86_64 -enable-kvm -M q35 -m 8196 -mem-path /dev/hugepages -cpu host,kvm=off \ -smp 6,sockets=1,cores=3,threads=2 \ -boot menu=on \ -bios /usr/share/qemu/bios.bin -vga none\ -device ioh3420,bus=pcie.0,addr=1c.0,multifunction=on,port=1,chassis=1,id=root.1 \ -device vfio-pci,host=01:00.0,bus=root.1,addr=00.0,multifunction=on,x-vga=on -nographic \ -device vfio-pci,host=01:00.1,bus=root.1,addr=00.1 \</code></pre></div><p>on vga and seabios but on ovmf it won&#039;t work. it shows no output. i accidentially left the command running over night and it appears it output &quot;3h&quot; every once and a while after many many lines. this is the command i was running to try to get it running with ovmf</p><div class="codebox"><pre><code>sudo vfio-bind 0000:01:00.0 0000:01:00.1 #0000:00:03.0 qemu-system-x86_64 -enable-kvm -m 8196 -cpu host,kvm=off \ -smp 6,sockets=1,cores=3,threads=2 \ -boot menu=on \ -drive if=pflash,format=raw,readonly,file=/home/anonymous/kvm/OVMF_CODE.fd \ -drive if=pflash,format=raw,file=/home/anonymous/kvm/OVMF_VARS.fd \ -device vfio-pci,host=01:00.0 -nographic -vga none \ -device vfio-pci,host=01:00.1 \</code></pre></div><p>i tried running aw&#039;s rom parser but it would output a 0 byte file even on a fresh restart. does that mean my card doesnt support efi?</p><p>when i ran with &quot;multifunction=on,x-vga=on&quot; it would show uefi interactive shell inside of my terminal but still wouldnt show anyhting on my graphics card screen.</p><div class="codebox"><pre><code>UEFI Interactive Shell v2.1 EDK II UEFI v2.40 (EDK II, 0x00010000) Mapping table BLK2: Alias(s): PciRoot(0x0)/Pci(0x1,0x1)/Ata(0x0) BLK0: Alias(s): PciRoot(0x0)/Pci(0x1,0x0)/Floppy(0x0) BLK1: Alias(s): PciRoot(0x0)/Pci(0x1,0x0)/Floppy(0x1) Press ESC in 1 seconds to skip startup.nsh or any other key to continue. Shell&gt; </code></pre></div> <p class="postedit"><em>Last edited by risho (2014-12-07 07:31:00)</em></p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1482195">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div class="postlinksb"> <div class="inbox crumbsplus"> <div class="pagepost"> <p class="pagelink conl"><span class="pages-label">Pages: </span><a rel="prev" class="item1" href="viewtopic.php?id=162768&amp;p=140">Previous</a> <a href="viewtopic.php?id=162768">1</a> <span class="spacer">…</span> <a href="viewtopic.php?id=162768&amp;p=139">139</a> <a href="viewtopic.php?id=162768&amp;p=140">140</a> <strong>141</strong> <a href="viewtopic.php?id=162768&amp;p=142">142</a> <a href="viewtopic.php?id=162768&amp;p=143">143</a> <span class="spacer">…</span> <a href="viewtopic.php?id=162768&amp;p=234">234</a> <a rel="next" href="viewtopic.php?id=162768&amp;p=142">Next</a></p> <p class="postlink conr">Topic closed</p> </div> <ul class="crumbs"> <li><a href="index.php">Index</a></li> <li><span>»&#160;</span><a href="viewforum.php?id=48">Topics Going Nowhere</a></li> <li><span>»&#160;</span><strong><a href="viewtopic.php?id=162768">KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</a></strong></li> </ul> <p class="subscribelink clearb"><a href="misc.php?action=subscribe&amp;tid=162768">Subscribe to this topic</a></p> <div class="clearer"></div> </div> </div> </div> <div id="brdfooter" class="block"> <h2><span>Board footer</span></h2> <div class="box"> <div id="brdfooternav" class="inbox"> <div class="conl"> <form id="qjump" method="get" action="viewforum.php"> <div><label><span>Jump to<br /></span> <select name="id" onchange="window.location=('viewforum.php?id='+this.options[this.selectedIndex].value)"> <optgroup label="Technical Issues and Assistance"> <option value="23">Newbie Corner</option> <option value="17">Installation</option> <option value="22">Kernel &amp; Hardware</option> <option value="18">Applications &amp; Desktop Environments</option> <option value="31">Laptop Issues</option> <option value="8">Networking, Server, and Protection</option> <option value="32">Multimedia and Games</option> <option value="50">System Administration</option> <option value="35">Other Architectures</option> </optgroup> <optgroup label="Arch-centric"> <option value="24">Announcements, Package &amp; Security Advisories</option> <option value="1">Arch Discussion</option> <option value="13">Forum &amp; Wiki discussion</option> </optgroup> <optgroup label="Pacman Upgrades, Packaging &amp; AUR"> <option value="44">Pacman &amp; Package Upgrade Issues</option> <option value="49">[testing] Repo Forum</option> <option value="4">Creating &amp; Modifying Packages</option> <option value="38">AUR Issues, Discussion &amp; PKGBUILD Requests</option> </optgroup> <optgroup label="Contributions &amp; Discussion"> <option value="20">GNU/Linux Discussion</option> <option value="27">Community Contributions</option> <option value="33">Programming &amp; Scripting</option> <option value="30">Other Languages</option> <option value="47">Artwork and Screenshots</option> <option value="42">Try This</option> </optgroup> <optgroup label="/dev/null"> <option value="29">Off-Topic</option> <option value="48" selected="selected">Topics Going Nowhere</option> <option value="36">Dustbin</option> </optgroup> </select></label> <input type="submit" value=" Go " accesskey="g" /> </div> </form> </div> <div class="conr"> <p id="feedlinks"><span class="atom"><a href="extern.php?action=feed&amp;tid=162768&amp;type=atom">Atom topic feed</a></span></p> <p id="poweredby">Powered by <a href="http://fluxbb.org/">FluxBB</a></p> </div> <div class="clearer"></div> </div> </div> </div> </div> <div class="end-box"></div> </div> </body> </html>
