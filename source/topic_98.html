<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"> <html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en" dir="ltr"> <head> <meta http-equiv="Content-Type" content="text/html; charset=utf-8" /> <title>KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9 (Page 98) / Topics Going Nowhere / Arch Linux Forums</title> <link rel="stylesheet" type="text/css" href="style/ArchLinux.css" /> <link rel="canonical" href="viewtopic.php?id=162768&amp;p=98" title="Page 98" /> <link rel="prev" href="viewtopic.php?id=162768&amp;p=97" title="Page 97" /> <link rel="next" href="viewtopic.php?id=162768&amp;p=99" title="Page 99" /> <link rel="alternate" type="application/atom+xml" href="extern.php?action=feed&amp;tid=162768&amp;type=atom" title="Atom topic feed" /> <link rel="stylesheet" media="screen" href="style/ArchLinux/arch.css?v=3" /> <link rel="stylesheet" media="screen" href="style/ArchLinux/archnavbar.css?v=2" /> <link rel="shortcut icon" href="style/ArchLinux/favicon.ico" /> </head> <body> <div id="archnavbar" class="anb-forum"> <div id="archnavbarlogo"><h1><a href="http://www.archlinux.org/">Arch Linux</a></h1></div> <div id="archnavbarmenu"> <ul id="archnavbarlist"> <li id="anb-home"><a href="http://www.archlinux.org/">Home</a></li><li id="anb-packages"><a href="http://www.archlinux.org/packages/">Packages</a></li><li id="anb-forums" class="anb-selected"><a href="https://bbs.archlinux.org/">Forums</a></li><li id="anb-wiki"><a href="https://wiki.archlinux.org/">Wiki</a></li><li id="anb-bugs"><a href="https://bugs.archlinux.org/">Bugs</a></li><li id="anb-aur"><a href="https://aur.archlinux.org/">AUR</a></li><li id="anb-download"><a href="http://www.archlinux.org/download/">Download</a></li> </ul> </div> </div> <div id="punviewtopic" class="pun"> <div class="top-box"></div> <div class="punwrap"> <div id="brdheader" class="block"> <div class="box"> <div id="brdmenu" class="inbox"> <ul> <li id="navindex" class="isactive"><a href="index.php">Index</a></li> <li id="navuserlist"><a href="userlist.php">User list</a></li> <li id="navsearch"><a href="search.php">Search</a></li> <li id="navprofile"><a href="profile.php?id=80749">Profile</a></li> <li id="navlogout"><a href="login.php?action=out&amp;id=80749&amp;csrf_token=5c20501ec397bb45ef8ee8c84db232c8d8e421c6">Logout</a></li> </ul> </div> <div id="brdwelcome" class="inbox"> <ul class="conl"> <li><span>Logged in as <strong>SXX</strong></span></li> <li><span>Last visit: 2015-08-16 12:20:09</span></li> </ul> <ul class="conr"> <li><span>Topics: <a href="search.php?action=show_replies" title="Find topics you have posted to.">Posted</a> | <a href="search.php?action=show_new" title="Find topics with new posts since your last visit.">New</a> | <a href="search.php?action=show_recent" title="Find topics with recent posts.">Active</a> | <a href="search.php?action=show_unanswered" title="Find topics with no replies.">Unanswered</a></span></li> </ul> <div class="clearer"></div> </div> </div> </div> <div id="brdmain"> <div class="linkst"> <div class="inbox crumbsplus"> <ul class="crumbs"> <li><a href="index.php">Index</a></li> <li><span>»&#160;</span><a href="viewforum.php?id=48">Topics Going Nowhere</a></li> <li><span>»&#160;</span><strong><a href="viewtopic.php?id=162768">KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</a></strong></li> </ul> <div class="pagepost"> <p class="pagelink conl"><span class="pages-label">Pages: </span><a rel="prev" class="item1" href="viewtopic.php?id=162768&amp;p=97">Previous</a> <a href="viewtopic.php?id=162768">1</a> <span class="spacer">…</span> <a href="viewtopic.php?id=162768&amp;p=96">96</a> <a href="viewtopic.php?id=162768&amp;p=97">97</a> <strong>98</strong> <a href="viewtopic.php?id=162768&amp;p=99">99</a> <a href="viewtopic.php?id=162768&amp;p=100">100</a> <span class="spacer">…</span> <a href="viewtopic.php?id=162768&amp;p=234">234</a> <a rel="next" href="viewtopic.php?id=162768&amp;p=99">Next</a></p> <p class="postlink conr">Topic closed</p> </div> <div class="clearer"></div> </div> </div> <div id="p1443658" class="blockpost rowodd blockpost1"> <h2><span><span class="conr">#2426</span> <a href="viewtopic.php?pid=1443658#p1443658">2014-08-04 15:42:49</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=80387">dwe11er</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2014-03-18</span></dd> <dd><span>Posts: 73</span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>rg80 wrote:</cite><blockquote><div><div class="quotebox"><cite>rg80 wrote:</cite><blockquote><div><p>Hi again. <img src="https://bbs.archlinux.org/img/smilies/smile.png" width="15" height="15" alt="smile" /> </p><p>Do you have any idea how to add -cpu kvm=off option into a virt-manager xml?<br />I already tried with qemu arg:</p><div class="codebox"><pre><code> &lt;qemu:arg value=&#039;-cpu&#039;/&gt; &lt;qemu:arg value=&#039;kvm=off&#039;/&gt;</code></pre></div><p>but it does not work.</p><p>Should i put it somewhere into CPU options?</p><div class="codebox"><pre><code> &lt;cpu mode=&#039;host-passthrough&#039;&gt; &lt;topology sockets=&#039;1&#039; cores=&#039;4&#039; threads=&#039;2&#039;/&gt; &lt;/cpu&gt;</code></pre></div><p>Thanks. <img src="https://bbs.archlinux.org/img/smilies/smile.png" width="15" height="15" alt="smile" /></p></div></blockquote></div><br /><p>Bumping in a different format.<br />I want to disable the KVM Signture to update my nvidia windows drivers to any newer than v335.</p><p>Then got latest GIT version of qemu, applied <a href="http://permalink.gmane.org/gmane.comp.emulators.kvm.devel/122649" rel="nofollow">this patch</a>, then config, make, make install, reboot.</p><p>Applied:</p><div class="codebox"><pre><code> &lt;qemu:arg value=&#039;-cpu&#039;/&gt; &lt;qemu:arg value=&#039;host,kvm=off&#039;/&gt;</code></pre></div><p>but qemu reports .kvm is not an available option for qemu-system-x86_64.</p><p>On the contrary:</p><div class="codebox"><pre><code> &lt;qemu:arg value=&#039;-cpu&#039;/&gt; &lt;qemu:arg value=&#039;host,hv-time&#039;/&gt;</code></pre></div><p>works.</p><p>Am i doing something wrong?</p><p>Note:<br />For some reason, <a href="http://lists.gnu.org/archive/html/qemu-devel/2014-06/msg00319.html" rel="nofollow">the original patch</a> posted on page 1 gives me a format error on:</p><div class="codebox"><pre><code>diff --git a/target-i386/cpu.c b/target-i386/cpu.c</code></pre></div><p>it&#039;s not a blank, i can&#039;t understand where the problem is...</p><p>Thanks! <img src="https://bbs.archlinux.org/img/smilies/smile.png" width="15" height="15" alt="smile" /></p></div></blockquote></div><p>I belive qemu from git has this patch already applied.</p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1443658">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1443660" class="blockpost roweven"> <h2><span><span class="conr">#2427</span> <a href="viewtopic.php?pid=1443660#p1443660">2014-08-04 15:46:41</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=83763">rg80</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2014-07-23</span></dd> <dd><span>Posts: 7</span></dd> <dd class="usercontacts"><span class="email"><a href="misc.php?email=83763">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><blockquote><div><p>I belive qemu from git has this patch already applied.</p></div></blockquote></div><p>Thanks, I believe the same but what is the -cpu option then?<br />I also tried without patch but it does not work on its own and -cpu kvm=off gives the same error with libvirt. <img src="https://bbs.archlinux.org/img/smilies/sad.png" width="15" height="15" alt="sad" /></p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1443660">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1443729" class="blockpost rowodd"> <h2><span><span class="conr">#2428</span> <a href="viewtopic.php?pid=1443729#p1443729">2014-08-04 19:17:49</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=83763">rg80</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2014-07-23</span></dd> <dd><span>Posts: 7</span></dd> <dd class="usercontacts"><span class="email"><a href="misc.php?email=83763">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <p>Got it! <img src="https://bbs.archlinux.org/img/smilies/smile.png" width="15" height="15" alt="smile" /></p><p>virsh XML was pointing to /user/bin/qemu while git qemu installs into /usr/local/bin/qemu&#160; !!!</p><p>Changed the path in the XML, added:</p><div class="codebox"><pre><code> &lt;qemu:arg value=&#039;-cpu&#039;/&gt; &lt;qemu:arg value=&#039;host,kvm=off&#039;/&gt;</code></pre></div><p>Now i am on nvidia with windows driver 340! <img src="https://bbs.archlinux.org/img/smilies/smile.png" width="15" height="15" alt="smile" /></p><p>And yes, qemu git already contains the &quot;-cpu kvm&quot; option, no need to apply any patch!</p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1443729">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1443786" class="blockpost roweven"> <h2><span><span class="conr">#2429</span> <a href="viewtopic.php?pid=1443786#p1443786">2014-08-04 22:27:39</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=82227">HPvirt</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2014-05-23</span></dd> <dd><span>Posts: 6</span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <p>Hello!</p><p>Previously, I&#039;ve checked if some hardware would be able to do this kind of virtualization.<br />Now, I have my hardware (check my signature for details).</p><p>I started yesterday to prepare my linux for virt. (kernel compilation, grub command line,...). I&#039;ve tried with kernel 3.15.6 with the 3 patches from #1. Without success: no /etc/vfio/x, qemu would not start.</p><p>And tonight, I&#039;ve succeeded to start Seven SP1 boot CD! I used kernel 3.15.8 sources, apply patches, build, install, and it works.<br />First step done.</p><p>I&#039;ve tried to read all posts. Sorting all these infos (obsolete one, AMD specific, etc.) to apply them to my specific case is quite time consuming, but it&#039;s very usefull. However, as I&#039;m more linux user than administrator, I think I&#039;ve missed some part, and there&#039;s some things I do not understand fully.</p><p>So, before going into the real seven installation, I&#039;ve some questions:<br />- I do not use pci-stub: as I understand the first post, it must be used only if we cannot blacklist GPU drivers (as with 2 NVidia or 2 AMD). Right?<br />- I want to install Seven on a SSD, so I would like to have AHCI and trim working for Windows. Between solutions on #1 for giving access to disk drives, which one is recommanded?<br />- <span class="bbs">Moving windows under Linux is... smooth... too smooth, producing great latency: my cursor is already stopped and the window is still moving to overtake the cursor. Is the disabling of DRI the cause?</span> If I boot from liveCD, I have the same behavior.<br />- In first post, I do not understand the part &quot;Systemd service:&quot;. I think I must add a file containing following text to do the vfio bindings at start time. But I would like to be sure... Can someone confirm please?</p><p>Some info:</p><div class="codebox"><pre><code>$ grep VFIO /boot/config-3.15.8 CONFIG_VFIO_IOMMU_TYPE1=y CONFIG_VFIO=y CONFIG_VFIO_PCI=y CONFIG_VFIO_PCI_VGA=y CONFIG_KVM_VFIO=y $ cat /proc/cmdline BOOT_IMAGE=/boot/vmlinuz-3.15.8 root=UUID=a98c98e2-53a6-4771-a465-e5dd7128ae4e ro quiet splash nvidia.blacklist=yes nvidia-current.blacklist=yes nvidia_337.blacklist=yes nvidiafb.blacklist=yes i915.enable_hd_vgaarb=1 intel_iommu=on vt.handoff=7</code></pre></div><p>For the cmdline, I followed post #2308 as rafalcieslak have the same hardware.</p><p>I do not use (cf. #2308):</p><div class="quotebox"><blockquote><div><p>options kvm allow_unsafe_assigned_interrupts=1</p></div></blockquote></div><p>nor (not yet):</p><div class="quotebox"><blockquote><div><p>pcie_acs_override=downstream</p></div></blockquote></div><p>About this last parameter, is it a requisite? I&#039;ve check groups, and if I fully give ASMedia USB &amp; Sata controllers and Realtek Network controller to Seven, as they share the same group, it would not be necessary. Or, more likely, I missed something...</p><p>(lsgroup is aw script in #722)</p><div class="codebox"><pre class="vscroll"><code>$ ./lsgroup.sh ### Group 0 ### 00:00.0 Host bridge: Intel Corporation 4th Gen Core Processor DRAM Controller (rev 06) ### Group 1 ### 00:01.0 PCI bridge: Intel Corporation Xeon E3-1200 v3/4th Gen Core Processor PCI Express x16 Controller (rev 06) 01:00.0 VGA compatible controller: NVIDIA Corporation GK104 [GeForce GTX 680] (rev a1) 01:00.1 Audio device: NVIDIA Corporation GK104 HDMI Audio Controller (rev a1) ### Group 2 ### 00:02.0 VGA compatible controller: Intel Corporation Xeon E3-1200 v3/4th Gen Core Processor Integrated Graphics Controller (rev 06) ### Group 3 ### 00:03.0 Audio device: Intel Corporation Xeon E3-1200 v3/4th Gen Core Processor HD Audio Controller (rev 06) ### Group 4 ### 00:14.0 USB controller: Intel Corporation Device 8cb1 ### Group 5 ### 00:16.0 Communication controller: Intel Corporation Device 8cba ### Group 6 ### 00:19.0 Ethernet controller: Intel Corporation Ethernet Connection (2) I218-V ### Group 7 ### 00:1a.0 USB controller: Intel Corporation Device 8cad ### Group 8 ### 00:1b.0 Audio device: Intel Corporation Device 8ca0 ### Group 9 ### 00:1c.0 PCI bridge: Intel Corporation Device 8c90 (rev d0) 00:1c.2 PCI bridge: Intel Corporation Device 8c94 (rev d0) 00:1c.3 PCI bridge: Intel Corporation Device 8c96 (rev d0) 00:1c.6 PCI bridge: Intel Corporation Device 8c9c (rev d0) 03:00.0 Ethernet controller: Realtek Semiconductor Co., Ltd. RTL8111/8168/8411 PCI Express Gigabit Ethernet Controller (rev 11) 04:00.0 PCI bridge: ASMedia Technology Inc. Device 1184 05:01.0 PCI bridge: ASMedia Technology Inc. Device 1184 05:03.0 PCI bridge: ASMedia Technology Inc. Device 1184 05:05.0 PCI bridge: ASMedia Technology Inc. Device 1184 05:07.0 PCI bridge: ASMedia Technology Inc. Device 1184 07:00.0 SATA controller: ASMedia Technology Inc. ASM1062 Serial ATA Controller (rev 02) 09:00.0 SATA controller: ASMedia Technology Inc. ASM1062 Serial ATA Controller (rev 02) 0a:00.0 USB controller: ASMedia Technology Inc. Device 1142 ### Group 10 ### 00:1d.0 USB controller: Intel Corporation Device 8ca6 ### Group 11 ### 00:1f.0 ISA bridge: Intel Corporation Device 8cc4 00:1f.2 SATA controller: Intel Corporation Device 8c82 00:1f.3 SMBus: Intel Corporation Device 8ca2</code></pre></div><p>Thank you all for sharing your knowledge.<br />I hope I&#039;m understandable as my english is not pretty good...</p> <p class="postedit"><em>Last edited by HPvirt (2014-08-06 20:36:00)</em></p> </div> <div class="postsignature postmsg"><hr /><p>Hardware: ASRock Z97 Extreme 6 - Intel Core i7 4790 - NVidia GTX680<br />Host: Linux Mint 17 Qiana, Kernel 3.15.8 (custom)<br />Guest: Windows Seven Ultimate SP1</p></div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1443786">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1443878" class="blockpost rowodd"> <h2><span><span class="conr">#2430</span> <a href="viewtopic.php?pid=1443878#p1443878">2014-08-05 05:38:52</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=82442">slis</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2014-06-02</span></dd> <dd><span>Posts: 125</span></dd> <dd class="usercontacts"><span class="email"><a href="mailto:xslisx@gmail.com">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <p>you must use pci-stub if u have 2 same cards, for host and guest.</p><p>maybe you need option downstream if u have 2 gpu-s (maybe even if u don&#039;t, depending on mbo)...</p><p>you need to bind device before u start vm, with systemd service or by hand (vfio-bind 0000:01:00.0 0000:01:00.1, assumin u created vfio-bind script as in first post)</p><p>not sure about window lag,&#160; i don&#039;t use gui on host.</p><p>about ssd... i am not sure, but i think u need to pass whole sata controller to use trim etc...</p><p>virtio-disk is best option if u ask me <img src="https://bbs.archlinux.org/img/smilies/wink.png" width="15" height="15" alt="wink" /></p><p>edit:<br />check my posts for configs and help...</p> <p class="postedit"><em>Last edited by slis (2014-08-05 05:54:17)</em></p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1443878">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1443890" class="blockpost roweven"> <h2><span><span class="conr">#2431</span> <a href="viewtopic.php?pid=1443890#p1443890">2014-08-05 06:29:29</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=83741">monchi</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2014-07-21</span></dd> <dd><span>Posts: 9</span></dd> <dd class="usercontacts"><span class="email"><a href="misc.php?email=83741">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <p>are the patches from #1 still needed for the recent stabel kernel version 3.16 ?</p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1443890">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1443905" class="blockpost rowodd"> <h2><span><span class="conr">#2432</span> <a href="viewtopic.php?pid=1443905#p1443905">2014-08-05 08:01:54</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=84101">zerotri</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2014-08-03</span></dd> <dd><span>Posts: 2</span></dd> <dd class="usercontacts"><span class="email"><a href="misc.php?email=84101">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <p>I seem to have made a bit of progress on a few fronts but still have a ways to go.</p><p>I ended up not using pci-stub at all. This may or may not be causing problems. lspci -v shows that my first hd6770 is bound to radeon while my second is bound to vfio-pci. Host&#039;s graphics are working 100% but when I start up a windows guest I am getting the infamous &quot;video_tdr_failure / atikmpag.sys&quot; BSoD. I&#039;ve tried playing around with moving the HDMI audio device to a few other pci locations, as well as not passing it through at all, with no luck. Maybe I&#039;m doing something wrong in the process of debugging that.</p><p>Also, I was able to turn off the DMAR error associated with my Marvell controller by completely disabling the device in my bios. Now my system boots up pretty quickly, just need to iron out the vga passthrough issues with the vm.</p><p>I guess this could be contributing to the issue?<br />Gonna have to dig around in dmesg a bit more to see if I&#039;m missing anything else.</p><div class="codebox"><pre class="vscroll"><code>[ 4.894003] VFIO - User Level meta-driver version: 0.3 [ 4.897769] scsi 8:0:0:0: Direct-Access SanDisk Cruzer Fit 1.22 PQ: 0 ANSI: 5 [ 4.898516] sd 8:0:0:0: [sdc] 15633408 512-byte logical blocks: (8.00 GB/7.45 GiB) [ 4.899512] sd 8:0:0:0: [sdc] Write Protect is off [ 4.899515] sd 8:0:0:0: [sdc] Mode Sense: 43 00 00 00 [ 4.899873] sd 8:0:0:0: Attached scsi generic sg2 type 0 [ 4.900960] sd 8:0:0:0: [sdc] Write cache: disabled, read cache: enabled, doesn&#039;t support DPO or FUA [ 4.908768] ------------[ cut here ]------------ [ 4.908774] WARNING: CPU: 5 PID: 956 at fs/sysfs/group.c:219 sysfs_remove_group+0x93/0xa0() [ 4.908776] sysfs group ffffffff81cb8dc0 not found for kobject &#039;i2c-21&#039; [ 4.908777] Modules linked in: vfio_iommu_type1 vfio_pci vfio joydev uas usb_storage hid_logitech_dj iTCO_wdt iTCO_vendor_support eeepc_wmi asus_wmi sparse_keymap video mxm_wmi vfat fat x86_pkg_temp_thermal coretemp kvm_intel kvm crct10dif_pclmul crc32_pclmul crc32c_intel ghash_clmulni_intel snd_hda_codec_realtek snd_hda_codec_generic microcode snd_hda_codec_hdmi serio_raw btusb sb_edac edac_core bluetooth snd_hda_intel snd_hda_controller snd_hda_codec i2c_i801 rfkill snd_hwdep snd_seq snd_seq_device lpc_ich mfd_core snd_pcm snd_timer mei_me snd mei soundcore shpchp wmi nfsd auth_rpcgss nfs_acl lockd sunrpc radeon i2c_algo_bit drm_kms_helper e1000e ttm drm ptp i2c_core pps_core [ 4.908811] CPU: 5 PID: 956 Comm: vfio-bind Not tainted 3.15.7-200.fc20.x86_64 #1 [ 4.908813] Hardware name: System manufacturer System Product Name/P9X79 PRO, BIOS 1203 05/24/2012 [ 4.908814] 0000000000000000 000000002e9d5df5 ffff8808078abba0 ffffffff816ef92e [ 4.908816] ffff8808078abbe8 ffff8808078abbd8 ffffffff8108933d 0000000000000000 [ 4.908818] ffffffff81cb8dc0 ffff88080eef2480 ffff88080fedb000 ffff88080eef24c8 [ 4.908821] Call Trace: [ 4.908825] [&lt;ffffffff816ef92e&gt;] dump_stack+0x45/0x56 [ 4.908827] [&lt;ffffffff8108933d&gt;] warn_slowpath_common+0x7d/0xa0 [ 4.908829] [&lt;ffffffff810893bc&gt;] warn_slowpath_fmt+0x5c/0x80 [ 4.908832] [&lt;ffffffff81260918&gt;] ? kernfs_find_and_get_ns+0x48/0x60 [ 4.908834] [&lt;ffffffff81263fc3&gt;] sysfs_remove_group+0x93/0xa0 [ 4.908837] [&lt;ffffffff81465197&gt;] dpm_sysfs_remove+0x57/0x60 [ 4.908840] [&lt;ffffffff8145a1f5&gt;] device_del+0x45/0x1c0 [ 4.908841] [&lt;ffffffff8145a38e&gt;] device_unregister+0x1e/0x60 [ 4.908848] [&lt;ffffffffa000cd2c&gt;] i2c_del_adapter+0x1bc/0x2f0 [i2c_core] [ 4.908852] [&lt;ffffffffa0093412&gt;] drm_dp_aux_unregister_i2c_bus+0x12/0x20 [drm_kms_helper] [ 4.908867] [&lt;ffffffffa01812fc&gt;] radeon_i2c_destroy+0x3c/0x40 [radeon] [ 4.908878] [&lt;ffffffffa018137a&gt;] radeon_i2c_fini+0x2a/0x50 [radeon] [ 4.908890] [&lt;ffffffffa017e6d9&gt;] radeon_modeset_fini+0x89/0x90 [radeon] [ 4.908899] [&lt;ffffffffa0157180&gt;] radeon_driver_unload_kms+0x40/0x60 [radeon] [ 4.908908] [&lt;ffffffffa00497a9&gt;] drm_dev_unregister+0x29/0xb0 [drm] [ 4.908915] [&lt;ffffffffa0049d13&gt;] drm_put_dev+0x23/0x70 [drm] [ 4.908923] [&lt;ffffffffa015327d&gt;] radeon_pci_remove+0x1d/0x20 [radeon] [ 4.908927] [&lt;ffffffff8138fb7b&gt;] pci_device_remove+0x3b/0xb0 [ 4.908930] [&lt;ffffffff8145e48f&gt;] __device_release_driver+0x7f/0xf0 [ 4.908932] [&lt;ffffffff8145e523&gt;] device_release_driver+0x23/0x30 [ 4.908935] [&lt;ffffffff8145d06d&gt;] unbind_store+0xbd/0xe0 [ 4.908937] [&lt;ffffffff8145c574&gt;] drv_attr_store+0x24/0x40 [ 4.908939] [&lt;ffffffff81262c1d&gt;] sysfs_kf_write+0x3d/0x50 [ 4.908941] [&lt;ffffffff812623e0&gt;] kernfs_fop_write+0xe0/0x160 [ 4.908944] [&lt;ffffffff811e67da&gt;] vfs_write+0xba/0x1e0 [ 4.908946] [&lt;ffffffff811e7395&gt;] SyS_write+0x55/0xd0 [ 4.908950] [&lt;ffffffff816ff969&gt;] system_call_fastpath+0x16/0x1b [ 4.908951] ---[ end trace 4a930f0eb6428dc9 ]--- [ 4.908985] ------------[ cut here ]------------ [ 4.908988] WARNING: CPU: 5 PID: 956 at fs/sysfs/group.c:219 sysfs_remove_group+0x93/0xa0() [ 4.908989] sysfs group ffffffff81cb8dc0 not found for kobject &#039;i2c-24&#039; [ 4.908989] Modules linked in: vfio_iommu_type1 vfio_pci vfio joydev uas usb_storage hid_logitech_dj iTCO_wdt iTCO_vendor_support eeepc_wmi asus_wmi sparse_keymap video mxm_wmi vfat fat x86_pkg_temp_thermal coretemp kvm_intel kvm crct10dif_pclmul crc32_pclmul crc32c_intel ghash_clmulni_intel snd_hda_codec_realtek snd_hda_codec_generic microcode snd_hda_codec_hdmi serio_raw btusb sb_edac edac_core bluetooth snd_hda_intel snd_hda_controller snd_hda_codec i2c_i801 rfkill snd_hwdep snd_seq snd_seq_device lpc_ich mfd_core snd_pcm snd_timer mei_me snd mei soundcore shpchp wmi nfsd auth_rpcgss nfs_acl lockd sunrpc radeon i2c_algo_bit drm_kms_helper e1000e ttm drm ptp i2c_core pps_core [ 4.909015] CPU: 5 PID: 956 Comm: vfio-bind Tainted: G W 3.15.7-200.fc20.x86_64 #1 [ 4.909016] Hardware name: System manufacturer System Product Name/P9X79 PRO, BIOS 1203 05/24/2012 [ 4.909017] 0000000000000000 000000002e9d5df5 ffff8808078abba0 ffffffff816ef92e [ 4.909019] ffff8808078abbe8 ffff8808078abbd8 ffffffff8108933d 0000000000000000 [ 4.909021] ffffffff81cb8dc0 ffff88080eef2c80 ffff88080fedf000 ffff88080eef2cc8 [ 4.909023] Call Trace: [ 4.909025] [&lt;ffffffff816ef92e&gt;] dump_stack+0x45/0x56 [ 4.909027] [&lt;ffffffff8108933d&gt;] warn_slowpath_common+0x7d/0xa0 [ 4.909029] [&lt;ffffffff810893bc&gt;] warn_slowpath_fmt+0x5c/0x80 [ 4.909031] [&lt;ffffffff81260918&gt;] ? kernfs_find_and_get_ns+0x48/0x60 [ 4.909033] [&lt;ffffffff81263fc3&gt;] sysfs_remove_group+0x93/0xa0 [ 4.909035] [&lt;ffffffff81465197&gt;] dpm_sysfs_remove+0x57/0x60 [ 4.909037] [&lt;ffffffff8145a1f5&gt;] device_del+0x45/0x1c0 [ 4.909039] [&lt;ffffffff8145a38e&gt;] device_unregister+0x1e/0x60 [ 4.909044] [&lt;ffffffffa000cd2c&gt;] i2c_del_adapter+0x1bc/0x2f0 [i2c_core] [ 4.909048] [&lt;ffffffffa0093412&gt;] drm_dp_aux_unregister_i2c_bus+0x12/0x20 [drm_kms_helper] [ 4.909060] [&lt;ffffffffa01812fc&gt;] radeon_i2c_destroy+0x3c/0x40 [radeon] [ 4.909071] [&lt;ffffffffa018137a&gt;] radeon_i2c_fini+0x2a/0x50 [radeon] [ 4.909082] [&lt;ffffffffa017e6d9&gt;] radeon_modeset_fini+0x89/0x90 [radeon] [ 4.909091] [&lt;ffffffffa0157180&gt;] radeon_driver_unload_kms+0x40/0x60 [radeon] [ 4.909098] [&lt;ffffffffa00497a9&gt;] drm_dev_unregister+0x29/0xb0 [drm] [ 4.909105] [&lt;ffffffffa0049d13&gt;] drm_put_dev+0x23/0x70 [drm] [ 4.909114] [&lt;ffffffffa015327d&gt;] radeon_pci_remove+0x1d/0x20 [radeon] [ 4.909116] [&lt;ffffffff8138fb7b&gt;] pci_device_remove+0x3b/0xb0 [ 4.909119] [&lt;ffffffff8145e48f&gt;] __device_release_driver+0x7f/0xf0 [ 4.909122] [&lt;ffffffff8145e523&gt;] device_release_driver+0x23/0x30 [ 4.909124] [&lt;ffffffff8145d06d&gt;] unbind_store+0xbd/0xe0 [ 4.909126] [&lt;ffffffff8145c574&gt;] drv_attr_store+0x24/0x40 [ 4.909128] [&lt;ffffffff81262c1d&gt;] sysfs_kf_write+0x3d/0x50 [ 4.909130] [&lt;ffffffff812623e0&gt;] kernfs_fop_write+0xe0/0x160 [ 4.909133] [&lt;ffffffff811e67da&gt;] vfs_write+0xba/0x1e0 [ 4.909135] [&lt;ffffffff811e7395&gt;] SyS_write+0x55/0xd0 [ 4.909137] [&lt;ffffffff816ff969&gt;] system_call_fastpath+0x16/0x1b [ 4.909139] ---[ end trace 4a930f0eb6428dca ]--- [ 4.909163] ------------[ cut here ]------------ [ 4.909166] WARNING: CPU: 5 PID: 956 at fs/sysfs/group.c:219 sysfs_remove_group+0x93/0xa0() [ 4.909167] sysfs group ffffffff81cb8dc0 not found for kobject &#039;i2c-22&#039; [ 4.909168] Modules linked in: vfio_iommu_type1 vfio_pci vfio joydev uas usb_storage hid_logitech_dj iTCO_wdt iTCO_vendor_support eeepc_wmi asus_wmi sparse_keymap video mxm_wmi vfat fat x86_pkg_temp_thermal coretemp kvm_intel kvm crct10dif_pclmul crc32_pclmul crc32c_intel ghash_clmulni_intel snd_hda_codec_realtek snd_hda_codec_generic microcode snd_hda_codec_hdmi serio_raw btusb sb_edac edac_core bluetooth snd_hda_intel snd_hda_controller snd_hda_codec i2c_i801 rfkill snd_hwdep snd_seq snd_seq_device lpc_ich mfd_core snd_pcm snd_timer mei_me snd mei soundcore shpchp wmi nfsd auth_rpcgss nfs_acl lockd sunrpc radeon i2c_algo_bit drm_kms_helper e1000e ttm drm ptp i2c_core pps_core [ 4.909193] CPU: 5 PID: 956 Comm: vfio-bind Tainted: G W 3.15.7-200.fc20.x86_64 #1 [ 4.909195] Hardware name: System manufacturer System Product Name/P9X79 PRO, BIOS 1203 05/24/2012 [ 4.909195] 0000000000000000 000000002e9d5df5 ffff8808078abba0 ffffffff816ef92e [ 4.909197] ffff8808078abbe8 ffff8808078abbd8 ffffffff8108933d 0000000000000000 [ 4.909200] ffffffff81cb8dc0 ffff88080eef3480 ffff88080fedc000 ffff88080eef34c8 [ 4.909202] Call Trace: [ 4.909204] [&lt;ffffffff816ef92e&gt;] dump_stack+0x45/0x56 [ 4.909206] [&lt;ffffffff8108933d&gt;] warn_slowpath_common+0x7d/0xa0 [ 4.909208] [&lt;ffffffff810893bc&gt;] warn_slowpath_fmt+0x5c/0x80 [ 4.909210] [&lt;ffffffff81260918&gt;] ? kernfs_find_and_get_ns+0x48/0x60 [ 4.909212] [&lt;ffffffff81263fc3&gt;] sysfs_remove_group+0x93/0xa0 [ 4.909214] [&lt;ffffffff81465197&gt;] dpm_sysfs_remove+0x57/0x60 [ 4.909216] [&lt;ffffffff8145a1f5&gt;] device_del+0x45/0x1c0 [ 4.909218] [&lt;ffffffff8145a38e&gt;] device_unregister+0x1e/0x60 [ 4.909223] [&lt;ffffffffa000cd2c&gt;] i2c_del_adapter+0x1bc/0x2f0 [i2c_core] [ 4.909228] [&lt;ffffffffa0093412&gt;] drm_dp_aux_unregister_i2c_bus+0x12/0x20 [drm_kms_helper] [ 4.909241] [&lt;ffffffffa01812fc&gt;] radeon_i2c_destroy+0x3c/0x40 [radeon] [ 4.909253] [&lt;ffffffffa018137a&gt;] radeon_i2c_fini+0x2a/0x50 [radeon] [ 4.909264] [&lt;ffffffffa017e6d9&gt;] radeon_modeset_fini+0x89/0x90 [radeon] [ 4.909273] [&lt;ffffffffa0157180&gt;] radeon_driver_unload_kms+0x40/0x60 [radeon] [ 4.909281] [&lt;ffffffffa00497a9&gt;] drm_dev_unregister+0x29/0xb0 [drm] [ 4.909288] [&lt;ffffffffa0049d13&gt;] drm_put_dev+0x23/0x70 [drm] [ 4.909296] [&lt;ffffffffa015327d&gt;] radeon_pci_remove+0x1d/0x20 [radeon] [ 4.909299] [&lt;ffffffff8138fb7b&gt;] pci_device_remove+0x3b/0xb0 [ 4.909303] [&lt;ffffffff8145e48f&gt;] __device_release_driver+0x7f/0xf0 [ 4.909305] [&lt;ffffffff8145e523&gt;] device_release_driver+0x23/0x30 [ 4.909307] [&lt;ffffffff8145d06d&gt;] unbind_store+0xbd/0xe0 [ 4.909309] [&lt;ffffffff8145c574&gt;] drv_attr_store+0x24/0x40 [ 4.909312] [&lt;ffffffff81262c1d&gt;] sysfs_kf_write+0x3d/0x50 [ 4.909314] [&lt;ffffffff812623e0&gt;] kernfs_fop_write+0xe0/0x160 [ 4.909316] [&lt;ffffffff811e67da&gt;] vfs_write+0xba/0x1e0 [ 4.909318] [&lt;ffffffff811e7395&gt;] SyS_write+0x55/0xd0 [ 4.909321] [&lt;ffffffff816ff969&gt;] system_call_fastpath+0x16/0x1b [ 4.909323] ---[ end trace 4a930f0eb6428dcb ]--- [ 4.909353] ------------[ cut here ]------------ [ 4.909356] WARNING: CPU: 5 PID: 956 at fs/sysfs/group.c:219 sysfs_remove_group+0x93/0xa0() [ 4.909357] sysfs group ffffffff81cb8dc0 not found for kobject &#039;i2c-23&#039; [ 4.909358] Modules linked in: vfio_iommu_type1 vfio_pci vfio joydev uas usb_storage hid_logitech_dj iTCO_wdt iTCO_vendor_support eeepc_wmi asus_wmi sparse_keymap video mxm_wmi vfat fat x86_pkg_temp_thermal coretemp kvm_intel kvm crct10dif_pclmul crc32_pclmul crc32c_intel ghash_clmulni_intel snd_hda_codec_realtek snd_hda_codec_generic microcode snd_hda_codec_hdmi serio_raw btusb sb_edac edac_core bluetooth snd_hda_intel snd_hda_controller snd_hda_codec i2c_i801 rfkill snd_hwdep snd_seq snd_seq_device lpc_ich mfd_core snd_pcm snd_timer mei_me snd mei soundcore shpchp wmi nfsd auth_rpcgss nfs_acl lockd sunrpc radeon i2c_algo_bit drm_kms_helper e1000e ttm drm ptp i2c_core pps_core [ 4.909385] CPU: 5 PID: 956 Comm: vfio-bind Tainted: G W 3.15.7-200.fc20.x86_64 #1 [ 4.909386] Hardware name: System manufacturer System Product Name/P9X79 PRO, BIOS 1203 05/24/2012 [ 4.909387] 0000000000000000 000000002e9d5df5 ffff8808078abba0 ffffffff816ef92e [ 4.909389] ffff8808078abbe8 ffff8808078abbd8 ffffffff8108933d 0000000000000000 [ 4.909391] ffffffff81cb8dc0 ffff88080eef3c80 ffff88080fede800 ffff88080eef3cc8 [ 4.909394] Call Trace: [ 4.909396] [&lt;ffffffff816ef92e&gt;] dump_stack+0x45/0x56 [ 4.909398] [&lt;ffffffff8108933d&gt;] warn_slowpath_common+0x7d/0xa0 [ 4.909400] [&lt;ffffffff810893bc&gt;] warn_slowpath_fmt+0x5c/0x80 [ 4.909403] [&lt;ffffffff816f526b&gt;] ? mutex_unlock+0x1b/0x20 [ 4.909406] [&lt;ffffffff81260918&gt;] ? kernfs_find_and_get_ns+0x48/0x60 [ 4.909408] [&lt;ffffffff81263fc3&gt;] sysfs_remove_group+0x93/0xa0 [ 4.909410] [&lt;ffffffff81465197&gt;] dpm_sysfs_remove+0x57/0x60 [ 4.909412] [&lt;ffffffff8145a1f5&gt;] device_del+0x45/0x1c0 [ 4.909414] [&lt;ffffffff8145a38e&gt;] device_unregister+0x1e/0x60 [ 4.909419] [&lt;ffffffffa000cd2c&gt;] i2c_del_adapter+0x1bc/0x2f0 [i2c_core] [ 4.909423] [&lt;ffffffffa0093412&gt;] drm_dp_aux_unregister_i2c_bus+0x12/0x20 [drm_kms_helper] [ 4.909435] [&lt;ffffffffa01812fc&gt;] radeon_i2c_destroy+0x3c/0x40 [radeon] [ 4.909446] [&lt;ffffffffa018137a&gt;] radeon_i2c_fini+0x2a/0x50 [radeon] [ 4.909457] [&lt;ffffffffa017e6d9&gt;] radeon_modeset_fini+0x89/0x90 [radeon] [ 4.909466] [&lt;ffffffffa0157180&gt;] radeon_driver_unload_kms+0x40/0x60 [radeon] [ 4.909479] [&lt;ffffffffa00497a9&gt;] drm_dev_unregister+0x29/0xb0 [drm] [ 4.909486] [&lt;ffffffffa0049d13&gt;] drm_put_dev+0x23/0x70 [drm] [ 4.909494] [&lt;ffffffffa015327d&gt;] radeon_pci_remove+0x1d/0x20 [radeon] [ 4.909497] [&lt;ffffffff8138fb7b&gt;] pci_device_remove+0x3b/0xb0 [ 4.909500] [&lt;ffffffff8145e48f&gt;] __device_release_driver+0x7f/0xf0 [ 4.909502] [&lt;ffffffff8145e523&gt;] device_release_driver+0x23/0x30 [ 4.909504] [&lt;ffffffff8145d06d&gt;] unbind_store+0xbd/0xe0 [ 4.909506] [&lt;ffffffff8145c574&gt;] drv_attr_store+0x24/0x40 [ 4.909509] [&lt;ffffffff81262c1d&gt;] sysfs_kf_write+0x3d/0x50 [ 4.909511] [&lt;ffffffff812623e0&gt;] kernfs_fop_write+0xe0/0x160 [ 4.909513] [&lt;ffffffff811e67da&gt;] vfs_write+0xba/0x1e0 [ 4.909515] [&lt;ffffffff811e7395&gt;] SyS_write+0x55/0xd0 [ 4.909517] [&lt;ffffffff816ff969&gt;] system_call_fastpath+0x16/0x1b [ 4.909519] ---[ end trace 4a930f0eb6428dcc ]--- [ 4.909550] ------------[ cut here ]------------ [ 4.909552] WARNING: CPU: 5 PID: 956 at fs/sysfs/group.c:219 sysfs_remove_group+0x93/0xa0() [ 4.909554] sysfs group ffffffff81cb8dc0 not found for kobject &#039;i2c-25&#039; [ 4.909554] Modules linked in: vfio_iommu_type1 vfio_pci vfio joydev uas usb_storage hid_logitech_dj iTCO_wdt iTCO_vendor_support eeepc_wmi asus_wmi sparse_keymap video mxm_wmi vfat fat x86_pkg_temp_thermal coretemp kvm_intel kvm crct10dif_pclmul crc32_pclmul crc32c_intel ghash_clmulni_intel snd_hda_codec_realtek snd_hda_codec_generic microcode snd_hda_codec_hdmi serio_raw btusb sb_edac edac_core bluetooth snd_hda_intel snd_hda_controller snd_hda_codec i2c_i801 rfkill snd_hwdep snd_seq snd_seq_device lpc_ich mfd_core snd_pcm snd_timer mei_me snd mei soundcore shpchp wmi nfsd auth_rpcgss nfs_acl lockd sunrpc radeon i2c_algo_bit drm_kms_helper e1000e ttm drm ptp i2c_core pps_core [ 4.909580] CPU: 5 PID: 956 Comm: vfio-bind Tainted: G W 3.15.7-200.fc20.x86_64 #1 [ 4.909581] Hardware name: System manufacturer System Product Name/P9X79 PRO, BIOS 1203 05/24/2012 [ 4.909582] 0000000000000000 000000002e9d5df5 ffff8808078abba0 ffffffff816ef92e [ 4.909584] ffff8808078abbe8 ffff8808078abbd8 ffffffff8108933d 0000000000000000 [ 4.909585] ffffffff81cb8dc0 ffff88080eef4480 ffff88080fedf400 ffff88080eef44c8 [ 4.909587] Call Trace: [ 4.909590] [&lt;ffffffff816ef92e&gt;] dump_stack+0x45/0x56 [ 4.909591] [&lt;ffffffff8108933d&gt;] warn_slowpath_common+0x7d/0xa0 [ 4.909593] [&lt;ffffffff810893bc&gt;] warn_slowpath_fmt+0x5c/0x80 [ 4.909595] [&lt;ffffffff81260918&gt;] ? kernfs_find_and_get_ns+0x48/0x60 [ 4.909597] [&lt;ffffffff81263fc3&gt;] sysfs_remove_group+0x93/0xa0 [ 4.909599] [&lt;ffffffff81465197&gt;] dpm_sysfs_remove+0x57/0x60 [ 4.909601] [&lt;ffffffff8145a1f5&gt;] device_del+0x45/0x1c0 [ 4.909603] [&lt;ffffffff8145a38e&gt;] device_unregister+0x1e/0x60 [ 4.909608] [&lt;ffffffffa000cd2c&gt;] i2c_del_adapter+0x1bc/0x2f0 [i2c_core] [ 4.909612] [&lt;ffffffffa0093412&gt;] drm_dp_aux_unregister_i2c_bus+0x12/0x20 [drm_kms_helper] [ 4.909623] [&lt;ffffffffa01812fc&gt;] radeon_i2c_destroy+0x3c/0x40 [radeon] [ 4.909634] [&lt;ffffffffa018137a&gt;] radeon_i2c_fini+0x2a/0x50 [radeon] [ 4.909645] [&lt;ffffffffa017e6d9&gt;] radeon_modeset_fini+0x89/0x90 [radeon] [ 4.909654] [&lt;ffffffffa0157180&gt;] radeon_driver_unload_kms+0x40/0x60 [radeon] [ 4.909661] [&lt;ffffffffa00497a9&gt;] drm_dev_unregister+0x29/0xb0 [drm] [ 4.909667] [&lt;ffffffffa0049d13&gt;] drm_put_dev+0x23/0x70 [drm] [ 4.909675] [&lt;ffffffffa015327d&gt;] radeon_pci_remove+0x1d/0x20 [radeon] [ 4.909678] [&lt;ffffffff8138fb7b&gt;] pci_device_remove+0x3b/0xb0 [ 4.909681] [&lt;ffffffff8145e48f&gt;] __device_release_driver+0x7f/0xf0 [ 4.909683] [&lt;ffffffff8145e523&gt;] device_release_driver+0x23/0x30 [ 4.909685] [&lt;ffffffff8145d06d&gt;] unbind_store+0xbd/0xe0 [ 4.909687] [&lt;ffffffff8145c574&gt;] drv_attr_store+0x24/0x40 [ 4.909689] [&lt;ffffffff81262c1d&gt;] sysfs_kf_write+0x3d/0x50 [ 4.909691] [&lt;ffffffff812623e0&gt;] kernfs_fop_write+0xe0/0x160 [ 4.909693] [&lt;ffffffff811e67da&gt;] vfs_write+0xba/0x1e0 [ 4.909696] [&lt;ffffffff811e7395&gt;] SyS_write+0x55/0xd0 [ 4.909698] [&lt;ffffffff816ff969&gt;] system_call_fastpath+0x16/0x1b [ 4.909700] ---[ end trace 4a930f0eb6428dcd ]--- [ 4.909742] [drm] radeon: finishing device.</code></pre></div><p>EDIT: Well, I feel like a damn fool. Got it working by applying the arbiter patches to the kernel. When I had checked the patches out I had wrongly assumed they were both intel graphics only patches and so weren&#039;t necessary. This doesn&#039;t seem to be the case with the vga_arbiter_fix though. Windows 8 running with graphics passthrough working beautifully. Going to play with graphics drivers a bit, get it updated to 8.1 and see what kinds of issues I am running into then, if any. Thanks for all of your hard work everyone!</p> <p class="postedit"><em>Last edited by zerotri (2014-08-05 10:44:58)</em></p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1443905">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1444087" class="blockpost roweven"> <h2><span><span class="conr">#2433</span> <a href="viewtopic.php?pid=1444087#p1444087">2014-08-05 20:06:58</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=82227">HPvirt</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2014-05-23</span></dd> <dd><span>Posts: 6</span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>slis wrote:</cite><blockquote><div><p>you need to bind device before u start vm, <em>with systemd service</em> or by hand (vfio-bind 0000:01:00.0 0000:01:00.1, assumin u created vfio-bind script as in first post)</p></div></blockquote></div><p>I know this and I use vfio-bind script ... except the italic part. I know this question is off topic, so I&#039;ve done some research.<br />This is what I found:<br />- Create the file (VFIOBindings.service for example) into /etc/systemd/system<br />- systemctl start VFIOBindings.service<br />- systemctl enable VFIOBindings.service<br />And that&#039;s all.<br />But I would be sure to avoid messing startup.</p><br /><p>I progress... I assigned the ASMedia SATA controller with success.<br />The SSD is recognized by the live CD, and SMART works. Great!</p><p>Tried the ASMedia USB controller too with some succes: at VM boot time, the USB does not work, it&#039;s only when the live CD launch the keyboard and the mouse lights. Is there something wrong or is it normal?<br />This is my command line to launch qemu:</p><div class="codebox"><pre><code>qemu-system-x86_64 -enable-kvm -M q35 -m 4096 -cpu host -smp sockets=1,cores=2,threads=2 -bios /usr/share/qemu/bios.bin -vga none \ -device ioh3420,bus=pcie.0,addr=1c.0,multifunction=on,port=1,chassis=1,id=root.1 \ -device vfio-pci,host=01:00.0,bus=root.1,addr=00.0,multifunction=on,x-vga=on \ -device vfio-pci,host=01:00.1,bus=root.1,addr=00.1 \ -device vfio-pci,host=07:00.0,bus=pcie.0 \ -device vfio-pci,host=09:00.0,bus=pcie.0 \ [b]-device vfio-pci,host=0a:00.0,bus=pcie.0[/b] \ -device ahci,id=ahci0 \ -boot menu=on,oder=d \ -drive file=~/Linux/Mint/64/linuxmint-17-cinnamon-64bit-v2.iso,id=isocd \ -device ide-cd,bus=ide.1,drive=isocd</code></pre></div><p>(bold is ASMedia USB Controller).</p><br /><p>And now, the network part... I tried to passthrough the Realtek Ethernet Controller...<br />lspci gives me:</p><div class="codebox"><pre><code>... 03:00.0 Ethernet controller: Realtek Semiconductor Co., Ltd. RTL8111/8168/8411 PCI Express Gigabit Ethernet Controller (rev 11) ...</code></pre></div><p>So, <em>vfio-bind 0000:03:00.0</em> then launch qemu with: <em>-device vfio-pci,host=03:00.0,bus=pcie.0 -net none</em><br />And it works. I have the Realtek under liveCD and this one.</p><br /><p>So, everything seems to work.<br />Second step done.</p><p>For the moment,&#160; &#160; &#160;<em>options kvm allow_unsafe_assigned_interrupts=1</em> and <em>pcie_acs_override=downstream</em> are not used.</p><p>And now the last one: installing Windows!</p> </div> <div class="postsignature postmsg"><hr /><p>Hardware: ASRock Z97 Extreme 6 - Intel Core i7 4790 - NVidia GTX680<br />Host: Linux Mint 17 Qiana, Kernel 3.15.8 (custom)<br />Guest: Windows Seven Ultimate SP1</p></div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1444087">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1444167" class="blockpost rowodd"> <h2><span><span class="conr">#2434</span> <a href="viewtopic.php?pid=1444167#p1444167">2014-08-06 00:09:06</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=79909">CharlieBra7o</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2014-03-01</span></dd> <dd><span>Posts: 20</span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>monchi wrote:</cite><blockquote><div><p>are the patches from #1 still needed for the recent stabel kernel version 3.16 ?</p></div></blockquote></div><p>I&#039;m using 3.16 RC7 and didn&#039;t have to patch the Intel stuff... Not sure about the other patches though.</p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1444167">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1444454" class="blockpost roweven"> <h2><span><span class="conr">#2435</span> <a href="viewtopic.php?pid=1444454#p1444454">2014-08-06 23:52:03</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=66944">shrubuntu</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2012-12-26</span></dd> <dd><span>Posts: 16</span></dd> <dd class="usercontacts"><span class="email"><a href="misc.php?email=66944">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>kameloc wrote:</cite><blockquote><div><div class="quotebox"><cite>shrubuntu wrote:</cite><blockquote><div><div class="quotebox"><cite>kameloc wrote:</cite><blockquote><div><p>I had this issue on Windows 8 and tried using different cards to emulate with no fix. Switched to Windows 7 and using ac97 (-sound ac97) works really well.</p></div></blockquote></div><div class="codebox"><pre><code>-device ac97,bus=pcie.0,addr=1b.0,id=sound0 \ -device hda-duplex,id=sound0-codec0,bus=sound0.0,cad=0</code></pre></div><p>like this?</p></div></blockquote></div><p>Oh sorry I don&#039;t passthrough my onboard audio, just share it. If you add </p><div class="codebox"><pre><code>-soundhw ac97</code></pre></div><p>It emulates Realtek AC&#039;97 for the guest. It allowed me to use my speakers from the VM or host, and at the same time</p></div></blockquote></div><p>Can you show me the whole command? I can&#039;t seem to get it to work</p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1444454">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1444465" class="blockpost rowodd"> <h2><span><span class="conr">#2436</span> <a href="viewtopic.php?pid=1444465#p1444465">2014-08-07 00:48:22</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=83145">kameloc</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2014-06-28</span></dd> <dd><span>Posts: 11</span></dd> <dd class="usercontacts"><span class="email"><a href="misc.php?email=83145">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>shrubuntu wrote:</cite><blockquote><div><div class="quotebox"><cite>kameloc wrote:</cite><blockquote><div><div class="quotebox"><cite>shrubuntu wrote:</cite><blockquote><div><div class="codebox"><pre><code>-device ac97,bus=pcie.0,addr=1b.0,id=sound0 \ -device hda-duplex,id=sound0-codec0,bus=sound0.0,cad=0</code></pre></div><p>like this?</p></div></blockquote></div><p>Oh sorry I don&#039;t passthrough my onboard audio, just share it. If you add </p><div class="codebox"><pre><code>-soundhw ac97</code></pre></div><p>It emulates Realtek AC&#039;97 for the guest. It allowed me to use my speakers from the VM or host, and at the same time</p></div></blockquote></div><p>Can you show me the whole command? I can&#039;t seem to get it to work</p></div></blockquote></div><p>This is how I start my VM. Only passthrough my GPU and a USB device. Emulate ac97 at the end.</p><p>sudo -E qemu-system-x86_64 -enable-kvm \<br />-M q35 \<br />-cpu host \<br />-smp 4,cores=4,threads=8,sockets=1 \<br />-m 6122 \<br />-rtc base=localtime,clock=host \<br />-balloon virtio \<br />-boot menu=on \<br />-bios /usr/share/qemu/bios.bin \<br />-vga none \<br />-usbdevice host:0d8c:0008 \<br />-device ioh3420,bus=pcie.0,addr=1c.0,multifunction=on,port=1,chassis=1,id=root.1 \<br />-device vfio-pci,host=01:00.0,bus=root.1,addr=00.0,romfile=/home/kameloc/windows7/EVGA.GTX550Ti.1024.121031.rom,multifunction=on,x-vga=on \<br />-device piix4-ide,bus=pcie.0,id=piix4-ide \<br />-drive file=/home/kameloc/windows7/windows7.img,id=disk,format=raw -device ide-hd,bus=piix4-ide.0,drive=disk \<br />-net nic,macaddr=DE:AD:BE:EF:00:00 \<br />-net bridge,br=br0 \<br />-soundhw ac97</p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1444465">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1444523" class="blockpost roweven"> <h2><span><span class="conr">#2437</span> <a href="viewtopic.php?pid=1444523#p1444523">2014-08-07 08:21:41</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=82227">HPvirt</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2014-05-23</span></dd> <dd><span>Posts: 6</span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>slis wrote:</cite><blockquote><div><p>about ssd... i am not sure, but i think u need to pass whole sata controller to use trim etc...</p></div></blockquote></div><p>With whole sata controller passed, I can start Win7 installation (copying file, uncompress), but at reboot time to finish installation, QEmu/SeaBios do not see the SSD anymore so cannot boot on it. If I try the installation from scratch once more, the installer see the SSD.</p><p>This is the qemu commande I used:</p><div class="codebox"><pre><code>qemu-system-x86_64 -enable-kvm -M q35 -m 4096 -cpu host -smp sockets=1,cores=2,threads=2 -bios /usr/share/qemu/bios.bin -vga none \ -device ioh3420,bus=pcie.0,addr=1c.0,multifunction=on,port=1,chassis=1,id=root.1 \ -device vfio-pci,host=01:00.0,bus=root.1,addr=00.0,multifunction=on,x-vga=on \ -device vfio-pci,host=01:00.1,bus=root.1,addr=00.1 \ -device vfio-pci,host=03:00.0,bus=pcie.0 \ -device vfio-pci,host=07:00.0,bus=pcie.0 \ -device vfio-pci,host=09:00.0,bus=pcie.0 \ -device vfio-pci,host=0a:00.0,bus=pcie.0 \ -boot menu=on,oder=d \ -drive file=~/Win7SP1.iso,id=isocd \ -device ide-cd,bus=ide.1,drive=isocd \ -net none</code></pre></div><p>I have to add:</p><div class="codebox"><pre><code>-usb \ -usbdevice host=xxxx:xxxx \ -usbdevice host=xxxx:xxxx \</code></pre></div><p>for mouse and keyboard as ASMedia USB controller does not seem initialized by seabios (or qemu) at boot time, so cannot use them during Win7 installation.</p><p>So, I have 2 problems that I need help:<br />- USB initialization at boot<br />- SSD no more visible by qemu/seabios after first phase of Win7 installation</p><p>I&#039;ve googled each problem, but I&#039;ve not found anything valuable <img src="https://bbs.archlinux.org/img/smilies/sad.png" width="15" height="15" alt="sad" /></p> </div> <div class="postsignature postmsg"><hr /><p>Hardware: ASRock Z97 Extreme 6 - Intel Core i7 4790 - NVidia GTX680<br />Host: Linux Mint 17 Qiana, Kernel 3.15.8 (custom)<br />Guest: Windows Seven Ultimate SP1</p></div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1444523">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1444645" class="blockpost rowodd"> <h2><span><span class="conr">#2438</span> <a href="viewtopic.php?pid=1444645#p1444645">2014-08-07 18:19:35</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=82238">sinny</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2014-05-24</span></dd> <dd><span>Posts: 75</span></dd> <dd class="usercontacts"><span class="email"><a href="misc.php?email=82238">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>HPvirt wrote:</cite><blockquote><div><div class="quotebox"><cite>slis wrote:</cite><blockquote><div><p>about ssd... i am not sure, but i think u need to pass whole sata controller to use trim etc...</p></div></blockquote></div><p>With whole sata controller passed, I can start Win7 installation (copying file, uncompress), but at reboot time to finish installation, QEmu/SeaBios do not see the SSD anymore so cannot boot on it. If I try the installation from scratch once more, the installer see the SSD.</p><p>This is the qemu commande I used:</p><div class="codebox"><pre><code>qemu-system-x86_64 -enable-kvm -M q35 -m 4096 -cpu host -smp sockets=1,cores=2,threads=2 -bios /usr/share/qemu/bios.bin -vga none \ -device ioh3420,bus=pcie.0,addr=1c.0,multifunction=on,port=1,chassis=1,id=root.1 \ -device vfio-pci,host=01:00.0,bus=root.1,addr=00.0,multifunction=on,x-vga=on \ -device vfio-pci,host=01:00.1,bus=root.1,addr=00.1 \ -device vfio-pci,host=03:00.0,bus=pcie.0 \ -device vfio-pci,host=07:00.0,bus=pcie.0 \ -device vfio-pci,host=09:00.0,bus=pcie.0 \ -device vfio-pci,host=0a:00.0,bus=pcie.0 \ -boot menu=on,oder=d \ -drive file=~/Win7SP1.iso,id=isocd \ -device ide-cd,bus=ide.1,drive=isocd \ -net none</code></pre></div><p>I have to add:</p><div class="codebox"><pre><code>-usb \ -usbdevice host=xxxx:xxxx \ -usbdevice host=xxxx:xxxx \</code></pre></div><p>for mouse and keyboard as ASMedia USB controller does not seem initialized by seabios (or qemu) at boot time, so cannot use them during Win7 installation.</p><p>So, I have 2 problems that I need help:<br />- USB initialization at boot<br />- SSD no more visible by qemu/seabios after first phase of Win7 installation</p><p>I&#039;ve googled each problem, but I&#039;ve not found anything valuable :(</p></div></blockquote></div><p>maybe &quot;-no-reboot&quot; qemu parameter may serve you as a workaround?</p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1444645">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1444907" class="blockpost roweven"> <h2><span><span class="conr">#2439</span> <a href="viewtopic.php?pid=1444907#p1444907">2014-08-08 15:07:42</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=82094">Namelles_One</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2014-05-18</span></dd> <dd><span>Posts: 8</span></dd> <dd class="usercontacts"><span class="email"><a href="misc.php?email=82094">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <p>So, I was updated to qemu 2.1 on Gentoo and get input grabbing problems like in this <a href="https://www.mail-archive.com/qemu-devel@nongnu.org/msg249496.html" rel="nofollow">thread</a></p><p>But I can&#039;t understand, how to fix it? Can I do this, or I will downgrade to qemu 2.0?</p><p>Thx.</p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1444907">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1444967" class="blockpost rowodd"> <h2><span><span class="conr">#2440</span> <a href="viewtopic.php?pid=1444967#p1444967">2014-08-08 18:39:44</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=73655">irtimmer</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2013-07-30</span></dd> <dd><span>Posts: 3</span></dd> <dd class="usercontacts"><span class="email"><a href="misc.php?email=73655">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <p>I never know it was possible to grab the mouse and keyboard with -vga none in Qemu 2.0 as it also don&#039;t work in Qemu &lt; 2.0. But a simple fix is to add <br />&quot;-device qxl&quot;</p> </div> <div class="postsignature postmsg"><hr /><p>I can read and write in English, but my english grammar is just horrible.</p></div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1444967">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1445151" class="blockpost roweven"> <h2><span><span class="conr">#2441</span> <a href="viewtopic.php?pid=1445151#p1445151">2014-08-09 11:31:34</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=72881">alexis_evo</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2013-07-04</span></dd> <dd><span>Posts: 33</span></dd> <dd class="usercontacts"><span class="email"><a href="misc.php?email=72881">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <p>Have a huge problem, no idea how to fix it, really need help as it makes a game I&#039;m playing unplayable.</p><p>Final Fantasy XIV (an MMO) disconnects every hour. After spending ~8 hours trying to figure out why, I&#039;ve narrowed it down to the cause but can&#039;t find a solution.</p><p>Every hour, the Windows VM&#039;s clock drifts to 3-4 minutes behind the real time. Windows detects this and fixes it. All applications that use the system clock then freak out as time just jumped forward 3-4 minutes, including FFXIV which causes you to disconnect.</p><div class="codebox"><pre><code>The system time has changed to 2014-08-09T11:23:48.500000000Z from 2014-08-09T11:22:27.765200000Z.</code></pre></div><p>This is the message shown in Windows Event Viewer, pointing out the change. I&#039;ve tried adding two things to qemu to fix it.</p><div class="codebox"><pre><code>-rtc clock=vm,base=localtime,driftfix=slew</code></pre></div><div class="codebox"><pre><code>-rtc base=utc,driftfix=slew</code></pre></div><p>Neither of these have worked. The first one has worked the best, and has the drift down to 1 minute per hour, but that is still unacceptable and causes a disconnect. My computers RTC (in BIOS) is set to UTC time, and the time in Arch is changed via timezones to UTC-6 (MST).</p><p>Has anyone figured this out? <img src="https://bbs.archlinux.org/img/smilies/hmm.png" width="15" height="15" alt="hmm" /> kinda desperate, need my MMO fix lol.</p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1445151">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1445156" class="blockpost rowodd"> <h2><span><span class="conr">#2442</span> <a href="viewtopic.php?pid=1445156#p1445156">2014-08-09 11:48:32</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=58169">aldum</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd class="postavatar"><img src="https://bbs.archlinux.org/img/avatars/58169.jpg?m=1401983659" width="80" height="80" alt="" /></dd> <dd><span>Registered: 2012-03-14</span></dd> <dd><span>Posts: 7</span></dd> <dd class="usercontacts"><span class="email"><a href="misc.php?email=58169">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>alexis_evo wrote:</cite><blockquote><div><p>Has anyone figured this out? <img src="https://bbs.archlinux.org/img/smilies/hmm.png" width="15" height="15" alt="hmm" /> kinda desperate, need my MMO fix lol.</p></div></blockquote></div><p>You could either try to make it refresh more often so it wouldn&#039;t jump as much at once, or turn off the automatic time correction altogether and update time by hand after quitting the game <img src="https://bbs.archlinux.org/img/smilies/smile.png" width="15" height="15" alt="smile" /><br />Key to modify:<br />HKEY_LOCAL_MACHINE\SYSTEM\ControlSet001\services\W32Time\TimeProviders\NtpClient\SpecialPollInterval (seconds)</p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1445156">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1445212" class="blockpost roweven"> <h2><span><span class="conr">#2443</span> <a href="viewtopic.php?pid=1445212#p1445212">2014-08-09 15:06:45</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=82094">Namelles_One</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2014-05-18</span></dd> <dd><span>Posts: 8</span></dd> <dd class="usercontacts"><span class="email"><a href="misc.php?email=82094">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>irtimmer wrote:</cite><blockquote><div><p>I never know it was possible to grab the mouse and keyboard with -vga none in Qemu 2.0 as it also don&#039;t work in Qemu &lt; 2.0. But a simple fix is to add <br />&quot;-device qxl&quot;</p></div></blockquote></div><p>This don&#039;t help me. On Qemu 2.0 I was clicking on black window and my VM grab my input. How to do this with 2.1?</p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1445212">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1445223" class="blockpost rowodd"> <h2><span><span class="conr">#2444</span> <a href="viewtopic.php?pid=1445223#p1445223">2014-08-09 15:56:37</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=80387">dwe11er</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2014-03-18</span></dd> <dd><span>Posts: 73</span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>alexis_evo wrote:</cite><blockquote><div><p>Have a huge problem, no idea how to fix it, really need help as it makes a game I&#039;m playing unplayable.</p><p>Final Fantasy XIV (an MMO) disconnects every hour. After spending ~8 hours trying to figure out why, I&#039;ve narrowed it down to the cause but can&#039;t find a solution.</p><p>Every hour, the Windows VM&#039;s clock drifts to 3-4 minutes behind the real time. Windows detects this and fixes it. All applications that use the system clock then freak out as time just jumped forward 3-4 minutes, including FFXIV which causes you to disconnect.</p><div class="codebox"><pre><code>The system time has changed to 2014-08-09T11:23:48.500000000Z from 2014-08-09T11:22:27.765200000Z.</code></pre></div><p>This is the message shown in Windows Event Viewer, pointing out the change. I&#039;ve tried adding two things to qemu to fix it.</p><div class="codebox"><pre><code>-rtc clock=vm,base=localtime,driftfix=slew</code></pre></div><div class="codebox"><pre><code>-rtc base=utc,driftfix=slew</code></pre></div><p>Neither of these have worked. The first one has worked the best, and has the drift down to 1 minute per hour, but that is still unacceptable and causes a disconnect. My computers RTC (in BIOS) is set to UTC time, and the time in Arch is changed via timezones to UTC-6 (MST).</p><p>Has anyone figured this out? <img src="https://bbs.archlinux.org/img/smilies/hmm.png" width="15" height="15" alt="hmm" /> kinda desperate, need my MMO fix lol.</p></div></blockquote></div><p>I&#039;ve stumbled upon this issue, when all of hosts cores/threads where assigned to vm. Host was doing something in the background, while I was playing on Windows.</p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1445223">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1445319" class="blockpost roweven"> <h2><span><span class="conr">#2445</span> <a href="viewtopic.php?pid=1445319#p1445319">2014-08-09 19:24:28</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=72881">alexis_evo</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2013-07-04</span></dd> <dd><span>Posts: 33</span></dd> <dd class="usercontacts"><span class="email"><a href="misc.php?email=72881">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>aldum wrote:</cite><blockquote><div><div class="quotebox"><cite>alexis_evo wrote:</cite><blockquote><div><p>Has anyone figured this out? <img src="https://bbs.archlinux.org/img/smilies/hmm.png" width="15" height="15" alt="hmm" /> kinda desperate, need my MMO fix lol.</p></div></blockquote></div><p>You could either try to make it refresh more often so it wouldn&#039;t jump as much at once, or turn off the automatic time correction altogether and update time by hand after quitting the game <img src="https://bbs.archlinux.org/img/smilies/smile.png" width="15" height="15" alt="smile" /><br />Key to modify:<br />HKEY_LOCAL_MACHINE\SYSTEM\ControlSet001\services\W32Time\TimeProviders\NtpClient\SpecialPollInterval (seconds)</p></div></blockquote></div><p>I appreciate the help, but I don&#039;t think the issue is NTP. I&#039;ve already disabled NTP in Windows. It&#039;s my understanding that there&#039;s three clocks on a computer. The RTC (hardware level, set in BIOS, battery backed), the system time (low level, set by the RTC on boot, never changes, used for timing by games/etc), and the local clock (the time displayed, synced by NTP). The problem is the system time is drifting off of the RTC. Windows checks it every hour and sees how much it has drifted, then snaps it back into place. XIV expects this time to never ever change, so it messes seriously with the ping thread/connection.</p><div class="quotebox"><cite>dwe11er wrote:</cite><blockquote><div><p>I&#039;ve stumbled upon this issue, when all of hosts cores/threads where assigned to vm. Host was doing something in the background, while I was playing on Windows.</p></div></blockquote></div><p>I don&#039;t see why the # of cores would matter, Windows isn&#039;t eating up all available CPU time, but I&#039;ll try dropping it down to 7 cores anyway. Also tried adding &quot;hv-time&quot; to &quot;-cpu host, hv-time&quot;, as it looks like that should fix it. I guess time will tell...</p> <p class="postedit"><em>Last edited by alexis_evo (2014-08-09 19:24:45)</em></p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1445319">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1445321" class="blockpost rowodd"> <h2><span><span class="conr">#2446</span> <a href="viewtopic.php?pid=1445321#p1445321">2014-08-09 19:27:21</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=82643">abdullah</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2014-06-10</span></dd> <dd><span>Posts: 33</span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <p>Is the KVM=off applied in Qemu 2.1.0 ? it was released 8 days ago, do I still need the Qemu-git ?<br />And I did compile the Qemu-git, yet I receive BSOD in windows, and I can not pass the USB devices with -usb -usbdevice host:*:* anymore.</p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1445321">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1445336" class="blockpost roweven"> <h2><span><span class="conr">#2447</span> <a href="viewtopic.php?pid=1445336#p1445336">2014-08-09 20:07:56</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=72881">alexis_evo</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2013-07-04</span></dd> <dd><span>Posts: 33</span></dd> <dd class="usercontacts"><span class="email"><a href="misc.php?email=72881">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <p>Still happening.</p><div class="codebox"><pre><code>The system time has changed to 2014-08-09T20:07:47.500000000Z from 2014-08-09T20:05:54.641000000Z.</code></pre></div> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1445336">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1445379" class="blockpost rowodd"> <h2><span><span class="conr">#2448</span> <a href="viewtopic.php?pid=1445379#p1445379">2014-08-09 22:17:42</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=80387">dwe11er</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2014-03-18</span></dd> <dd><span>Posts: 73</span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>alexis_evo wrote:</cite><blockquote><div><div class="quotebox"><cite>aldum wrote:</cite><blockquote><div><div class="quotebox"><cite>alexis_evo wrote:</cite><blockquote><div><p>Has anyone figured this out? <img src="https://bbs.archlinux.org/img/smilies/hmm.png" width="15" height="15" alt="hmm" /> kinda desperate, need my MMO fix lol.</p></div></blockquote></div><p>You could either try to make it refresh more often so it wouldn&#039;t jump as much at once, or turn off the automatic time correction altogether and update time by hand after quitting the game <img src="https://bbs.archlinux.org/img/smilies/smile.png" width="15" height="15" alt="smile" /><br />Key to modify:<br />HKEY_LOCAL_MACHINE\SYSTEM\ControlSet001\services\W32Time\TimeProviders\NtpClient\SpecialPollInterval (seconds)</p></div></blockquote></div><p>I appreciate the help, but I don&#039;t think the issue is NTP. I&#039;ve already disabled NTP in Windows. It&#039;s my understanding that there&#039;s three clocks on a computer. The RTC (hardware level, set in BIOS, battery backed), the system time (low level, set by the RTC on boot, never changes, used for timing by games/etc), and the local clock (the time displayed, synced by NTP). The problem is the system time is drifting off of the RTC. Windows checks it every hour and sees how much it has drifted, then snaps it back into place. XIV expects this time to never ever change, so it messes seriously with the ping thread/connection.</p><div class="quotebox"><cite>dwe11er wrote:</cite><blockquote><div><p>I&#039;ve stumbled upon this issue, when all of hosts cores/threads where assigned to vm. Host was doing something in the background, while I was playing on Windows.</p></div></blockquote></div><p>I don&#039;t see why the # of cores would matter, Windows isn&#039;t eating up all available CPU time, but I&#039;ll try dropping it down to 7 cores anyway. Also tried adding &quot;hv-time&quot; to &quot;-cpu host, hv-time&quot;, as it looks like that should fix it. I guess time will tell...</p></div></blockquote></div><p>It&#039;s because of load on every core host can&#039;t keep up with clock emulation. I&#039;m guessing here.</p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1445379">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1445383" class="blockpost roweven"> <h2><span><span class="conr">#2449</span> <a href="viewtopic.php?pid=1445383#p1445383">2014-08-09 22:28:49</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=72881">alexis_evo</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2013-07-04</span></dd> <dd><span>Posts: 33</span></dd> <dd class="usercontacts"><span class="email"><a href="misc.php?email=72881">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <p>CPU has 8 cores, at most I&#039;m ever using 300%. There&#039;s more than enough CPU time on the host to do things it needs. I lowered Windows to 7 cores and it still drifts. I&#039;ve tried a couple different options now and it still drifts. It&#039;s annoying as it takes an hour to test every time, as it takes an hour for Windows to pick up on the drift and adjust system time. Should know in a couple of minutes if the latest incantation worked...</p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1445383">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1445385" class="blockpost rowodd"> <h2><span><span class="conr">#2450</span> <a href="viewtopic.php?pid=1445385#p1445385">2014-08-09 22:31:39</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=58169">aldum</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd class="postavatar"><img src="https://bbs.archlinux.org/img/avatars/58169.jpg?m=1401983659" width="80" height="80" alt="" /></dd> <dd><span>Registered: 2012-03-14</span></dd> <dd><span>Posts: 7</span></dd> <dd class="usercontacts"><span class="email"><a href="misc.php?email=58169">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>alexis_evo wrote:</cite><blockquote><div><p>I appreciate the help, but I don&#039;t think the issue is NTP. I&#039;ve already disabled NTP in Windows. It&#039;s my understanding that there&#039;s three clocks on a computer. The RTC (hardware level, set in BIOS, battery backed), the system time (low level, set by the RTC on boot, never changes, used for timing by games/etc), and the local clock (the time displayed, synced by NTP). The problem is the system time is drifting off of the RTC.</p></div></blockquote></div><p>Ok, so you tried turning it off, now try the other way: have it update every 5 minutes.</p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1445385">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div class="postlinksb"> <div class="inbox crumbsplus"> <div class="pagepost"> <p class="pagelink conl"><span class="pages-label">Pages: </span><a rel="prev" class="item1" href="viewtopic.php?id=162768&amp;p=97">Previous</a> <a href="viewtopic.php?id=162768">1</a> <span class="spacer">…</span> <a href="viewtopic.php?id=162768&amp;p=96">96</a> <a href="viewtopic.php?id=162768&amp;p=97">97</a> <strong>98</strong> <a href="viewtopic.php?id=162768&amp;p=99">99</a> <a href="viewtopic.php?id=162768&amp;p=100">100</a> <span class="spacer">…</span> <a href="viewtopic.php?id=162768&amp;p=234">234</a> <a rel="next" href="viewtopic.php?id=162768&amp;p=99">Next</a></p> <p class="postlink conr">Topic closed</p> </div> <ul class="crumbs"> <li><a href="index.php">Index</a></li> <li><span>»&#160;</span><a href="viewforum.php?id=48">Topics Going Nowhere</a></li> <li><span>»&#160;</span><strong><a href="viewtopic.php?id=162768">KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</a></strong></li> </ul> <p class="subscribelink clearb"><a href="misc.php?action=subscribe&amp;tid=162768">Subscribe to this topic</a></p> <div class="clearer"></div> </div> </div> </div> <div id="brdfooter" class="block"> <h2><span>Board footer</span></h2> <div class="box"> <div id="brdfooternav" class="inbox"> <div class="conl"> <form id="qjump" method="get" action="viewforum.php"> <div><label><span>Jump to<br /></span> <select name="id" onchange="window.location=('viewforum.php?id='+this.options[this.selectedIndex].value)"> <optgroup label="Technical Issues and Assistance"> <option value="23">Newbie Corner</option> <option value="17">Installation</option> <option value="22">Kernel &amp; Hardware</option> <option value="18">Applications &amp; Desktop Environments</option> <option value="31">Laptop Issues</option> <option value="8">Networking, Server, and Protection</option> <option value="32">Multimedia and Games</option> <option value="50">System Administration</option> <option value="35">Other Architectures</option> </optgroup> <optgroup label="Arch-centric"> <option value="24">Announcements, Package &amp; Security Advisories</option> <option value="1">Arch Discussion</option> <option value="13">Forum &amp; Wiki discussion</option> </optgroup> <optgroup label="Pacman Upgrades, Packaging &amp; AUR"> <option value="44">Pacman &amp; Package Upgrade Issues</option> <option value="49">[testing] Repo Forum</option> <option value="4">Creating &amp; Modifying Packages</option> <option value="38">AUR Issues, Discussion &amp; PKGBUILD Requests</option> </optgroup> <optgroup label="Contributions &amp; Discussion"> <option value="20">GNU/Linux Discussion</option> <option value="27">Community Contributions</option> <option value="33">Programming &amp; Scripting</option> <option value="30">Other Languages</option> <option value="47">Artwork and Screenshots</option> <option value="42">Try This</option> </optgroup> <optgroup label="/dev/null"> <option value="29">Off-Topic</option> <option value="48" selected="selected">Topics Going Nowhere</option> <option value="36">Dustbin</option> </optgroup> </select></label> <input type="submit" value=" Go " accesskey="g" /> </div> </form> </div> <div class="conr"> <p id="feedlinks"><span class="atom"><a href="extern.php?action=feed&amp;tid=162768&amp;type=atom">Atom topic feed</a></span></p> <p id="poweredby">Powered by <a href="http://fluxbb.org/">FluxBB</a></p> </div> <div class="clearer"></div> </div> </div> </div> </div> <div class="end-box"></div> </div> </body> </html>
