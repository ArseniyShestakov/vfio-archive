<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"> <html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en" dir="ltr"> <head> <meta http-equiv="Content-Type" content="text/html; charset=utf-8" /> <title>KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9 (Page 136) / Topics Going Nowhere / Arch Linux Forums</title> <link rel="stylesheet" type="text/css" href="style/ArchLinux.css" /> <link rel="canonical" href="viewtopic.php?id=162768&amp;p=136" title="Page 136" /> <link rel="prev" href="viewtopic.php?id=162768&amp;p=135" title="Page 135" /> <link rel="next" href="viewtopic.php?id=162768&amp;p=137" title="Page 137" /> <link rel="alternate" type="application/atom+xml" href="extern.php?action=feed&amp;tid=162768&amp;type=atom" title="Atom topic feed" /> <link rel="stylesheet" media="screen" href="style/ArchLinux/arch.css?v=3" /> <link rel="stylesheet" media="screen" href="style/ArchLinux/archnavbar.css?v=2" /> <link rel="shortcut icon" href="style/ArchLinux/favicon.ico" /> </head> <body> <div id="archnavbar" class="anb-forum"> <div id="archnavbarlogo"><h1><a href="http://www.archlinux.org/">Arch Linux</a></h1></div> <div id="archnavbarmenu"> <ul id="archnavbarlist"> <li id="anb-home"><a href="http://www.archlinux.org/">Home</a></li><li id="anb-packages"><a href="http://www.archlinux.org/packages/">Packages</a></li><li id="anb-forums" class="anb-selected"><a href="https://bbs.archlinux.org/">Forums</a></li><li id="anb-wiki"><a href="https://wiki.archlinux.org/">Wiki</a></li><li id="anb-bugs"><a href="https://bugs.archlinux.org/">Bugs</a></li><li id="anb-aur"><a href="https://aur.archlinux.org/">AUR</a></li><li id="anb-download"><a href="http://www.archlinux.org/download/">Download</a></li> </ul> </div> </div> <div id="punviewtopic" class="pun"> <div class="top-box"></div> <div class="punwrap"> <div id="brdheader" class="block"> <div class="box"> <div id="brdmenu" class="inbox"> <ul> <li id="navindex" class="isactive"><a href="index.php">Index</a></li> <li id="navuserlist"><a href="userlist.php">User list</a></li> <li id="navsearch"><a href="search.php">Search</a></li> <li id="navprofile"><a href="profile.php?id=80749">Profile</a></li> <li id="navlogout"><a href="login.php?action=out&amp;id=80749&amp;csrf_token=5c20501ec397bb45ef8ee8c84db232c8d8e421c6">Logout</a></li> </ul> </div> <div id="brdwelcome" class="inbox"> <ul class="conl"> <li><span>Logged in as <strong>SXX</strong></span></li> <li><span>Last visit: 2015-08-16 12:20:09</span></li> </ul> <ul class="conr"> <li><span>Topics: <a href="search.php?action=show_replies" title="Find topics you have posted to.">Posted</a> | <a href="search.php?action=show_new" title="Find topics with new posts since your last visit.">New</a> | <a href="search.php?action=show_recent" title="Find topics with recent posts.">Active</a> | <a href="search.php?action=show_unanswered" title="Find topics with no replies.">Unanswered</a></span></li> </ul> <div class="clearer"></div> </div> </div> </div> <div id="brdmain"> <div class="linkst"> <div class="inbox crumbsplus"> <ul class="crumbs"> <li><a href="index.php">Index</a></li> <li><span>»&#160;</span><a href="viewforum.php?id=48">Topics Going Nowhere</a></li> <li><span>»&#160;</span><strong><a href="viewtopic.php?id=162768">KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</a></strong></li> </ul> <div class="pagepost"> <p class="pagelink conl"><span class="pages-label">Pages: </span><a rel="prev" class="item1" href="viewtopic.php?id=162768&amp;p=135">Previous</a> <a href="viewtopic.php?id=162768">1</a> <span class="spacer">…</span> <a href="viewtopic.php?id=162768&amp;p=134">134</a> <a href="viewtopic.php?id=162768&amp;p=135">135</a> <strong>136</strong> <a href="viewtopic.php?id=162768&amp;p=137">137</a> <a href="viewtopic.php?id=162768&amp;p=138">138</a> <span class="spacer">…</span> <a href="viewtopic.php?id=162768&amp;p=234">234</a> <a rel="next" href="viewtopic.php?id=162768&amp;p=137">Next</a></p> <p class="postlink conr">Topic closed</p> </div> <div class="clearer"></div> </div> </div> <div id="p1478249" class="blockpost rowodd blockpost1"> <h2><span><span class="conr">#3376</span> <a href="viewtopic.php?pid=1478249#p1478249">2014-11-23 10:53:36</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=84760">Denso</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd class="postavatar"><img src="https://bbs.archlinux.org/img/avatars/84760.png?m=1412533733" width="71" height="80" alt="" /></dd> <dd><span>Registered: 2014-08-30</span></dd> <dd><span>Posts: 179</span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><blockquote><div><p>Unfortunately, I&#039;m still with error 43. Version 340.52.</p></div></blockquote></div><p>Maybe it&#039;s a hardware issue , did others have success passing through the same GPU as yours ?</p><p>Anyway , you&#039;re missing an extra line regarding OVMF . You need two files , please see my post :</p><p><a href="https://bbs.archlinux.org/viewtopic.php?pid=1466309#p1466309" rel="nofollow">https://bbs.archlinux.org/viewtopic.php … 9#p1466309</a></p><p>Best of luck <img src="https://bbs.archlinux.org/img/smilies/smile.png" width="15" height="15" alt="smile" /></p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1478249">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1478256" class="blockpost roweven"> <h2><span><span class="conr">#3377</span> <a href="viewtopic.php?pid=1478256#p1478256">2014-11-23 11:34:28</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=86321">thearcherblog</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2014-10-30</span></dd> <dd><span>Posts: 165</span></dd> <dd class="usercontacts"><span class="email"><a href="mailto:jjgarcianorway@gmail.com">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>Denso wrote:</cite><blockquote><div><div class="quotebox"><blockquote><div><p>Unfortunately, I&#039;m still with error 43. Version 340.52.</p></div></blockquote></div><p>Maybe it&#039;s a hardware issue , did others have success passing through the same GPU as yours ?</p><p>Anyway , you&#039;re missing an extra line regarding OVMF . You need two files , please see my post :</p><p><a href="https://bbs.archlinux.org/viewtopic.php?pid=1466309#p1466309" rel="nofollow">https://bbs.archlinux.org/viewtopic.php … 9#p1466309</a></p><p>Best of luck <img src="https://bbs.archlinux.org/img/smilies/smile.png" width="15" height="15" alt="smile" /></p></div></blockquote></div><p>Hello sir <img src="https://bbs.archlinux.org/img/smilies/smile.png" width="15" height="15" alt="smile" /></p><p>It&#039;s truth, I forgot the second bios parameter...</p><p>I made a copy of the bin fine and put it inseide my VM directory with the win7_bios.bin name</p><p>Started the whole thing with:</p><div class="codebox"><pre><code>sudo qemu-system-x86_64 -name main -enable-kvm -localtime -m 8192 -cpu host,kvm=off -drive if=pflash,format=raw,readonly,file=/usr/share/ovmf/x64/ovmf_code_x64.bin -drive if=pflash,format=raw,file=/home/jgomez/VM/win7_bios.bin -smp sockets=1,cores=4 -serial none -parallel none -nodefconfig -drive file=/home/jgomez/VM/win7.img,cache=writeback,if=none,id=drive0,aio=native -device virtio-blk-pci,drive=drive0,ioeventfd=on,bootindex=1 -device virtio-scsi-pci,id=scsi -drive file=/home/jgomez/Downloads/win8.iso,id=iso_install,if=none -device scsi-cd,drive=iso_install -device vfio-pci,host=01:00.0,multifunction=on -device vfio-pci,host=01:00.1 -cdrom /home/jgomez/Downloads/virtio.iso -vga none</code></pre></div><p>But even when the QEMU monitor starts, seems like is not booting or nothing happens (teamviewer does not see the computer).</p><p>I also tried with -vga cirrus but black screen. If I remove the &quot;sencond&quot; bios parameters works as usual.</p><p>Regards,</p><br /><p>TheArcher</p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1478256">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1478257" class="blockpost rowodd"> <h2><span><span class="conr">#3378</span> <a href="viewtopic.php?pid=1478257#p1478257">2014-11-23 11:34:56</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=58583">Nesousx</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2012-03-27</span></dd> <dd><span>Posts: 46</span></dd> <dd class="usercontacts"><span class="email"><a href="misc.php?email=58583">Email</a></span> <span class="website"><a href="https://www.kodi-xbmc.com/" rel="nofollow">Website</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <p>Hi all,</p><p>I have a working setup based on Intel CPU and Z77 chipset + GTX 970 as graphic cards. However I have one question, and one issue.</p><p>First, here is my question: whats the point using a bios dump (from graphic card) in the qemu command-line? I am not doing it yet and everything seems ok. Good performance, VM reboots ok, etc.</p><p>Then, my little issue. I have an USB sound card : Asus Xonar U7. If I use it on a USB hub (shared with my mouse + keyboard), then I have some sound issues. It stutters sometimes, and causes lag. Only happens during games; never while watching a movie / youtube / listening to music.<br />I decided to go with emulated audio (cf. command line below). Now i non longer have those sound / lags issue. However I have a little latency in sound. All the time. The sound occurs half a second (or even less) after the real action. I tried with various PA samples from 128 to 16384 (cf. command line). 128 to 512 is unusable, audio lag and video lag. And high values (above 4096) make the latency higher. So far, it seems that the best value is 1024.</p><p>Do you have any idea what to do? </p><p>Let me know if you need additional information.<br />Thanks in advance.</p><p>Edit ; HDMI audio is not a solution since my screen as no audio jack output (and on screen&#039;s speaker are just horrible).</p><p>Command line:</p><div class="codebox"><pre><code>QEMU_PA_SAMPLES=1024 QEMU_AUDIO_DRV=pa \ qemu-system-x86_64 -name game -M q35 -enable-kvm \ -mem-path /dev/hugepages \ -balloon virtio \ -nographic \ -m 16384 \ -cpu host,kvm=off -smp 4,sockets=1,cores=4,threads=1 \ -bios /usr/share/qemu/bios.bin -realtime mlock=on -vga none \ -device ioh3420,bus=pcie.0,addr=1c.0,multifunction=on,port=1,chassis=1,id=root.1 \ -device vfio-pci,host=01:00.0,bus=root.1,addr=00.0,multifunction=on,x-vga=on \ -device vfio-pci,host=01:00.1,bus=pcie.0 \ -device virtio-scsi-pci,id=scsi \ -drive file=/dev/guest/Windaube_7,id=sys,format=raw -device scsi-hd,drive=sys \ -drive file=/dev/guest/win7,id=data,format=raw -device scsi-hd,drive=data \ -device vfio-pci,host=00:1d.0,bus=pcie.0 \ -device virtio-scsi-pci,id=scsi2 \ -net nic,model=virtio,macaddr=52:54:00:7c:3c:42 -net bridge,br=virbr0 \ -device ich9-intel-hda,bus=pcie.0,addr=1b.0,id=sound0 \ -device hda-duplex,id=sound0-codec0,bus=sound0.0,cad=0</code></pre></div> <p class="postedit"><em>Last edited by Nesousx (2014-11-23 15:23:59)</em></p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1478257">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1478290" class="blockpost roweven"> <h2><span><span class="conr">#3379</span> <a href="viewtopic.php?pid=1478290#p1478290">2014-11-23 14:39:44</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=84760">Denso</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd class="postavatar"><img src="https://bbs.archlinux.org/img/avatars/84760.png?m=1412533733" width="71" height="80" alt="" /></dd> <dd><span>Registered: 2014-08-30</span></dd> <dd><span>Posts: 179</span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><blockquote><div><p>I also tried with -vga cirrus but black screen. If I remove the &quot;sencond&quot; bios parameters works as usual.</p></div></blockquote></div><p>I think it is because you&#039;ve already installed Windows . Windows writes its VARS during the installation process .</p><div class="quotebox"><blockquote><div><p>First, here is my question: whats the point using a bios dump (from graphic card) in the qemu command-line? I am not doing it yet and everything seems ok. Good performance, VM reboots ok, etc.</p></div></blockquote></div><p>BIOS dumps are not needed if your VGA passthrough is working correctly . You won&#039;t notice any difference in performance if you provided a BIOS ROM file for your GPU .</p><p>Sorry , I passthrough-ed the onboard sound to my VM and it is working perfectly . Also HDMI (GPU) sound works aswell . I can&#039;t help with emulated sound cards .</p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1478290">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1478307" class="blockpost rowodd"> <h2><span><span class="conr">#3380</span> <a href="viewtopic.php?pid=1478307#p1478307">2014-11-23 15:25:01</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=58583">Nesousx</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2012-03-27</span></dd> <dd><span>Posts: 46</span></dd> <dd class="usercontacts"><span class="email"><a href="misc.php?email=58583">Email</a></span> <span class="website"><a href="https://www.kodi-xbmc.com/" rel="nofollow">Website</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>Denso wrote:</cite><blockquote><div><div class="quotebox"><blockquote><div><p>I also tried with -vga cirrus but black screen. If I remove the &quot;sencond&quot; bios parameters works as usual.</p></div></blockquote></div><p>I think it is because you&#039;ve already installed Windows . Windows writes its VARS during the installation process .</p><div class="quotebox"><blockquote><div><p>First, here is my question: whats the point using a bios dump (from graphic card) in the qemu command-line? I am not doing it yet and everything seems ok. Good performance, VM reboots ok, etc.</p></div></blockquote></div><p>BIOS dumps are not needed if your VGA passthrough is working correctly . You won&#039;t notice any difference in performance if you provided a BIOS ROM file for your GPU .</p><p>Sorry , I passthrough-ed the onboard sound to my VM and it is working perfectly . Also HDMI (GPU) sound works aswell . I can&#039;t help with emulated sound cards .</p></div></blockquote></div><p>Ok, thanks for info. However, can you let me know how do you get sound in Linux then?</p><p>At some point I wanted to used onboard sound for Windows, but then I have no sound in Linux unless I plug / unplug an audio cable or buy some expensive KVM (I use DP and WQHD resolution).</p> <p class="postedit"><em>Last edited by Nesousx (2014-11-23 15:27:31)</em></p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1478307">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1478312" class="blockpost roweven"> <h2><span><span class="conr">#3381</span> <a href="viewtopic.php?pid=1478312#p1478312">2014-11-23 15:48:37</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=84760">Denso</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd class="postavatar"><img src="https://bbs.archlinux.org/img/avatars/84760.png?m=1412533733" width="71" height="80" alt="" /></dd> <dd><span>Registered: 2014-08-30</span></dd> <dd><span>Posts: 179</span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><blockquote><div><p>Ok, thanks for info. However, can you let me know how do you get sound in Linux then?</p></div></blockquote></div><p>I didn&#039;t need to , it&#039;s a headless VM + File server .</p><p>All of my gaming + daily + email needs are served from VMs . This way I kept my Arch as clean as possible .</p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1478312">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1478319" class="blockpost rowodd"> <h2><span><span class="conr">#3382</span> <a href="viewtopic.php?pid=1478319#p1478319">2014-11-23 16:16:37</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=86321">thearcherblog</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2014-10-30</span></dd> <dd><span>Posts: 165</span></dd> <dd class="usercontacts"><span class="email"><a href="mailto:jjgarcianorway@gmail.com">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <p>Hello again,</p><p>Windows 8 reinstalled, using the following command:</p><div class="codebox"><pre><code>sudo qemu-system-x86_64 -name main -enable-kvm -localtime -m 8192 -cpu host,kvm=off -drive if=pflash,format=raw,readonly,file=/usr/share/ovmf/x64/ovmf_x64.bin -drive if=pflash,format=raw,file=/home/jgomez/VM/ovmf_x64.bin -smp sockets=1,cores=4 -serial none -parallel none -nodefconfig -drive file=/home/jgomez/VM/win7.img,cache=writeback,if=none,id=drive0,aio=native -device virtio-blk-pci,drive=drive0,ioeventfd=on,bootindex=1 -device virtio-scsi-pci,id=scsi -drive file=/home/jgomez/Downloads/win8.iso,id=iso_install,if=none -device scsi-cd,drive=iso_install -device vfio-pci,host=01:00.0,multifunction=on -device vfio-pci,host=01:00.1 -cdrom /home/jgomez/Downloads/virtio.iso -vga none</code></pre></div><p>Error Code 43 with several drivers... Feeling so close and so far XD</p><p><img src="https://bbs.archlinux.org/img/smilies/smile.png" width="15" height="15" alt="smile" /></p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1478319">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1478324" class="blockpost roweven"> <h2><span><span class="conr">#3383</span> <a href="viewtopic.php?pid=1478324#p1478324">2014-11-23 16:37:05</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=75590">aw</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2013-10-04</span></dd> <dd><span>Posts: 921</span></dd> <dd class="usercontacts"><span class="email"><a href="misc.php?email=75590">Email</a></span> <span class="website"><a href="http://vfio.blogspot.com/" rel="nofollow">Website</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>thearcherblog wrote:</cite><blockquote><div><p>Hello again,</p><p>Windows 8 reinstalled, using the following command:</p><div class="codebox"><pre><code>sudo qemu-system-x86_64 -name main -enable-kvm -localtime -m 8192 -cpu host,kvm=off -drive if=pflash,format=raw,readonly,file=/usr/share/ovmf/x64/ovmf_x64.bin -drive if=pflash,format=raw,file=/home/jgomez/VM/ovmf_x64.bin -smp sockets=1,cores=4 -serial none -parallel none -nodefconfig -drive file=/home/jgomez/VM/win7.img,cache=writeback,if=none,id=drive0,aio=native -device virtio-blk-pci,drive=drive0,ioeventfd=on,bootindex=1 -device virtio-scsi-pci,id=scsi -drive file=/home/jgomez/Downloads/win8.iso,id=iso_install,if=none -device scsi-cd,drive=iso_install -device vfio-pci,host=01:00.0,multifunction=on -device vfio-pci,host=01:00.1 -cdrom /home/jgomez/Downloads/virtio.iso -vga none</code></pre></div><p>Error Code 43 with several drivers... Feeling so close and so far XD</p><p><img src="https://bbs.archlinux.org/img/smilies/smile.png" width="15" height="15" alt="smile" /></p></div></blockquote></div><p>Have you ever told us what model GPU you&#039;re trying to assign?&#160; I&#039;m starting to wonder if your BIOS is set correctly to make the assigned GPU a secondary device on the host, whether you&#039;ve got the host drivers blacklisted or excluded from the device with pci-stub.ids, or whether dmesg reports errors loading the device ROM.</p> </div> <div class="postsignature postmsg"><hr /><p><a href="http://vfio.blogspot.com" rel="nofollow">http://vfio.blogspot.com</a><br />Looking for a more open forum to discuss vfio related uses?&#160; Try <a href="https://www.redhat.com/mailman/listinfo/vfio-users" rel="nofollow">https://www.redhat.com/mailman/listinfo/vfio-users</a></p></div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1478324">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1478334" class="blockpost rowodd"> <h2><span><span class="conr">#3384</span> <a href="viewtopic.php?pid=1478334#p1478334">2014-11-23 17:07:28</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=86321">thearcherblog</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2014-10-30</span></dd> <dd><span>Posts: 165</span></dd> <dd class="usercontacts"><span class="email"><a href="mailto:jjgarcianorway@gmail.com">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>aw wrote:</cite><blockquote><div><div class="quotebox"><cite>thearcherblog wrote:</cite><blockquote><div><p>Hello again,</p><p>Windows 8 reinstalled, using the following command:</p><div class="codebox"><pre><code>sudo qemu-system-x86_64 -name main -enable-kvm -localtime -m 8192 -cpu host,kvm=off -drive if=pflash,format=raw,readonly,file=/usr/share/ovmf/x64/ovmf_x64.bin -drive if=pflash,format=raw,file=/home/jgomez/VM/ovmf_x64.bin -smp sockets=1,cores=4 -serial none -parallel none -nodefconfig -drive file=/home/jgomez/VM/win7.img,cache=writeback,if=none,id=drive0,aio=native -device virtio-blk-pci,drive=drive0,ioeventfd=on,bootindex=1 -device virtio-scsi-pci,id=scsi -drive file=/home/jgomez/Downloads/win8.iso,id=iso_install,if=none -device scsi-cd,drive=iso_install -device vfio-pci,host=01:00.0,multifunction=on -device vfio-pci,host=01:00.1 -cdrom /home/jgomez/Downloads/virtio.iso -vga none</code></pre></div><p>Error Code 43 with several drivers... Feeling so close and so far XD</p><p><img src="https://bbs.archlinux.org/img/smilies/smile.png" width="15" height="15" alt="smile" /></p></div></blockquote></div><p>Have you ever told us what model GPU you&#039;re trying to assign?&#160; I&#039;m starting to wonder if your BIOS is set correctly to make the assigned GPU a secondary device on the host, whether you&#039;ve got the host drivers blacklisted or excluded from the device with pci-stub.ids, or whether dmesg reports errors loading the device ROM.</p></div></blockquote></div><p>Hello,</p><p>Thanks a lot for your reply!</p><p>I think everything is correct but I will show you all my configuration and logs if necessary <img src="https://bbs.archlinux.org/img/smilies/smile.png" width="15" height="15" alt="smile" /></p><p>My processor is an intel 4790K and the motherboard is a Z97 Extreme 6 from Asrock.</p><p>Vt-d is enabled on UEFI.</p><br /><br /><p>My graphic card is a 01:00.0 VGA compatible controller [0300]: NVIDIA Corporation GK104 [GeForce GTX 770] [10de:1184] (rev a1)<br />My Linux (Arch) is configured with the Intel driver and the Kernel options are:</p><div class="codebox"><pre><code>options root=/dev/sda2 rw pcie_aspm=force acpi_osi=Linux acpi=force acpi_enforce_resources=lax i915.enable_rc6=1 i915.enable_fbc=1 i915.lvds_downclock=1 i915.semaphores=1 drm.vblankoffdelay=1 acpi_backlight=vendor intel_pstate=disable pci-stub.ids=10de:1184,10de:030a intel_iommu=on,igfx_off rdblacklist=nouveau nouveau.modeset=0 elevator=noop intremap=no_x2apic_optout libata.force=noncq loglevel=3 i915.enable_hd_vgaarb=1 libata.noacpi=1 pcie_acs_override=downstream vfio_iommu_type1.allow_unsafe_interrupts=1 quiet</code></pre></div><p>Kernel downloaded from the first post:</p><p>journalctl -b | grep vgaarb</p><div class="codebox"><pre><code>Nov 23 11:59:00 myArch kernel: vgaarb: setting as boot device: PCI:0000:00:02.0 Nov 23 11:59:00 myArch kernel: vgaarb: device added: PCI:0000:00:02.0,decodes=io+mem,owns=io+mem,locks=none Nov 23 11:59:00 myArch kernel: vgaarb: device added: PCI:0000:01:00.0,decodes=io+mem,owns=none,locks=none Nov 23 11:59:00 myArch kernel: vgaarb: loaded Nov 23 11:59:00 myArch kernel: vgaarb: bridge control possible 0000:01:00.0 Nov 23 11:59:00 myArch kernel: vgaarb: no bridge control possible 0000:00:02.0 Nov 23 11:59:01 myArch kernel: vgaarb: device changed decodes: PCI:0000:00:02.0,olddecodes=io+mem,decodes=io:owns=io+mem</code></pre></div><p>The only error I can find, at the moment, is running dmesg:</p><div class="codebox"><pre><code>[21438.474193] dmar: DMAR:[DMA Read] Request device [01:00.0] fault addr 228fa5000 DMAR:[fault reason 12] non-zero reserved fields in PTE</code></pre></div><p>Please, do not hesitate to request me any log <img src="https://bbs.archlinux.org/img/smilies/smile.png" width="15" height="15" alt="smile" /></p><p>Thanks a lot and best regards,</p><br /><p>TheArcher</p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1478334">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1478338" class="blockpost roweven"> <h2><span><span class="conr">#3385</span> <a href="viewtopic.php?pid=1478338#p1478338">2014-11-23 17:14:49</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=84760">Denso</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd class="postavatar"><img src="https://bbs.archlinux.org/img/avatars/84760.png?m=1412533733" width="71" height="80" alt="" /></dd> <dd><span>Registered: 2014-08-30</span></dd> <dd><span>Posts: 179</span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><blockquote><div><p>My Linux (Arch) is configured with the Intel driver and the Kernel options are:</p></div></blockquote></div><p>Wow , lots of parameters ! Why would you need all of these ? I have the same GTX 770 (EVGA SC) , and they work good . With only &quot;intel_iommu=on&quot; and correct &quot;pci-stub.ids&quot; .</p><p>Please , trim your boot parameters , I&#039;m sure you don&#039;t need OR want all of those .</p><p>EDIT : here is my boot line :</p><div class="codebox"><pre><code>intel_iommu=on elevator=noop modprobe.blacklist=nouveau pci-stub.ids=10de:104a,10de:0e08,10de:1184,10de:0e0a,1912:0015</code></pre></div><p>The only thing I imagine you would need to add is the &quot;i915.enable_hd_vgaarb=1&quot; and the &quot;pcie_acs_override=downstream&quot; parameters .</p> <p class="postedit"><em>Last edited by Denso (2014-11-23 17:23:10)</em></p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1478338">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1478370" class="blockpost rowodd"> <h2><span><span class="conr">#3386</span> <a href="viewtopic.php?pid=1478370#p1478370">2014-11-23 19:21:36</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=86321">thearcherblog</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2014-10-30</span></dd> <dd><span>Posts: 165</span></dd> <dd class="usercontacts"><span class="email"><a href="mailto:jjgarcianorway@gmail.com">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>Denso wrote:</cite><blockquote><div><div class="quotebox"><blockquote><div><p>My Linux (Arch) is configured with the Intel driver and the Kernel options are:</p></div></blockquote></div><p>Wow , lots of parameters ! Why would you need all of these ? I have the same GTX 770 (EVGA SC) , and they work good . With only &quot;intel_iommu=on&quot; and correct &quot;pci-stub.ids&quot; .</p><p>Please , trim your boot parameters , I&#039;m sure you don&#039;t need OR want all of those .</p><p>EDIT : here is my boot line :</p><div class="codebox"><pre><code>intel_iommu=on elevator=noop modprobe.blacklist=nouveau pci-stub.ids=10de:104a,10de:0e08,10de:1184,10de:0e0a,1912:0015</code></pre></div><p>The only thing I imagine you would need to add is the &quot;i915.enable_hd_vgaarb=1&quot; and the &quot;pcie_acs_override=downstream&quot; parameters .</p></div></blockquote></div><p>Hello <img src="https://bbs.archlinux.org/img/smilies/smile.png" width="15" height="15" alt="smile" /></p><p>I removed all my kernel boot parameters but still on the same situation:</p><div class="codebox"><pre><code>intel_iommu=on,igfx_off elevator=noop modprobe.blacklist=nouveau pci-stub.ids=10de:1184,10de:030a rdblacklist=nouveau nouveau.modeset=0 i915.enable_hd_vgaarb=1 pcie_acs_override=downstream quiet</code></pre></div><p>I kept only the nouveau related ones and the igfx_off to have sound on host with HDMI <img src="https://bbs.archlinux.org/img/smilies/smile.png" width="15" height="15" alt="smile" /></p><p>I&#039;m open to the next step <img src="https://bbs.archlinux.org/img/smilies/wink.png" width="15" height="15" alt="wink" /></p><p>Edit: I have a question but not sure if will help <img src="https://bbs.archlinux.org/img/smilies/smile.png" width="15" height="15" alt="smile" /></p><p>Seems like if I&#039;m running the qemu with the -vga qxl then shows the nvidia graphic card well installed... Don&#039;t know for sure if that means that is working fine or not and I do not know if I can force to use the Nvidia one for gaming... Maybe I&#039;m just crazy and I need to sleep <img src="https://bbs.archlinux.org/img/smilies/smile.png" width="15" height="15" alt="smile" /></p><p>Thanks a lot and regards,</p><br /><p>TheArcher</p> <p class="postedit"><em>Last edited by thearcherblog (2014-11-23 19:30:01)</em></p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1478370">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1478406" class="blockpost roweven"> <h2><span><span class="conr">#3387</span> <a href="viewtopic.php?pid=1478406#p1478406">2014-11-23 20:38:27</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=75590">aw</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2013-10-04</span></dd> <dd><span>Posts: 921</span></dd> <dd class="usercontacts"><span class="email"><a href="misc.php?email=75590">Email</a></span> <span class="website"><a href="http://vfio.blogspot.com/" rel="nofollow">Website</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>thearcherblog wrote:</cite><blockquote><div><p>The only error I can find, at the moment, is running dmesg:</p><div class="codebox"><pre><code>[21438.474193] dmar: DMAR:[DMA Read] Request device [01:00.0] fault addr 228fa5000 DMAR:[fault reason 12] non-zero reserved fields in PTE</code></pre></div></div></blockquote></div><p>That doesn&#039;t look good.&#160; The only thing I can think that would get that particular error was fixed in v3.15, what kernel version are you using?</p><p>EDIT: And if it&#039;s the bit I&#039;m thinking of, it could definitely contribute to the Code 43 problem</p> <p class="postedit"><em>Last edited by aw (2014-11-23 20:40:52)</em></p> </div> <div class="postsignature postmsg"><hr /><p><a href="http://vfio.blogspot.com" rel="nofollow">http://vfio.blogspot.com</a><br />Looking for a more open forum to discuss vfio related uses?&#160; Try <a href="https://www.redhat.com/mailman/listinfo/vfio-users" rel="nofollow">https://www.redhat.com/mailman/listinfo/vfio-users</a></p></div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1478406">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1478411" class="blockpost rowodd"> <h2><span><span class="conr">#3388</span> <a href="viewtopic.php?pid=1478411#p1478411">2014-11-23 20:43:14</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=84760">Denso</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd class="postavatar"><img src="https://bbs.archlinux.org/img/avatars/84760.png?m=1412533733" width="71" height="80" alt="" /></dd> <dd><span>Registered: 2014-08-30</span></dd> <dd><span>Posts: 179</span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><blockquote><div><p>Seems like if I&#039;m running the qemu with the -vga qxl then shows the nvidia graphic card well installed... Don&#039;t know for sure if that means that is working fine or not and I do not know if I can force to use the Nvidia one for gaming... Maybe I&#039;m just crazy and I need to sleep</p></div></blockquote></div><p>You can passthrough it as a secondary GPU for your VM . I tried it , and it switches to the nvidia GPU as soon as Windows enters to desktop . I don&#039;t think its related to Code 43 issue .</p><p>Any special errors in dmesg when you run the VM ? Maybe ROM errors would appear when you launch the VM . Have you tried passing a ROM file along the QEMU command line ?</p><p>EDIT : </p><p>Didn&#039;t notice the DMAR error you posted earlier .</p><p>I used to recieve a similar error , and if I remember correctly , setting some modules parameters helped :</p><p>try to create a file as :</p><div class="codebox"><pre><code>/etc/modprobe.d/qemu_kvm.conf</code></pre></div><p>Inside it paste the following :</p><div class="codebox"><pre><code>options kvm ignore_msrs=1 options intel_kvm emulate_invalid_guest_state=0 options intel_kvm nested=1 options intel_kvm enable_shadow_vmcs=1 options intel_kvm enable_apicv=1 options intel_kvm ept=1 options vfio_pci nointxmask=1 options vfio_iommu_type1 disable_hugepages=1 options vfio_iommu_type1 allow_unsafe_interrupts=1</code></pre></div><p>Honestly , there is a line among these that helped stopping the DMAR error I had with my X99 . Can you test it ? You need to reboot the host after creating the file .</p> <p class="postedit"><em>Last edited by Denso (2014-11-23 20:49:24)</em></p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1478411">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1478440" class="blockpost roweven"> <h2><span><span class="conr">#3389</span> <a href="viewtopic.php?pid=1478440#p1478440">2014-11-23 21:55:29</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=86321">thearcherblog</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2014-10-30</span></dd> <dd><span>Posts: 165</span></dd> <dd class="usercontacts"><span class="email"><a href="mailto:jjgarcianorway@gmail.com">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>Denso wrote:</cite><blockquote><div><div class="quotebox"><blockquote><div><p>Seems like if I&#039;m running the qemu with the -vga qxl then shows the nvidia graphic card well installed... Don&#039;t know for sure if that means that is working fine or not and I do not know if I can force to use the Nvidia one for gaming... Maybe I&#039;m just crazy and I need to sleep</p></div></blockquote></div><p>You can passthrough it as a secondary GPU for your VM . I tried it , and it switches to the nvidia GPU as soon as Windows enters to desktop . I don&#039;t think its related to Code 43 issue .</p><p>Any special errors in dmesg when you run the VM ? Maybe ROM errors would appear when you launch the VM . Have you tried passing a ROM file along the QEMU command line ?</p><p>EDIT : </p><p>Didn&#039;t notice the DMAR error you posted earlier .</p><p>I used to recieve a similar error , and if I remember correctly , setting some modules parameters helped :</p><p>try to create a file as :</p><div class="codebox"><pre><code>/etc/modprobe.d/qemu_kvm.conf</code></pre></div><p>Inside it paste the following :</p><div class="codebox"><pre><code>options kvm ignore_msrs=1 options intel_kvm emulate_invalid_guest_state=0 options intel_kvm nested=1 options intel_kvm enable_shadow_vmcs=1 options intel_kvm enable_apicv=1 options intel_kvm ept=1 options vfio_pci nointxmask=1 options vfio_iommu_type1 disable_hugepages=1 options vfio_iommu_type1 allow_unsafe_interrupts=1</code></pre></div><p>Honestly , there is a line among these that helped stopping the DMAR error I had with my X99 . Can you test it ? You need to reboot the host after creating the file .</p></div></blockquote></div><p>Hello all <img src="https://bbs.archlinux.org/img/smilies/smile.png" width="15" height="15" alt="smile" /></p><p>I tried this and this is the result:</p><div class="codebox"><pre><code>sudo qemu-system-x86_64 -name main -enable-kvm -localtime -m 8192 -cpu host,kvm=off -drive if=pflash,format=raw,readonly,file=/usr/share/ovmf/x64/ovmf_x64.bin -drive if=pflash,format=raw,file=/home/jgomez/VM/ovmf_x64.bin -smp sockets=1,cores=4 -serial none -parallel none -nodefconfig -drive file=/home/jgomez/VM/win7.img,cache=writeback,if=none,id=drive0,aio=native -device virtio-blk-pci,drive=drive0,ioeventfd=on,bootindex=1 -device virtio-scsi-pci,id=scsi -drive file=/home/jgomez/Downloads/win8.iso,id=iso_install,if=none -device scsi-cd,drive=iso_install -device vfio-pci,host=01:00.0,multifunction=on -device vfio-pci,host=01:00.1 -cdrom /home/jgomez/Downloads/virtio.iso -vga none qemu-system-x86_64: -device vfio-pci,host=01:00.0,multifunction=on: vfio: Error: Failed to setup INTx fd: Device or resource busy qemu-system-x86_64: -device vfio-pci,host=01:00.0,multifunction=on: Device initialization failed. qemu-system-x86_64: -device vfio-pci,host=01:00.0,multifunction=on: Device &#039;vfio-pci&#039; could not be initialized</code></pre></div><p>BTW, my kernel (from the first post) is: </p><div class="codebox"><pre><code>[jgomez@myArch ~]$ uname -r 3.17.2-1-mainline</code></pre></div><p>I guess one of the options conflicts but I will check them tomorrow <img src="https://bbs.archlinux.org/img/smilies/smile.png" width="15" height="15" alt="smile" /></p><p>I would like to give to all of you a big thanks before going to sleep... all day helping me, really thanks <img src="https://bbs.archlinux.org/img/smilies/smile.png" width="15" height="15" alt="smile" /></p><p>Regards,</p><br /><p>TheArcher</p> <p class="postedit"><em>Last edited by thearcherblog (2014-11-23 21:59:48)</em></p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1478440">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1478520" class="blockpost rowodd"> <h2><span><span class="conr">#3390</span> <a href="viewtopic.php?pid=1478520#p1478520">2014-11-24 05:10:19</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=84760">Denso</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd class="postavatar"><img src="https://bbs.archlinux.org/img/avatars/84760.png?m=1412533733" width="71" height="80" alt="" /></dd> <dd><span>Registered: 2014-08-30</span></dd> <dd><span>Posts: 179</span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>thearcherblog wrote:</cite><blockquote><div><p>I guess one of the options conflicts but I will check them tomorrow</p></div></blockquote></div><p>It is this option :</p><div class="codebox"><pre><code>options vfio_pci nointxmask=1</code></pre></div><p>Comment it out and reboot the host . See if that resolves these errors .</p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1478520">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1478524" class="blockpost roweven"> <h2><span><span class="conr">#3391</span> <a href="viewtopic.php?pid=1478524#p1478524">2014-11-24 06:38:09</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=86321">thearcherblog</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2014-10-30</span></dd> <dd><span>Posts: 165</span></dd> <dd class="usercontacts"><span class="email"><a href="mailto:jjgarcianorway@gmail.com">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>Denso wrote:</cite><blockquote><div><div class="quotebox"><cite>thearcherblog wrote:</cite><blockquote><div><p>I guess one of the options conflicts but I will check them tomorrow</p></div></blockquote></div><p>It is this option :</p><div class="codebox"><pre><code>options vfio_pci nointxmask=1</code></pre></div><p>Comment it out and reboot the host . See if that resolves these errors .</p></div></blockquote></div><p>Thanks a lot!</p><p>I willl test it as soon as I arrive home (near 18h (are 7:37 here now) and I will let you know <img src="https://bbs.archlinux.org/img/smilies/smile.png" width="15" height="15" alt="smile" /></p><p>Thanks a lot again!!</p><p>Regards,</p><br /><p>TheArcher</p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1478524">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1478527" class="blockpost rowodd"> <h2><span><span class="conr">#3392</span> <a href="viewtopic.php?pid=1478527#p1478527">2014-11-24 07:04:25</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=86321">thearcherblog</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2014-10-30</span></dd> <dd><span>Posts: 165</span></dd> <dd class="usercontacts"><span class="email"><a href="mailto:jjgarcianorway@gmail.com">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <p>OMG... Today will be a party day!!!!! It&#039;s working!!!</p><p>All of you are the masters of knowledge and the kings of wisdom!!!!</p><p>There are not enough words to express my happiness right now!</p><p>If exists a donation place I will do it right now and if not, please, let me know if any of you is in Norway and I will invite him/her to a beer!!!!</p><p>Amazing!!!!!! Thanks a lot!!!!!</p> <p class="postedit"><em>Last edited by thearcherblog (2014-11-24 07:05:49)</em></p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1478527">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1478529" class="blockpost roweven"> <h2><span><span class="conr">#3393</span> <a href="viewtopic.php?pid=1478529#p1478529">2014-11-24 07:10:40</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=25579">jasonwryan</a></strong></dt> <dd class="usertitle"><strong>Forum &amp; Wiki Admin</strong></dd> <dd class="postavatar"><img src="https://bbs.archlinux.org/img/avatars/25579.png?m=1386831523" width="80" height="69" alt="" /></dd> <dd><span>From: .nz</span></dd> <dd><span>Registered: 2009-05-09</span></dd> <dd><span>Posts: 15,669</span></dd> <dd class="usercontacts"><span class="email"><a href="misc.php?email=25579">Email</a></span> <span class="website"><a href="http://jasonwryan.com/" rel="nofollow">Website</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>thearcherblog wrote:</cite><blockquote><div><p>If exists a donation place I will do it right now and if not, please, let me know if any of you is in Norway and I will invite him/her to a beer!!!!</p></div></blockquote></div><br /><p><a href="https://www.archlinux.org/donate/" rel="nofollow">https://www.archlinux.org/donate/</a></p> </div> <div class="postsignature postmsg"><hr /><p><a href="http://www.flickr.com/photos/jasonwryan/9333810442/lightbox/" rel="nofollow">Arch + dwm</a>&#160; &#160;•&#160; &#160;<a href="http://bitbucket.jasonwryan.com/" rel="nofollow">Mercurial repos</a>&#160; •&#160; &#160;<a href="https://github.com/jasonwryan/" rel="nofollow">Github</a></p><p>Registered Linux User #482438</p></div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1478529">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1478537" class="blockpost rowodd"> <h2><span><span class="conr">#3394</span> <a href="viewtopic.php?pid=1478537#p1478537">2014-11-24 07:43:01</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=85314">Duelist</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2014-09-22</span></dd> <dd><span>Posts: 358</span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <p>I&#039;ve noticed that my disk subsystem is bottlenecking my game.<br />I&#039;m using a virtio-blk-pci device with 60GB raw image cache=none(i thought that windows would cache disk adequately, foolish me) on my 750GB 5-years-old-with-few-badsectors-louder-than-a-CNC-mill WD caviar black hdd.</p><p>So i&#039;ve created a new image sized 10GB in some directory mounted on the system SSD disk, sized 10GB. Attached it as an another virtio-blk-pci device to my windows VM and...<br />The disk image had 10GB of zeroes inside, so windows suggested initializing it in diskmgmt.msc, allowing me to choose between MBR and GPT(windows 7!). That again proves that i am right saying you do not need windows 8 to run on pure EFI.</p><p>So i&#039;ve moved my steam library to&#160; the new disk image, and i want to show you a neat little trick: windows has symlinks. Kind of. You can attach a drive as an empty NTFS folder, which is useful for some applications that load their data from a fixed location(like user&#039;s documents folder), but the folder must be empty.</p><p>Now the disk IO lags are gone, yay for me.</p> </div> <div class="postsignature postmsg"><hr /><p><span class="bbs">The forum rules prohibit requesting support for distributions other than arch.</span><br /><a href="https://bbs.archlinux.org/viewtopic.php?pid=1551460#p1551460" rel="nofollow">I gave up.</a><a href="https://bbs.archlinux.org/viewtopic.php?id=162768" rel="nofollow"> It was too late.</a><br /><a href="http://pastebin.com/B3fL84bq" rel="nofollow">What I was trying to do</a>.<br /><a href="http://vfio.blogspot.com/" rel="nofollow">The reference about VFIO and KVM VGA passthrough.</a></p></div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1478537">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1478538" class="blockpost roweven"> <h2><span><span class="conr">#3395</span> <a href="viewtopic.php?pid=1478538#p1478538">2014-11-24 07:43:15</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=86321">thearcherblog</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2014-10-30</span></dd> <dd><span>Posts: 165</span></dd> <dd class="usercontacts"><span class="email"><a href="mailto:jjgarcianorway@gmail.com">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>jasonwryan wrote:</cite><blockquote><div><div class="quotebox"><cite>thearcherblog wrote:</cite><blockquote><div><p>If exists a donation place I will do it right now and if not, please, let me know if any of you is in Norway and I will invite him/her to a beer!!!!</p></div></blockquote></div><br /><p><a href="https://www.archlinux.org/donate/" rel="nofollow">https://www.archlinux.org/donate/</a></p></div></blockquote></div><p>Done <img src="https://bbs.archlinux.org/img/smilies/smile.png" width="15" height="15" alt="smile" /></p><p>Btw, I made a mistake on the donation... can I chat with you privately?</p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1478538">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1478539" class="blockpost rowodd"> <h2><span><span class="conr">#3396</span> <a href="viewtopic.php?pid=1478539#p1478539">2014-11-24 07:48:56</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=25579">jasonwryan</a></strong></dt> <dd class="usertitle"><strong>Forum &amp; Wiki Admin</strong></dd> <dd class="postavatar"><img src="https://bbs.archlinux.org/img/avatars/25579.png?m=1386831523" width="80" height="69" alt="" /></dd> <dd><span>From: .nz</span></dd> <dd><span>Registered: 2009-05-09</span></dd> <dd><span>Posts: 15,669</span></dd> <dd class="usercontacts"><span class="email"><a href="misc.php?email=25579">Email</a></span> <span class="website"><a href="http://jasonwryan.com/" rel="nofollow">Website</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>thearcherblog wrote:</cite><blockquote><div><div class="quotebox"><cite>jasonwryan wrote:</cite><blockquote><div><div class="quotebox"><cite>thearcherblog wrote:</cite><blockquote><div><p>If exists a donation place I will do it right now and if not, please, let me know if any of you is in Norway and I will invite him/her to a beer!!!!</p></div></blockquote></div><br /><p><a href="https://www.archlinux.org/donate/" rel="nofollow">https://www.archlinux.org/donate/</a></p></div></blockquote></div><p>Done <img src="https://bbs.archlinux.org/img/smilies/smile.png" width="15" height="15" alt="smile" /></p><p>Btw, I made a mistake on the donation... can I chat with you privately?</p></div></blockquote></div><br /><p>Sure. Or you can just email Aaron: he looks after the donations.</p> </div> <div class="postsignature postmsg"><hr /><p><a href="http://www.flickr.com/photos/jasonwryan/9333810442/lightbox/" rel="nofollow">Arch + dwm</a>&#160; &#160;•&#160; &#160;<a href="http://bitbucket.jasonwryan.com/" rel="nofollow">Mercurial repos</a>&#160; •&#160; &#160;<a href="https://github.com/jasonwryan/" rel="nofollow">Github</a></p><p>Registered Linux User #482438</p></div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1478539">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1478540" class="blockpost roweven"> <h2><span><span class="conr">#3397</span> <a href="viewtopic.php?pid=1478540#p1478540">2014-11-24 07:51:57</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=86321">thearcherblog</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2014-10-30</span></dd> <dd><span>Posts: 165</span></dd> <dd class="usercontacts"><span class="email"><a href="mailto:jjgarcianorway@gmail.com">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <p>Thanks a lot <img src="https://bbs.archlinux.org/img/smilies/smile.png" width="15" height="15" alt="smile" /></p><p>Can you give me his mail address in a private message?</p><p>Thanks!</p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1478540">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1478541" class="blockpost rowodd"> <h2><span><span class="conr">#3398</span> <a href="viewtopic.php?pid=1478541#p1478541">2014-11-24 07:53:54</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=25579">jasonwryan</a></strong></dt> <dd class="usertitle"><strong>Forum &amp; Wiki Admin</strong></dd> <dd class="postavatar"><img src="https://bbs.archlinux.org/img/avatars/25579.png?m=1386831523" width="80" height="69" alt="" /></dd> <dd><span>From: .nz</span></dd> <dd><span>Registered: 2009-05-09</span></dd> <dd><span>Posts: 15,669</span></dd> <dd class="usercontacts"><span class="email"><a href="misc.php?email=25579">Email</a></span> <span class="website"><a href="http://jasonwryan.com/" rel="nofollow">Website</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <p><a href="https://www.archlinux.org/people/developers/#aaron" rel="nofollow">https://www.archlinux.org/people/developers/#aaron</a></p> </div> <div class="postsignature postmsg"><hr /><p><a href="http://www.flickr.com/photos/jasonwryan/9333810442/lightbox/" rel="nofollow">Arch + dwm</a>&#160; &#160;•&#160; &#160;<a href="http://bitbucket.jasonwryan.com/" rel="nofollow">Mercurial repos</a>&#160; •&#160; &#160;<a href="https://github.com/jasonwryan/" rel="nofollow">Github</a></p><p>Registered Linux User #482438</p></div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1478541">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1478543" class="blockpost roweven"> <h2><span><span class="conr">#3399</span> <a href="viewtopic.php?pid=1478543#p1478543">2014-11-24 07:55:39</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=86321">thearcherblog</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2014-10-30</span></dd> <dd><span>Posts: 165</span></dd> <dd class="usercontacts"><span class="email"><a href="mailto:jjgarcianorway@gmail.com">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>jasonwryan wrote:</cite><blockquote><div><p><a href="https://www.archlinux.org/people/developers/#aaron" rel="nofollow">https://www.archlinux.org/people/developers/#aaron</a></p></div></blockquote></div><p>Perfect and thanks a lot!!!</p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1478543">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1478544" class="blockpost rowodd"> <h2><span><span class="conr">#3400</span> <a href="viewtopic.php?pid=1478544#p1478544">2014-11-24 07:57:38</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=84760">Denso</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd class="postavatar"><img src="https://bbs.archlinux.org/img/avatars/84760.png?m=1412533733" width="71" height="80" alt="" /></dd> <dd><span>Registered: 2014-08-30</span></dd> <dd><span>Posts: 179</span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>thearcherblog wrote:</cite><blockquote><div><p>OMG... Today will be a party day!!!!! It&#039;s working!!!</p><p>All of you are the masters of knowledge and the kings of wisdom!!!!</p><p>There are not enough words to express my happiness right now!</p><p>If exists a donation place I will do it right now and if not, please, let me know if any of you is in Norway and I will invite him/her to a beer!!!!</p><p>Amazing!!!!!! Thanks a lot!!!!!</p></div></blockquote></div><p>So setting those options seems necessary on new Intel platforms (X99-Z97) .</p><p>Happy to see that you got it working <img src="https://bbs.archlinux.org/img/smilies/smile.png" width="15" height="15" alt="smile" /></p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1478544">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div class="postlinksb"> <div class="inbox crumbsplus"> <div class="pagepost"> <p class="pagelink conl"><span class="pages-label">Pages: </span><a rel="prev" class="item1" href="viewtopic.php?id=162768&amp;p=135">Previous</a> <a href="viewtopic.php?id=162768">1</a> <span class="spacer">…</span> <a href="viewtopic.php?id=162768&amp;p=134">134</a> <a href="viewtopic.php?id=162768&amp;p=135">135</a> <strong>136</strong> <a href="viewtopic.php?id=162768&amp;p=137">137</a> <a href="viewtopic.php?id=162768&amp;p=138">138</a> <span class="spacer">…</span> <a href="viewtopic.php?id=162768&amp;p=234">234</a> <a rel="next" href="viewtopic.php?id=162768&amp;p=137">Next</a></p> <p class="postlink conr">Topic closed</p> </div> <ul class="crumbs"> <li><a href="index.php">Index</a></li> <li><span>»&#160;</span><a href="viewforum.php?id=48">Topics Going Nowhere</a></li> <li><span>»&#160;</span><strong><a href="viewtopic.php?id=162768">KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</a></strong></li> </ul> <p class="subscribelink clearb"><a href="misc.php?action=subscribe&amp;tid=162768">Subscribe to this topic</a></p> <div class="clearer"></div> </div> </div> </div> <div id="brdfooter" class="block"> <h2><span>Board footer</span></h2> <div class="box"> <div id="brdfooternav" class="inbox"> <div class="conl"> <form id="qjump" method="get" action="viewforum.php"> <div><label><span>Jump to<br /></span> <select name="id" onchange="window.location=('viewforum.php?id='+this.options[this.selectedIndex].value)"> <optgroup label="Technical Issues and Assistance"> <option value="23">Newbie Corner</option> <option value="17">Installation</option> <option value="22">Kernel &amp; Hardware</option> <option value="18">Applications &amp; Desktop Environments</option> <option value="31">Laptop Issues</option> <option value="8">Networking, Server, and Protection</option> <option value="32">Multimedia and Games</option> <option value="50">System Administration</option> <option value="35">Other Architectures</option> </optgroup> <optgroup label="Arch-centric"> <option value="24">Announcements, Package &amp; Security Advisories</option> <option value="1">Arch Discussion</option> <option value="13">Forum &amp; Wiki discussion</option> </optgroup> <optgroup label="Pacman Upgrades, Packaging &amp; AUR"> <option value="44">Pacman &amp; Package Upgrade Issues</option> <option value="49">[testing] Repo Forum</option> <option value="4">Creating &amp; Modifying Packages</option> <option value="38">AUR Issues, Discussion &amp; PKGBUILD Requests</option> </optgroup> <optgroup label="Contributions &amp; Discussion"> <option value="20">GNU/Linux Discussion</option> <option value="27">Community Contributions</option> <option value="33">Programming &amp; Scripting</option> <option value="30">Other Languages</option> <option value="47">Artwork and Screenshots</option> <option value="42">Try This</option> </optgroup> <optgroup label="/dev/null"> <option value="29">Off-Topic</option> <option value="48" selected="selected">Topics Going Nowhere</option> <option value="36">Dustbin</option> </optgroup> </select></label> <input type="submit" value=" Go " accesskey="g" /> </div> </form> </div> <div class="conr"> <p id="feedlinks"><span class="atom"><a href="extern.php?action=feed&amp;tid=162768&amp;type=atom">Atom topic feed</a></span></p> <p id="poweredby">Powered by <a href="http://fluxbb.org/">FluxBB</a></p> </div> <div class="clearer"></div> </div> </div> </div> </div> <div class="end-box"></div> </div> </body> </html>
