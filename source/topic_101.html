<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"> <html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en" dir="ltr"> <head> <meta http-equiv="Content-Type" content="text/html; charset=utf-8" /> <title>KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9 (Page 101) / Topics Going Nowhere / Arch Linux Forums</title> <link rel="stylesheet" type="text/css" href="style/ArchLinux.css" /> <link rel="canonical" href="viewtopic.php?id=162768&amp;p=101" title="Page 101" /> <link rel="prev" href="viewtopic.php?id=162768&amp;p=100" title="Page 100" /> <link rel="next" href="viewtopic.php?id=162768&amp;p=102" title="Page 102" /> <link rel="alternate" type="application/atom+xml" href="extern.php?action=feed&amp;tid=162768&amp;type=atom" title="Atom topic feed" /> <link rel="stylesheet" media="screen" href="style/ArchLinux/arch.css?v=3" /> <link rel="stylesheet" media="screen" href="style/ArchLinux/archnavbar.css?v=2" /> <link rel="shortcut icon" href="style/ArchLinux/favicon.ico" /> </head> <body> <div id="archnavbar" class="anb-forum"> <div id="archnavbarlogo"><h1><a href="http://www.archlinux.org/">Arch Linux</a></h1></div> <div id="archnavbarmenu"> <ul id="archnavbarlist"> <li id="anb-home"><a href="http://www.archlinux.org/">Home</a></li><li id="anb-packages"><a href="http://www.archlinux.org/packages/">Packages</a></li><li id="anb-forums" class="anb-selected"><a href="https://bbs.archlinux.org/">Forums</a></li><li id="anb-wiki"><a href="https://wiki.archlinux.org/">Wiki</a></li><li id="anb-bugs"><a href="https://bugs.archlinux.org/">Bugs</a></li><li id="anb-aur"><a href="https://aur.archlinux.org/">AUR</a></li><li id="anb-download"><a href="http://www.archlinux.org/download/">Download</a></li> </ul> </div> </div> <div id="punviewtopic" class="pun"> <div class="top-box"></div> <div class="punwrap"> <div id="brdheader" class="block"> <div class="box"> <div id="brdmenu" class="inbox"> <ul> <li id="navindex" class="isactive"><a href="index.php">Index</a></li> <li id="navuserlist"><a href="userlist.php">User list</a></li> <li id="navsearch"><a href="search.php">Search</a></li> <li id="navprofile"><a href="profile.php?id=80749">Profile</a></li> <li id="navlogout"><a href="login.php?action=out&amp;id=80749&amp;csrf_token=5c20501ec397bb45ef8ee8c84db232c8d8e421c6">Logout</a></li> </ul> </div> <div id="brdwelcome" class="inbox"> <ul class="conl"> <li><span>Logged in as <strong>SXX</strong></span></li> <li><span>Last visit: 2015-08-16 12:20:09</span></li> </ul> <ul class="conr"> <li><span>Topics: <a href="search.php?action=show_replies" title="Find topics you have posted to.">Posted</a> | <a href="search.php?action=show_new" title="Find topics with new posts since your last visit.">New</a> | <a href="search.php?action=show_recent" title="Find topics with recent posts.">Active</a> | <a href="search.php?action=show_unanswered" title="Find topics with no replies.">Unanswered</a></span></li> </ul> <div class="clearer"></div> </div> </div> </div> <div id="brdmain"> <div class="linkst"> <div class="inbox crumbsplus"> <ul class="crumbs"> <li><a href="index.php">Index</a></li> <li><span>»&#160;</span><a href="viewforum.php?id=48">Topics Going Nowhere</a></li> <li><span>»&#160;</span><strong><a href="viewtopic.php?id=162768">KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</a></strong></li> </ul> <div class="pagepost"> <p class="pagelink conl"><span class="pages-label">Pages: </span><a rel="prev" class="item1" href="viewtopic.php?id=162768&amp;p=100">Previous</a> <a href="viewtopic.php?id=162768">1</a> <span class="spacer">…</span> <a href="viewtopic.php?id=162768&amp;p=99">99</a> <a href="viewtopic.php?id=162768&amp;p=100">100</a> <strong>101</strong> <a href="viewtopic.php?id=162768&amp;p=102">102</a> <a href="viewtopic.php?id=162768&amp;p=103">103</a> <span class="spacer">…</span> <a href="viewtopic.php?id=162768&amp;p=234">234</a> <a rel="next" href="viewtopic.php?id=162768&amp;p=102">Next</a></p> <p class="postlink conr">Topic closed</p> </div> <div class="clearer"></div> </div> </div> <div id="p1446939" class="blockpost rowodd blockpost1"> <h2><span><span class="conr">#2501</span> <a href="viewtopic.php?pid=1446939#p1446939">2014-08-14 21:50:31</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=80028">trimm</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2014-03-06</span></dd> <dd><span>Posts: 31</span></dd> <dd class="usercontacts"><span class="email"><a href="misc.php?email=80028">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <p>I dont know if this is the correct place to post this, but since aw (and perhaps others contributing to qemu etc) is here:</p><p>Fully updated qemu(not git, but qemu 2.1.0-2) and nvidia drivers in windows 340.52.<br />I cant use game optimization nor shadowplay since the only thing I lack is the CPU requirements. (However, I do have an i7 Haswell CPU, with kvm=off in my qemu settings)</p><p>Before I upgraded my qemu(and before using kvm=off) and before using the latest nvidia drivers, this worked fine.</p><p>In device manager, under processors - I can see &quot;Intel Core Processor (Haswell), but I believe there should be standing something else here, but quite similar - so that the nvidia drivers &quot;accept&quot; me having the correct CPU?</p><p>Anyone else having the same issue? (PS: I dont use these features that often, however I&#039;m somewhat pedantic about making things just right. Keep up the good work!).</p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1446939">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1446975" class="blockpost roweven"> <h2><span><span class="conr">#2502</span> <a href="viewtopic.php?pid=1446975#p1446975">2014-08-14 23:59:12</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=80387">dwe11er</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2014-03-18</span></dd> <dd><span>Posts: 73</span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>trimm wrote:</cite><blockquote><div><p>I dont know if this is the correct place to post this, but since aw (and perhaps others contributing to qemu etc) is here:</p><p>Fully updated qemu(not git, but qemu 2.1.0-2) and nvidia drivers in windows 340.52.<br />I cant use game optimization nor shadowplay since the only thing I lack is the CPU requirements. (However, I do have an i7 Haswell CPU, with kvm=off in my qemu settings)</p><p>Before I upgraded my qemu(and before using kvm=off) and before using the latest nvidia drivers, this worked fine.</p><p>In device manager, under processors - I can see &quot;Intel Core Processor (Haswell), but I believe there should be standing something else here, but quite similar - so that the nvidia drivers &quot;accept&quot; me having the correct CPU?</p><p>Anyone else having the same issue? (PS: I dont use these features that often, however I&#039;m somewhat pedantic about making things just right. Keep up the good work!).</p></div></blockquote></div><p>How &#039;-cpu ...&#039; looks like? With &#039;-cpu host,...&#039;&#160; (host-passthrough if you&#039;re using libvirt) it should work fine.</p> <p class="postedit"><em>Last edited by dwe11er (2014-08-15 11:14:32)</em></p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1446975">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1447060" class="blockpost rowodd"> <h2><span><span class="conr">#2503</span> <a href="viewtopic.php?pid=1447060#p1447060">2014-08-15 09:46:17</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=80028">trimm</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2014-03-06</span></dd> <dd><span>Posts: 31</span></dd> <dd class="usercontacts"><span class="email"><a href="misc.php?email=80028">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>dwe11er wrote:</cite><blockquote><div><div class="quotebox"><cite>trimm wrote:</cite><blockquote><div><p>I dont know if this is the correct place to post this, but since aw (and perhaps others contributing to qemu etc) is here:</p><p>Fully updated qemu(not git, but qemu 2.1.0-2) and nvidia drivers in windows 340.52.<br />I cant use game optimization nor shadowplay since the only thing I lack is the CPU requirements. (However, I do have an i7 Haswell CPU, with kvm=off in my qemu settings)</p><p>Before I upgraded my qemu(and before using kvm=off) and before using the latest nvidia drivers, this worked fine.</p><p>In device manager, under processors - I can see &quot;Intel Core Processor (Haswell), but I believe there should be standing something else here, but quite similar - so that the nvidia drivers &quot;accept&quot; me having the correct CPU?</p><p>Anyone else having the same issue? (PS: I dont use these features that often, however I&#039;m somewhat pedantic about making things just right. Keep up the good work!).</p></div></blockquote></div><p>How &#039;-cpu ...&#039; looks like? With&#039;-cpu host,...&#039;&#160; (host-passthrough if you&#039;re using libvirt) it should work fine.</p></div></blockquote></div><p>Ah, stupid me!<br />I had -cpu Haswell instead of -cpu host in my script. Thanks.</p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1447060">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1447284" class="blockpost roweven"> <h2><span><span class="conr">#2504</span> <a href="viewtopic.php?pid=1447284#p1447284">2014-08-15 23:18:49</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=55423">Hspasta</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2011-12-24</span></dd> <dd><span>Posts: 187</span></dd> <dd class="usercontacts"><span class="email"><a href="misc.php?email=55423">Email</a></span> <span class="website"><a href="http://www.hspak.com" rel="nofollow">Website</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <p>I&#039;m running into that silly code 43 error for Nvidia on Windows. Nvidia driver version: 340.52.</p><p>I&#039;m using libvirt to run everything because my server is headless. <br />I&#039;m using qemu-git and a vanilla kernel.</p><p>Following are my settings for a win8 vm:</p><div class="codebox"><pre class="vscroll"><code>&lt;domain type=&#039;kvm&#039; xmlns:qemu=&#039;http://libvirt.org/schemas/domain/qemu/1.0&#039;&gt; &lt;name&gt;win8&lt;/name&gt; &lt;uuid&gt;38176c7c-d25c-4cb0-aac5-107056c345f8&lt;/uuid&gt; &lt;memory unit=&#039;KiB&#039;&gt;4194304&lt;/memory&gt; &lt;currentMemory unit=&#039;KiB&#039;&gt;4194304&lt;/currentMemory&gt; &lt;vcpu placement=&#039;static&#039; current=&#039;1&#039;&gt;2&lt;/vcpu&gt; &lt;os&gt; &lt;type arch=&#039;x86_64&#039; machine=&#039;pc-i440fx-2.1&#039;&gt;hvm&lt;/type&gt; &lt;boot dev=&#039;hd&#039;/&gt; &lt;/os&gt; &lt;features&gt; &lt;acpi/&gt; &lt;apic/&gt; &lt;pae/&gt; &lt;/features&gt; &lt;cpu mode=&#039;host-model&#039;&gt; &lt;model fallback=&#039;allow&#039;/&gt; &lt;/cpu&gt; &lt;clock offset=&#039;localtime&#039;&gt; &lt;timer name=&#039;rtc&#039; tickpolicy=&#039;catchup&#039;/&gt; &lt;timer name=&#039;pit&#039; tickpolicy=&#039;delay&#039;/&gt; &lt;timer name=&#039;hpet&#039; present=&#039;no&#039;/&gt; &lt;/clock&gt; &lt;on_poweroff&gt;destroy&lt;/on_poweroff&gt; &lt;on_reboot&gt;restart&lt;/on_reboot&gt; &lt;on_crash&gt;restart&lt;/on_crash&gt; &lt;pm&gt; &lt;suspend-to-mem enabled=&#039;no&#039;/&gt; &lt;suspend-to-disk enabled=&#039;no&#039;/&gt; &lt;/pm&gt; &lt;devices&gt; &lt;emulator&gt;/usr/sbin/qemu-system-x86_64&lt;/emulator&gt; &lt;disk type=&#039;file&#039; device=&#039;disk&#039;&gt; &lt;driver name=&#039;qemu&#039; type=&#039;qcow2&#039;/&gt; &lt;source file=&#039;/mnt/zfs/vmpool/win8.qcow2&#039;/&gt; &lt;target dev=&#039;hda&#039; bus=&#039;ide&#039;/&gt; &lt;address type=&#039;drive&#039; controller=&#039;0&#039; bus=&#039;0&#039; target=&#039;0&#039; unit=&#039;0&#039;/&gt; &lt;/disk&gt; &lt;disk type=&#039;file&#039; device=&#039;cdrom&#039;&gt; &lt;driver name=&#039;qemu&#039; type=&#039;raw&#039;/&gt; &lt;source file=&#039;/mnt/zfs/share/isos/en_windows_8_1_enterprise_x64_dvd_2971902.iso&#039;/&gt; &lt;target dev=&#039;hdb&#039; bus=&#039;ide&#039;/&gt; &lt;readonly/&gt; &lt;address type=&#039;drive&#039; controller=&#039;0&#039; bus=&#039;0&#039; target=&#039;0&#039; unit=&#039;1&#039;/&gt; &lt;/disk&gt; &lt;controller type=&#039;usb&#039; index=&#039;0&#039; model=&#039;ich9-ehci1&#039;&gt; &lt;address type=&#039;pci&#039; domain=&#039;0x0000&#039; bus=&#039;0x00&#039; slot=&#039;0x05&#039; function=&#039;0x7&#039;/&gt; &lt;/controller&gt; &lt;controller type=&#039;usb&#039; index=&#039;0&#039; model=&#039;ich9-uhci1&#039;&gt; &lt;master startport=&#039;0&#039;/&gt; &lt;address type=&#039;pci&#039; domain=&#039;0x0000&#039; bus=&#039;0x00&#039; slot=&#039;0x05&#039; function=&#039;0x0&#039; multifunction=&#039;on&#039;/&gt; &lt;/controller&gt; &lt;controller type=&#039;usb&#039; index=&#039;0&#039; model=&#039;ich9-uhci2&#039;&gt; &lt;master startport=&#039;2&#039;/&gt; &lt;address type=&#039;pci&#039; domain=&#039;0x0000&#039; bus=&#039;0x00&#039; slot=&#039;0x05&#039; function=&#039;0x1&#039;/&gt; &lt;/controller&gt; &lt;controller type=&#039;usb&#039; index=&#039;0&#039; model=&#039;ich9-uhci3&#039;&gt; &lt;master startport=&#039;4&#039;/&gt; &lt;address type=&#039;pci&#039; domain=&#039;0x0000&#039; bus=&#039;0x00&#039; slot=&#039;0x05&#039; function=&#039;0x2&#039;/&gt; &lt;/controller&gt; &lt;controller type=&#039;pci&#039; index=&#039;0&#039; model=&#039;pci-root&#039;/&gt; &lt;controller type=&#039;ide&#039; index=&#039;0&#039;&gt; &lt;address type=&#039;pci&#039; domain=&#039;0x0000&#039; bus=&#039;0x00&#039; slot=&#039;0x01&#039; function=&#039;0x1&#039;/&gt; &lt;/controller&gt; &lt;controller type=&#039;virtio-serial&#039; index=&#039;0&#039;&gt; &lt;address type=&#039;pci&#039; domain=&#039;0x0000&#039; bus=&#039;0x00&#039; slot=&#039;0x06&#039; function=&#039;0x0&#039;/&gt; &lt;/controller&gt; &lt;interface type=&#039;network&#039;&gt; &lt;mac address=&#039;52:54:00:90:71:8c&#039;/&gt; &lt;source network=&#039;default&#039;/&gt; &lt;model type=&#039;rtl8139&#039;/&gt; &lt;address type=&#039;pci&#039; domain=&#039;0x0000&#039; bus=&#039;0x00&#039; slot=&#039;0x03&#039; function=&#039;0x0&#039;/&gt; &lt;/interface&gt; &lt;serial type=&#039;pty&#039;&gt; &lt;target port=&#039;0&#039;/&gt; &lt;/serial&gt; &lt;console type=&#039;pty&#039;&gt; &lt;target type=&#039;serial&#039; port=&#039;0&#039;/&gt; &lt;/console&gt; &lt;channel type=&#039;spicevmc&#039;&gt; &lt;target type=&#039;virtio&#039; name=&#039;com.redhat.spice.0&#039;/&gt; &lt;address type=&#039;virtio-serial&#039; controller=&#039;0&#039; bus=&#039;0&#039; port=&#039;1&#039;/&gt; &lt;/channel&gt; &lt;input type=&#039;tablet&#039; bus=&#039;usb&#039;/&gt; &lt;input type=&#039;mouse&#039; bus=&#039;ps2&#039;/&gt; &lt;input type=&#039;keyboard&#039; bus=&#039;ps2&#039;/&gt; &lt;graphics type=&#039;spice&#039; autoport=&#039;yes&#039;/&gt; &lt;sound model=&#039;ac97&#039;&gt; &lt;address type=&#039;pci&#039; domain=&#039;0x0000&#039; bus=&#039;0x00&#039; slot=&#039;0x04&#039; function=&#039;0x0&#039;/&gt; &lt;/sound&gt; &lt;video&gt; &lt;model type=&#039;qxl&#039; ram=&#039;65536&#039; vram=&#039;65536&#039; heads=&#039;1&#039;/&gt; &lt;address type=&#039;pci&#039; domain=&#039;0x0000&#039; bus=&#039;0x00&#039; slot=&#039;0x02&#039; function=&#039;0x0&#039;/&gt; &lt;/video&gt; &lt;hostdev mode=&#039;subsystem&#039; type=&#039;pci&#039; managed=&#039;yes&#039;&gt; &lt;source&gt; &lt;address domain=&#039;0x0000&#039; bus=&#039;0x01&#039; slot=&#039;0x00&#039; function=&#039;0x0&#039;/&gt; &lt;/source&gt; &lt;rom bar=&#039;off&#039;/&gt; &lt;address type=&#039;pci&#039; domain=&#039;0x0000&#039; bus=&#039;0x00&#039; slot=&#039;0x08&#039; function=&#039;0x0&#039;/&gt; &lt;/hostdev&gt; &lt;hostdev mode=&#039;subsystem&#039; type=&#039;pci&#039; managed=&#039;yes&#039;&gt; &lt;source&gt; &lt;address domain=&#039;0x0000&#039; bus=&#039;0x01&#039; slot=&#039;0x00&#039; function=&#039;0x1&#039;/&gt; &lt;/source&gt; &lt;rom bar=&#039;off&#039;/&gt; &lt;address type=&#039;pci&#039; domain=&#039;0x0000&#039; bus=&#039;0x00&#039; slot=&#039;0x09&#039; function=&#039;0x0&#039;/&gt; &lt;/hostdev&gt; &lt;redirdev bus=&#039;usb&#039; type=&#039;spicevmc&#039;&gt; &lt;/redirdev&gt; &lt;redirdev bus=&#039;usb&#039; type=&#039;spicevmc&#039;&gt; &lt;/redirdev&gt; &lt;redirdev bus=&#039;usb&#039; type=&#039;spicevmc&#039;&gt; &lt;/redirdev&gt; &lt;redirdev bus=&#039;usb&#039; type=&#039;spicevmc&#039;&gt; &lt;/redirdev&gt; &lt;memballoon model=&#039;virtio&#039;&gt; &lt;address type=&#039;pci&#039; domain=&#039;0x0000&#039; bus=&#039;0x00&#039; slot=&#039;0x07&#039; function=&#039;0x0&#039;/&gt; &lt;/memballoon&gt; &lt;/devices&gt; &lt;qemu:commandline&gt; &lt;qemu:arg value=&#039;-cpu&#039;/&gt; &lt;qemu:arg value=&#039;host,kvm=off&#039;/&gt; &lt;/qemu:commandline&gt; &lt;/domain&gt;</code></pre></div><p>Did I miss something? Am I setting the qemu arg settings correctly? Does the video model type matter?</p> <p class="postedit"><em>Last edited by Hspasta (2014-08-16 00:07:00)</em></p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1447284">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1447287" class="blockpost rowodd"> <h2><span><span class="conr">#2505</span> <a href="viewtopic.php?pid=1447287#p1447287">2014-08-15 23:28:22</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=83145">kameloc</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2014-06-28</span></dd> <dd><span>Posts: 11</span></dd> <dd class="usercontacts"><span class="email"><a href="misc.php?email=83145">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>Hspasta wrote:</cite><blockquote><div><p>I&#039;m running into that silly code 43 error for Nvidia on Windows. Nvidia driver version: 340.52.</p></div></blockquote></div><p>I don&#039;t have a solution but I had the same problem on Windows 7 x64 when downloading and installing the Nvidia drivers. When I use the drivers supplied through windows update (335.23) it works fine. Something to try.</p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1447287">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1447337" class="blockpost roweven"> <h2><span><span class="conr">#2506</span> <a href="viewtopic.php?pid=1447337#p1447337">2014-08-16 02:05:10</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=82442">slis</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2014-06-02</span></dd> <dd><span>Posts: 125</span></dd> <dd class="usercontacts"><span class="email"><a href="mailto:xslisx@gmail.com">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <p>&lt;qemu:arg value=&#039;-cpu&#039;/&gt;<br />&#160; &#160; &lt;qemu:arg value=&#039;host,kvm=off&#039;/&gt;</p><p>for 340+ nvidia drivers</p><p>edit... i saw u got this... </p><p>then u can&#039;t have spice (video QXL) i think... thats reason for error 43</p> <p class="postedit"><em>Last edited by slis (2014-08-16 02:15:55)</em></p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1447337">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1447715" class="blockpost rowodd"> <h2><span><span class="conr">#2507</span> <a href="viewtopic.php?pid=1447715#p1447715">2014-08-17 15:11:05</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=83687">k0olfir3</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2014-07-20</span></dd> <dd><span>Posts: 7</span></dd> <dd class="usercontacts"><span class="email"><a href="misc.php?email=83687">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <p>Hi all,</p><p>with the help of this thread, I managed to create a gaming vm to play windows games while linux is running. Everything is working except for one aspect. I am not sure whether this is on topic here, but I don&#039;t know where to ask. Sorry for that.</p><p>I want to use only one keyboard and only one mouse to control both, the host and the windows guest. So far I have used synergy to share the host&#039;s mouse and keyboard with the vm. However, this is somewhat suboptimal since I cannot use all mouse buttons on the guest and because the mouse is not reacting very precisely. I guess it is okay for most use cases but not for gaming. One solution to this would be to give the mouse and keyboard to the vm and to run the synergy server in the guest to share the guest&#039;s controls with the host. However, when I try to run the synergy client on the host it is not able to connect to the synergy server on the guest (NOTE: connecting to &#039;10.0.2.15&#039;: 10.0.2.15:24800 ... WARNING: failed to connect to server: Timed out). Is there any possibility to solve this?</p><p>My qemu command is:</p><div class="codebox"><pre><code> qemu-system-x86_64 -enable-kvm -M q35 -m 8192 -cpu host \ -smp 6,sockets=1,cores=6,threads=1 \ -bios /usr/share/qemu/bios.bin -vga none \ -net nic -net user,smb=/home/xxxx \ -device ioh3420,bus=pcie.0,addr=1c.0,multifunction=on,port=1,chassis=1,id=root.1 \ -device vfio-pci,host=01:00.0,bus=root.1,addr=00.0,multifunction=on,x-vga=on \ -device vfio-pci,host=01:00.1,bus=root.1,addr=00.1 \ -device virtio-scsi-pci,id=scsi \ -drive file=/mnt/vboxes/win_root.qcow2,id=disk,format=qcow2 -device scsi-hd,drive=disk \ -drive file=/mnt/vboxes/win_games.raw,id=disk2,format=raw -device scsi-hd,drive=disk2 \ -usb -usbdevice host:045e:0719 -usbdevice host:1e7d:2e22 \ -device ich9-intel-hda,bus=pcie.0,addr=1b.0,id=sound0 \ -device hda-duplex,id=sound0-codec0,bus=sound0.0,cad=0</code></pre></div><p>Apart from synergy, I only use networking to provide the guest with Internet access and to share my home folder. Should I try one of the more sophisticated networking approaches (e.g., bridges)? Do you have any other suggestions?</p><p>Best k0ol</p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1447715">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1447734" class="blockpost roweven"> <h2><span><span class="conr">#2508</span> <a href="viewtopic.php?pid=1447734#p1447734">2014-08-17 16:43:26</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=82238">sinny</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2014-05-24</span></dd> <dd><span>Posts: 75</span></dd> <dd class="usercontacts"><span class="email"><a href="misc.php?email=82238">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>k0olfir3 wrote:</cite><blockquote><div><p>Apart from synergy, I only use networking to provide the guest with Internet access and to share my home folder. Should I try one of the more sophisticated networking approaches (e.g., bridges)? Do you have any other suggestions?</p><p>Best k0ol</p></div></blockquote></div><p>imo, you really should try going for bridges</p><p>there was a link somewhere above (not more than few pages) for qemu/kvm networking wiki page</p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1447734">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1447923" class="blockpost rowodd"> <h2><span><span class="conr">#2509</span> <a href="viewtopic.php?pid=1447923#p1447923">2014-08-18 03:01:36</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=84422">somearchfan</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2014-08-18</span></dd> <dd><span>Posts: 33</span></dd> <dd class="usercontacts"><span class="email"><a href="misc.php?email=84422">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <p>Sadly it doesn&#039;t work for me. I&#039;ve followed all the instructions given by nbhs. I would really appreciate some help.</p><p>CPU: I5 4570<br />Mainboard: Asrock H97M Pro 4 / vt-d &amp; vt-x enabled / onboard as primary / dual gpu disabled / UEFI mode<br />GPU: Asus R9 270<br />RAM: 16 GB DDR3<br />OS: Arch Linux / 3.16.0-1-mainline by nbhs (no changes have been made, except arch =&gt; core2 or newer)<br />qemu 2.1.0-2 / seabios 1.7.5-2 </p><p>cat /proc/cmdline</p><div class="quotebox"><blockquote><div><p>BOOT_IMAGE=/vmlinuz-linux-mainline root=UUID=9fb159a7-84b2-401b-a745-8199d3b0339c rw vfio_iommu_type1.allow_unsafe_interrupts=1 i915.enable_hd_vgaarb=1 pci-stub.ids=1002:6811,1002:aab0 resume=UUID=9416fa53-b808-4b96-bd92-6839effde5c5 quiet</p></div></blockquote></div><p>cat /etc/modprobe.d/blacklist.conf </p><div class="quotebox"><blockquote><div><p>blacklist radeon</p></div></blockquote></div><p>dmesg | grep pci-stub</p><div class="quotebox"><blockquote><div><p>[&#160; &#160; 0.000000] Command line: BOOT_IMAGE=/vmlinuz-linux-mainline root=UUID=9fb159a7-84b2-401b-a745-8199d3b0339c rw vfio_iommu_type1.allow_unsafe_interrupts=1 i915.enable_hd_vgaarb=1 pci-stub.ids=1002:6811,1002:aab0 resume=UUID=9416fa53-b808-4b96-bd92-6839effde5c5 quiet<br />[&#160; &#160; 0.000000] Kernel command line: BOOT_IMAGE=/vmlinuz-linux-mainline root=UUID=9fb159a7-84b2-401b-a745-8199d3b0339c rw vfio_iommu_type1.allow_unsafe_interrupts=1 i915.enable_hd_vgaarb=1 pci-stub.ids=1002:6811,1002:aab0 resume=UUID=9416fa53-b808-4b96-bd92-6839effde5c5 quiet<br />[&#160; &#160; 0.459556] pci-stub: add 1002:6811 sub=FFFFFFFF:FFFFFFFF cls=00000000/00000000<br />[&#160; &#160; 0.459563] pci-stub 0000:01:00.0: claimed by stub<br />[&#160; &#160; 0.459565] pci-stub: add 1002:AAB0 sub=FFFFFFFF:FFFFFFFF cls=00000000/00000000<br />[&#160; &#160; 0.459581] pci-stub 0000:01:00.1: claimed by stub</p></div></blockquote></div><p>lpsci -n (shortened)</p><div class="quotebox"><blockquote><div><p>01:00.0 0300: 1002:6811 <br />01:00.1 0403: 1002:aab0</p></div></blockquote></div><p>cat /etc/vfio-pci.cfg</p><div class="quotebox"><blockquote><div><p>DEVICES=&quot;0000:01:00.0 000:01:00.1&quot;</p></div></blockquote></div><p>When I enter this into my terminal -&gt;</p><div class="quotebox"><blockquote><div><p>qemu-system-x86_64 -enable-kvm -M q35 -m 1024 -cpu host \<br />-smp 3,sockets=1,cores=3,threads=1 \<br />-bios /usr/share/qemu/bios.bin -vga none \<br />-device ioh3420,bus=pcie.0,addr=1c.0,multifunction=on,port=1,chassis=1,id=root.1 \<br />-device vfio-pci,host=01:00.0,bus=root.1,addr=00.0,multifunction=on,x-vga=on \<br />-device vfio-pci,host=01:00.1,bus=root.1,addr=00.1</p></div></blockquote></div><p>I get this error:</p><div class="quotebox"><blockquote><div><p>qemu-system-x86_64: -device vfio-pci,host=01:00.0,bus=root.1,addr=00.0,multifunction=on,x-vga=on: vfio: error no iommu_group for device<br />qemu-system-x86_64: -device vfio-pci,host=01:00.0,bus=root.1,addr=00.0,multifunction=on,x-vga=on: Device initialization failed.<br />qemu-system-x86_64: -device vfio-pci,host=01:00.0,bus=root.1,addr=00.0,multifunction=on,x-vga=on: Device &#039;vfio-pci&#039; could not be initialized</p></div></blockquote></div> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1447923">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1447930" class="blockpost roweven"> <h2><span><span class="conr">#2510</span> <a href="viewtopic.php?pid=1447930#p1447930">2014-08-18 04:28:24</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=82442">slis</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2014-06-02</span></dd> <dd><span>Posts: 125</span></dd> <dd class="usercontacts"><span class="email"><a href="mailto:xslisx@gmail.com">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <p>@somearchfan</p><p>missing intel_iommu=on in cmdline ?</p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1447930">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1447934" class="blockpost rowodd"> <h2><span><span class="conr">#2511</span> <a href="viewtopic.php?pid=1447934#p1447934">2014-08-18 04:45:48</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=84422">somearchfan</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2014-08-18</span></dd> <dd><span>Posts: 33</span></dd> <dd class="usercontacts"><span class="email"><a href="misc.php?email=84422">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <p>Thanks! It works now with &quot;intel_iommu=on&quot;.</p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1447934">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1447942" class="blockpost roweven"> <h2><span><span class="conr">#2512</span> <a href="viewtopic.php?pid=1447942#p1447942">2014-08-18 05:13:07</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=84422">somearchfan</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2014-08-18</span></dd> <dd><span>Posts: 33</span></dd> <dd class="usercontacts"><span class="email"><a href="misc.php?email=84422">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <p>One more quick question:</p><p>How do I get a useful USB ID for qemu? I entered &quot;usb-devices | egrep &#039;(Manufacturer|SerialNumber)&#039;&quot; into my terminal and got the manufacturer (in this case Logitech) and a serial number (C0030059D31E) but not a correct PCI-ID. C0030059D31E is of no use. How can I find out what ID is to what device assigned specifically?</p><p>One example<br />[john@mainhub ~]$ usb-devices | egrep &#039;(Manufacturer|SerialNumber)&#039;<br />S:&#160; Manufacturer=Linux 3.16.0-1-mainline ehci_hcd<br />S:&#160; SerialNumber=0000:00:1a.0<br />S:&#160; Manufacturer=Linux 3.16.0-1-mainline ehci_hcd<br />S:&#160; SerialNumber=0000:00:1d.0<br />S:&#160; Manufacturer=Linux 3.16.0-1-mainline xhci_hcd<br />S:&#160; SerialNumber=0000:00:14.0<br />S:&#160; Manufacturer=Logitech<br />S:&#160; SerialNumber=C0030059D31E<br />S:&#160; Manufacturer=LGE<br />S:&#160; SerialNumber=030a483608e7ef63<br />S:&#160; Manufacturer=Logitech<br />S:&#160; Manufacturer=Linux 3.16.0-1-mainline xhci_hcd<br />S:&#160; SerialNumber=0000:00:14.0<br />S:&#160; Manufacturer=Western Digital<br />S:&#160; SerialNumber=575843314131343535353730</p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1447942">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1447945" class="blockpost rowodd"> <h2><span><span class="conr">#2513</span> <a href="viewtopic.php?pid=1447945#p1447945">2014-08-18 05:37:13</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=27289">ewaller</a></strong></dt> <dd class="usertitle"><strong>Forum Moderator</strong></dd> <dd class="postavatar"><img src="https://bbs.archlinux.org/img/avatars/27289.jpg?m=1406180442" width="80" height="80" alt="" /></dd> <dd><span>From: Pasadena, CA</span></dd> <dd><span>Registered: 2009-07-13</span></dd> <dd><span>Posts: 10,547</span></dd> <dd class="usercontacts"><span class="email"><a href="misc.php?email=27289">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>somearchfan wrote:</cite><blockquote><div><p>How can I find out what ID is to what device assigned specifically?</p></div></blockquote></div><p><em>lsusb</em><br />or, if you like trying to drink from a firehose:<br /><em>lsusb -v</em>&#160; <img src="https://bbs.archlinux.org/img/smilies/smile.png" width="15" height="15" alt="smile" /></p> </div> <div class="postsignature postmsg"><hr /><p>Nothing is too wonderful to be true, if it be consistent with the laws of nature -- <em>Michael Faraday</em><br />Like you, I have no idea what you are doing, but I am pretty sure it is wrong...<em>Jasonwryan</em><br />----<br /><a href="http://www.catb.org/~esr/faqs/smart-questions.html" rel="nofollow">How to Ask Questions the Smart Way</a></p></div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1447945">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1447951" class="blockpost roweven"> <h2><span><span class="conr">#2514</span> <a href="viewtopic.php?pid=1447951#p1447951">2014-08-18 05:47:55</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=84422">somearchfan</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2014-08-18</span></dd> <dd><span>Posts: 33</span></dd> <dd class="usercontacts"><span class="email"><a href="misc.php?email=84422">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <p>Wow. Great. It works. </p><p>Thank you.</p><p>Edit: OK. I have successfully installed Windows 8.1. But after installing the AMD graphics driver my monitor goes into power saving mode and doesn&#039;t awake anymore. My graphics card has been detected by the driver but something doesn&#039;t work.</p><p>This is what I get with windows 7 after installing the driver: <a href="http://www.xup.to/dl,79159015/49781408364797804-1041416908.jpg/" rel="nofollow"><span class="postimg"><img src="http://www1.xup.to/tn/2014_08/79159015.jpeg" alt="79159015.jpeg" /></span></a></p> <p class="postedit"><em>Last edited by somearchfan (2014-08-18 12:28:46)</em></p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1447951">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1448084" class="blockpost rowodd"> <h2><span><span class="conr">#2515</span> <a href="viewtopic.php?pid=1448084#p1448084">2014-08-18 13:44:23</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=80387">dwe11er</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2014-03-18</span></dd> <dd><span>Posts: 73</span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>somearchfan wrote:</cite><blockquote><div><p>Wow. Great. It works. </p><p>Thank you.</p><p>Edit: OK. I have successfully installed Windows 8.1. But after installing the AMD graphics driver my monitor goes into power saving mode and doesn&#039;t awake anymore. My graphics card has been detected by the driver but something doesn&#039;t work.</p><p>This is what I get with windows 7 after installing the driver: <a href="http://www.xup.to/dl,79159015/49781408364797804-1041416908.jpg/" rel="nofollow">http://www1.xup.to/tn/2014_08/79159015.jpeg</a></p></div></blockquote></div><p>Are you passing ATI&#039;s HD Audio controller? Just bind it to vfio-pci and leave it alone, passing just VGA controller.</p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1448084">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1448088" class="blockpost roweven"> <h2><span><span class="conr">#2516</span> <a href="viewtopic.php?pid=1448088#p1448088">2014-08-18 14:09:55</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=84422">somearchfan</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2014-08-18</span></dd> <dd><span>Posts: 33</span></dd> <dd class="usercontacts"><span class="email"><a href="misc.php?email=84422">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <p>Yes, I did. Without passing the HD controller I get this under Windows 8.1:<br /><a href="http://www.xup.to/dl,42552220/IMG_20140818_155427_1.jpg/" rel="nofollow"><span class="postimg"><img src="http://www1.xup.to/tn/2014_08/42552220.jpeg" alt="42552220.jpeg" /></span></a></p><p>My config:<br />qemu-system-x86_64 -enable-kvm -M q35 -m 8196 -cpu host -boot d \<br />-smp 4,sockets=1,cores=4,threads=1 \<br />-bios /usr/share/qemu/bios.bin -vga none \<br />-device ioh3420,bus=pcie.0,addr=1c.0,multifunction=on,port=1,chassis=1,id=root.1 \<br />-device vfio-pci,host=01:00.0,bus=root.1,addr=00.0,multifunction=on,x-vga=on,rombar=0,romfile=/home/john/Downloads/Asus.R9270.2048.131007.rom \<br />-device virtio-scsi-pci,id=scsi \<br />-drive file=/run/media/john/win//windows.img,id=disk,format=raw -device scsi-hd,drive=disk \<br />-drive file=/home/john/Desktop/Win7.iso,id=isocd -device ide-cd,bus=ide.1,drive=isocd \<br />-drive file=/home/john/Downloads/virtio-win-0.1-81.iso,id=virtiocd -device ide-cd,bus=ide.2,drive=virtiocd \<br />-usb -usbdevice host:046d:c019 -usbdevice host:046a:0021</p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1448088">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1448233" class="blockpost rowodd"> <h2><span><span class="conr">#2517</span> <a href="viewtopic.php?pid=1448233#p1448233">2014-08-18 20:37:07</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=82643">abdullah</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2014-06-10</span></dd> <dd><span>Posts: 33</span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <p>that BSOD is from Windows itself, you need to go to device manager and disable the graphic from what window, then do the installtion for the drivers.</p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1448233">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1448289" class="blockpost roweven"> <h2><span><span class="conr">#2518</span> <a href="viewtopic.php?pid=1448289#p1448289">2014-08-18 22:45:26</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=84422">somearchfan</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2014-08-18</span></dd> <dd><span>Posts: 33</span></dd> <dd class="usercontacts"><span class="email"><a href="misc.php?email=84422">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <p>Hi,</p><p>this doesn&#039;t sound anything. I still get the BSOD while installing the graphics driver. ;o</p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1448289">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1448302" class="blockpost rowodd"> <h2><span><span class="conr">#2519</span> <a href="viewtopic.php?pid=1448302#p1448302">2014-08-18 23:10:01</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=84447">somebuddy</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2014-08-18</span></dd> <dd><span>Posts: 1</span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <p>I can&#039;t get audio working right in Windows 8.1 as a guest, I get audio output but it is distorted.&#160; I&#039;ve tried both alsa (with libspeex_mediumrate resampler), and pulseaudio as an alsa pipe, as described at: <a href="https://wiki.archlinux.org/index.php/PulseAudio/Examples#PulseAudio_as_a_minimal_unintrusive_dumb_pipe_to_ALSA" rel="nofollow">https://wiki.archlinux.org/index.php/Pu … pe_to_ALSA</a> <br />I&#039;ve also tried installing Realtek audio drivers on the guest, it doesn&#039;t help at all.</p><p>I&#039;m using an Asrock Z97 Extreme 3, which uses Realtek ALC892 for audio.</p><p>Qemu command:</p><div class="codebox"><pre><code>QEMU_ALSA_DAC_BUFFER_SIZE=512 QEMU_ALSA_DAC_PERIOD_SIZE=170 QEMU_AUDIO_DRV=alsa \ sudo qemu-system-x86_64 -enable-kvm -M q35 -m 4096 \ -cpu host,kvm=off \ -smp 2,sockets=1,cores=2,threads=4 \ -bios /usr/share/qemu/bios.bin -vga none -nographic \ -boot menu=on \ -device ioh3420,bus=pcie.0,addr=1c.0,multifunction=on,port=1,chassis=1,id=root.1 \ -device vfio-pci,host=01:00.0,bus=root.1,addr=00.0,multifunction=on,x-vga=on \ -device vfio-pci,host=01:00.1,bus=root.1,addr=00.1 \ -no-hpet \ -usb -usbdevice host:413c:3200 \ -usbdevice host:09da:0260 \ -usbdevice host:0810:0001 \ -device ich9-intel-hda,bus=pcie.0,addr=1b.0,id=sound0 \ -device hda-duplex,id=sound0-codec0,bus=sound0.0,cad=0 \ -drive file=/home/someguy/VM/win8.1.qcow2,id=disk,format=qcow2 -device ide-hd,bus=ide.0,drive=disk </code></pre></div><p>Any ideas?</p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1448302">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1448347" class="blockpost roweven"> <h2><span><span class="conr">#2520</span> <a href="viewtopic.php?pid=1448347#p1448347">2014-08-19 01:48:35</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=84454">darkstego</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2014-08-19</span></dd> <dd><span>Posts: 4</span></dd> <dd class="usercontacts"><span class="email"><a href="misc.php?email=84454">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <p>I haven&#039;t been able to get my passthrough video card to display anything through qemu. I have an nvidia gtx 770 to passthrough to my Windows 8.1 guest while the host is using video from my Intel i5 processor. I am running linux 3.16 with the i915, acs and vga arbiter patches. I have the guest running on qemu 2.0 and I can expose the video card to it and see it in device manager (it is disabled due to Code 43 error). </p><p>The problem is I can never seem to get any output from the nvidia card, not even the seabios. I have the card on the first pcie slot, and set the primary output to igfx in the UEFI/bios.</p><p>/proc/cmdline</p><div class="quotebox"><blockquote><div><p>intel_iommu=on vfio_iommu_type1.allow_unsafe_interrupts=1 kvm_intel.emulate_invalid_guest_state=0 pcie_acs_override=downstream</p></div></blockquote></div><p>I try to test the passthrough by running the following</p><div class="quotebox"><blockquote><div><p>sudo qemu-system-x86_64 -enable-kvm -M q35 -m 1024 -cpu host \<br /> -smp 2,sockets=1,cores=2,threads=1 \<br /> -bios /usr/share/qemu/bios.bin -vga none \<br /> -device ioh3420,bus=pcie.0,addr=1c.0,multifunction=on,port=1,chassis=1,id=root.1 \<br /> -device vfio-pci,host=01:00.0,bus=root.1,addr=00.0,multifunction=on,x-vga=on&#160; \<br /> -device vfio-pci,host=01:00.1,bus=root.1,addr=00.1</p></div></blockquote></div><p>but I don&#039;t get any output from the video card. </p><p>I do however get the following in dmesg</p><div class="quotebox"><blockquote><div><p>[&#160; 108.138741] vfio-pci 0000:01:00.0: enabling device (0000 -&gt; 0003)<br />[&#160; 108.138896] vfio_ecap_init: 0000:01:00.0 hiding ecap 0x19@0x900<br />[&#160; 110.371251] [drm:intel_uncore_check_errors] *ERROR* Unclaimed register before interrupt<br />[&#160; 110.371302] [drm:intel_uncore_check_errors] *ERROR* Unclaimed register before interrupt<br />[&#160; 110.371308] [drm:hsw_unclaimed_reg_check] *ERROR* Unclaimed write to 44040</p></div></blockquote></div><p>Any ideas what I may be doing wrong?</p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1448347">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1448357" class="blockpost rowodd"> <h2><span><span class="conr">#2521</span> <a href="viewtopic.php?pid=1448357#p1448357">2014-08-19 02:17:51</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=82442">slis</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2014-06-02</span></dd> <dd><span>Posts: 125</span></dd> <dd class="usercontacts"><span class="email"><a href="mailto:xslisx@gmail.com">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <p>@darkstego</p><p>you are missing i915 patch activation in cmdline....</p><p>and kvm=off option in qemu for 325+ nvidia driver</p> <p class="postedit"><em>Last edited by slis (2014-08-19 02:18:07)</em></p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1448357">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1448359" class="blockpost roweven"> <h2><span><span class="conr">#2522</span> <a href="viewtopic.php?pid=1448359#p1448359">2014-08-19 02:22:07</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=84454">darkstego</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2014-08-19</span></dd> <dd><span>Posts: 4</span></dd> <dd class="usercontacts"><span class="email"><a href="misc.php?email=84454">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <p>@slis, thanks, I just enabled it.</p><p>I was unaware that there is a kvm=off option for new drivers. I will be sure to add that.</p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1448359">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1448363" class="blockpost rowodd"> <h2><span><span class="conr">#2523</span> <a href="viewtopic.php?pid=1448363#p1448363">2014-08-19 02:46:13</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=84422">somearchfan</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2014-08-18</span></dd> <dd><span>Posts: 33</span></dd> <dd class="usercontacts"><span class="email"><a href="misc.php?email=84422">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <p>My configuration works now. Special thanks to nbhs, abdullah, dwe11erm and ewaller.</p> <p class="postedit"><em>Last edited by somearchfan (2014-08-19 02:47:03)</em></p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1448363">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1448377" class="blockpost roweven"> <h2><span><span class="conr">#2524</span> <a href="viewtopic.php?pid=1448377#p1448377">2014-08-19 04:30:58</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=78377">sitonapanotis</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2014-01-08</span></dd> <dd><span>Posts: 15</span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <p>Im currently in the process of setting up my system and I am wondering does anyone have a way to disable your second monitor in linux when you start the vm and use your 2nd vga card to drive the second monitor? I would like my window manager/desktop environment to transfer the workspaces belonging to the second screen to my primary screen.</p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1448377">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1448436" class="blockpost rowodd"> <h2><span><span class="conr">#2525</span> <a href="viewtopic.php?pid=1448436#p1448436">2014-08-19 09:42:14</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=82238">sinny</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2014-05-24</span></dd> <dd><span>Posts: 75</span></dd> <dd class="usercontacts"><span class="email"><a href="misc.php?email=82238">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>somebuddy wrote:</cite><blockquote><div><p>I can&#039;t get audio working right in Windows 8.1 as a guest, I get audio output but it is distorted.&#160; I&#039;ve tried both alsa (with libspeex_mediumrate resampler), and pulseaudio as an alsa pipe, as described at: <a href="https://wiki.archlinux.org/index.php/PulseAudio/Examples#PulseAudio_as_a_minimal_unintrusive_dumb_pipe_to_ALSA" rel="nofollow">https://wiki.archlinux.org/index.php/Pu … pe_to_ALSA</a> <br />I&#039;ve also tried installing Realtek audio drivers on the guest, it doesn&#039;t help at all.</p><p>I&#039;m using an Asrock Z97 Extreme 3, which uses Realtek ALC892 for audio.</p><p>Qemu command:</p><div class="codebox"><pre><code>QEMU_ALSA_DAC_BUFFER_SIZE=512 QEMU_ALSA_DAC_PERIOD_SIZE=170 QEMU_AUDIO_DRV=alsa \ sudo qemu-system-x86_64 ...</code></pre></div><p>Any ideas?</p></div></blockquote></div><p>why not just pa?<br />why not try varying parameters being used (not to mention learning what they are supposed to mean)?<br />for gods sake...</p><div class="quotebox"><cite>sitonapanotis wrote:</cite><blockquote><div><p>Im currently in the process of setting up my system and I am wondering does anyone have a way to disable your second monitor in linux when you start the vm and use your 2nd vga card to drive the second monitor? I would like my window manager/desktop environment to transfer the workspaces belonging to the second screen to my primary screen.</p></div></blockquote></div><p>xrandr?</p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1448436">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div class="postlinksb"> <div class="inbox crumbsplus"> <div class="pagepost"> <p class="pagelink conl"><span class="pages-label">Pages: </span><a rel="prev" class="item1" href="viewtopic.php?id=162768&amp;p=100">Previous</a> <a href="viewtopic.php?id=162768">1</a> <span class="spacer">…</span> <a href="viewtopic.php?id=162768&amp;p=99">99</a> <a href="viewtopic.php?id=162768&amp;p=100">100</a> <strong>101</strong> <a href="viewtopic.php?id=162768&amp;p=102">102</a> <a href="viewtopic.php?id=162768&amp;p=103">103</a> <span class="spacer">…</span> <a href="viewtopic.php?id=162768&amp;p=234">234</a> <a rel="next" href="viewtopic.php?id=162768&amp;p=102">Next</a></p> <p class="postlink conr">Topic closed</p> </div> <ul class="crumbs"> <li><a href="index.php">Index</a></li> <li><span>»&#160;</span><a href="viewforum.php?id=48">Topics Going Nowhere</a></li> <li><span>»&#160;</span><strong><a href="viewtopic.php?id=162768">KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</a></strong></li> </ul> <p class="subscribelink clearb"><a href="misc.php?action=subscribe&amp;tid=162768">Subscribe to this topic</a></p> <div class="clearer"></div> </div> </div> </div> <div id="brdfooter" class="block"> <h2><span>Board footer</span></h2> <div class="box"> <div id="brdfooternav" class="inbox"> <div class="conl"> <form id="qjump" method="get" action="viewforum.php"> <div><label><span>Jump to<br /></span> <select name="id" onchange="window.location=('viewforum.php?id='+this.options[this.selectedIndex].value)"> <optgroup label="Technical Issues and Assistance"> <option value="23">Newbie Corner</option> <option value="17">Installation</option> <option value="22">Kernel &amp; Hardware</option> <option value="18">Applications &amp; Desktop Environments</option> <option value="31">Laptop Issues</option> <option value="8">Networking, Server, and Protection</option> <option value="32">Multimedia and Games</option> <option value="50">System Administration</option> <option value="35">Other Architectures</option> </optgroup> <optgroup label="Arch-centric"> <option value="24">Announcements, Package &amp; Security Advisories</option> <option value="1">Arch Discussion</option> <option value="13">Forum &amp; Wiki discussion</option> </optgroup> <optgroup label="Pacman Upgrades, Packaging &amp; AUR"> <option value="44">Pacman &amp; Package Upgrade Issues</option> <option value="49">[testing] Repo Forum</option> <option value="4">Creating &amp; Modifying Packages</option> <option value="38">AUR Issues, Discussion &amp; PKGBUILD Requests</option> </optgroup> <optgroup label="Contributions &amp; Discussion"> <option value="20">GNU/Linux Discussion</option> <option value="27">Community Contributions</option> <option value="33">Programming &amp; Scripting</option> <option value="30">Other Languages</option> <option value="47">Artwork and Screenshots</option> <option value="42">Try This</option> </optgroup> <optgroup label="/dev/null"> <option value="29">Off-Topic</option> <option value="48" selected="selected">Topics Going Nowhere</option> <option value="36">Dustbin</option> </optgroup> </select></label> <input type="submit" value=" Go " accesskey="g" /> </div> </form> </div> <div class="conr"> <p id="feedlinks"><span class="atom"><a href="extern.php?action=feed&amp;tid=162768&amp;type=atom">Atom topic feed</a></span></p> <p id="poweredby">Powered by <a href="http://fluxbb.org/">FluxBB</a></p> </div> <div class="clearer"></div> </div> </div> </div> </div> <div class="end-box"></div> </div> </body> </html>
