<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"> <html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en" dir="ltr"> <head> <meta http-equiv="Content-Type" content="text/html; charset=utf-8" /> <title>KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9 (Page 158) / Topics Going Nowhere / Arch Linux Forums</title> <link rel="stylesheet" type="text/css" href="style/ArchLinux.css" /> <link rel="canonical" href="viewtopic.php?id=162768&amp;p=158" title="Page 158" /> <link rel="prev" href="viewtopic.php?id=162768&amp;p=157" title="Page 157" /> <link rel="next" href="viewtopic.php?id=162768&amp;p=159" title="Page 159" /> <link rel="alternate" type="application/atom+xml" href="extern.php?action=feed&amp;tid=162768&amp;type=atom" title="Atom topic feed" /> <link rel="stylesheet" media="screen" href="style/ArchLinux/arch.css?v=3" /> <link rel="stylesheet" media="screen" href="style/ArchLinux/archnavbar.css?v=2" /> <link rel="shortcut icon" href="style/ArchLinux/favicon.ico" /> </head> <body> <div id="archnavbar" class="anb-forum"> <div id="archnavbarlogo"><h1><a href="http://www.archlinux.org/">Arch Linux</a></h1></div> <div id="archnavbarmenu"> <ul id="archnavbarlist"> <li id="anb-home"><a href="http://www.archlinux.org/">Home</a></li><li id="anb-packages"><a href="http://www.archlinux.org/packages/">Packages</a></li><li id="anb-forums" class="anb-selected"><a href="https://bbs.archlinux.org/">Forums</a></li><li id="anb-wiki"><a href="https://wiki.archlinux.org/">Wiki</a></li><li id="anb-bugs"><a href="https://bugs.archlinux.org/">Bugs</a></li><li id="anb-aur"><a href="https://aur.archlinux.org/">AUR</a></li><li id="anb-download"><a href="http://www.archlinux.org/download/">Download</a></li> </ul> </div> </div> <div id="punviewtopic" class="pun"> <div class="top-box"></div> <div class="punwrap"> <div id="brdheader" class="block"> <div class="box"> <div id="brdmenu" class="inbox"> <ul> <li id="navindex" class="isactive"><a href="index.php">Index</a></li> <li id="navuserlist"><a href="userlist.php">User list</a></li> <li id="navsearch"><a href="search.php">Search</a></li> <li id="navprofile"><a href="profile.php?id=80749">Profile</a></li> <li id="navlogout"><a href="login.php?action=out&amp;id=80749&amp;csrf_token=5c20501ec397bb45ef8ee8c84db232c8d8e421c6">Logout</a></li> </ul> </div> <div id="brdwelcome" class="inbox"> <ul class="conl"> <li><span>Logged in as <strong>SXX</strong></span></li> <li><span>Last visit: 2015-08-16 12:20:09</span></li> </ul> <ul class="conr"> <li><span>Topics: <a href="search.php?action=show_replies" title="Find topics you have posted to.">Posted</a> | <a href="search.php?action=show_new" title="Find topics with new posts since your last visit.">New</a> | <a href="search.php?action=show_recent" title="Find topics with recent posts.">Active</a> | <a href="search.php?action=show_unanswered" title="Find topics with no replies.">Unanswered</a></span></li> </ul> <div class="clearer"></div> </div> </div> </div> <div id="brdmain"> <div class="linkst"> <div class="inbox crumbsplus"> <ul class="crumbs"> <li><a href="index.php">Index</a></li> <li><span>»&#160;</span><a href="viewforum.php?id=48">Topics Going Nowhere</a></li> <li><span>»&#160;</span><strong><a href="viewtopic.php?id=162768">KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</a></strong></li> </ul> <div class="pagepost"> <p class="pagelink conl"><span class="pages-label">Pages: </span><a rel="prev" class="item1" href="viewtopic.php?id=162768&amp;p=157">Previous</a> <a href="viewtopic.php?id=162768">1</a> <span class="spacer">…</span> <a href="viewtopic.php?id=162768&amp;p=156">156</a> <a href="viewtopic.php?id=162768&amp;p=157">157</a> <strong>158</strong> <a href="viewtopic.php?id=162768&amp;p=159">159</a> <a href="viewtopic.php?id=162768&amp;p=160">160</a> <span class="spacer">…</span> <a href="viewtopic.php?id=162768&amp;p=234">234</a> <a rel="next" href="viewtopic.php?id=162768&amp;p=159">Next</a></p> <p class="postlink conr">Topic closed</p> </div> <div class="clearer"></div> </div> </div> <div id="p1494641" class="blockpost rowodd blockpost1"> <h2><span><span class="conr">#3926</span> <a href="viewtopic.php?pid=1494641#p1494641">2015-01-19 21:17:05</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=75590">aw</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2013-10-04</span></dd> <dd><span>Posts: 921</span></dd> <dd class="usercontacts"><span class="email"><a href="misc.php?email=75590">Email</a></span> <span class="website"><a href="http://vfio.blogspot.com/" rel="nofollow">Website</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>DelusionalLogic wrote:</cite><blockquote><div><p>Am i right in assuming i can&#039;t enable Spice at all on nividia passthrough? I&#039;d love to hotplug usb devices to the VM.</p></div></blockquote></div><p>Why do you need spice to have hotplug usb devices?&#160; Do you mean hotplug usb from remote clients?&#160; AFAIK, spice requires adding a QXL video head.&#160; If you&#039;re using Win8+/OVMF, then that&#039;s possible and you can even have the GPU render into the QXL display.&#160; However, you might as well be doing software 3D with the speed you&#039;ll get.&#160; You can also disable the QXL display in the guest, I&#039;ve done this to experiment with piping the audio back to the host over spice.&#160; I don&#039;t see why USB wouldn&#039;t work the same.&#160; However, I wonder what the value is of doing USB passthrough via spice when you&#039;re sitting within a monitor cable length of the host and therefore able to just hotplug usb via virt-manager.</p> </div> <div class="postsignature postmsg"><hr /><p><a href="http://vfio.blogspot.com" rel="nofollow">http://vfio.blogspot.com</a><br />Looking for a more open forum to discuss vfio related uses?&#160; Try <a href="https://www.redhat.com/mailman/listinfo/vfio-users" rel="nofollow">https://www.redhat.com/mailman/listinfo/vfio-users</a></p></div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1494641">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1494643" class="blockpost roweven"> <h2><span><span class="conr">#3927</span> <a href="viewtopic.php?pid=1494643#p1494643">2015-01-19 21:28:17</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=71051">DelusionalLogic</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2013-05-07</span></dd> <dd><span>Posts: 40</span></dd> <dd class="usercontacts"><span class="email"><a href="mailto:delusionallogic@gmail.com">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>aw wrote:</cite><blockquote><div><p>Why do you need spice to have hotplug usb devices?&#160; Do you mean hotplug usb from remote clients?&#160; AFAIK, spice requires adding a QXL video head.&#160; If you&#039;re using Win8+/OVMF, then that&#039;s possible and you can even have the GPU render into the QXL display.&#160; However, you might as well be doing software 3D with the speed you&#039;ll get.&#160; You can also disable the QXL display in the guest, I&#039;ve done this to experiment with piping the audio back to the host over spice.&#160; I don&#039;t see why USB wouldn&#039;t work the same.&#160; However, I wonder what the value is of doing USB passthrough via spice when you&#039;re sitting within a monitor cable length of the host and therefore able to just hotplug usb via virt-manager.</p></div></blockquote></div><p>I was under the impression that you would have to reboot the VM to attach a new USB device to it. Is that wrong? If so, then how would i go about hotplugging passthrough devices into the vm. It&#039;s all on my local qemu:///system.</p><p>I tried virsh attach-device usb-dev.xml (with a correctly formatted xml file specifying my phone vendor and product id) sadly that had no effect on my vm.</p><p>I see no option in virt-manager to do this.</p><p>EDIT: Okay, so it works fine with virsh attach-device (the problem was that qualcomm sneakily changes product id every time you switch mode, i was using the wrong id). I&#039;d still love to know how this is done in virt-manager.</p> <p class="postedit"><em>Last edited by DelusionalLogic (2015-01-19 21:33:51)</em></p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1494643">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1494644" class="blockpost rowodd"> <h2><span><span class="conr">#3928</span> <a href="viewtopic.php?pid=1494644#p1494644">2015-01-19 21:32:58</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=75590">aw</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2013-10-04</span></dd> <dd><span>Posts: 921</span></dd> <dd class="usercontacts"><span class="email"><a href="misc.php?email=75590">Email</a></span> <span class="website"><a href="http://vfio.blogspot.com/" rel="nofollow">Website</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>DelusionalLogic wrote:</cite><blockquote><div><p>I was under the impression that you would have to reboot the VM to attach a new USB device to it. Is that wrong? If so, then how would i go about hotplugging passthrough devices into the vm. It&#039;s all on my local qemu:///system.</p><p>I tried virsh attach-device usb-dev.xml (with a correctly formatted xml file specifying my phone vendor and product id) sadly that had no effect on my vm.</p><p>I see no option in virt-manager to do this.</p></div></blockquote></div><p>Hotplug USB should work w/o spice.</p><p>View -&gt; Details</p><p>Add Hardware -&gt; USB Host device -&gt; [select] -&gt; Finish</p> </div> <div class="postsignature postmsg"><hr /><p><a href="http://vfio.blogspot.com" rel="nofollow">http://vfio.blogspot.com</a><br />Looking for a more open forum to discuss vfio related uses?&#160; Try <a href="https://www.redhat.com/mailman/listinfo/vfio-users" rel="nofollow">https://www.redhat.com/mailman/listinfo/vfio-users</a></p></div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1494644">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1494647" class="blockpost roweven"> <h2><span><span class="conr">#3929</span> <a href="viewtopic.php?pid=1494647#p1494647">2015-01-19 21:39:53</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=71051">DelusionalLogic</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2013-05-07</span></dd> <dd><span>Posts: 40</span></dd> <dd class="usercontacts"><span class="email"><a href="mailto:delusionallogic@gmail.com">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>aw wrote:</cite><blockquote><div><p>Hotplug USB should work w/o spice.</p><p>View -&gt; Details</p><p>Add Hardware -&gt; USB Host device -&gt; [select] -&gt; Finish</p></div></blockquote></div><p>Ahh, the problem here is that virt-manager is as dumb as me. It isn&#039;t updating the product id of the device, so it&#039;s trying to add 0x6765 when the correct id is 0x6764. In static applications (such as a controller) that shouldn&#039;t be an issue. thanks.</p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1494647">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1494653" class="blockpost rowodd"> <h2><span><span class="conr">#3930</span> <a href="viewtopic.php?pid=1494653#p1494653">2015-01-19 21:49:23</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=73162">myweb</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2013-07-13</span></dd> <dd><span>Posts: 68</span></dd> <dd class="usercontacts"><span class="email"><a href="misc.php?email=73162">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <p>With i915 is blacklisted I got host system hanged when run two Guests</p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1494653">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1494689" class="blockpost roweven"> <h2><span><span class="conr">#3931</span> <a href="viewtopic.php?pid=1494689#p1494689">2015-01-19 23:51:03</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=71051">DelusionalLogic</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2013-05-07</span></dd> <dd><span>Posts: 40</span></dd> <dd class="usercontacts"><span class="email"><a href="mailto:delusionallogic@gmail.com">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <p>aw, you mentioned audio and spice. Is that the only way to get audio back to the host and out through the same speakers?</p><p>I&#039;m trying to do it right now, and the ICH6 driver is working (i can see it in windows) but nothing is playing from the host, and pulse isn&#039;t detecting a source. I would really prefer not to configure pulse as a system wide service.</p> <p class="postedit"><em>Last edited by DelusionalLogic (2015-01-20 00:29:02)</em></p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1494689">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1494799" class="blockpost rowodd"> <h2><span><span class="conr">#3932</span> <a href="viewtopic.php?pid=1494799#p1494799">2015-01-20 12:29:34</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=79825">redger</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2014-02-26</span></dd> <dd><span>Posts: 15</span></dd> <dd class="usercontacts"><span class="email"><a href="misc.php?email=79825">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <p>Help<br />I am trying to install Win 7 via ovmf / uefi. Win 8 works nicely via ovmf in Libvirt / virt-manager but Win 7 does not<br />The machine is running Ubuntu 14.04 Trusty LTS, patched to support KVM VMs with VGA passthrough - which has been working well for about a year. And a Win8 uefi VM was easy to install. But I want Win 7 <img src="https://bbs.archlinux.org/img/smilies/smile.png" width="15" height="15" alt="smile" /><br />I found NBH reference to success at <a href="https://bbs.archlinux.org/viewtopic.php?pid=1483550#p1483550" rel="nofollow">https://bbs.archlinux.org/viewtopic.php … 0#p1483550</a> and I tried several variations of that method (starting with a Win 7 image which is known to work for BIOS install)<br />ie. create a new image including Virtio and QXL drivers using wintoolkit, create a Fat32 partition on a GPT disk, copy the image files to the new partition and then start the VM for install</p><p>Somehow I always wind up with BCD issues .. or worse eg. </p><div class="codebox"><pre><code>File: \EFI\Microsoft\Boot\BCD Status: 0x0000178 Info: An error occurred while attempting to read the boot configuration data</code></pre></div><p>I&#039;ve looked at the BCD using bcd-edit and cannot see anything obviously wrong ... but then I&#039;m an absolute neophyte so who knows</p><p>The EFI shell is available ..... but I cannot find any useful commands and executing \efi\boot\bootx64.efi just takes me back to the same error - as you might expect</p><p>Can anyone advise a way forward ?</p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1494799">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1494892" class="blockpost roweven"> <h2><span><span class="conr">#3933</span> <a href="viewtopic.php?pid=1494892#p1494892">2015-01-20 18:42:03</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=71051">DelusionalLogic</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2013-05-07</span></dd> <dd><span>Posts: 40</span></dd> <dd class="usercontacts"><span class="email"><a href="mailto:delusionallogic@gmail.com">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <p>I just noticed something, and i can&#039;t be the only one.</p><p>I&#039;m getting really screwy screen updates on the host. If i switch between pages in my PDF reader the display will be one input behind (if i pgup and then pgdown it will go up when i click down, but then after a couple of seconds it goes down). In vim i&#039;m getting 2 lines highlighted at once, and in firefox sometimes my keypresses does the same as the PDF reader (so i write hello, and the h appears when i press e, then the e when i press l and so on).</p><p>It seems to have something to do with the VM running, because it doesn&#039;t really happen when it&#039;s off. I really wish i could turn off the card (at least the fan, the card does seem to go into D3) when i don&#039;t need it.</p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1494892">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1494897" class="blockpost rowodd"> <h2><span><span class="conr">#3934</span> <a href="viewtopic.php?pid=1494897#p1494897">2015-01-20 18:57:54</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=75590">aw</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2013-10-04</span></dd> <dd><span>Posts: 921</span></dd> <dd class="usercontacts"><span class="email"><a href="misc.php?email=75590">Email</a></span> <span class="website"><a href="http://vfio.blogspot.com/" rel="nofollow">Website</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>DelusionalLogic wrote:</cite><blockquote><div><p>I just noticed something, and i can&#039;t be the only one.</p><p>I&#039;m getting really screwy screen updates on the host.[snip]</p></div></blockquote></div><p>Are you using synergy?&#160; I had some strange mouse behavior in chrome that was resolved by using the upstream (paid) version of synergy rather than the distro version.&#160; Otherwise I don&#039;t notice anything like you&#039;re describing with a VM running.&#160; I also don&#039;t try to share mouse/keyboard except through synergy.</p> </div> <div class="postsignature postmsg"><hr /><p><a href="http://vfio.blogspot.com" rel="nofollow">http://vfio.blogspot.com</a><br />Looking for a more open forum to discuss vfio related uses?&#160; Try <a href="https://www.redhat.com/mailman/listinfo/vfio-users" rel="nofollow">https://www.redhat.com/mailman/listinfo/vfio-users</a></p></div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1494897">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1494901" class="blockpost roweven"> <h2><span><span class="conr">#3935</span> <a href="viewtopic.php?pid=1494901#p1494901">2015-01-20 19:20:54</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=57829">walkindude</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2012-03-04</span></dd> <dd><span>Posts: 27</span></dd> <dd class="usercontacts"><span class="email"><a href="mailto:lunarstrainut@gmail.com">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>walkindude wrote:</cite><blockquote><div><p>Tried to switch GPUs on my mobo:</p><p>so, now we have</p><p>HD 6850, x16, blue<br />R9 270, x4, black</p><p>after reboot can&#039;t load to my kernel, it just stuck on <br />grub complaining about diskfilter writes (system&#039;s on lvm, just wait or press any key -&gt; it goes away, and system boots as expected)</p><p>It doesn&#039;t matter if I removed pci-ids or not.</p><p>But I managed to boot in ARCH-kernel, and now I get in dmesg:</p><div class="quotebox"><blockquote><div><p>walkindude@Desktop&gt; sudo dmesg | grep -i AMD-Vi&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; ~<br />[sudo] password for walkindude: <br />[&#160; &#160; 0.107871] AMD-Vi: device: 00:00.2 cap: 0040 seg: 0 flags: 3e info 1300<br />[&#160; &#160; 0.107872] AMD-Vi:&#160; &#160; &#160; &#160; mmio-addr: 00000000feb20000<br />[&#160; &#160; 0.107883] AMD-Vi:&#160; &#160;DEV_SELECT_RANGE_START&#160; &#160;&#160; devid: 00:00.0 flags: 00<br />[&#160; &#160; 0.107885] AMD-Vi:&#160; &#160;DEV_RANGE_END&#160; &#160; &#160; &#160;&#160; devid: 00:00.2<br />[&#160; &#160; 0.107886] AMD-Vi:&#160; &#160;DEV_SELECT&#160; &#160; &#160; &#160; &#160; &#160;&#160; devid: 00:02.0 flags: 00<br />[&#160; &#160; 0.107887] AMD-Vi:&#160; &#160;DEV_SELECT_RANGE_START&#160; &#160;&#160; devid: 01:00.0 flags: 00<br />[&#160; &#160; 0.107888] AMD-Vi:&#160; &#160;DEV_RANGE_END&#160; &#160; &#160; &#160;&#160; devid: 01:00.1<br />[&#160; &#160; 0.107889] AMD-Vi:&#160; &#160;DEV_SELECT&#160; &#160; &#160; &#160; &#160; &#160;&#160; devid: 00:11.0 flags: 00<br />[&#160; &#160; 0.107890] AMD-Vi:&#160; &#160;DEV_SELECT_RANGE_START&#160; &#160;&#160; devid: 00:12.0 flags: 00<br />[&#160; &#160; 0.107891] AMD-Vi:&#160; &#160;DEV_RANGE_END&#160; &#160; &#160; &#160;&#160; devid: 00:12.2<br />[&#160; &#160; 0.107892] AMD-Vi:&#160; &#160;DEV_SELECT_RANGE_START&#160; &#160;&#160; devid: 00:13.0 flags: 00<br />[&#160; &#160; 0.107893] AMD-Vi:&#160; &#160;DEV_RANGE_END&#160; &#160; &#160; &#160;&#160; devid: 00:13.2<br />[&#160; &#160; 0.107894] AMD-Vi:&#160; &#160;DEV_SELECT&#160; &#160; &#160; &#160; &#160; &#160;&#160; devid: 00:14.0 flags: d7<br />[&#160; &#160; 0.107895] AMD-Vi:&#160; &#160;DEV_SELECT&#160; &#160; &#160; &#160; &#160; &#160;&#160; devid: 00:14.3 flags: 00<br />[&#160; &#160; 0.107896] AMD-Vi:&#160; &#160;DEV_SELECT&#160; &#160; &#160; &#160; &#160; &#160;&#160; devid: 00:14.4 flags: 00<br />[&#160; &#160; 0.107898] AMD-Vi:&#160; &#160;DEV_ALIAS_RANGE&#160; &#160; &#160; &#160;&#160; devid: 02:00.0 flags: 00 devid_to: 00:14.4<br />[&#160; &#160; 0.107898] AMD-Vi:&#160; &#160;DEV_RANGE_END&#160; &#160; &#160; &#160;&#160; devid: 02:1f.7<br />[&#160; &#160; 0.107906] AMD-Vi:&#160; &#160;DEV_SELECT&#160; &#160; &#160; &#160; &#160; &#160;&#160; devid: 00:14.5 flags: 00<br />[&#160; &#160; 0.107907] AMD-Vi:&#160; &#160;DEV_SELECT&#160; &#160; &#160; &#160; &#160; &#160;&#160; devid: 00:15.0 flags: 00<br />[&#160; &#160; 0.107908] AMD-Vi:&#160; &#160;DEV_SELECT_RANGE_START&#160; &#160;&#160; devid: 03:00.0 flags: 00<br />[&#160; &#160; 0.107909] AMD-Vi:&#160; &#160;DEV_RANGE_END&#160; &#160; &#160; &#160;&#160; devid: 03:00.1<br />[&#160; &#160; 0.107910] AMD-Vi:&#160; &#160;DEV_SELECT_RANGE_START&#160; &#160;&#160; devid: 00:16.0 flags: 00<br />[&#160; &#160; 0.107911] AMD-Vi:&#160; &#160;DEV_RANGE_END&#160; &#160; &#160; &#160;&#160; devid: 00:16.2<br />[&#160; &#160; 0.107912] AMD-Vi:&#160; &#160;DEV_SPECIAL(IOAPIC[0])&#160; &#160; &#160; &#160; devid: 00:14.0<br />[&#160; &#160; 0.107914] AMD-Vi:&#160; &#160;DEV_SPECIAL(HPET[0])&#160; &#160; &#160; &#160; devid: 00:14.0<br />[&#160; &#160; 0.107915] AMD-Vi:&#160; &#160;DEV_SPECIAL(IOAPIC[255])&#160; &#160; &#160; &#160; devid: 00:00.1<br />[&#160; &#160; 2.908990] AMD-Vi: Found IOMMU at 0000:00:00.2 cap 0x40<br />[&#160; &#160; 2.908992] AMD-Vi: Interrupt remapping enabled<br />[&#160; &#160; 2.909114] AMD-Vi: Initialized for Passthrough Mode<br />[&#160; &#160; 3.045906] AMD-Vi: Completion-Wait loop timed out<br />[&#160; &#160; 3.156248] AMD-Vi: Completion-Wait loop timed out<br />[&#160; &#160; 3.266509] AMD-Vi: Completion-Wait loop timed out<br />[&#160; &#160; 3.376798] AMD-Vi: Completion-Wait loop timed out<br />[&#160; &#160; 3.487084] AMD-Vi: Completion-Wait loop timed out<br />[&#160; &#160; 3.597349] AMD-Vi: Completion-Wait loop timed out<br />[&#160; &#160; 3.707628] AMD-Vi: Completion-Wait loop timed out<br />[&#160; &#160; 3.817917] AMD-Vi: Completion-Wait loop timed out<br />[&#160; &#160; 3.928191] AMD-Vi: Completion-Wait loop timed out<br />[&#160; &#160; 4.017795] AMD-Vi: Event logged [IOTLB_INV_TIMEOUT device=03:00.0 address=0x00000002331e88e0]<br />[&#160; &#160; 4.017805] AMD-Vi: Event logged [IOTLB_INV_TIMEOUT device=03:00.0 address=0x00000002331e8900]<br />[&#160; &#160; 4.017810] AMD-Vi: Event logged [IOTLB_INV_TIMEOUT device=03:00.0 address=0x00000002331e8930]</p></div></blockquote></div><p>If I switch GPUs back,my kernel boots, but during this process I&#039;m seing something strange (can&#039;t find it later in logs, so I shot it by my phone camera)<br /><a href="http://rghost.net/private/60392304/15d7e0fd9de4cf57cad4c8e6c83e5413.view" rel="nofollow">http://rghost.net/private/60392304/15d7 … e5413.view</a><br />These two line were present on all my attempts (on this and previous pages of current topic)</p><p>In dmesg after</p><div class="quotebox"><blockquote><div><p>AMD-Vi: Initialized for Passthrough Mode</p></div></blockquote></div><p>nothing, no lines about </p><div class="quotebox"><blockquote><div><p>Completion-Wait loop timed out or</p></div></blockquote></div><div class="quotebox"><blockquote><div><p>Event logged [IOTLB_INV_TIMEOUT device=03:00.0 address=0x00000002331e8900]</p></div></blockquote></div><p>UEFI bios on my mobo (M5A97 PRO) is the latest available: 1604. I&#039;d flashed it a long time ago, during the installation of FX CPU.</p><p>What is wrong here? Should I buy the second revision or completely another AM3+ motherboard? or smth wrong in my settings?</p></div></blockquote></div><p>So no Windows with Seabios on this configuration?</p><div class="quotebox"><blockquote><div><p>walkindude@Desktop&gt; sudo lspci -v -s 3:00.0&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;~<br />03:00.0 VGA compatible controller: Advanced Micro Devices, Inc. [AMD/ATI] Barts PRO [Radeon HD 6850] (prog-if 00 [VGA controller])<br />&#160; &#160; Subsystem: PC Partner Limited / Sapphire Technology Device e174<br />&#160; &#160; Flags: fast devsel, IRQ 16<br />&#160; &#160; Memory at c0000000 (64-bit, prefetchable) [size=256M]<br />&#160; &#160; Memory at fe820000 (64-bit, non-prefetchable) [size=128K]<br />&#160; &#160; I/O ports at c000 [size=256]<br />&#160; &#160; Expansion ROM at fe800000 [disabled] [size=128K]<br />&#160; &#160; Capabilities: [50] Power Management version 3<br />&#160; &#160; Capabilities: [58] Express Legacy Endpoint, MSI 00<br />&#160; &#160; Capabilities: [a0] MSI: Enable- Count=1/1 Maskable- 64bit+<br />&#160; &#160; Capabilities: [100] Vendor Specific Information: ID=0001 Rev=1 Len=010 &lt;?&gt;<br />&#160; &#160; Capabilities: [150] Advanced Error Reporting<br />&#160; &#160; Kernel driver in use: vfio-pci<br />&#160; &#160; Kernel modules: radeon</p></div></blockquote></div><p>meaning no MSI support currently enabled, am I right? Could I enable it?</p><p>Also tried these patches<br /><a href="http://vfio.blogspot.co.uk/2014/08/fixes-for-linux-radeon-with-440fx-guests.html" rel="nofollow">http://vfio.blogspot.co.uk/2014/08/fixe … uests.html</a><br />the same,<br />AFTER choosing device to boot - black screen</p> <p class="postedit"><em>Last edited by walkindude (2015-01-20 23:16:43)</em></p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1494901">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1494905" class="blockpost rowodd"> <h2><span><span class="conr">#3936</span> <a href="viewtopic.php?pid=1494905#p1494905">2015-01-20 19:35:20</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=71051">DelusionalLogic</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2013-05-07</span></dd> <dd><span>Posts: 40</span></dd> <dd class="usercontacts"><span class="email"><a href="mailto:delusionallogic@gmail.com">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <p>Okay then. I guess i jumped the gun a bit. I noticed that it wasn&#039;t happening earlier, when the VM was down for a reboot, but was now. After turning off the VM and playing around a bit it&#039;s actually vims fault.</p><p>When i do some copy and paste operations in vim (or whatever it feels like it sometimes) it will start to not refresh a line on the screen. It seems that when this happens i have the issues in Zathura as well (my pdf reader). Quitting Vim while the issue is ongoing actually completely fixes the issue in zathura. Very strange, not the VM&#039;s fault though. Even stranger is that i&#039;ve never had this problem before switching my graphics cards (the 660 was my main before), so either the VM does have some effect or the video card is acting up.</p><p>EDIT: Tried it again, and the issue happened again. It seems to be linked to the usage of the virtual machine as well... What&#039;s the current status on CPU pinning and hugepages? are either of those known to cause problems if on/off?</p> <p class="postedit"><em>Last edited by DelusionalLogic (2015-01-20 20:10:39)</em></p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1494905">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1494934" class="blockpost roweven"> <h2><span><span class="conr">#3937</span> <a href="viewtopic.php?pid=1494934#p1494934">2015-01-20 21:18:08</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=73162">myweb</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2013-07-13</span></dd> <dd><span>Posts: 68</span></dd> <dd class="usercontacts"><span class="email"><a href="misc.php?email=73162">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <p><strong>aw</strong><br />Could you please specify what log files, actions should be performed in order to collect necessary information - why virtual machine is not booted (screen is not turned on) if Nvidia GT640 is set as primary VGA device (via vfio x-vga=on).</p><p>Thank you in advance!</p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1494934">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1495023" class="blockpost rowodd"> <h2><span><span class="conr">#3938</span> <a href="viewtopic.php?pid=1495023#p1495023">2015-01-21 08:03:14</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=87815">MrTUX-10</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2015-01-06</span></dd> <dd><span>Posts: 3</span></dd> <dd class="usercontacts"><span class="email"><a href="mailto:speer.jesse25@gmail.com">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <p>Thank you all nbhs, and everyone else for your contributions to this thread! It has been so helpful getting everything setup. I&#039;ve had my VM running for a while now, everything runs pretty damn well. I&#039;m using an Intel 4820k, EVGA-X79 Motherboard, GTX,970 with the latest drivers. I was wondering if anyone could provide some insight on vcpu pinning, i have cset and cgroups setup, and the performance on the machine is actually pretty awesome, but with that, making it even faster is always better, I have looked around a bit from googling, and everthing seems to point to an xml file, however I didn&#039;t create it using libvirt, I launch it from as script. Does anyone have any idea how you would pin the vpcu&#039;s? That would be so helpful!</p><p>Thanks in advance!</p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1495023">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1495048" class="blockpost roweven"> <h2><span><span class="conr">#3939</span> <a href="viewtopic.php?pid=1495048#p1495048">2015-01-21 10:52:20</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=57829">walkindude</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2012-03-04</span></dd> <dd><span>Posts: 27</span></dd> <dd class="usercontacts"><span class="email"><a href="mailto:lunarstrainut@gmail.com">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <p>Tried one last solution (why I didn&#039;t do it earlier?). Booted in ARCH kernel (with no additional patching at all), and NO black screen: Windows DVD boots as expected!!<br />So I guess something wrong either in -ck patches or uksm.</p><p>No, nothing wrong with them:<br />just removed custom dsdt table from kernel and now no black screen</p> <p class="postedit"><em>Last edited by walkindude (2015-01-21 16:55:28)</em></p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1495048">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1495062" class="blockpost rowodd"> <h2><span><span class="conr">#3940</span> <a href="viewtopic.php?pid=1495062#p1495062">2015-01-21 11:41:33</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=57829">walkindude</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2012-03-04</span></dd> <dd><span>Posts: 27</span></dd> <dd class="usercontacts"><span class="email"><a href="mailto:lunarstrainut@gmail.com">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <p>Catalyst installs without problems, I have 1920x1080 on guest.<br />Windows 10 Build 9888<br />Seabios for now, because desired card hasn&#039;t UEFI bios (6850) or maybe I don&#039;t know how to get one. Had seen on youtube how they managed to do it with 7000 series videocard, but for me it didn&#039;t work.</p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1495062">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1495245" class="blockpost roweven"> <h2><span><span class="conr">#3941</span> <a href="viewtopic.php?pid=1495245#p1495245">2015-01-21 21:57:07</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=79825">redger</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2014-02-26</span></dd> <dd><span>Posts: 15</span></dd> <dd class="usercontacts"><span class="email"><a href="misc.php?email=79825">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <p>@walkindude<br />for UEFI bios on older AMD cards, try here <a href="http://www.overclock.net/t/1474306/radeon-6000-series-uefi-bios-thread" rel="nofollow">http://www.overclock.net/t/1474306/rade … ios-thread</a> ... worked for me</p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1495245">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1495263" class="blockpost rowodd"> <h2><span><span class="conr">#3942</span> <a href="viewtopic.php?pid=1495263#p1495263">2015-01-21 22:35:44</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=57829">walkindude</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2012-03-04</span></dd> <dd><span>Posts: 27</span></dd> <dd class="usercontacts"><span class="email"><a href="mailto:lunarstrainut@gmail.com">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <p>@redger<br />Yep, saw it, but not very thorough.. didn&#039;t find Sapphire 6850 1 gb, and moved to seabios then</p><p>tried it, now getting</p><div class="quotebox"><blockquote><div><p>walkindude@Desktop&gt; ~/rom-parser/rom-parser uefi.rom&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; ~/Dropbox<br />Valid ROM signature found @0h, PCIR offset 1ech<br />&#160; &#160; PCIR: type 0, vendor: 1002, device: 6739, class: 030000<br />&#160; &#160; PCIR: revision 0, vendor revision: d0a<br />Valid ROM signature found @fa00h, PCIR offset 1ch<br />&#160; &#160; PCIR: type 3, vendor: 1002, device: 6779, class: 030000<br />&#160; &#160; PCIR: revision 0, vendor revision: 0<br />&#160; &#160; &#160; &#160; EFI: Signature Valid<br />&#160; &#160; Last image</p></div></blockquote></div><p>but isn&#039;t 1002:6779 a 6450? so I just lowered my card?)</p><p>Besides for now system is quite stable and I&#039;ve already install a lot of things and don&#039;t really want to make any more experiments and reinstall everything again. </p><p>Thanks anyway</p><p>----</p><p>One question remains:</p><p>Arch:</p><p>Screen 1 -- Screen 2 &lt;-- hdmi1<br />Synergy server</p><p>Windows:</p><p>Screen 2 &lt;-- hdmi2<br />Synergy client</p><p>Synergys on both system work, I can use my host mouse / keyboard in guest, but </p><p>- If I place hosts horizontally I can&#039;t move to arch at all.</p><p>- If I place windows above, then at start I can move mouse in arch, but after it goes up in windows - it&#039;ll never return.</p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1495263">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1495373" class="blockpost roweven"> <h2><span><span class="conr">#3943</span> <a href="viewtopic.php?pid=1495373#p1495373">2015-01-22 11:51:52</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=86302">4kGamer</a></strong></dt> <dd class="usertitle"><strong>Banned</strong></dd> <dd><span>Registered: 2014-10-29</span></dd> <dd><span>Posts: 82</span></dd> <dd class="usercontacts"><span class="email"><a href="mailto:oktayaslantas@gmx.de">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <p>one question; these days I am enjoying my successful VM <img src="https://bbs.archlinux.org/img/smilies/smile.png" width="15" height="15" alt="smile" /> Although I don&#039;t have to much time. Exams in exactly one month! Therefore I don&#039;t want to break something that works. However having archlinux as a host, I am kinda relying on system updates </p><p>So: How safe is it to update lnux without breaking the VM?</p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1495373">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1495392" class="blockpost rowodd"> <h2><span><span class="conr">#3944</span> <a href="viewtopic.php?pid=1495392#p1495392">2015-01-22 13:09:08</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=57829">walkindude</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2012-03-04</span></dd> <dd><span>Posts: 27</span></dd> <dd class="usercontacts"><span class="email"><a href="mailto:lunarstrainut@gmail.com">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <p>@4kGamer<br />Arch doesn&#039;t force you to update and will live one month and more happily without them.</p><p>As for me:<br />built new versions of kernel, qemu, libvirt several times, also upgraded other packages as well - all mistakes with VM were my own, not some buggy update</p><p>Also there is /var/cache/pacman/pkg is something goes terribly wrong</p> <p class="postedit"><em>Last edited by walkindude (2015-01-22 13:12:02)</em></p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1495392">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1495456" class="blockpost roweven"> <h2><span><span class="conr">#3945</span> <a href="viewtopic.php?pid=1495456#p1495456">2015-01-22 18:55:46</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=88179">KKF</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2015-01-21</span></dd> <dd><span>Posts: 3</span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <p>Hey guys,</p><p>I am new to all this and have wanted to try it out for a while as a learning experience for myself.&#160; I have the budget to build a PC just for this.&#160; For starters I would like to have one Windows 8 VM and Elementary OS as host; if possible.&#160; Eventually I would like to have an OSX VM and a Windows VM, though I understand how difficult that can be.</p><p>With anything of this magnitude I want to make sure I buy the right components for the job.&#160; The only components I own at this point are a 660 ti gpu and a R4 case.&#160; I will probably buy a 970 gpu at some point in the future but no rush at this point.&#160; Any advise on what to buy for MOBO, CPU, and Ram?&#160; Should I buy two separate SSD for each VM?&#160; I have a server that hosts all my documents and files so don&#039;t need to much space on those SSD&#039;s.&#160; </p><p>The OSX VM would mainly be used for Photoshop as my girlfriend prefers the layout of Photoshop in OSX to Windows. The Windows VM would be used for gaming.&#160; I play Heroes of the Storm and SC2.&#160; So nothing to intensive. </p><p>While I really do not have a budget for this I don&#039;t want to spend 2000 dollars either as it really is for learning and the challenge of putting this together.&#160; So what would be my best options for a MOBO, CPU, and Ram?&#160; </p><p>After I buy everything I plan to do an extensive how to on cost and time it took me, a novice, to do this.</p><p>Thanks!</p> <p class="postedit"><em>Last edited by KKF (2015-01-22 18:57:21)</em></p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1495456">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1495465" class="blockpost rowodd"> <h2><span><span class="conr">#3946</span> <a href="viewtopic.php?pid=1495465#p1495465">2015-01-22 20:08:21</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=86302">4kGamer</a></strong></dt> <dd class="usertitle"><strong>Banned</strong></dd> <dd><span>Registered: 2014-10-29</span></dd> <dd><span>Posts: 82</span></dd> <dd class="usercontacts"><span class="email"><a href="mailto:oktayaslantas@gmx.de">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <p>@dude <img src="https://bbs.archlinux.org/img/smilies/wink.png" width="15" height="15" alt="wink" /> Thank you. I tried and everything is still working. Phew <img src="https://bbs.archlinux.org/img/smilies/smile.png" width="15" height="15" alt="smile" /> </p><p>@KKF: Make sure you get the motherboard right. Everything else depends on you. </p><p>I use this one: <strong>ASROCK Z97 Extreme6</strong></p><p>It has been recommended to me by the user Archer here in this thread and I couldn&#039;t be happier</p> <p class="postedit"><em>Last edited by 4kGamer (2015-01-22 20:15:38)</em></p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1495465">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1495466" class="blockpost roweven"> <h2><span><span class="conr">#3947</span> <a href="viewtopic.php?pid=1495466#p1495466">2015-01-22 20:26:57</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=75590">aw</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2013-10-04</span></dd> <dd><span>Posts: 921</span></dd> <dd class="usercontacts"><span class="email"><a href="misc.php?email=75590">Email</a></span> <span class="website"><a href="http://vfio.blogspot.com/" rel="nofollow">Website</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>KKF wrote:</cite><blockquote><div><p>Hey guys,</p><p>I am new to all this and have wanted to try it out for a while as a learning experience for myself.&#160; I have the budget to build a PC just for this.&#160; For starters I would like to have one Windows 8 VM and Elementary OS as host; if possible.&#160; Eventually I would like to have an OSX VM and a Windows VM, though I understand how difficult that can be.</p><p>With anything of this magnitude I want to make sure I buy the right components for the job.&#160; The only components I own at this point are a 660 ti gpu and a R4 case.&#160; I will probably buy a 970 gpu at some point in the future but no rush at this point.&#160; Any advise on what to buy for MOBO, CPU, and Ram?&#160; Should I buy two separate SSD for each VM?&#160; I have a server that hosts all my documents and files so don&#039;t need to much space on those SSD&#039;s.&#160; </p><p>The OSX VM would mainly be used for Photoshop as my girlfriend prefers the layout of Photoshop in OSX to Windows. The Windows VM would be used for gaming.&#160; I play Heroes of the Storm and SC2.&#160; So nothing to intensive. </p><p>While I really do not have a budget for this I don&#039;t want to spend 2000 dollars either as it really is for learning and the challenge of putting this together.&#160; So what would be my best options for a MOBO, CPU, and Ram?&#160; </p><p>After I buy everything I plan to do an extensive how to on cost and time it took me, a novice, to do this.</p><p>Thanks!</p></div></blockquote></div><p>Use a Xeon E5 or better and non-Intel graphics for the host if you don&#039;t want to deal with patching your kernel for ACS or VGA arbitration (BTW, X99 PCH root port patch just posted).&#160; Gigabyte motherboards seem to be the most configurable when it comes selecting a primary graphics device, which may be important if you end up with 3 graphics cards.&#160; If you blow all your money on an over-spec&#039;d GPU for your needs and skimp a &quot;client&quot; processor, you&#039;ll pay for it patching your kernel forever.&#160; Also, make sure you scale your core count and memory for the intended usage.&#160; If you want to game at the same time as your gf is photoshop&#039;ing, then you need to be able to dedicate some cores to each VM.&#160; Also, OSX w/ GPU assignment is not something a lot of people are doing, so be sure to do your research on whether it&#039;s really an option.&#160; There are parts of getting OSX to work that cannot be discussed on forums like this.</p> </div> <div class="postsignature postmsg"><hr /><p><a href="http://vfio.blogspot.com" rel="nofollow">http://vfio.blogspot.com</a><br />Looking for a more open forum to discuss vfio related uses?&#160; Try <a href="https://www.redhat.com/mailman/listinfo/vfio-users" rel="nofollow">https://www.redhat.com/mailman/listinfo/vfio-users</a></p></div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1495466">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1495470" class="blockpost rowodd"> <h2><span><span class="conr">#3948</span> <a href="viewtopic.php?pid=1495470#p1495470">2015-01-22 20:42:33</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=84760">Denso</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd class="postavatar"><img src="https://bbs.archlinux.org/img/avatars/84760.png?m=1412533733" width="71" height="80" alt="" /></dd> <dd><span>Registered: 2014-08-30</span></dd> <dd><span>Posts: 179</span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <p>@aw :</p><p>Started recieving these after I upgraded to 3.19-rc1 and still reciving them on 3.19-rc5 :</p><div class="codebox"><pre class="vscroll"><code>[Thu Jan 22 23:13:54 2015] dmar: DRHD: handling fault status reg 2 [Thu Jan 22 23:13:54 2015] dmar: DMAR:[DMA Read] Request device [02:00.1] fault addr 10af25000 DMAR:[fault reason 06] PTE Read access is not set [Thu Jan 22 23:13:55 2015] dmar: DRHD: handling fault status reg 102 [Thu Jan 22 23:13:55 2015] dmar: DMAR:[DMA Read] Request device [02:00.1] fault addr 10af25000 DMAR:[fault reason 06] PTE Read access is not set [Thu Jan 22 23:13:55 2015] dmar: DRHD: handling fault status reg 202 [Thu Jan 22 23:13:55 2015] dmar: DMAR:[DMA Read] Request device [02:00.1] fault addr 10af25000 DMAR:[fault reason 06] PTE Read access is not set [Thu Jan 22 23:13:56 2015] dmar: DRHD: handling fault status reg 302 [Thu Jan 22 23:13:56 2015] dmar: DMAR:[DMA Read] Request device [02:00.1] fault addr 10af25000 DMAR:[fault reason 06] PTE Read access is not set [Thu Jan 22 23:13:56 2015] dmar: DRHD: handling fault status reg 402 [Thu Jan 22 23:13:56 2015] dmar: DMAR:[DMA Read] Request device [02:00.1] fault addr 10af25000 DMAR:[fault reason 06] PTE Read access is not set [Thu Jan 22 23:13:57 2015] dmar: DRHD: handling fault status reg 502 [Thu Jan 22 23:13:57 2015] dmar: DMAR:[DMA Read] Request device [02:00.1] fault addr 10af25000 DMAR:[fault reason 06] PTE Read access is not set [Thu Jan 22 23:13:58 2015] dmar: DRHD: handling fault status reg 602 [Thu Jan 22 23:13:58 2015] dmar: DMAR:[DMA Read] Request device [02:00.1] fault addr 10af25000 DMAR:[fault reason 06] PTE Read access is not set [Thu Jan 22 23:13:58 2015] dmar: DRHD: handling fault status reg 702 [Thu Jan 22 23:13:58 2015] dmar: DMAR:[DMA Read] Request device [02:00.1] fault addr 10af25000 DMAR:[fault reason 06] PTE Read access is not set [Thu Jan 22 23:13:59 2015] dmar: DRHD: handling fault status reg 2 [Thu Jan 22 23:13:59 2015] dmar: DMAR:[DMA Read] Request device [02:00.1] fault addr 10af25000 DMAR:[fault reason 06] PTE Read access is not set [Thu Jan 22 23:13:59 2015] dmar: DRHD: handling fault status reg 102 [Thu Jan 22 23:13:59 2015] dmar: DMAR:[DMA Read] Request device [02:00.1] fault addr 10af25000 DMAR:[fault reason 06] PTE Read access is not set [Thu Jan 22 23:14:00 2015] dmar: DRHD: handling fault status reg 202 [Thu Jan 22 23:14:00 2015] dmar: DMAR:[DMA Read] Request device [02:00.1] fault addr 10af25000 DMAR:[fault reason 06] PTE Read access is not set [Thu Jan 22 23:14:00 2015] dmar: DRHD: handling fault status reg 302 [Thu Jan 22 23:14:00 2015] dmar: DMAR:[DMA Read] Request device [02:00.1] fault addr 10af25000 DMAR:[fault reason 06] PTE Read access is not set [Thu Jan 22 23:14:01 2015] dmar: DRHD: handling fault status reg 402 [Thu Jan 22 23:14:01 2015] dmar: DMAR:[DMA Read] Request device [02:00.1] fault addr 10af25000 DMAR:[fault reason 06] PTE Read access is not set [Thu Jan 22 23:14:01 2015] dmar: DRHD: handling fault status reg 502 [Thu Jan 22 23:14:01 2015] dmar: DMAR:[DMA Read] Request device [02:00.1] fault addr 10af25000 DMAR:[fault reason 06] PTE Read access is not set [Thu Jan 22 23:14:02 2015] dmar: DRHD: handling fault status reg 602 [Thu Jan 22 23:14:02 2015] dmar: DMAR:[DMA Read] Request device [02:00.1] fault addr 10af25000 DMAR:[fault reason 06] PTE Read access is not set [Thu Jan 22 23:14:03 2015] dmar: DRHD: handling fault status reg 702 [Thu Jan 22 23:14:03 2015] dmar: DMAR:[DMA Read] Request device [02:00.1] fault addr 10af25000 DMAR:[fault reason 06] PTE Read access is not set [Thu Jan 22 23:14:03 2015] dmar: DRHD: handling fault status reg 2 [Thu Jan 22 23:14:03 2015] dmar: DMAR:[DMA Read] Request device [02:00.1] fault addr 10af25000 DMAR:[fault reason 06] PTE Read access is not set [Thu Jan 22 23:14:04 2015] dmar: DRHD: handling fault status reg 102 [Thu Jan 22 23:14:04 2015] dmar: DMAR:[DMA Read] Request device [02:00.1] fault addr 10af25000 DMAR:[fault reason 06] PTE Read access is not set [Thu Jan 22 23:14:04 2015] dmar: DRHD: handling fault status reg 202 [Thu Jan 22 23:14:04 2015] dmar: DMAR:[DMA Read] Request device [02:00.1] fault addr 10af25000 DMAR:[fault reason 06] PTE Read access is not set [Thu Jan 22 23:14:05 2015] dmar: DRHD: handling fault status reg 302 [Thu Jan 22 23:14:05 2015] dmar: DMAR:[DMA Read] Request device [02:00.1] fault addr 10af25000 DMAR:[fault reason 06] PTE Read access is not set [Thu Jan 22 23:14:05 2015] dmar: DRHD: handling fault status reg 402 [Thu Jan 22 23:14:05 2015] dmar: DMAR:[DMA Read] Request device [02:00.1] fault addr 10af25000 DMAR:[fault reason 06] PTE Read access is not set [Thu Jan 22 23:14:06 2015] dmar: DRHD: handling fault status reg 502 [Thu Jan 22 23:14:06 2015] dmar: DMAR:[DMA Read] Request device [02:00.1] fault addr 10af25000 DMAR:[fault reason 06] PTE Read access is not set [Thu Jan 22 23:14:07 2015] dmar: DRHD: handling fault status reg 602 [Thu Jan 22 23:14:07 2015] dmar: DMAR:[DMA Read] Request device [02:00.1] fault addr 10af25000 DMAR:[fault reason 06] PTE Read access is not set [Thu Jan 22 23:14:07 2015] dmar: DRHD: handling fault status reg 702 [Thu Jan 22 23:14:07 2015] dmar: DMAR:[DMA Read] Request device [02:00.1] fault addr 10af25000 DMAR:[fault reason 06] PTE Read access is not set [Thu Jan 22 23:14:08 2015] dmar: DRHD: handling fault status reg 2 [Thu Jan 22 23:14:08 2015] dmar: DMAR:[DMA Read] Request device [02:00.1] fault addr 10af25000 DMAR:[fault reason 06] PTE Read access is not set [Thu Jan 22 23:14:08 2015] dmar: DRHD: handling fault status reg 102 [Thu Jan 22 23:14:08 2015] dmar: DMAR:[DMA Read] Request device [02:00.1] fault addr 10af25000 DMAR:[fault reason 06] PTE Read access is not set [Thu Jan 22 23:14:09 2015] dmar: DRHD: handling fault status reg 202 [Thu Jan 22 23:14:09 2015] dmar: DMAR:[DMA Read] Request device [02:00.1] fault addr 10af25000 DMAR:[fault reason 06] PTE Read access is not set [Thu Jan 22 23:14:09 2015] dmar: DRHD: handling fault status reg 302 [Thu Jan 22 23:14:09 2015] dmar: DMAR:[DMA Read] Request device [02:00.1] fault addr 10af25000 DMAR:[fault reason 06] PTE Read access is not set [Thu Jan 22 23:14:10 2015] dmar: DRHD: handling fault status reg 402 [Thu Jan 22 23:14:10 2015] dmar: DMAR:[DMA Read] Request device [02:00.1] fault addr 10af25000 DMAR:[fault reason 06] PTE Read access is not set [Thu Jan 22 23:14:10 2015] dmar: DRHD: handling fault status reg 502 [Thu Jan 22 23:14:10 2015] dmar: DMAR:[DMA Read] Request device [02:00.1] fault addr 10af25000 DMAR:[fault reason 06] PTE Read access is not set [Thu Jan 22 23:14:11 2015] dmar: DRHD: handling fault status reg 602 [Thu Jan 22 23:14:11 2015] dmar: DMAR:[DMA Read] Request device [02:00.1] fault addr 10af25000 DMAR:[fault reason 06] PTE Read access is not set [Thu Jan 22 23:14:12 2015] dmar: DRHD: handling fault status reg 702 [Thu Jan 22 23:14:12 2015] dmar: DMAR:[DMA Read] Request device [02:00.1] fault addr 10af25000 DMAR:[fault reason 06] PTE Read access is not set [Thu Jan 22 23:14:12 2015] dmar: DRHD: handling fault status reg 2 [Thu Jan 22 23:14:12 2015] dmar: DMAR:[DMA Read] Request device [02:00.1] fault addr 10af25000 DMAR:[fault reason 06] PTE Read access is not set [Thu Jan 22 23:14:13 2015] dmar: DRHD: handling fault status reg 102 [Thu Jan 22 23:14:13 2015] dmar: DMAR:[DMA Read] Request device [02:00.1] fault addr 10af25000 DMAR:[fault reason 06] PTE Read access is not set [Thu Jan 22 23:14:13 2015] dmar: DRHD: handling fault status reg 202 [Thu Jan 22 23:14:13 2015] dmar: DMAR:[DMA Read] Request device [02:00.1] fault addr 10af25000 DMAR:[fault reason 06] PTE Read access is not set [Thu Jan 22 23:14:14 2015] dmar: DRHD: handling fault status reg 302 [Thu Jan 22 23:14:14 2015] dmar: DMAR:[DMA Read] Request device [02:00.1] fault addr 10af25000 DMAR:[fault reason 06] PTE Read access is not set [Thu Jan 22 23:14:14 2015] dmar: DRHD: handling fault status reg 402 [Thu Jan 22 23:14:14 2015] dmar: DMAR:[DMA Read] Request device [02:00.1] fault addr 10af25000 DMAR:[fault reason 06] PTE Read access is not set [Thu Jan 22 23:14:15 2015] dmar: DRHD: handling fault status reg 502 [Thu Jan 22 23:14:15 2015] dmar: DMAR:[DMA Read] Request device [02:00.1] fault addr 10af25000 DMAR:[fault reason 06] PTE Read access is not set [Thu Jan 22 23:14:16 2015] dmar: DRHD: handling fault status reg 602 [Thu Jan 22 23:14:16 2015] dmar: DMAR:[DMA Read] Request device [02:00.1] fault addr 10af25000 DMAR:[fault reason 06] PTE Read access is not set [Thu Jan 22 23:14:16 2015] dmar: DRHD: handling fault status reg 702 [Thu Jan 22 23:14:16 2015] dmar: DMAR:[DMA Read] Request device [02:00.1] fault addr 10af25000 DMAR:[fault reason 06] PTE Read access is not set [Thu Jan 22 23:14:17 2015] dmar: DRHD: handling fault status reg 2 [Thu Jan 22 23:14:17 2015] dmar: DMAR:[DMA Read] Request device [02:00.1] fault addr 10af25000 DMAR:[fault reason 06] PTE Read access is not set [Thu Jan 22 23:14:17 2015] dmar: DRHD: handling fault status reg 102 [Thu Jan 22 23:14:17 2015] dmar: DMAR:[DMA Read] Request device [02:00.1] fault addr 10af25000 DMAR:[fault reason 06] PTE Read access is not set [Thu Jan 22 23:14:18 2015] dmar: DRHD: handling fault status reg 202 [Thu Jan 22 23:14:18 2015] dmar: DMAR:[DMA Read] Request device [02:00.1] fault addr 10af25000 DMAR:[fault reason 06] PTE Read access is not set [Thu Jan 22 23:14:18 2015] dmar: DRHD: handling fault status reg 302 [Thu Jan 22 23:14:18 2015] dmar: DMAR:[DMA Read] Request device [02:00.1] fault addr 10af25000 DMAR:[fault reason 06] PTE Read access is not set [Thu Jan 22 23:14:19 2015] dmar: DRHD: handling fault status reg 402 [Thu Jan 22 23:14:19 2015] dmar: DMAR:[DMA Read] Request device [02:00.1] fault addr 10af25000 DMAR:[fault reason 06] PTE Read access is not set [Thu Jan 22 23:14:19 2015] dmar: DRHD: handling fault status reg 502 [Thu Jan 22 23:14:19 2015] dmar: DMAR:[DMA Read] Request device [02:00.1] fault addr 10af25000 DMAR:[fault reason 06] PTE Read access is not set [Thu Jan 22 23:14:20 2015] dmar: DRHD: handling fault status reg 602 [Thu Jan 22 23:14:20 2015] dmar: DMAR:[DMA Read] Request device [02:00.1] fault addr 10af25000 DMAR:[fault reason 06] PTE Read access is not set [Thu Jan 22 23:14:21 2015] dmar: DRHD: handling fault status reg 702 [Thu Jan 22 23:14:21 2015] dmar: DMAR:[DMA Read] Request device [02:00.1] fault addr 10af25000 DMAR:[fault reason 06] PTE Read access is not set [Thu Jan 22 23:14:21 2015] dmar: DRHD: handling fault status reg 2 [Thu Jan 22 23:14:21 2015] dmar: DMAR:[DMA Read] Request device [02:00.1] fault addr 10af25000 DMAR:[fault reason 06] PTE Read access is not set [Thu Jan 22 23:14:22 2015] dmar: DRHD: handling fault status reg 102 [Thu Jan 22 23:14:22 2015] dmar: DMAR:[DMA Read] Request device [02:00.1] fault addr 10af25000 DMAR:[fault reason 06] PTE Read access is not set [Thu Jan 22 23:14:22 2015] dmar: DRHD: handling fault status reg 202 [Thu Jan 22 23:14:22 2015] dmar: DMAR:[DMA Read] Request device [02:00.1] fault addr 10af25000 DMAR:[fault reason 06] PTE Read access is not set [Thu Jan 22 23:14:23 2015] dmar: DRHD: handling fault status reg 302 [Thu Jan 22 23:14:23 2015] dmar: DMAR:[DMA Read] Request device [02:00.1] fault addr 10af25000 DMAR:[fault reason 06] PTE Read access is not set [Thu Jan 22 23:14:23 2015] dmar: DRHD: handling fault status reg 402 [Thu Jan 22 23:14:23 2015] dmar: DMAR:[DMA Read] Request device [02:00.1] fault addr 10af25000 DMAR:[fault reason 06] PTE Read access is not set [Thu Jan 22 23:14:24 2015] dmar: DRHD: handling fault status reg 502 [Thu Jan 22 23:14:24 2015] dmar: DMAR:[DMA Read] Request device [02:00.1] fault addr 10af25000 DMAR:[fault reason 06] PTE Read access is not set [Thu Jan 22 23:14:25 2015] dmar: DRHD: handling fault status reg 602 [Thu Jan 22 23:14:25 2015] dmar: DMAR:[DMA Read] Request device [02:00.1] fault addr 10af25000 DMAR:[fault reason 06] PTE Read access is not set [Thu Jan 22 23:14:25 2015] dmar: DRHD: handling fault status reg 702 [Thu Jan 22 23:14:25 2015] dmar: DMAR:[DMA Read] Request device [02:00.1] fault addr 10af25000 DMAR:[fault reason 06] PTE Read access is not set [Thu Jan 22 23:14:26 2015] dmar: DRHD: handling fault status reg 2 [Thu Jan 22 23:14:26 2015] dmar: DMAR:[DMA Read] Request device [02:00.1] fault addr 10af25000 DMAR:[fault reason 06] PTE Read access is not set [Thu Jan 22 23:14:26 2015] dmar: DRHD: handling fault status reg 102 [Thu Jan 22 23:14:26 2015] dmar: DMAR:[DMA Read] Request device [02:00.1] fault addr 10af25000 DMAR:[fault reason 06] PTE Read access is not set [Thu Jan 22 23:14:27 2015] dmar: DRHD: handling fault status reg 202 [Thu Jan 22 23:14:27 2015] dmar: DMAR:[DMA Read] Request device [02:00.1] fault addr 10af25000 DMAR:[fault reason 06] PTE Read access is not set [Thu Jan 22 23:14:27 2015] dmar: DRHD: handling fault status reg 302 [Thu Jan 22 23:14:27 2015] dmar: DMAR:[DMA Read] Request device [02:00.1] fault addr 10af25000 DMAR:[fault reason 06] PTE Read access is not set [Thu Jan 22 23:14:28 2015] dmar: DRHD: handling fault status reg 402 [Thu Jan 22 23:14:28 2015] dmar: DMAR:[DMA Read] Request device [02:00.1] fault addr 10af25000 DMAR:[fault reason 06] PTE Read access is not set [Thu Jan 22 23:14:28 2015] dmar: DRHD: handling fault status reg 502 [Thu Jan 22 23:14:28 2015] dmar: DMAR:[DMA Read] Request device [02:00.1] fault addr 10af25000 DMAR:[fault reason 06] PTE Read access is not set [Thu Jan 22 23:14:29 2015] dmar: DRHD: handling fault status reg 602 [Thu Jan 22 23:14:29 2015] dmar: DMAR:[DMA Read] Request device [02:00.1] fault addr 10af25000 DMAR:[fault reason 06] PTE Read access is not set [Thu Jan 22 23:14:30 2015] dmar: DRHD: handling fault status reg 702 [Thu Jan 22 23:14:30 2015] dmar: DMAR:[DMA Read] Request device [02:00.1] fault addr 10af25000 DMAR:[fault reason 06] PTE Read access is not set [Thu Jan 22 23:14:46 2015] dmar: DRHD: handling fault status reg 2 [Thu Jan 22 23:14:46 2015] dmar: DMAR:[DMA Read] Request device [02:00.0] fault addr bf11f000 DMAR:[fault reason 06] PTE Read access is not set [Thu Jan 22 23:14:46 2015] dmar: DMAR:[DMA Read] Request device [02:00.0] fault addr bf169000 DMAR:[fault reason 06] PTE Read access is not set [Thu Jan 22 23:14:46 2015] dmar: DMAR:[DMA Read] Request device [02:00.0] fault addr bf201000 DMAR:[fault reason 06] PTE Read access is not set [Thu Jan 22 23:14:46 2015] dmar: DMAR:[DMA Read] Request device [02:00.0] fault addr bf299000 DMAR:[fault reason 06] PTE Read access is not set [Thu Jan 22 23:14:46 2015] dmar: DMAR:[DMA Read] Request device [02:00.0] fault addr bf331000 DMAR:[fault reason 06] PTE Read access is not set [Thu Jan 22 23:14:46 2015] dmar: DMAR:[DMA Read] Request device [02:00.0] fault addr bf128000 DMAR:[fault reason 06] PTE Read access is not set [Thu Jan 22 23:14:46 2015] dmar: DMAR:[DMA Read] Request device [02:00.0] fault addr bf1c5000 DMAR:[fault reason 06] PTE Read access is not set [Thu Jan 22 23:14:46 2015] dmar: DMAR:[DMA Read] Request device [02:00.0] fault addr bf260000 DMAR:[fault reason 06] PTE Read access is not set [Thu Jan 22 23:14:46 2015] dmar: DMAR:[DMA Read] Request device [02:00.0] fault addr bf2fa000 DMAR:[fault reason 06] PTE Read access is not set [Thu Jan 22 23:14:46 2015] dmar: DMAR:[DMA Read] Request device [02:00.0] fault addr bf466000 DMAR:[fault reason 06] PTE Read access is not set [Thu Jan 22 23:14:46 2015] dmar: DMAR:[DMA Read] Request device [02:00.0] fault addr bf11f000 DMAR:[fault reason 06] PTE Read access is not set [Thu Jan 22 23:14:46 2015] dmar: DMAR:[DMA Read] Request device [02:00.0] fault addr bf18b000 DMAR:[fault reason 06] PTE Read access is not set [Thu Jan 22 23:14:46 2015] dmar: DMAR:[DMA Read] Request device [02:00.0] fault addr bf22a000 DMAR:[fault reason 06] PTE Read access is not set [Thu Jan 22 23:14:46 2015] dmar: DMAR:[DMA Read] Request device [02:00.0] fault addr bf2cc000 DMAR:[fault reason 06] PTE Read access is not set [Thu Jan 22 23:14:46 2015] dmar: DMAR:[DMA Read] Request device [02:00.0] fault addr bf370000 DMAR:[fault reason 06] PTE Read access is not set [Thu Jan 22 23:14:46 2015] dmar: DRHD: handling fault status reg 700 [Thu Jan 22 23:14:46 2015] dmar: DRHD: handling fault status reg 702 [Thu Jan 22 23:14:46 2015] dmar: DMAR:[DMA Read] Request device [02:00.0] fault addr bf456000 DMAR:[fault reason 06] PTE Read access is not set [Thu Jan 22 23:14:46 2015] dmar: DRHD: handling fault status reg 2 [Thu Jan 22 23:14:46 2015] dmar: DMAR:[DMA Read] Request device [02:00.0] fault addr bf45f000 DMAR:[fault reason 06] PTE Read access is not set [Thu Jan 22 23:14:46 2015] dmar: DRHD: handling fault status reg 102 [Thu Jan 22 23:14:46 2015] dmar: DMAR:[DMA Read] Request device [02:00.0] fault addr bf45c000 DMAR:[fault reason 06] PTE Read access is not set [Thu Jan 22 23:14:49 2015] dmar: DRHD: handling fault status reg 202 [Thu Jan 22 23:14:49 2015] dmar: DMAR:[DMA Read] Request device [02:00.0] fault addr bef2e000 DMAR:[fault reason 06] PTE Read access is not set [Thu Jan 22 23:14:49 2015] dmar: DMAR:[DMA Read] Request device [02:00.0] fault addr bef7d000 DMAR:[fault reason 06] PTE Read access is not set [Thu Jan 22 23:14:49 2015] dmar: DMAR:[DMA Read] Request device [02:00.0] fault addr bf01c000 DMAR:[fault reason 06] PTE Read access is not set [Thu Jan 22 23:14:49 2015] dmar: DMAR:[DMA Read] Request device [00:1a.0] fault addr ffffd000 DMAR:[fault reason 06] PTE Read access is not set</code></pre></div><p>02:00.0 --&gt; Nvidia GTX 770<br />00:1a.0 --&gt; Intel X99 USB controller</p><p>Sometimes , the VM that has the GTX 770 throws code 43 and refuse to initialize the GPU when the above errors appear . Sometimes , it works perfectly even with the aforementioned errors .</p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1495470">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1495480" class="blockpost roweven"> <h2><span><span class="conr">#3949</span> <a href="viewtopic.php?pid=1495480#p1495480">2015-01-22 21:17:27</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=78620">mostlyharmless</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2014-01-16</span></dd> <dd><span>Posts: 50</span></dd> <dd class="usercontacts"><span class="email"><a href="misc.php?email=78620">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <p>So, I&#039;ve been trying Arch instead of Slackware and have noticed a few odd things.&#160; My qemu script is </p><div class="codebox"><pre><code>QEMU_SDL_SAMPLES=2048 \ qemu-system-x86_64 -enable-kvm -M q35 -m 8192 -cpu host -smp 6,sockets=1,cores=6,threads=1 \ -bios /usr/share/qemu/bios.bin -vga none\ -device ioh3420,bus=pcie.0,addr=1c.0,multifunction=on,port=1,chassis=1,id=root.1 \ -device vfio-pci,host=03:00.0,bus=root.1,addr=00.0,multifunction=on,x-vga=on \ -drive file=/dev/mapper/cryptvg2-win7,id=disk,if=virtio \ -device piix4-ide,bus=pcie.0 \ -drive file=/dev/sr0,id=cddisk -device ide-cd,bus=ide.1,drive=cddisk \ -net vde -net nic,vlan=0,model=virtio \ -device ich9-intel-hda,bus=pcie.0,addr=1b.0,id=sound0 \ -device hda-duplex,id=sound0-codec0,bus=sound0.0,cad=0 \ -drive file=virtio-win-0.1-74.iso,id=isocd -device ide-cd,bus=ide.2,drive=isocd \ -rtc base=localtime</code></pre></div><p>Which works fine under Slackware -current with kernel 3.16.2... but doesn&#039;t under Arch.&#160; There are two issues.&#160; First, qemu doesn&#039;t execute, it terminates with an error about how &quot;ide-hd&quot; yes &quot;h&quot; not &quot;c&quot; previously being in use. Which is odd considering there is no ide-hd.</p><p> The line -drive file=/dev/sr0,id=cddisk -device ide-cd,bus=ide.1,drive=cddisk&#160; is responsible, remove it and the problem goes away.&#160; I can&#039;t find any permutation of -cdrom,&#160; -device or -drive commands that allow sharing of the host cdrom drive.&#160; Did I miss something new in qemu?&#160; The version under slackware is 2.0.0.</p><p>The second problem is that Windows blue screens and can&#039;t boot, once I remove the offending cdrom line.&#160; If I run the qemu script without passthrough (using vga-std) and without the cdrom line, then it boots fine.&#160; Did something else change?</p><p>I also note that when I do boot successfully there are some console error messages about pulseaudio, presumably something I&#039;m supposed to use under Arch and have not set up. (Slackware doesn&#039;t do pulseaudio, it&#039;s against our/their religion)</p><p>The hardware is an Nvidia Quadro K2000, the CPU intel 4960K, no intel graphics, vfio bind seems to have worked and there is the usual /dev/vfio/vfio and other files present.</p> <p class="postedit"><em>Last edited by mostlyharmless (2015-01-22 21:18:02)</em></p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1495480">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1495515" class="blockpost rowodd"> <h2><span><span class="conr">#3950</span> <a href="viewtopic.php?pid=1495515#p1495515">2015-01-22 23:32:57</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=88205">nythrix</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2015-01-22</span></dd> <dd><span>Posts: 4</span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <p>Thanks to the awesome people helping out in this thread I&#039;ve been able to successfully pass through a 9600GT to a Windows 7 guest.</p><p>Unfortunately, linux guests don&#039;t work. I tried my oldish Debian VM, which has been running on &quot;-vga std&quot; since forever but I loose graphics output around the time the console switches fonts during boot (not sure how to describe it). Everything happens very quickly so the last messages I&#039;m able to make out are stuff about intel RAPL and something about BARs ..? I wiped out the VM and reinstalled Debian but the problem persisted. The installation itself was flawless though (with passthrough). Twice.</p><p>Then I tried installing Fedora 21 Workstation. Couldn&#039;t get much further than some sort of greeting menu. It seems the signal is again lost during attempts to fiddle with the graphics/framebuffer.</p><p>Is this some sort of device reset problems I&#039;m observing?</p><p>PS: I&#039;m running 3.17 with the i915 arbiter patch. Qemu 2.1.2.</p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1495515">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div class="postlinksb"> <div class="inbox crumbsplus"> <div class="pagepost"> <p class="pagelink conl"><span class="pages-label">Pages: </span><a rel="prev" class="item1" href="viewtopic.php?id=162768&amp;p=157">Previous</a> <a href="viewtopic.php?id=162768">1</a> <span class="spacer">…</span> <a href="viewtopic.php?id=162768&amp;p=156">156</a> <a href="viewtopic.php?id=162768&amp;p=157">157</a> <strong>158</strong> <a href="viewtopic.php?id=162768&amp;p=159">159</a> <a href="viewtopic.php?id=162768&amp;p=160">160</a> <span class="spacer">…</span> <a href="viewtopic.php?id=162768&amp;p=234">234</a> <a rel="next" href="viewtopic.php?id=162768&amp;p=159">Next</a></p> <p class="postlink conr">Topic closed</p> </div> <ul class="crumbs"> <li><a href="index.php">Index</a></li> <li><span>»&#160;</span><a href="viewforum.php?id=48">Topics Going Nowhere</a></li> <li><span>»&#160;</span><strong><a href="viewtopic.php?id=162768">KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</a></strong></li> </ul> <p class="subscribelink clearb"><a href="misc.php?action=subscribe&amp;tid=162768">Subscribe to this topic</a></p> <div class="clearer"></div> </div> </div> </div> <div id="brdfooter" class="block"> <h2><span>Board footer</span></h2> <div class="box"> <div id="brdfooternav" class="inbox"> <div class="conl"> <form id="qjump" method="get" action="viewforum.php"> <div><label><span>Jump to<br /></span> <select name="id" onchange="window.location=('viewforum.php?id='+this.options[this.selectedIndex].value)"> <optgroup label="Technical Issues and Assistance"> <option value="23">Newbie Corner</option> <option value="17">Installation</option> <option value="22">Kernel &amp; Hardware</option> <option value="18">Applications &amp; Desktop Environments</option> <option value="31">Laptop Issues</option> <option value="8">Networking, Server, and Protection</option> <option value="32">Multimedia and Games</option> <option value="50">System Administration</option> <option value="35">Other Architectures</option> </optgroup> <optgroup label="Arch-centric"> <option value="24">Announcements, Package &amp; Security Advisories</option> <option value="1">Arch Discussion</option> <option value="13">Forum &amp; Wiki discussion</option> </optgroup> <optgroup label="Pacman Upgrades, Packaging &amp; AUR"> <option value="44">Pacman &amp; Package Upgrade Issues</option> <option value="49">[testing] Repo Forum</option> <option value="4">Creating &amp; Modifying Packages</option> <option value="38">AUR Issues, Discussion &amp; PKGBUILD Requests</option> </optgroup> <optgroup label="Contributions &amp; Discussion"> <option value="20">GNU/Linux Discussion</option> <option value="27">Community Contributions</option> <option value="33">Programming &amp; Scripting</option> <option value="30">Other Languages</option> <option value="47">Artwork and Screenshots</option> <option value="42">Try This</option> </optgroup> <optgroup label="/dev/null"> <option value="29">Off-Topic</option> <option value="48" selected="selected">Topics Going Nowhere</option> <option value="36">Dustbin</option> </optgroup> </select></label> <input type="submit" value=" Go " accesskey="g" /> </div> </form> </div> <div class="conr"> <p id="feedlinks"><span class="atom"><a href="extern.php?action=feed&amp;tid=162768&amp;type=atom">Atom topic feed</a></span></p> <p id="poweredby">Powered by <a href="http://fluxbb.org/">FluxBB</a></p> </div> <div class="clearer"></div> </div> </div> </div> </div> <div class="end-box"></div> </div> </body> </html>
