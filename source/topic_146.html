<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"> <html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en" dir="ltr"> <head> <meta http-equiv="Content-Type" content="text/html; charset=utf-8" /> <title>KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9 (Page 146) / Topics Going Nowhere / Arch Linux Forums</title> <link rel="stylesheet" type="text/css" href="style/ArchLinux.css" /> <link rel="canonical" href="viewtopic.php?id=162768&amp;p=146" title="Page 146" /> <link rel="prev" href="viewtopic.php?id=162768&amp;p=145" title="Page 145" /> <link rel="next" href="viewtopic.php?id=162768&amp;p=147" title="Page 147" /> <link rel="alternate" type="application/atom+xml" href="extern.php?action=feed&amp;tid=162768&amp;type=atom" title="Atom topic feed" /> <link rel="stylesheet" media="screen" href="style/ArchLinux/arch.css?v=3" /> <link rel="stylesheet" media="screen" href="style/ArchLinux/archnavbar.css?v=2" /> <link rel="shortcut icon" href="style/ArchLinux/favicon.ico" /> </head> <body> <div id="archnavbar" class="anb-forum"> <div id="archnavbarlogo"><h1><a href="http://www.archlinux.org/">Arch Linux</a></h1></div> <div id="archnavbarmenu"> <ul id="archnavbarlist"> <li id="anb-home"><a href="http://www.archlinux.org/">Home</a></li><li id="anb-packages"><a href="http://www.archlinux.org/packages/">Packages</a></li><li id="anb-forums" class="anb-selected"><a href="https://bbs.archlinux.org/">Forums</a></li><li id="anb-wiki"><a href="https://wiki.archlinux.org/">Wiki</a></li><li id="anb-bugs"><a href="https://bugs.archlinux.org/">Bugs</a></li><li id="anb-aur"><a href="https://aur.archlinux.org/">AUR</a></li><li id="anb-download"><a href="http://www.archlinux.org/download/">Download</a></li> </ul> </div> </div> <div id="punviewtopic" class="pun"> <div class="top-box"></div> <div class="punwrap"> <div id="brdheader" class="block"> <div class="box"> <div id="brdmenu" class="inbox"> <ul> <li id="navindex" class="isactive"><a href="index.php">Index</a></li> <li id="navuserlist"><a href="userlist.php">User list</a></li> <li id="navsearch"><a href="search.php">Search</a></li> <li id="navprofile"><a href="profile.php?id=80749">Profile</a></li> <li id="navlogout"><a href="login.php?action=out&amp;id=80749&amp;csrf_token=5c20501ec397bb45ef8ee8c84db232c8d8e421c6">Logout</a></li> </ul> </div> <div id="brdwelcome" class="inbox"> <ul class="conl"> <li><span>Logged in as <strong>SXX</strong></span></li> <li><span>Last visit: 2015-08-16 12:20:09</span></li> </ul> <ul class="conr"> <li><span>Topics: <a href="search.php?action=show_replies" title="Find topics you have posted to.">Posted</a> | <a href="search.php?action=show_new" title="Find topics with new posts since your last visit.">New</a> | <a href="search.php?action=show_recent" title="Find topics with recent posts.">Active</a> | <a href="search.php?action=show_unanswered" title="Find topics with no replies.">Unanswered</a></span></li> </ul> <div class="clearer"></div> </div> </div> </div> <div id="brdmain"> <div class="linkst"> <div class="inbox crumbsplus"> <ul class="crumbs"> <li><a href="index.php">Index</a></li> <li><span>»&#160;</span><a href="viewforum.php?id=48">Topics Going Nowhere</a></li> <li><span>»&#160;</span><strong><a href="viewtopic.php?id=162768">KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</a></strong></li> </ul> <div class="pagepost"> <p class="pagelink conl"><span class="pages-label">Pages: </span><a rel="prev" class="item1" href="viewtopic.php?id=162768&amp;p=145">Previous</a> <a href="viewtopic.php?id=162768">1</a> <span class="spacer">…</span> <a href="viewtopic.php?id=162768&amp;p=144">144</a> <a href="viewtopic.php?id=162768&amp;p=145">145</a> <strong>146</strong> <a href="viewtopic.php?id=162768&amp;p=147">147</a> <a href="viewtopic.php?id=162768&amp;p=148">148</a> <span class="spacer">…</span> <a href="viewtopic.php?id=162768&amp;p=234">234</a> <a rel="next" href="viewtopic.php?id=162768&amp;p=147">Next</a></p> <p class="postlink conr">Topic closed</p> </div> <div class="clearer"></div> </div> </div> <div id="p1485493" class="blockpost rowodd blockpost1"> <h2><span><span class="conr">#3626</span> <a href="viewtopic.php?pid=1485493#p1485493">2014-12-18 02:08:50</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=87380">ebol4</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2014-12-17</span></dd> <dd><span>Posts: 4</span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <p>Oh my god, aw, it works. I&#039;ve been trying to get this running for so long. I get BIOS output and it boots into Windows. Checking to make sure the video drivers are functional... edit: YES THEY ARE! </p><p>In case anyone is having a similar issue with Code 12 with Intel Host/Nvidia Guest -- PATCH THE KERNEL!!!!</p><p>Now I just need to figure out how to get some decent input available on it... I&#039;m currently doing &quot;sendkey ____&quot; in the QEMU monitor through TightVNC to navigate Windows....</p><p>Thank you so much for your help.</p> <p class="postedit"><em>Last edited by ebol4 (2014-12-18 02:37:46)</em></p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1485493">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1485592" class="blockpost roweven"> <h2><span><span class="conr">#3627</span> <a href="viewtopic.php?pid=1485592#p1485592">2014-12-18 10:34:43</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=85314">Duelist</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2014-09-22</span></dd> <dd><span>Posts: 358</span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>ebol4 wrote:</cite><blockquote><div><p>Oh my god, aw, it works. I&#039;ve been trying to get this running for so long. I get BIOS output and it boots into Windows. Checking to make sure the video drivers are functional... edit: YES THEY ARE! </p><p>In case anyone is having a similar issue with Code 12 with Intel Host/Nvidia Guest -- PATCH THE KERNEL!!!!</p><p>Now I just need to figure out how to get some decent input available on it... I&#039;m currently doing &quot;sendkey ____&quot; in the QEMU monitor through TightVNC to navigate Windows....</p><p>Thank you so much for your help.</p></div></blockquote></div><p>You can add -device qxl somewhere in the middle to make qemu show you an SDL surface where it can grab keyboard and mouse. But be aware, it lags seriously in source-based games, sometimes mod-keys(shift, ctrl, etc.) stick and the mouse may stop responding if you press some weird buttons(like win+alt+smth). I&#039;ve been using this BAD input for a month or so because i&#039;m lazy as hell.</p><p>Another options are:<br />VNC. I think there was a way of getting it working via qemu&#039;s built-in, so you could rule the keyboard while it&#039;s in BIOS menu, so no software required on guest.<br />Synergy(it doesn&#039;t work in another context, like UAC windows popping up)<br />Spice(my fedora doesn&#039;t have a client in the repos)<br />Separate keyboard-mouse pair connected through passed-through USB controller(or just as usb devices).<br />Hardware KVM(heh!)-switch.</p> <p class="postedit"><em>Last edited by Duelist (2014-12-18 10:35:59)</em></p> </div> <div class="postsignature postmsg"><hr /><p><span class="bbs">The forum rules prohibit requesting support for distributions other than arch.</span><br /><a href="https://bbs.archlinux.org/viewtopic.php?pid=1551460#p1551460" rel="nofollow">I gave up.</a><a href="https://bbs.archlinux.org/viewtopic.php?id=162768" rel="nofollow"> It was too late.</a><br /><a href="http://pastebin.com/B3fL84bq" rel="nofollow">What I was trying to do</a>.<br /><a href="http://vfio.blogspot.com/" rel="nofollow">The reference about VFIO and KVM VGA passthrough.</a></p></div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1485592">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1485639" class="blockpost rowodd"> <h2><span><span class="conr">#3628</span> <a href="viewtopic.php?pid=1485639#p1485639">2014-12-18 13:16:43</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=87064">kidchunks</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2014-12-03</span></dd> <dd><span>Posts: 6</span></dd> <dd class="usercontacts"><span class="email"><a href="misc.php?email=87064">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <p>Setup: Debian, 3.14 Kernel with qemu 2.1.2</p><p>Doing some testing with libvirt (xml) config and I&#039;m getting the following when trying to start my guest using virsh.</p><div class="codebox"><pre><code>2014-12-18T13:11:47.567800Z qemu-system-x86_64: -device vfio-pci,host=85:00.0,addr=03.0,multifunction=on,x-vga=on: vfio_dma_map(0x7fe5acea33b0, 0x100000000, 0x40000000, 0x7fe555800000) = -12 (Cannot allocate memory)</code></pre></div><p>In dmesg (a few of htese):</p><div class="codebox"><pre><code>[ 350.663041] vfio_pin_pages: RLIMIT_MEMLOCK (65536) exceeded</code></pre></div><p>I looked around the thread and saw others have similar issues when trying to run as a diff user other than root. The problem is that I am as root and still cannot launch the guest.</p><p>I checked the RLIMIT using ulimit and got the following:</p><div class="codebox"><pre><code>root@local:~# ulimit unlimited</code></pre></div><p>/etc/libvirt/qemu.conf has the user/group set as well as the cgroup_device_acl.</p><p>libvirt sample config:</p><div class="codebox"><pre><code> &lt;qemu:commandline&gt; &lt;qemu:arg value=&#039;-device&#039;/&gt; &lt;qemu:arg value=&#039;vfio-pci,host=85:00.0,addr=09.0,multifunction=on,x-vga=on&#039;/&gt; &lt;qemu:arg value=&#039;-device&#039;/&gt; &lt;qemu:arg value=&#039;vfio-pci,host=85:00.1,addr=09.1&#039;/&gt; &lt;qemu:arg value=&#039;-bios&#039;/&gt; &lt;qemu:arg value=&#039;/usr/share/seabios/bios.bin&#039;/&gt; &lt;/qemu:commandline&gt;</code></pre></div><p>Again, not sure why even as root, I cannot run the guest using virsh. Running qemu directly works.</p> <p class="postedit"><em>Last edited by kidchunks (2014-12-18 13:40:50)</em></p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1485639">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1485670" class="blockpost roweven"> <h2><span><span class="conr">#3629</span> <a href="viewtopic.php?pid=1485670#p1485670">2014-12-18 15:44:29</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=75590">aw</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2013-10-04</span></dd> <dd><span>Posts: 921</span></dd> <dd class="usercontacts"><span class="email"><a href="misc.php?email=75590">Email</a></span> <span class="website"><a href="http://vfio.blogspot.com/" rel="nofollow">Website</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>kidchunks wrote:</cite><blockquote><div><p>libvirt sample config:</p><div class="codebox"><pre><code> &lt;qemu:commandline&gt; &lt;qemu:arg value=&#039;-device&#039;/&gt; &lt;qemu:arg value=&#039;vfio-pci,host=85:00.0,addr=09.0,multifunction=on,x-vga=on&#039;/&gt; &lt;qemu:arg value=&#039;-device&#039;/&gt; &lt;qemu:arg value=&#039;vfio-pci,host=85:00.1,addr=09.1&#039;/&gt; &lt;qemu:arg value=&#039;-bios&#039;/&gt; &lt;qemu:arg value=&#039;/usr/share/seabios/bios.bin&#039;/&gt; &lt;/qemu:commandline&gt;</code></pre></div></div></blockquote></div><p>You&#039;re causing your own problems with this &lt;qemu:arg&gt; crap.&#160; The bios option is not needed.&#160; The vfio-pci devices should be created as &lt;hostdev&gt; options.&#160; To add the x-vga=on option, use a wrapper script like shown in this post: <a href="https://bbs.archlinux.org/viewtopic.php?pid=1475541#p1475541" rel="nofollow">https://bbs.archlinux.org/viewtopic.php … 1#p1475541</a>&#160; Set the &lt;emulator&gt; to the wrapper.&#160; All the problems you&#039;re having are because you&#039;re hiding the assigned device from libvirt and therefore needing to hack the libvirt setup to allow the VM the permissions that libvirt doesn&#039;t know it needs.</p> </div> <div class="postsignature postmsg"><hr /><p><a href="http://vfio.blogspot.com" rel="nofollow">http://vfio.blogspot.com</a><br />Looking for a more open forum to discuss vfio related uses?&#160; Try <a href="https://www.redhat.com/mailman/listinfo/vfio-users" rel="nofollow">https://www.redhat.com/mailman/listinfo/vfio-users</a></p></div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1485670">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1485738" class="blockpost rowodd"> <h2><span><span class="conr">#3630</span> <a href="viewtopic.php?pid=1485738#p1485738">2014-12-18 20:53:29</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=58583">Nesousx</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2012-03-27</span></dd> <dd><span>Posts: 46</span></dd> <dd class="usercontacts"><span class="email"><a href="misc.php?email=58583">Email</a></span> <span class="website"><a href="https://www.kodi-xbmc.com/" rel="nofollow">Website</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <p>I was looking for the method to build the kernel from first post. Here is a little reminder if anyone had forgotten how to do it like myself.</p><p>Download archive, extract it and cd into it, then:</p><div class="codebox"><pre><code>makepkg -s pacman -U linux-mainline-*</code></pre></div><p>Imho, it would be great if OP could add it to his first post.</p> <p class="postedit"><em>Last edited by Nesousx (2014-12-18 21:09:24)</em></p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1485738">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1485750" class="blockpost roweven"> <h2><span><span class="conr">#3631</span> <a href="viewtopic.php?pid=1485750#p1485750">2014-12-18 21:31:06</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=87064">kidchunks</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2014-12-03</span></dd> <dd><span>Posts: 6</span></dd> <dd class="usercontacts"><span class="email"><a href="misc.php?email=87064">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>aw wrote:</cite><blockquote><div><p>You&#039;re causing your own problems with this &lt;qemu:arg&gt; crap.&#160; The bios option is not needed.&#160; The vfio-pci devices should be created as &lt;hostdev&gt; options.&#160; To add the x-vga=on option, use a wrapper script like shown in this post: <a href="https://bbs.archlinux.org/viewtopic.php?pid=1475541#p1475541" rel="nofollow">https://bbs.archlinux.org/viewtopic.php … 1#p1475541</a>&#160; Set the &lt;emulator&gt; to the wrapper.&#160; All the problems you&#039;re having are because you&#039;re hiding the assigned device from libvirt and therefore needing to hack the libvirt setup to allow the VM the permissions that libvirt doesn&#039;t know it needs.</p></div></blockquote></div><p>Thanks for the clarification and link to the wrapper script. I tried searching for a way to build the script after seeing <a href="https://bbs.archlinux.org/viewtopic.php?pid=1344316#p1344316" rel="nofollow">this post</a> from you but came up short. It&#039;s strange that this worked using ubuntu 14.04 (qemu args in xml file). It could be that ubuntu does something different regarding the implementation.</p><p>Anyways, I&#039;ll stick to using hostdev for libvirt and remove the qemu args. <img src="https://bbs.archlinux.org/img/smilies/smile.png" width="15" height="15" alt="smile" /></p> <p class="postedit"><em>Last edited by kidchunks (2014-12-18 21:40:14)</em></p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1485750">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1485768" class="blockpost rowodd"> <h2><span><span class="conr">#3632</span> <a href="viewtopic.php?pid=1485768#p1485768">2014-12-18 22:56:54</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=44291">magemaster</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>From: Brasil</span></dd> <dd><span>Registered: 2010-11-24</span></dd> <dd><span>Posts: 16</span></dd> <dd class="usercontacts"><span class="email"><a href="misc.php?email=44291">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <p>Just to be clear, the people who can do passthrough with stock kernel are not using intel onboard video as primary, right?<br />Tried a lot with arch stock kernel(3.17) and only was able to have image on the second monitor after <br />patching a kernel(3.18-ck + i915 vga arbiter patch).</p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1485768">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1485769" class="blockpost roweven"> <h2><span><span class="conr">#3633</span> <a href="viewtopic.php?pid=1485769#p1485769">2014-12-18 22:59:32</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=75590">aw</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2013-10-04</span></dd> <dd><span>Posts: 921</span></dd> <dd class="usercontacts"><span class="email"><a href="misc.php?email=75590">Email</a></span> <span class="website"><a href="http://vfio.blogspot.com/" rel="nofollow">Website</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>magemaster wrote:</cite><blockquote><div><p>Just to be clear, the people who can do passthrough with stock kernel are not using intel onboard video as primary, right?</p></div></blockquote></div><p>Or avoiding the whole VGA problem by using OVFM+UEFI</p> </div> <div class="postsignature postmsg"><hr /><p><a href="http://vfio.blogspot.com" rel="nofollow">http://vfio.blogspot.com</a><br />Looking for a more open forum to discuss vfio related uses?&#160; Try <a href="https://www.redhat.com/mailman/listinfo/vfio-users" rel="nofollow">https://www.redhat.com/mailman/listinfo/vfio-users</a></p></div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1485769">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1485825" class="blockpost rowodd"> <h2><span><span class="conr">#3634</span> <a href="viewtopic.php?pid=1485825#p1485825">2014-12-19 06:01:14</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=86321">thearcherblog</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2014-10-30</span></dd> <dd><span>Posts: 165</span></dd> <dd class="usercontacts"><span class="email"><a href="mailto:jjgarcianorway@gmail.com">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>aw wrote:</cite><blockquote><div><div class="quotebox"><cite>magemaster wrote:</cite><blockquote><div><p>Just to be clear, the people who can do passthrough with stock kernel are not using intel onboard video as primary, right?</p></div></blockquote></div><p>Or avoiding the whole VGA problem by using OVFM+UEFI</p></div></blockquote></div><p>Yes, I can confirm this.</p><p>Mine is working with intel on host and NVIDIA on guest using stock kernel but OVFM and UEFI and windows 8.</p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1485825">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1485892" class="blockpost roweven"> <h2><span><span class="conr">#3635</span> <a href="viewtopic.php?pid=1485892#p1485892">2014-12-19 13:13:31</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=44291">magemaster</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>From: Brasil</span></dd> <dd><span>Registered: 2010-11-24</span></dd> <dd><span>Posts: 16</span></dd> <dd class="usercontacts"><span class="email"><a href="misc.php?email=44291">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <p>My vga does not support UEFI and I can&#039;t change the card</p><p>8400GS<br />Valid ROM signature found @0h, PCIR offset 188h<br />&#160; &#160; PCIR: type 0, vendor: 10de, device: 10c3, class: 030000<br />&#160; &#160; PCIR: revision 0, vendor revision: 1<br />&#160; &#160; Last image</p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1485892">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1485900" class="blockpost rowodd"> <h2><span><span class="conr">#3636</span> <a href="viewtopic.php?pid=1485900#p1485900">2014-12-19 13:57:59</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=71051">DelusionalLogic</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2013-05-07</span></dd> <dd><span>Posts: 40</span></dd> <dd class="usercontacts"><span class="email"><a href="mailto:delusionallogic@gmail.com">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <p>If followed the guide, installed windows 8, and it kinda worked, execept the nividia driver. I enabled &quot;kvm=off&quot; on the cpu parameter, and installed the driver (from a cirrus vga adapter, with the card passthroug as secondary). It installed fine, but now i&#039;m getting BSOD&#039;s from the VM. The error is &quot;SYSTEM_SERVICE_EXCEPTION&quot; and it&#039;s originating from the nvidia driver.</p><p>I then tried installing windows 7, but that&#039;s just giving me this whenever i try to boot. the installation went fine (this is without any passthrough).</p><div class="codebox"><pre><code>KVM internal error. Suberror: 1 emulation failure EAX=00000010 EBX=00000080 ECX=00000000 EDX=00000080 ESI=0025db2a EDI=0007db2a EBP=00007c00 ESP=00000200 EIP=000000ca EFL=00010002 [-------] CPL=0 II=0 A20=1 SMM=0 HLT=0 ES =0020 00000200 0000ffff 00009300 CS =b000 000b0000 0000ffff 00009f00 SS =0020 00000200 0000ffff 00009300 DS =0020 00000200 0000ffff 00009300 FS =0020 00000200 0000ffff 00009300 GS =0020 00000200 0000ffff 00009300 LDT=0000 00000000 0000ffff 00008200 TR =0000 00000000 0000ffff 00008b00 GDT= 002b0000 0000001f IDT= 00000000 000003ff CR0=00000010 CR2=00000000 CR3=00000000 CR4=00000000 DR0=0000000000000000 DR1=0000000000000000 DR2=0000000000000000 DR3=0000000000000000 DR6=00000000ffff0ff0 DR7=0000000000000400 EFER=0000000000000000 Code=ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff &lt;ff&gt; ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff</code></pre></div><p>Here&#039;s my script for launching the vm:</p><div class="codebox"><pre><code>vfio-bind 0000:03:00.0 0000:03:00.1 qemu-system-x86_64 -enable-kvm -M q35 -m 1024 -cpu host,kvm=off \ -smp 6,sockets=1,cores=6,threads=1 \ -bios /usr/share/qemu/bios.bin -vga cirrus \ -device ioh3420,bus=pcie.0,addr=1c.0,multifunction=on,port=1,chassis=1,id=root.1 \ -device vfio-pci,host=03:00.0,bus=root.1,addr=00.0,multifunction=on,x-vga=on \ -device vfio-pci,host=03:00.1,bus=root.1,addr=00.1 \ -drive file=/home/delusional/vm/windows.img,id=disk,format=raw -device ide-hd,bus=ide.0,drive=disk \ -drive file=/home/delusional/vm/install.iso,id=isocd -device ide-cd,bus=ide.1,drive=isocd \ -usb -usbdevice host:1038:1361 -usbdevice host:1532:010d \ -net nic -net bridge,br=br0 \ -boot menu=on</code></pre></div><p>I am aware that this would not enable the passthrough anyway (seeing as the nividia card is secondary) but at least it should boot right?</p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1485900">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1485901" class="blockpost roweven"> <h2><span><span class="conr">#3637</span> <a href="viewtopic.php?pid=1485901#p1485901">2014-12-19 14:01:13</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=44291">magemaster</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>From: Brasil</span></dd> <dd><span>Registered: 2010-11-24</span></dd> <dd><span>Posts: 16</span></dd> <dd class="usercontacts"><span class="email"><a href="misc.php?email=44291">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>DelusionalLogic wrote:</cite><blockquote><div><p>If followed the guide, installed windows 8, and it kinda worked, execept the nividia driver. I enabled &quot;kvm=off&quot; on the cpu parameter, and installed the driver (from a cirrus vga adapter, with the card passthroug as secondary). It installed fine, but now i&#039;m getting BSOD&#039;s from the VM. The error is &quot;SYSTEM_SERVICE_EXCEPTION&quot; and it&#039;s originating from the nvidia driver.</p><p>I then tried installing windows 7, but that&#039;s just giving me this whenever i try to boot. the installation went fine (this is without any passthrough).</p><div class="codebox"><pre><code>KVM internal error. Suberror: 1 emulation failure EAX=00000010 EBX=00000080 ECX=00000000 EDX=00000080 ESI=0025db2a EDI=0007db2a EBP=00007c00 ESP=00000200 EIP=000000ca EFL=00010002 [-------] CPL=0 II=0 A20=1 SMM=0 HLT=0 ES =0020 00000200 0000ffff 00009300 CS =b000 000b0000 0000ffff 00009f00 SS =0020 00000200 0000ffff 00009300 DS =0020 00000200 0000ffff 00009300 FS =0020 00000200 0000ffff 00009300 GS =0020 00000200 0000ffff 00009300 LDT=0000 00000000 0000ffff 00008200 TR =0000 00000000 0000ffff 00008b00 GDT= 002b0000 0000001f IDT= 00000000 000003ff CR0=00000010 CR2=00000000 CR3=00000000 CR4=00000000 DR0=0000000000000000 DR1=0000000000000000 DR2=0000000000000000 DR3=0000000000000000 DR6=00000000ffff0ff0 DR7=0000000000000400 EFER=0000000000000000 Code=ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff &lt;ff&gt; ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff</code></pre></div><p>Here&#039;s my script for launching the vm:</p><div class="codebox"><pre><code>vfio-bind 0000:03:00.0 0000:03:00.1 qemu-system-x86_64 -enable-kvm -M q35 -m 1024 -cpu host,kvm=off \ -smp 6,sockets=1,cores=6,threads=1 \ -bios /usr/share/qemu/bios.bin -vga cirrus \ -device ioh3420,bus=pcie.0,addr=1c.0,multifunction=on,port=1,chassis=1,id=root.1 \ -device vfio-pci,host=03:00.0,bus=root.1,addr=00.0,multifunction=on,x-vga=on \ -device vfio-pci,host=03:00.1,bus=root.1,addr=00.1 \ -drive file=/home/delusional/vm/windows.img,id=disk,format=raw -device ide-hd,bus=ide.0,drive=disk \ -drive file=/home/delusional/vm/install.iso,id=isocd -device ide-cd,bus=ide.1,drive=isocd \ -usb -usbdevice host:1038:1361 -usbdevice host:1532:010d \ -net nic -net bridge,br=br0 \ -boot menu=on</code></pre></div><p>I am aware that this would not enable the passthrough anyway (seeing as the nividia card is secondary) but at least it should boot right?</p></div></blockquote></div><br /><p>I was having the same error before I patched the kernel.</p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1485901">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1486091" class="blockpost rowodd"> <h2><span><span class="conr">#3638</span> <a href="viewtopic.php?pid=1486091#p1486091">2014-12-20 10:41:15</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=87435">ailcp</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2014-12-20</span></dd> <dd><span>Posts: 4</span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <p>Hi,</p><p>I am trying to passthrough the GPU of the following computer:</p><p>CPU: Athlon x4 860k (no iGPU)<br />Motherboard: ASRock FM2A88M Extreme4+<br />Primary GPU for host: ATI Rage XL (in PCI slot)<br />GPU for passthrough: MSI GTX 750 Ti OC v1 (in PCIE 3.0 slot)<br />Host OS: Fedora 21 (Stock Kernel 3.17.4)<br />Guest OS: Windows 8.1 64 bit</p><p>Kernel boot parameter in grub:</p><div class="codebox"><pre><code>pci-stub.ids=10de:1380,10de:0fbc iommu=pt</code></pre></div><p>Libvirt XML:</p><div class="codebox"><pre class="vscroll"><code>&lt;domain type=&#039;kvm&#039; xmlns:qemu=&#039;http://libvirt.org/schemas/domain/qemu/1.0&#039;&gt; &lt;name&gt;win8&lt;/name&gt; &lt;uuid&gt;88b0dc9a-8831-11e4-b116-123b93f75cba&lt;/uuid&gt; &lt;memory unit=&#039;KiB&#039;&gt;4194304&lt;/memory&gt; &lt;currentMemory unit=&#039;KiB&#039;&gt;4194304&lt;/currentMemory&gt; &lt;vcpu placement=&#039;static&#039;&gt;2&lt;/vcpu&gt; &lt;resource&gt; &lt;partition&gt;/machine&lt;/partition&gt; &lt;/resource&gt; &lt;os&gt; &lt;type arch=&#039;x86_64&#039; machine=&#039;pc-i440fx-2.1&#039;&gt;hvm&lt;/type&gt; &lt;boot dev=&#039;cdrom&#039;/&gt; &lt;boot dev=&#039;hd&#039;/&gt; &lt;bootmenu enable=&#039;yes&#039;/&gt; &lt;smbios mode=&#039;host&#039;/&gt; &lt;/os&gt; &lt;features&gt; &lt;acpi/&gt; &lt;apic/&gt; &lt;pae/&gt; &lt;kvm&gt; &lt;hidden state=&#039;on&#039;/&gt; &lt;/kvm&gt; &lt;/features&gt; &lt;clock offset=&#039;localtime&#039;/&gt; &lt;on_poweroff&gt;destroy&lt;/on_poweroff&gt; &lt;on_reboot&gt;restart&lt;/on_reboot&gt; &lt;on_crash&gt;restart&lt;/on_crash&gt; &lt;devices&gt; &lt;emulator&gt;/usr/bin/qemu-system-x86_64&lt;/emulator&gt; &lt;disk type=&#039;file&#039; device=&#039;cdrom&#039;&gt; &lt;driver name=&#039;qemu&#039; type=&#039;raw&#039;/&gt; &lt;source file=&#039;/mnt/Windows81.iso&#039;/&gt; &lt;target dev=&#039;hda&#039; bus=&#039;ide&#039;/&gt; &lt;readonly/&gt; &lt;address type=&#039;drive&#039; controller=&#039;0&#039; bus=&#039;0&#039; target=&#039;0&#039; unit=&#039;0&#039;/&gt; &lt;/disk&gt; &lt;disk type=&#039;block&#039; device=&#039;disk&#039;&gt; &lt;driver name=&#039;qemu&#039; type=&#039;raw&#039;/&gt; &lt;source dev=&#039;/dev/disk/by-id/ata-WDC_WD10EALX-759BA1_WD-WCATR8239826&#039;/&gt; &lt;target dev=&#039;hdb&#039; bus=&#039;ide&#039;/&gt; &lt;address type=&#039;drive&#039; controller=&#039;0&#039; bus=&#039;0&#039; target=&#039;0&#039; unit=&#039;1&#039;/&gt; &lt;/disk&gt; &lt;controller type=&#039;usb&#039; index=&#039;0&#039;&gt; &lt;address type=&#039;pci&#039; domain=&#039;0x0000&#039; bus=&#039;0x00&#039; slot=&#039;0x01&#039; function=&#039;0x2&#039;/&gt; &lt;/controller&gt; &lt;controller type=&#039;pci&#039; index=&#039;0&#039; model=&#039;pci-root&#039;/&gt; &lt;controller type=&#039;pci&#039; index=&#039;1&#039; model=&#039;pci-bridge&#039;&gt; &lt;address type=&#039;pci&#039; domain=&#039;0x0000&#039; bus=&#039;0x00&#039; slot=&#039;0x03&#039; function=&#039;0x0&#039;/&gt; &lt;/controller&gt; &lt;controller type=&#039;pci&#039; index=&#039;2&#039; model=&#039;pci-bridge&#039;&gt; &lt;address type=&#039;pci&#039; domain=&#039;0x0000&#039; bus=&#039;0x00&#039; slot=&#039;0x04&#039; function=&#039;0x0&#039;/&gt; &lt;/controller&gt; &lt;controller type=&#039;ide&#039; index=&#039;0&#039;&gt; &lt;address type=&#039;pci&#039; domain=&#039;0x0000&#039; bus=&#039;0x00&#039; slot=&#039;0x01&#039; function=&#039;0x1&#039;/&gt; &lt;/controller&gt; &lt;controller type=&#039;sata&#039; index=&#039;0&#039;&gt; &lt;address type=&#039;pci&#039; domain=&#039;0x0000&#039; bus=&#039;0x00&#039; slot=&#039;0x05&#039; function=&#039;0x0&#039;/&gt; &lt;/controller&gt; &lt;interface type=&#039;bridge&#039;&gt; &lt;mac address=&#039;28:8F:A0:07:98:C4&#039;/&gt; &lt;source bridge=&#039;br0&#039;/&gt; &lt;model type=&#039;e1000&#039;/&gt; &lt;address type=&#039;pci&#039; domain=&#039;0x0000&#039; bus=&#039;0x00&#039; slot=&#039;0x02&#039; function=&#039;0x0&#039;/&gt; &lt;/interface&gt; &lt;input type=&#039;tablet&#039; bus=&#039;usb&#039;/&gt; &lt;hostdev mode=&#039;subsystem&#039; type=&#039;usb&#039; managed=&#039;yes&#039;&gt; &lt;source&gt; &lt;vendor id=&#039;0x046d&#039;/&gt; &lt;product id=&#039;0xc246&#039;/&gt; &lt;address bus=&#039;1&#039; device=&#039;3&#039;/&gt; &lt;/source&gt; &lt;/hostdev&gt; &lt;hostdev mode=&#039;subsystem&#039; type=&#039;usb&#039; managed=&#039;yes&#039;&gt; &lt;source&gt; &lt;vendor id=&#039;0x046d&#039;/&gt; &lt;product id=&#039;0xc52e&#039;/&gt; &lt;address bus=&#039;1&#039; device=&#039;4&#039;/&gt; &lt;/source&gt; &lt;/hostdev&gt; &lt;hostdev mode=&#039;subsystem&#039; type=&#039;pci&#039; managed=&#039;yes&#039;&gt; &lt;driver name=&#039;vfio&#039;/&gt; &lt;source&gt; &lt;address domain=&#039;0x0000&#039; bus=&#039;0x01&#039; slot=&#039;0x00&#039; function=&#039;0x0&#039;/&gt; &lt;/source&gt; &lt;address type=&#039;pci&#039; domain=&#039;0x0000&#039; bus=&#039;0x00&#039; slot=&#039;0x06&#039; function=&#039;0x0&#039;/&gt; &lt;/hostdev&gt; &lt;hostdev mode=&#039;subsystem&#039; type=&#039;pci&#039; managed=&#039;yes&#039;&gt; &lt;driver name=&#039;vfio&#039;/&gt; &lt;source&gt; &lt;address domain=&#039;0x0000&#039; bus=&#039;0x01&#039; slot=&#039;0x00&#039; function=&#039;0x1&#039;/&gt; &lt;/source&gt; &lt;address type=&#039;pci&#039; domain=&#039;0x0000&#039; bus=&#039;0x00&#039; slot=&#039;0x07&#039; function=&#039;0x0&#039;/&gt; &lt;/hostdev&gt; &lt;memballoon model=&#039;virtio&#039;&gt; &lt;address type=&#039;pci&#039; domain=&#039;0x0000&#039; bus=&#039;0x02&#039; slot=&#039;0x04&#039; function=&#039;0x0&#039;/&gt; &lt;/memballoon&gt; &lt;/devices&gt; &lt;qemu:commandline&gt; &lt;qemu:arg value=&#039;-drive&#039;/&gt; &lt;qemu:arg value=&#039;if=pflash,format=raw,readonly,file=/usr/share/edk2.git/ovmf-x64/OVMF-pure-efi.fd&#039;/&gt; &lt;/qemu:commandline&gt; &lt;/domain&gt;</code></pre></div><p>Symptoms:<br />When I boot the guest the first time, the display can output the OVMF screen and the whole boot process successfully.&#160; After booting into Windows, I installed Nvidia driver 334.89 and hope to avoid code 43 error.&#160; After installation finished, the name &quot;GTX 750 Ti&quot; was shown correctly with a yellow exclamation mark in Device Manager and still come with code 43 error.&#160; The screen resolution was stuck at 800x600 and the option to change resolution was greyed out.</p><p>I have looked at the google doc for reporting GPU passthrough results.&#160; It seems that there is no success case of passing through a Nvidia GPU on FM2/FM2+ motherboard + CPU combo.&#160; If someone had successfully passthrough a Nvidia GPU on FM2/FM2+ CPU, would you please share your results.&#160; Since there is some success case of passthrough AMD GPU on FM2/FM2+ CPU, should I just give up on the GTX 750 Ti and buy a AMD GPU instead?&#160; Please give me some advice?&#160; Thank you very much!</p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1486091">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1486095" class="blockpost roweven"> <h2><span><span class="conr">#3639</span> <a href="viewtopic.php?pid=1486095#p1486095">2014-12-20 11:08:22</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=84759">Ansa89</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2014-08-30</span></dd> <dd><span>Posts: 20</span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <p>I encountered a problem while running my VM: it freezed and when I tried to stop it with Ctrl+C, I got this message in syslog:</p><div class="codebox"><pre><code>WARNING: CPU: 3 PID: 2679 at fs/block_dev.c:67 bdev_inode_switch_bdi+0x77/0x80() Modules linked in: xt_mac xt_iprange xt_mark ipt_MASQUERADE nf_nat_masquerade_ipv4 xt_connmark xt_physdev xt_state xt_multiport CPU: 3 PID: 2679 Comm: qemu-system-x86 Tainted: G D O 3.18.1 #1 Hardware name: MSI MS-7758/ZH77A-G43 (MS-7758), BIOS V1.6 10/25/2012 0000000000000000 0000000000000009 ffffffff81a33879 0000000000000000 ffffffff8112cadb ffff88031cc891b0 ffff88031cc89238 ffffffff81ddc400 0000000000000000 000000000006001f ffffffff81286367 ffff88031cc890c0 Call Trace: [&lt;ffffffff81a33879&gt;] ? dump_stack+0x41/0x51 [&lt;ffffffff8112cadb&gt;] ? warn_slowpath_common+0x8b/0xc0 [&lt;ffffffff81286367&gt;] ? bdev_inode_switch_bdi+0x77/0x80 [&lt;ffffffff8128672c&gt;] ? __blkdev_put+0x6c/0x1a0 [&lt;ffffffff812869d5&gt;] ? blkdev_close+0x25/0x30 [&lt;ffffffff81250fad&gt;] ? __fput+0xcd/0x1f0 [&lt;ffffffff8114807f&gt;] ? task_work_run+0x9f/0xe0 [&lt;ffffffff8105bbb9&gt;] ? do_notify_resume+0x69/0xa0 [&lt;ffffffff81250e9b&gt;] ? fput+0x4b/0x90 [&lt;ffffffff81a3cba0&gt;] ? int_signal+0x12/0x17</code></pre></div><br /><p>Host info:<br />- kernel 3.18.1 (without patches)<br />- IGD as primary graphic device<br />- qemu 2.2.0<br />- OVMF (latest svn)<br />- LVM used for guest disk</p><p>Guest info:<br />- Windows 8.1 UEFI<br />- nVidia geForce GTX 650 passed as primary graphic device<br />- virtio drivers for disk</p><p>Script to launch qemu:</p><div class="codebox"><pre><code>qemu-system-x86_64 -enable-kvm -m 4096 -cpu host,hv_relaxed,hv_time,kvm=off \ -smp 2,sockets=1,cores=2,threads=1 \ -vga none -rtc base=localtime -k it \ -device vfio-pci,host=01:00.0,multifunction=on \ -device vfio-pci,host=01:00.1 \ -device virtio-scsi-pci,id=scsi \ -drive file=/dev/qemu/windows,id=disk,format=raw,if=none -device scsi-hd,bus=scsi.0,drive=disk \ -drive if=pflash,format=raw,readonly,file=/usr/share/ovmf/x64/OVMF_CODE.fd \ -drive if=pflash,format=raw,file=/root/OVMF_VARS_Win8.1.fd</code></pre></div><br /><p>Any thoughts about the kernel oops?</p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1486095">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1486269" class="blockpost rowodd"> <h2><span><span class="conr">#3640</span> <a href="viewtopic.php?pid=1486269#p1486269">2014-12-20 21:39:50</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=87446">maxqia</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2014-12-20</span></dd> <dd><span>Posts: 1</span></dd> <dd class="usercontacts"><span class="email"><a href="misc.php?email=87446">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>nbhs wrote:</cite><blockquote><div><p>[*]Use pci-stub</p><p>In my case since i have 2 radeon cards blacklisting the radeon module is not an option, so i use pci-stub.</p><p>NOTE: If pci-stub was built as a module, you&#039;ll need to modify /etc/mkinitcpio.conf and add pci-stub in the MODULES section, after that you need to update your initramfs like this.</p><div class="codebox"><pre><code>mkinitcpio -p linux-mainline</code></pre></div><p>lspci </p><div class="codebox"><pre><code>07:00.0 VGA compatible controller: Advanced Micro Devices, Inc. [AMD/ATI] Cayman PRO [Radeon HD 6950] &lt;-- radeon 6950 07:00.1 Audio device: Advanced Micro Devices, Inc. [AMD/ATI] Cayman/Antilles HDMI Audio [Radeon HD 6900 Series] &lt;-- radeon 6950 audio</code></pre></div><p>lspci -n</p><div class="codebox"><pre><code>07:00.0 0300: 1002:6719 &lt;-- radeon 6950 07:00.1 0403: 1002:aa80 &lt;-- radeon 6950 audio</code></pre></div><p>[/*]</p></div></blockquote></div><p>By the Way, &quot;lspci&quot; &amp; &quot;lspci -n&quot; Can be replaced with a single &quot;lspci -nn&quot; command</p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1486269">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1486455" class="blockpost roweven"> <h2><span><span class="conr">#3641</span> <a href="viewtopic.php?pid=1486455#p1486455">2014-12-21 18:04:13</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=85314">Duelist</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2014-09-22</span></dd> <dd><span>Posts: 358</span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>ailcp wrote:</cite><blockquote><div><p>Hi,</p><p>I am trying to passthrough the GPU of the following computer:</p><p>CPU: Athlon x4 860k (no iGPU)<br />Motherboard: ASRock FM2A88M Extreme4+<br />Primary GPU for host: ATI Rage XL (in PCI slot)<br />GPU for passthrough: MSI GTX 750 Ti OC v1 (in PCIE 3.0 slot)<br />Host OS: Fedora 21 (Stock Kernel 3.17.4)<br />Guest OS: Windows 8.1 64 bit</p><p>I have looked at the google doc for reporting GPU passthrough results.&#160; It seems that there is no success case of passing through a Nvidia GPU on FM2/FM2+ motherboard + CPU combo.&#160; If someone had successfully passthrough a Nvidia GPU on FM2/FM2+ CPU, would you please share your results.&#160; Since there is some success case of passthrough AMD GPU on FM2/FM2+ CPU, should I just give up on the GTX 750 Ti and buy a AMD GPU instead?&#160; Please give me some advice?&#160; Thank you very much!</p></div></blockquote></div><p>1. I really like your CPU. I want that CPU, actually. Can you tell me if there&#039;s PCI-E 3.0 support there? Google tells me that there isn&#039;t one. What does your lspci tell about it?<br />2. I have Athlon X4 750K, trinity-based FM2-socket paired with F2A55 motherboard. I am passing through TWO HD7750 with VGA and it works. As a host GPU i have nvidia gt610. Due to ASUS, there is MAJOR problems with IOMMU realization and memory accesses, but it works as long as i have my firefox running during the startup of VM. It reboots perfectly too. There appear to be some slight performance drawbacks related to bandwidth-issues, but i can&#039;t find the reasons or any info on how the hell crossfire works. I can post my qemu&#039;s launching script if you&#039;re interested, but it&#039;s awful. Oh, and i have fedora 21 too. Check if you have git-repo of OVMF, it helped me a lot when i fiddled with win7+UEFI+GPT setup.<br />3. Continue digging.<br />4. Awesome host gpu, i definitely should dig into old ATI cards, since only PCI ones i have right now are various S3 cards, which won&#039;t work.</p><p>P.S. I&#039;m really-really tired right now, so my language may be a little bit messy, since my head&#039;s contents are messy.</p> <p class="postedit"><em>Last edited by Duelist (2014-12-21 18:05:29)</em></p> </div> <div class="postsignature postmsg"><hr /><p><span class="bbs">The forum rules prohibit requesting support for distributions other than arch.</span><br /><a href="https://bbs.archlinux.org/viewtopic.php?pid=1551460#p1551460" rel="nofollow">I gave up.</a><a href="https://bbs.archlinux.org/viewtopic.php?id=162768" rel="nofollow"> It was too late.</a><br /><a href="http://pastebin.com/B3fL84bq" rel="nofollow">What I was trying to do</a>.<br /><a href="http://vfio.blogspot.com/" rel="nofollow">The reference about VFIO and KVM VGA passthrough.</a></p></div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1486455">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1486590" class="blockpost rowodd"> <h2><span><span class="conr">#3642</span> <a href="viewtopic.php?pid=1486590#p1486590">2014-12-22 03:47:57</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=87435">ailcp</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2014-12-20</span></dd> <dd><span>Posts: 4</span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>Duelist wrote:</cite><blockquote><div><p>1. I really like your CPU. I want that CPU, actually. Can you tell me if there&#039;s PCI-E 3.0 support there? Google tells me that there isn&#039;t one. What does your lspci tell about it?</p></div></blockquote></div><p>Hi Duelist,</p><p>I think there is PCI-E 3.0 support.&#160; lspci shows:<br />LnkCap: Port #0, Speed 8GT/s, Width x16</p><p>Actually I have read your success case about passing through the HD7750, so I am thinking to buy a single slot XFX R7 250e which should be equivalent to the HD7750.&#160; However, I really want to make the GTX 750 Ti work because I really like its low power consumption.</p><p>Since I am a Linux Newbie, hopefully someone with the FM2/FM2+ CPU and Nvidia GPU combo can share their experience on resolving this dreadful code 43 error.&#160; Thank you.</p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1486590">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1486598" class="blockpost roweven"> <h2><span><span class="conr">#3643</span> <a href="viewtopic.php?pid=1486598#p1486598">2014-12-22 04:26:09</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=75590">aw</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2013-10-04</span></dd> <dd><span>Posts: 921</span></dd> <dd class="usercontacts"><span class="email"><a href="misc.php?email=75590">Email</a></span> <span class="website"><a href="http://vfio.blogspot.com/" rel="nofollow">Website</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>ailcp wrote:</cite><blockquote><div><p>I have looked at the google doc for reporting GPU passthrough results.&#160; It seems that there is no success case of passing through a Nvidia GPU on FM2/FM2+ motherboard + CPU combo.&#160; If someone had successfully passthrough a Nvidia GPU on FM2/FM2+ CPU, would you please share your results.&#160; Since there is some success case of passthrough AMD GPU on FM2/FM2+ CPU, should I just give up on the GTX 750 Ti and buy a AMD GPU instead?&#160; Please give me some advice?&#160; Thank you very much!</p></div></blockquote></div><p>I don&#039;t know why you&#039;re getting a Code 43 and don&#039;t have or want any experience on an FM2/+ system, but a few comments on your config:</p><p>a) Your &lt;qemu:arg&gt; options can be avoided, libvirt should support OVMF on F21, it certainly does on F20 w/ the virt-preview repo enabled - <a href="http://vfio.blogspot.com/2014/09/libvirt-now-supports-ovmf.html" rel="nofollow">http://vfio.blogspot.com/2014/09/libvir … -ovmf.html</a></p><p>b) Why are you defining extra PCI bridges in slots 3 &amp; 4?</p><p>c) Why aren&#039;t you using your distro version of QEMU?&#160; Again, F20 + virt preview repo works just fine on my Intel box with GTX750 and OVMF</p><p>d) &lt;smbios mode=&#039;host&#039;/&gt;&#160; Why?</p><p>I don&#039;t know if any of that will help, but better than nothing I suppose.</p> </div> <div class="postsignature postmsg"><hr /><p><a href="http://vfio.blogspot.com" rel="nofollow">http://vfio.blogspot.com</a><br />Looking for a more open forum to discuss vfio related uses?&#160; Try <a href="https://www.redhat.com/mailman/listinfo/vfio-users" rel="nofollow">https://www.redhat.com/mailman/listinfo/vfio-users</a></p></div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1486598">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1486607" class="blockpost rowodd"> <h2><span><span class="conr">#3644</span> <a href="viewtopic.php?pid=1486607#p1486607">2014-12-22 05:44:54</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=87435">ailcp</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2014-12-20</span></dd> <dd><span>Posts: 4</span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>aw wrote:</cite><blockquote><div><p>I don&#039;t know why you&#039;re getting a Code 43 and don&#039;t have or want any experience on an FM2/+ system, but a few comments on your config:</p></div></blockquote></div><p>Thank you so much for aw&#039;s advice.&#160; I guess I should give up on this Nvidia GPU and maybe buy the HD7750 to try.</p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1486607">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1486653" class="blockpost roweven"> <h2><span><span class="conr">#3645</span> <a href="viewtopic.php?pid=1486653#p1486653">2014-12-22 12:33:28</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=85314">Duelist</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2014-09-22</span></dd> <dd><span>Posts: 358</span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>ailcp wrote:</cite><blockquote><div><div class="quotebox"><cite>aw wrote:</cite><blockquote><div><p>I don&#039;t know why you&#039;re getting a Code 43 and don&#039;t have or want any experience on an FM2/+ system, but a few comments on your config:</p></div></blockquote></div><p>Thank you so much for aw&#039;s advice.&#160; I guess I should give up on this Nvidia GPU and maybe buy the HD7750 to try.</p></div></blockquote></div><p>750Ti is better than HD7750 or rare R7 250E. It eats less power, works faster, heats less. It should work. HD7750 isn&#039;t compatible with UEFI out-of-the-box, while 750Ti is.(aw has 750 too) Is there any related messages related to VFIO or your GPU in dmesg? Or, maybe, windows doesn&#039;t enable MSI? Can you show us &quot;sudo lspci -v&quot; when your VM is running?</p><br /><p>BTW, aw, does libvirt gets a copy of OVMF_VARS when ovmf is specified via qemu:arg section? Wasn&#039;t there some other way?</p> </div> <div class="postsignature postmsg"><hr /><p><span class="bbs">The forum rules prohibit requesting support for distributions other than arch.</span><br /><a href="https://bbs.archlinux.org/viewtopic.php?pid=1551460#p1551460" rel="nofollow">I gave up.</a><a href="https://bbs.archlinux.org/viewtopic.php?id=162768" rel="nofollow"> It was too late.</a><br /><a href="http://pastebin.com/B3fL84bq" rel="nofollow">What I was trying to do</a>.<br /><a href="http://vfio.blogspot.com/" rel="nofollow">The reference about VFIO and KVM VGA passthrough.</a></p></div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1486653">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1486666" class="blockpost rowodd"> <h2><span><span class="conr">#3646</span> <a href="viewtopic.php?pid=1486666#p1486666">2014-12-22 14:15:29</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=75590">aw</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2013-10-04</span></dd> <dd><span>Posts: 921</span></dd> <dd class="usercontacts"><span class="email"><a href="misc.php?email=75590">Email</a></span> <span class="website"><a href="http://vfio.blogspot.com/" rel="nofollow">Website</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>Duelist wrote:</cite><blockquote><div><p>BTW, aw, does libvirt gets a copy of OVMF_VARS when ovmf is specified via qemu:arg section? Wasn&#039;t there some other way?</p></div></blockquote></div><p>Not the way it&#039;s specified there, that&#039;s using the unified OVMF image that contains both CODE and VARS.&#160; The guest doesn&#039;t get to persistently store any EFI variables.&#160; It is possible to specify separate CODE and VARS with &lt;qemu:arg&gt;, but libvirt won&#039;t automatically do it for you.&#160; libvirt doesn&#039;t parse anything specified via &lt;qemu:arg&gt;, it just blindly passes it through.</p> </div> <div class="postsignature postmsg"><hr /><p><a href="http://vfio.blogspot.com" rel="nofollow">http://vfio.blogspot.com</a><br />Looking for a more open forum to discuss vfio related uses?&#160; Try <a href="https://www.redhat.com/mailman/listinfo/vfio-users" rel="nofollow">https://www.redhat.com/mailman/listinfo/vfio-users</a></p></div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1486666">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1486706" class="blockpost roweven"> <h2><span><span class="conr">#3647</span> <a href="viewtopic.php?pid=1486706#p1486706">2014-12-22 17:54:25</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=85314">Duelist</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2014-09-22</span></dd> <dd><span>Posts: 358</span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>aw wrote:</cite><blockquote><div><div class="quotebox"><cite>Duelist wrote:</cite><blockquote><div><p>BTW, aw, does libvirt gets a copy of OVMF_VARS when ovmf is specified via qemu:arg section? Wasn&#039;t there some other way?</p></div></blockquote></div><p>Not the way it&#039;s specified there, that&#039;s using the unified OVMF image that contains both CODE and VARS.&#160; The guest doesn&#039;t get to persistently store any EFI variables.</p></div></blockquote></div><p>But that&#039;s not so crucial. Or is it?</p> </div> <div class="postsignature postmsg"><hr /><p><span class="bbs">The forum rules prohibit requesting support for distributions other than arch.</span><br /><a href="https://bbs.archlinux.org/viewtopic.php?pid=1551460#p1551460" rel="nofollow">I gave up.</a><a href="https://bbs.archlinux.org/viewtopic.php?id=162768" rel="nofollow"> It was too late.</a><br /><a href="http://pastebin.com/B3fL84bq" rel="nofollow">What I was trying to do</a>.<br /><a href="http://vfio.blogspot.com/" rel="nofollow">The reference about VFIO and KVM VGA passthrough.</a></p></div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1486706">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1486707" class="blockpost rowodd"> <h2><span><span class="conr">#3648</span> <a href="viewtopic.php?pid=1486707#p1486707">2014-12-22 17:57:07</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=75590">aw</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2013-10-04</span></dd> <dd><span>Posts: 921</span></dd> <dd class="usercontacts"><span class="email"><a href="misc.php?email=75590">Email</a></span> <span class="website"><a href="http://vfio.blogspot.com/" rel="nofollow">Website</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>Duelist wrote:</cite><blockquote><div><div class="quotebox"><cite>aw wrote:</cite><blockquote><div><div class="quotebox"><cite>Duelist wrote:</cite><blockquote><div><p>BTW, aw, does libvirt gets a copy of OVMF_VARS when ovmf is specified via qemu:arg section? Wasn&#039;t there some other way?</p></div></blockquote></div><p>Not the way it&#039;s specified there, that&#039;s using the unified OVMF image that contains both CODE and VARS.&#160; The guest doesn&#039;t get to persistently store any EFI variables.</p></div></blockquote></div><p>But that&#039;s not so crucial. Or is it?</p></div></blockquote></div><p>Depends on the guest and whether it can manage to boot without them.&#160; In most cases I&#039;ve seen, it works fine without VARs.</p> </div> <div class="postsignature postmsg"><hr /><p><a href="http://vfio.blogspot.com" rel="nofollow">http://vfio.blogspot.com</a><br />Looking for a more open forum to discuss vfio related uses?&#160; Try <a href="https://www.redhat.com/mailman/listinfo/vfio-users" rel="nofollow">https://www.redhat.com/mailman/listinfo/vfio-users</a></p></div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1486707">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1486843" class="blockpost roweven"> <h2><span><span class="conr">#3649</span> <a href="viewtopic.php?pid=1486843#p1486843">2014-12-23 08:53:28</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=87484">kainet</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2014-12-22</span></dd> <dd><span>Posts: 9</span></dd> <dd class="usercontacts"><span class="email"><a href="mailto:bart47@gmail.com">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <p>Hi guys! Thanks for this helpful thread.</p><p>I managed to start VM with such hardware:</p><p>OS: Debian Wheezy with no patches (3.18.1 self compiled kernel)<br />MB: GA-Z97M-WIFI<br />Host gpu: Intel HD (unplugged all actions through ssh)<br />Guest: Asus GTX 670</p><div class="codebox"><pre><code>qemu-system-x86_64 -nographic -enable-kvm -M q35 -m 1024 -cpu host,kvm=off \ -smp 4,sockets=1,cores=4,threads=1 \ -bios /usr/share/qemu/bios.bin -vga none \ -device ioh3420,bus=pcie.0,addr=1c.0,multifunction=on,port=1,chassis=1,id=root.1 \ -device vfio-pci,host=01:00.0,bus=root.1,addr=00.0,multifunction=on,x-vga=on \ -device vfio-pci,host=01:00.1,bus=root.1,addr=00.1 \ -usb -usbdevice host:099a:0721 -usbdevice host:09da:9090 \ -device piix4-ide,bus=pcie.0,id=piix4-ide \ -drive file=/root/windows.img,id=disk,format=raw -device ide-hd,bus=piix4-ide.0,drive=disk</code></pre></div><p>But i struggling with several issues. At first i used Q35 sata controller but where was to many BSODs. So i switched to piix4-ide. VM becomes more stable and even faster, but in both cases i cannot install nvidia video driver VM simply freezes. I am using Windows 7 x64. Also i tried to install driver manually but windows cannot find specific file for gtx 670 but it managed to identify video card correctly. I need some help here <img src="https://bbs.archlinux.org/img/smilies/smile.png" width="15" height="15" alt="smile" /> Please <img src="https://bbs.archlinux.org/img/smilies/smile.png" width="15" height="15" alt="smile" /></p><br /><p>Also a have a lot of such messages but they are refers for some problems with my usb devices. For some reason my keyboard resets many times and shifts picture on monitor to right. After several resets and shifts on monitor all calms down.</p><div class="codebox"><pre><code>Dec 23 03:15:21 hypervisor kernel: [17266.255391] usb 1-10: ep 0x82 - rounding interval to 64 microframes, ep desc says 80 microframes Dec 23 03:15:21 hypervisor kernel: [17266.408915] usb 1-7: reset full-speed USB device number 2 using xhci_hcd Dec 23 03:15:21 hypervisor kernel: [17266.409015] xhci_hcd 0000:00:14.0: Setup ERROR: setup context command for slot 1. Dec 23 03:15:21 hypervisor kernel: [17266.409111] usb 1-7: hub failed to enable device, error -22 Dec 23 03:15:21 hypervisor kernel: [17266.561631] usb 1-7: reset full-speed USB device number 2 using xhci_hcd Dec 23 03:15:21 hypervisor kernel: [17266.561743] xhci_hcd 0000:00:14.0: Setup ERROR: setup context command for slot 1. Dec 23 03:15:21 hypervisor kernel: [17266.561852] usb 1-7: hub failed to enable device, error -22 Dec 23 03:15:21 hypervisor kernel: [17266.714487] usb 1-7: reset full-speed USB device number 2 using xhci_hcd Dec 23 03:15:21 hypervisor kernel: [17266.726624] xhci_hcd 0000:00:14.0: xHCI xhci_drop_endpoint called with disabled ep ffff88041a0cd840 Dec 23 03:15:21 hypervisor kernel: [17266.726747] xhci_hcd 0000:00:14.0: xHCI xhci_drop_endpoint called with disabled ep ffff88041a0cd7c0</code></pre></div> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1486843">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1486856" class="blockpost rowodd"> <h2><span><span class="conr">#3650</span> <a href="viewtopic.php?pid=1486856#p1486856">2014-12-23 10:05:47</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=82442">slis</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2014-06-02</span></dd> <dd><span>Posts: 125</span></dd> <dd class="usercontacts"><span class="email"><a href="mailto:xslisx@gmail.com">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <p>You need to use OVMF, or patch kernel.</p><p>That dmesg, looks normal when u pass usb devices like that.</p> <p class="postedit"><em>Last edited by slis (2014-12-23 10:06:14)</em></p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1486856">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div class="postlinksb"> <div class="inbox crumbsplus"> <div class="pagepost"> <p class="pagelink conl"><span class="pages-label">Pages: </span><a rel="prev" class="item1" href="viewtopic.php?id=162768&amp;p=145">Previous</a> <a href="viewtopic.php?id=162768">1</a> <span class="spacer">…</span> <a href="viewtopic.php?id=162768&amp;p=144">144</a> <a href="viewtopic.php?id=162768&amp;p=145">145</a> <strong>146</strong> <a href="viewtopic.php?id=162768&amp;p=147">147</a> <a href="viewtopic.php?id=162768&amp;p=148">148</a> <span class="spacer">…</span> <a href="viewtopic.php?id=162768&amp;p=234">234</a> <a rel="next" href="viewtopic.php?id=162768&amp;p=147">Next</a></p> <p class="postlink conr">Topic closed</p> </div> <ul class="crumbs"> <li><a href="index.php">Index</a></li> <li><span>»&#160;</span><a href="viewforum.php?id=48">Topics Going Nowhere</a></li> <li><span>»&#160;</span><strong><a href="viewtopic.php?id=162768">KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</a></strong></li> </ul> <p class="subscribelink clearb"><a href="misc.php?action=subscribe&amp;tid=162768">Subscribe to this topic</a></p> <div class="clearer"></div> </div> </div> </div> <div id="brdfooter" class="block"> <h2><span>Board footer</span></h2> <div class="box"> <div id="brdfooternav" class="inbox"> <div class="conl"> <form id="qjump" method="get" action="viewforum.php"> <div><label><span>Jump to<br /></span> <select name="id" onchange="window.location=('viewforum.php?id='+this.options[this.selectedIndex].value)"> <optgroup label="Technical Issues and Assistance"> <option value="23">Newbie Corner</option> <option value="17">Installation</option> <option value="22">Kernel &amp; Hardware</option> <option value="18">Applications &amp; Desktop Environments</option> <option value="31">Laptop Issues</option> <option value="8">Networking, Server, and Protection</option> <option value="32">Multimedia and Games</option> <option value="50">System Administration</option> <option value="35">Other Architectures</option> </optgroup> <optgroup label="Arch-centric"> <option value="24">Announcements, Package &amp; Security Advisories</option> <option value="1">Arch Discussion</option> <option value="13">Forum &amp; Wiki discussion</option> </optgroup> <optgroup label="Pacman Upgrades, Packaging &amp; AUR"> <option value="44">Pacman &amp; Package Upgrade Issues</option> <option value="49">[testing] Repo Forum</option> <option value="4">Creating &amp; Modifying Packages</option> <option value="38">AUR Issues, Discussion &amp; PKGBUILD Requests</option> </optgroup> <optgroup label="Contributions &amp; Discussion"> <option value="20">GNU/Linux Discussion</option> <option value="27">Community Contributions</option> <option value="33">Programming &amp; Scripting</option> <option value="30">Other Languages</option> <option value="47">Artwork and Screenshots</option> <option value="42">Try This</option> </optgroup> <optgroup label="/dev/null"> <option value="29">Off-Topic</option> <option value="48" selected="selected">Topics Going Nowhere</option> <option value="36">Dustbin</option> </optgroup> </select></label> <input type="submit" value=" Go " accesskey="g" /> </div> </form> </div> <div class="conr"> <p id="feedlinks"><span class="atom"><a href="extern.php?action=feed&amp;tid=162768&amp;type=atom">Atom topic feed</a></span></p> <p id="poweredby">Powered by <a href="http://fluxbb.org/">FluxBB</a></p> </div> <div class="clearer"></div> </div> </div> </div> </div> <div class="end-box"></div> </div> </body> </html>
