<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"> <html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en" dir="ltr"> <head> <meta http-equiv="Content-Type" content="text/html; charset=utf-8" /> <title>KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9 (Page 201) / Topics Going Nowhere / Arch Linux Forums</title> <link rel="stylesheet" type="text/css" href="style/ArchLinux.css" /> <link rel="canonical" href="viewtopic.php?id=162768&amp;p=201" title="Page 201" /> <link rel="prev" href="viewtopic.php?id=162768&amp;p=200" title="Page 200" /> <link rel="next" href="viewtopic.php?id=162768&amp;p=202" title="Page 202" /> <link rel="alternate" type="application/atom+xml" href="extern.php?action=feed&amp;tid=162768&amp;type=atom" title="Atom topic feed" /> <link rel="stylesheet" media="screen" href="style/ArchLinux/arch.css?v=3" /> <link rel="stylesheet" media="screen" href="style/ArchLinux/archnavbar.css?v=2" /> <link rel="shortcut icon" href="style/ArchLinux/favicon.ico" /> </head> <body> <div id="archnavbar" class="anb-forum"> <div id="archnavbarlogo"><h1><a href="http://www.archlinux.org/">Arch Linux</a></h1></div> <div id="archnavbarmenu"> <ul id="archnavbarlist"> <li id="anb-home"><a href="http://www.archlinux.org/">Home</a></li><li id="anb-packages"><a href="http://www.archlinux.org/packages/">Packages</a></li><li id="anb-forums" class="anb-selected"><a href="https://bbs.archlinux.org/">Forums</a></li><li id="anb-wiki"><a href="https://wiki.archlinux.org/">Wiki</a></li><li id="anb-bugs"><a href="https://bugs.archlinux.org/">Bugs</a></li><li id="anb-aur"><a href="https://aur.archlinux.org/">AUR</a></li><li id="anb-download"><a href="http://www.archlinux.org/download/">Download</a></li> </ul> </div> </div> <div id="punviewtopic" class="pun"> <div class="top-box"></div> <div class="punwrap"> <div id="brdheader" class="block"> <div class="box"> <div id="brdmenu" class="inbox"> <ul> <li id="navindex" class="isactive"><a href="index.php">Index</a></li> <li id="navuserlist"><a href="userlist.php">User list</a></li> <li id="navsearch"><a href="search.php">Search</a></li> <li id="navprofile"><a href="profile.php?id=80749">Profile</a></li> <li id="navlogout"><a href="login.php?action=out&amp;id=80749&amp;csrf_token=5c20501ec397bb45ef8ee8c84db232c8d8e421c6">Logout</a></li> </ul> </div> <div id="brdwelcome" class="inbox"> <ul class="conl"> <li><span>Logged in as <strong>SXX</strong></span></li> <li><span>Last visit: 2015-08-16 12:20:09</span></li> </ul> <ul class="conr"> <li><span>Topics: <a href="search.php?action=show_replies" title="Find topics you have posted to.">Posted</a> | <a href="search.php?action=show_new" title="Find topics with new posts since your last visit.">New</a> | <a href="search.php?action=show_recent" title="Find topics with recent posts.">Active</a> | <a href="search.php?action=show_unanswered" title="Find topics with no replies.">Unanswered</a></span></li> </ul> <div class="clearer"></div> </div> </div> </div> <div id="brdmain"> <div class="linkst"> <div class="inbox crumbsplus"> <ul class="crumbs"> <li><a href="index.php">Index</a></li> <li><span>»&#160;</span><a href="viewforum.php?id=48">Topics Going Nowhere</a></li> <li><span>»&#160;</span><strong><a href="viewtopic.php?id=162768">KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</a></strong></li> </ul> <div class="pagepost"> <p class="pagelink conl"><span class="pages-label">Pages: </span><a rel="prev" class="item1" href="viewtopic.php?id=162768&amp;p=200">Previous</a> <a href="viewtopic.php?id=162768">1</a> <span class="spacer">…</span> <a href="viewtopic.php?id=162768&amp;p=199">199</a> <a href="viewtopic.php?id=162768&amp;p=200">200</a> <strong>201</strong> <a href="viewtopic.php?id=162768&amp;p=202">202</a> <a href="viewtopic.php?id=162768&amp;p=203">203</a> <span class="spacer">…</span> <a href="viewtopic.php?id=162768&amp;p=234">234</a> <a rel="next" href="viewtopic.php?id=162768&amp;p=202">Next</a></p> <p class="postlink conr">Topic closed</p> </div> <div class="clearer"></div> </div> </div> <div id="p1526225" class="blockpost rowodd blockpost1"> <h2><span><span class="conr">#5001</span> <a href="viewtopic.php?pid=1526225#p1526225">2015-05-05 16:43:26</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=82442">slis</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2014-06-02</span></dd> <dd><span>Posts: 125</span></dd> <dd class="usercontacts"><span class="email"><a href="mailto:xslisx@gmail.com">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <p>Hahahaha.</p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1526225">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1526227" class="blockpost roweven"> <h2><span><span class="conr">#5002</span> <a href="viewtopic.php?pid=1526227#p1526227">2015-05-05 16:53:12</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=90902">wulfspider</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2015-05-05</span></dd> <dd><span>Posts: 6</span></dd> <dd class="usercontacts"><span class="email"><a href="misc.php?email=90902">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <p>Just for notice:</p><p>What&#039;s the difference between q35 and 440fx (I think this is the default one)?</p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1526227">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1526229" class="blockpost rowodd"> <h2><span><span class="conr">#5003</span> <a href="viewtopic.php?pid=1526229#p1526229">2015-05-05 16:58:10</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=75590">aw</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2013-10-04</span></dd> <dd><span>Posts: 921</span></dd> <dd class="usercontacts"><span class="email"><a href="misc.php?email=75590">Email</a></span> <span class="website"><a href="http://vfio.blogspot.com/" rel="nofollow">Website</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>wulfspider wrote:</cite><blockquote><div><p>Just for notice:</p><p>What&#039;s the difference between q35 and 440fx (I think this is the default one)?</p></div></blockquote></div><p>Q35 is a PCI-express chipset from around 2007, i440FX is a conventional PCI chipset from around 1996 used on Pentium Pro systems.&#160; QEMU emulates both of these, 440FX better than Q35, IMO.&#160; If you&#039;re running a Windows guest and can use OVMF (UEFI support for GPU and guest OS), then use the default 440FX, it will cause you far fewer problems and you can use libvirt without any hacks.</p> </div> <div class="postsignature postmsg"><hr /><p><a href="http://vfio.blogspot.com" rel="nofollow">http://vfio.blogspot.com</a><br />Looking for a more open forum to discuss vfio related uses?&#160; Try <a href="https://www.redhat.com/mailman/listinfo/vfio-users" rel="nofollow">https://www.redhat.com/mailman/listinfo/vfio-users</a></p></div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1526229">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1526231" class="blockpost roweven"> <h2><span><span class="conr">#5004</span> <a href="viewtopic.php?pid=1526231#p1526231">2015-05-05 17:13:03</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=90902">wulfspider</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2015-05-05</span></dd> <dd><span>Posts: 6</span></dd> <dd class="usercontacts"><span class="email"><a href="misc.php?email=90902">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <p>I am trying to look for the EFI support of my graphics card (GTX 680) like this:</p><div class="codebox"><pre><code># cd /sys/bus/pci/devices/0000:01:00.0/ # echo 1 &gt; rom # cat rom &gt; /tmp/image.rom # echo 0 &gt; rom</code></pre></div><p>But I get an Input/Output error at the step with cat. I added the ids to the pci-stub boot parameter and added the nouveau to modprobe blacklist. Should I remove one of them?</p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1526231">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1526270" class="blockpost rowodd"> <h2><span><span class="conr">#5005</span> <a href="viewtopic.php?pid=1526270#p1526270">2015-05-05 19:44:32</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=75590">aw</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2013-10-04</span></dd> <dd><span>Posts: 921</span></dd> <dd class="usercontacts"><span class="email"><a href="misc.php?email=75590">Email</a></span> <span class="website"><a href="http://vfio.blogspot.com/" rel="nofollow">Website</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>wulfspider wrote:</cite><blockquote><div><p>I am trying to look for the EFI support of my graphics card (GTX 680) like this:</p><div class="codebox"><pre><code># cd /sys/bus/pci/devices/0000:01:00.0/ # echo 1 &gt; rom # cat rom &gt; /tmp/image.rom # echo 0 &gt; rom</code></pre></div><p>But I get an Input/Output error at the step with cat. I added the ids to the pci-stub boot parameter and added the nouveau to modprobe blacklist. Should I remove one of them?</p></div></blockquote></div><p>Just try a try an OVMF VM with it, if you get the TianoCore splash screen it supports UEFI.</p> </div> <div class="postsignature postmsg"><hr /><p><a href="http://vfio.blogspot.com" rel="nofollow">http://vfio.blogspot.com</a><br />Looking for a more open forum to discuss vfio related uses?&#160; Try <a href="https://www.redhat.com/mailman/listinfo/vfio-users" rel="nofollow">https://www.redhat.com/mailman/listinfo/vfio-users</a></p></div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1526270">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1526295" class="blockpost roweven"> <h2><span><span class="conr">#5006</span> <a href="viewtopic.php?pid=1526295#p1526295">2015-05-05 20:51:11</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=85314">Duelist</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2014-09-22</span></dd> <dd><span>Posts: 358</span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>wulfspider wrote:</cite><blockquote><div><p>But I get an Input/Output error at the step with cat.</p></div></blockquote></div><p>Try using something like nvagetram or how was that software called.. There&#039;s a special piece of software to extract nvidia pre-POST ROMs from cards. Or you could get yours from baremetal GPU-z or techpowerup database. Or you can just follow aw&#039;s wise advise of just trying to kickstart OVMF without that unnecessary for GTX6XX cards check.</p><br /><div class="quotebox"><cite>aw wrote:</cite><blockquote><div><p>5000!&#160; (sorry, had to do it)</p></div></blockquote></div><p>Time to celebrate.</p> </div> <div class="postsignature postmsg"><hr /><p><span class="bbs">The forum rules prohibit requesting support for distributions other than arch.</span><br /><a href="https://bbs.archlinux.org/viewtopic.php?pid=1551460#p1551460" rel="nofollow">I gave up.</a><a href="https://bbs.archlinux.org/viewtopic.php?id=162768" rel="nofollow"> It was too late.</a><br /><a href="http://pastebin.com/B3fL84bq" rel="nofollow">What I was trying to do</a>.<br /><a href="http://vfio.blogspot.com/" rel="nofollow">The reference about VFIO and KVM VGA passthrough.</a></p></div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1526295">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1526305" class="blockpost rowodd"> <h2><span><span class="conr">#5007</span> <a href="viewtopic.php?pid=1526305#p1526305">2015-05-05 21:21:39</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=52587">Fira</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2011-09-24</span></dd> <dd><span>Posts: 8</span></dd> <dd class="usercontacts"><span class="email"><a href="misc.php?email=52587">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <p>Yo. I just upgraded to kernel 4.0.1, and applied the same old i915 patch....<br />But it doesn&#039;t seem to work anymore, even though the patch was successful.<br />I&#039;m getting nothing anymore on my card output, and a bunch of &quot;unclaimed register&quot; errors in dmesg coming from i915.</p><p>Any tips ? Do anyone has a more recent version of the arbitration patch ?</p><p>Thanks <img src="https://bbs.archlinux.org/img/smilies/smile.png" width="15" height="15" alt="smile" /></p><p>Edit: I&#039;ve looked into OVMF, but sadly that means a whole system reinstall.<br />Actually been trying to reinstall on full EFI with OVMF, but I can&#039;t manage to boot any install ISO from OVMF. <br />VGA passthrough works perfect though.</p> <p class="postedit"><em>Last edited by Fira (2015-05-05 22:46:04)</em></p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1526305">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1526348" class="blockpost roweven"> <h2><span><span class="conr">#5008</span> <a href="viewtopic.php?pid=1526348#p1526348">2015-05-06 01:20:30</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=75590">aw</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2013-10-04</span></dd> <dd><span>Posts: 921</span></dd> <dd class="usercontacts"><span class="email"><a href="misc.php?email=75590">Email</a></span> <span class="website"><a href="http://vfio.blogspot.com/" rel="nofollow">Website</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>Fira wrote:</cite><blockquote><div><p>Yo. I just upgraded to kernel 4.0.1, and applied the same old i915 patch....<br />But it doesn&#039;t seem to work anymore, even though the patch was successful.<br />I&#039;m getting nothing anymore on my card output, and a bunch of &quot;unclaimed register&quot; errors in dmesg coming from i915.</p><p>Any tips ? Do anyone has a more recent version of the arbitration patch ?</p><p>Thanks <img src="https://bbs.archlinux.org/img/smilies/smile.png" width="15" height="15" alt="smile" /></p><p>Edit: I&#039;ve looked into OVMF, but sadly that means a whole system reinstall.<br />Actually been trying to reinstall on full EFI with OVMF, but I can&#039;t manage to boot any install ISO from OVMF. <br />VGA passthrough works perfect though.</p></div></blockquote></div><p>Whole <strong>guest</strong> system re-install.&#160; Well worth it to not be patching every new host kernel you get IMO.&#160; I don&#039;t know where these ISO boot problems are coming from, but see the recent series on my blog, part 4 covers installing Windows 8.1 with OVMF using virt-manager.&#160; If you&#039;re using Windows 7 with OVMF, I think some people have gotten that to work, but I haven&#039;t gotten that far in my howto series, maybe next week.</p> </div> <div class="postsignature postmsg"><hr /><p><a href="http://vfio.blogspot.com" rel="nofollow">http://vfio.blogspot.com</a><br />Looking for a more open forum to discuss vfio related uses?&#160; Try <a href="https://www.redhat.com/mailman/listinfo/vfio-users" rel="nofollow">https://www.redhat.com/mailman/listinfo/vfio-users</a></p></div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1526348">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1526376" class="blockpost rowodd"> <h2><span><span class="conr">#5009</span> <a href="viewtopic.php?pid=1526376#p1526376">2015-05-06 05:30:13</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=52587">Fira</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2011-09-24</span></dd> <dd><span>Posts: 8</span></dd> <dd class="usercontacts"><span class="email"><a href="misc.php?email=52587">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <p>In fact I&#039;ve done the exact same as you did in your blog, but on QEMU command line directly..<br />I&#039;ve tried with Windows 8.1 and 7 images from MSDNAA as you did, and even an ArchLinux ISO.<br />Every time, OVMF fails to boot both with pure-EFI and CSM, then drops you to the shell indicating there is a valid GPT Label on the disks.<br />Any ideas ? I didn&#039;t have any trouble booting these under Seabios, and AFAIK they should all be EFI-aware.</p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1526376">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1526391" class="blockpost roweven"> <h2><span><span class="conr">#5010</span> <a href="viewtopic.php?pid=1526391#p1526391">2015-05-06 07:39:42</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=79471">Bronek</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>From: London</span></dd> <dd><span>Registered: 2014-02-14</span></dd> <dd><span>Posts: 90</span></dd> <dd class="usercontacts"><span class="email"><a href="misc.php?email=79471">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>aw wrote:</cite><blockquote><div><p>5000!&#160; (sorry, had to do it)</p></div></blockquote></div><p>You worked hard for the privilege :-P</p> </div> <div class="postsignature postmsg"><hr /><p>Sorry about&#160; &quot;KVM VGA-Passthrough ...&quot; thread <img src="https://bbs.archlinux.org/img/smilies/sad.png" width="15" height="15" alt="sad" /> Anyone interested in continuing this discussion elsewhere, please contact me privately. I might be able to find it a new home.</p></div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1526391">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1526393" class="blockpost rowodd"> <h2><span><span class="conr">#5011</span> <a href="viewtopic.php?pid=1526393#p1526393">2015-05-06 07:45:09</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=79471">Bronek</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>From: London</span></dd> <dd><span>Registered: 2014-02-14</span></dd> <dd><span>Posts: 90</span></dd> <dd class="usercontacts"><span class="email"><a href="misc.php?email=79471">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <p>@aw I think my FirePro W7100 is either not meant to work with passthrough at all or is just faulty, since I have occasional artefacts on screen even before restarting the guest and when the card is secondary GPU in the system (i.e. should not be referred by host in any way). I think its not worth your time to try diagnosing my problems, I will switch to something else and put this card to other use.</p> </div> <div class="postsignature postmsg"><hr /><p>Sorry about&#160; &quot;KVM VGA-Passthrough ...&quot; thread <img src="https://bbs.archlinux.org/img/smilies/sad.png" width="15" height="15" alt="sad" /> Anyone interested in continuing this discussion elsewhere, please contact me privately. I might be able to find it a new home.</p></div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1526393">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1526449" class="blockpost roweven"> <h2><span><span class="conr">#5012</span> <a href="viewtopic.php?pid=1526449#p1526449">2015-05-06 12:09:29</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=90710">toxster</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2015-04-28</span></dd> <dd><span>Posts: 4</span></dd> <dd class="usercontacts"><span class="email"><a href="misc.php?email=90710">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <p>Hi again,</p><p>since my last post i have managed to go fully libvirt! no more vfio-bind scripts and long command lines...</p><p>For reference: the Nvidia Controlpanel defaults to vsync on (since i have a g-sync monitor) hence why i capped out at 60fps. I can get higher FPS in games now if i turn it off.</p><p>Here is my libvirt (since i was struggling to find a sample to base my own upon) i ended up creating a new machine in virt-manager and the virsh edit &lt;name&gt; to add the OVMF, kvm off, etc, required parts, left to do is trim out the unnecessary parts, serial port, ballooning etc. </p><div class="codebox"><pre class="vscroll"><code>&lt;domain type=&#039;kvm&#039; id=&#039;2&#039;&gt; &lt;name&gt;win8.1&lt;/name&gt; &lt;uuid&gt;d9aaa8dd-6b43-421b-b165-706926e9181e&lt;/uuid&gt; &lt;memory unit=&#039;KiB&#039;&gt;16760832&lt;/memory&gt; &lt;currentMemory unit=&#039;KiB&#039;&gt;16760832&lt;/currentMemory&gt; &lt;vcpu placement=&#039;static&#039; current=&#039;8&#039;&gt;32&lt;/vcpu&gt; &lt;resource&gt; &lt;partition&gt;/machine&lt;/partition&gt; &lt;/resource&gt; &lt;os&gt; &lt;type arch=&#039;x86_64&#039; machine=&#039;pc-i440fx-2.3&#039;&gt;hvm&lt;/type&gt; &lt;loader readonly=&#039;yes&#039; type=&#039;pflash&#039;&gt;/usr/share/ovmf/x64/ovmf_code_x64.bin&lt;/loader&gt; &lt;nvram template=&#039;/usr/share/ovmf/x64/ovmf_vars_x64.bin&#039;&gt;/var/lib/libvirt/qemu/nvram/win8.1_VARS.fd&lt;/nvram&gt; &lt;/os&gt; &lt;features&gt; &lt;acpi/&gt; &lt;apic/&gt; &lt;pae/&gt; &lt;!-- if using NVIDIA, remove all elements inside of hyperv (Code 43 else) --&gt; &lt;hyperv&gt; &lt;/hyperv&gt; &lt;!-- this kvm element was added to be able to use NVIDIA drivers. (Code 43 else) --&gt; &lt;kvm&gt; &lt;hidden state=&#039;on&#039;/&gt; &lt;/kvm&gt; &lt;/features&gt; &lt;cpu mode=&#039;host-passthrough&#039;&gt; &lt;topology sockets=&#039;1&#039; cores=&#039;4&#039; threads=&#039;8&#039;/&gt; &lt;/cpu&gt; &lt;clock offset=&#039;localtime&#039;&gt; &lt;timer name=&#039;rtc&#039; tickpolicy=&#039;catchup&#039;/&gt; &lt;timer name=&#039;pit&#039; tickpolicy=&#039;delay&#039;/&gt; &lt;timer name=&#039;hpet&#039; present=&#039;no&#039;/&gt; &lt;timer name=&#039;hypervclock&#039; present=&#039;no&#039;/&gt; &lt;!-- NVIDIA: must be set to no --&gt; &lt;/clock&gt; &lt;on_poweroff&gt;destroy&lt;/on_poweroff&gt; &lt;on_reboot&gt;restart&lt;/on_reboot&gt; &lt;on_crash&gt;restart&lt;/on_crash&gt; &lt;pm&gt; &lt;suspend-to-mem enabled=&#039;no&#039;/&gt; &lt;suspend-to-disk enabled=&#039;no&#039;/&gt; &lt;/pm&gt; &lt;devices&gt; &lt;emulator&gt;/usr/sbin/qemu-system-x86_64&lt;/emulator&gt; &lt;disk type=&#039;block&#039; device=&#039;disk&#039;&gt; &lt;driver name=&#039;qemu&#039; type=&#039;raw&#039; cache=&#039;none&#039; io=&#039;native&#039;/&gt; &lt;source dev=&#039;/dev/sdb3&#039;/&gt; &lt;backingStore/&gt; &lt;target dev=&#039;sda&#039; bus=&#039;scsi&#039;/&gt; &lt;alias name=&#039;scsi0-0-0-1&#039;/&gt; &lt;address type=&#039;drive&#039; controller=&#039;0&#039; bus=&#039;0&#039; target=&#039;0&#039; unit=&#039;1&#039;/&gt; &lt;/disk&gt; &lt;disk type=&#039;block&#039; device=&#039;disk&#039;&gt; &lt;driver name=&#039;qemu&#039; type=&#039;raw&#039; cache=&#039;none&#039; io=&#039;native&#039;/&gt; &lt;source dev=&#039;/dev/sda&#039;/&gt; &lt;backingStore/&gt; &lt;target dev=&#039;sdb&#039; bus=&#039;scsi&#039;/&gt; &lt;boot order=&#039;1&#039;/&gt; &lt;alias name=&#039;scsi0-0-0-0&#039;/&gt; &lt;address type=&#039;drive&#039; controller=&#039;0&#039; bus=&#039;0&#039; target=&#039;0&#039; unit=&#039;0&#039;/&gt; &lt;/disk&gt; &lt;disk type=&#039;file&#039; device=&#039;cdrom&#039;&gt; &lt;driver name=&#039;qemu&#039; type=&#039;raw&#039;/&gt; &lt;source file=&#039;/root/vm/virtio-win-0.1-100.iso&#039;/&gt; &lt;backingStore/&gt; &lt;target dev=&#039;hda&#039; bus=&#039;ide&#039;/&gt; &lt;readonly/&gt; &lt;alias name=&#039;ide0-0-0&#039;/&gt; &lt;address type=&#039;drive&#039; controller=&#039;0&#039; bus=&#039;0&#039; target=&#039;0&#039; unit=&#039;0&#039;/&gt; &lt;/disk&gt; &lt;controller type=&#039;usb&#039; index=&#039;0&#039; model=&#039;ich9-ehci1&#039;&gt; &lt;alias name=&#039;usb0&#039;/&gt; &lt;address type=&#039;pci&#039; domain=&#039;0x0000&#039; bus=&#039;0x00&#039; slot=&#039;0x06&#039; function=&#039;0x7&#039;/&gt; &lt;/controller&gt; &lt;controller type=&#039;usb&#039; index=&#039;0&#039; model=&#039;ich9-uhci1&#039;&gt; &lt;alias name=&#039;usb0&#039;/&gt; &lt;master startport=&#039;0&#039;/&gt; &lt;address type=&#039;pci&#039; domain=&#039;0x0000&#039; bus=&#039;0x00&#039; slot=&#039;0x06&#039; function=&#039;0x0&#039; multifunction=&#039;on&#039;/&gt; &lt;/controller&gt; &lt;controller type=&#039;usb&#039; index=&#039;0&#039; model=&#039;ich9-uhci2&#039;&gt; &lt;alias name=&#039;usb0&#039;/&gt; &lt;master startport=&#039;2&#039;/&gt; &lt;address type=&#039;pci&#039; domain=&#039;0x0000&#039; bus=&#039;0x00&#039; slot=&#039;0x06&#039; function=&#039;0x1&#039;/&gt; &lt;/controller&gt; &lt;controller type=&#039;usb&#039; index=&#039;0&#039; model=&#039;ich9-uhci3&#039;&gt; &lt;alias name=&#039;usb0&#039;/&gt; &lt;master startport=&#039;4&#039;/&gt; &lt;address type=&#039;pci&#039; domain=&#039;0x0000&#039; bus=&#039;0x00&#039; slot=&#039;0x06&#039; function=&#039;0x2&#039;/&gt; &lt;/controller&gt; &lt;controller type=&#039;scsi&#039; index=&#039;0&#039; model=&#039;virtio-scsi&#039;&gt; &lt;alias name=&#039;scsi0&#039;/&gt; &lt;address type=&#039;pci&#039; domain=&#039;0x0000&#039; bus=&#039;0x00&#039; slot=&#039;0x05&#039; function=&#039;0x0&#039;/&gt; &lt;/controller&gt; &lt;controller type=&#039;pci&#039; index=&#039;0&#039; model=&#039;pci-root&#039;&gt; &lt;alias name=&#039;pci.0&#039;/&gt; &lt;/controller&gt; &lt;controller type=&#039;ide&#039; index=&#039;0&#039;&gt; &lt;alias name=&#039;ide0&#039;/&gt; &lt;address type=&#039;pci&#039; domain=&#039;0x0000&#039; bus=&#039;0x00&#039; slot=&#039;0x01&#039; function=&#039;0x1&#039;/&gt; &lt;/controller&gt; &lt;controller type=&#039;virtio-serial&#039; index=&#039;0&#039;&gt; &lt;alias name=&#039;virtio-serial0&#039;/&gt; &lt;address type=&#039;pci&#039; domain=&#039;0x0000&#039; bus=&#039;0x00&#039; slot=&#039;0x07&#039; function=&#039;0x0&#039;/&gt; &lt;/controller&gt; &lt;interface type=&#039;network&#039;&gt; &lt;mac address=&#039;52:54:00:f8:f3:dd&#039;/&gt; &lt;source network=&#039;default&#039; bridge=&#039;virbr0&#039;/&gt; &lt;target dev=&#039;vnet0&#039;/&gt; &lt;model type=&#039;virtio&#039;/&gt; &lt;alias name=&#039;net0&#039;/&gt; &lt;address type=&#039;pci&#039; domain=&#039;0x0000&#039; bus=&#039;0x00&#039; slot=&#039;0x02&#039; function=&#039;0x0&#039;/&gt; &lt;/interface&gt; &lt;hostdev mode=&#039;subsystem&#039; type=&#039;pci&#039; managed=&#039;yes&#039;&gt; &lt;driver name=&#039;vfio&#039;/&gt; &lt;source&gt; &lt;address domain=&#039;0x0000&#039; bus=&#039;0x03&#039; slot=&#039;0x00&#039; function=&#039;0x0&#039;/&gt; &lt;/source&gt; &lt;alias name=&#039;hostdev0&#039;/&gt; &lt;address type=&#039;pci&#039; domain=&#039;0x0000&#039; bus=&#039;0x00&#039; slot=&#039;0x03&#039; function=&#039;0x0&#039;/&gt; &lt;/hostdev&gt; &lt;hostdev mode=&#039;subsystem&#039; type=&#039;usb&#039; managed=&#039;yes&#039;&gt; &lt;source&gt; &lt;vendor id=&#039;0x05ac&#039;/&gt; &lt;product id=&#039;0x1006&#039;/&gt; &lt;address bus=&#039;1&#039; device=&#039;6&#039;/&gt; &lt;/source&gt; &lt;alias name=&#039;hostdev1&#039;/&gt; &lt;/hostdev&gt; &lt;hostdev mode=&#039;subsystem&#039; type=&#039;usb&#039; managed=&#039;yes&#039;&gt; &lt;source&gt; &lt;vendor id=&#039;0x046d&#039;/&gt; &lt;product id=&#039;0x0a01&#039;/&gt; &lt;address bus=&#039;1&#039; device=&#039;2&#039;/&gt; &lt;/source&gt; &lt;alias name=&#039;hostdev2&#039;/&gt; &lt;/hostdev&gt; &lt;hostdev mode=&#039;subsystem&#039; type=&#039;usb&#039; managed=&#039;yes&#039;&gt; &lt;source&gt; &lt;vendor id=&#039;0x046d&#039;/&gt; &lt;product id=&#039;0xc07d&#039;/&gt; &lt;address bus=&#039;1&#039; device=&#039;5&#039;/&gt; &lt;/source&gt; &lt;alias name=&#039;hostdev3&#039;/&gt; &lt;/hostdev&gt; &lt;hostdev mode=&#039;subsystem&#039; type=&#039;usb&#039; managed=&#039;yes&#039;&gt; &lt;source&gt; &lt;vendor id=&#039;0x05ac&#039;/&gt; &lt;product id=&#039;0x0250&#039;/&gt; &lt;address bus=&#039;1&#039; device=&#039;7&#039;/&gt; &lt;/source&gt; &lt;alias name=&#039;hostdev4&#039;/&gt; &lt;/hostdev&gt; &lt;memballoon model=&#039;virtio&#039;&gt; &lt;alias name=&#039;balloon0&#039;/&gt; &lt;address type=&#039;pci&#039; domain=&#039;0x0000&#039; bus=&#039;0x00&#039; slot=&#039;0x08&#039; function=&#039;0x0&#039;/&gt; &lt;/memballoon&gt; &lt;/devices&gt; &lt;/domain&gt;</code></pre></div><p>I hope this helps anyone.. </p><p>Is there anything i can add to increase performance? Huge pages?</p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1526449">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1526466" class="blockpost rowodd"> <h2><span><span class="conr">#5013</span> <a href="viewtopic.php?pid=1526466#p1526466">2015-05-06 13:25:52</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=82442">slis</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2014-06-02</span></dd> <dd><span>Posts: 125</span></dd> <dd class="usercontacts"><span class="email"><a href="mailto:xslisx@gmail.com">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <p>Yes hugepages,<br />and change &lt;topology sockets=&#039;1&#039; cores=&#039;4&#039; threads=&#039;8&#039;/&gt; to &lt;topology sockets=&#039;1&#039; cores=&#039;8&#039; threads=&#039;1&#039;/&gt; or something like that, using threads slows cpu down atleast for me... </p><p>and you should do static pinning on real cores no ht ones, and maybe emulatorpin, read more at</p><p><a href="https://libvirt.org/formatdomain.html#elementsCPUTuning" rel="nofollow">https://libvirt.org/formatdomain.html#elementsCPUTuning</a></p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1526466">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1526479" class="blockpost roweven"> <h2><span><span class="conr">#5014</span> <a href="viewtopic.php?pid=1526479#p1526479">2015-05-06 14:23:26</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=79471">Bronek</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>From: London</span></dd> <dd><span>Registered: 2014-02-14</span></dd> <dd><span>Posts: 90</span></dd> <dd class="usercontacts"><span class="email"><a href="misc.php?email=79471">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>toxster wrote:</cite><blockquote><div><p>Hi again,</p><p>since my last post i have managed to go fully libvirt! no more vfio-bind scripts and long command lines...</p><p>For reference: the Nvidia Controlpanel defaults to vsync on (since i have a g-sync monitor) hence why i capped out at 60fps. I can get higher FPS in games now if i turn it off.</p><p>Here is my libvirt (since i was struggling to find a sample to base my own upon) i ended up creating a new machine in virt-manager and the virsh edit &lt;name&gt; to add the OVMF, kvm off, etc, required parts, left to do is trim out the unnecessary parts, serial port, ballooning etc. </p><div class="codebox"><pre><code>&lt;domain type=&#039;kvm&#039; id=&#039;2&#039;&gt; &lt;name&gt;win8.1&lt;/name&gt; &lt;uuid&gt;d9aaa8dd-6b43-421b-b165-706926e9181e&lt;/uuid&gt; &lt;memory unit=&#039;KiB&#039;&gt;16760832&lt;/memory&gt; &lt;currentMemory unit=&#039;KiB&#039;&gt;16760832&lt;/currentMemory&gt; &lt;vcpu placement=&#039;static&#039; current=&#039;8&#039;&gt;32&lt;/vcpu&gt; . . .</code></pre></div><p>I hope this helps anyone.. </p><p>Is there anything i can add to increase performance? Huge pages?</p></div></blockquote></div><p>Yes go with hugepages. Also, giving your VM 32 vcpus will slow it down quite a bit, unless you actually have this many threads in host machine to give away!</p> </div> <div class="postsignature postmsg"><hr /><p>Sorry about&#160; &quot;KVM VGA-Passthrough ...&quot; thread <img src="https://bbs.archlinux.org/img/smilies/sad.png" width="15" height="15" alt="sad" /> Anyone interested in continuing this discussion elsewhere, please contact me privately. I might be able to find it a new home.</p></div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1526479">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1526536" class="blockpost rowodd"> <h2><span><span class="conr">#5015</span> <a href="viewtopic.php?pid=1526536#p1526536">2015-05-06 18:04:54</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=70922">nbhs</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd class="postavatar"><img src="https://bbs.archlinux.org/img/avatars/70922.jpg?m=1367773811" width="80" height="80" alt="" /></dd> <dd><span>From: Montevideo, Uruguay</span></dd> <dd><span>Registered: 2013-05-02</span></dd> <dd><span>Posts: 402</span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>aw wrote:</cite><blockquote><div><p>5000!&#160; (sorry, had to do it)</p></div></blockquote></div><p>And it&#039;s also exaclty 2 years old</p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1526536">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1526546" class="blockpost roweven"> <h2><span><span class="conr">#5016</span> <a href="viewtopic.php?pid=1526546#p1526546">2015-05-06 18:48:28</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=85314">Duelist</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2014-09-22</span></dd> <dd><span>Posts: 358</span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>nbhs wrote:</cite><blockquote><div><div class="quotebox"><cite>aw wrote:</cite><blockquote><div><p>5000!&#160; (sorry, had to do it)</p></div></blockquote></div><p>And it&#039;s also exaclty 2 years old</p></div></blockquote></div><p>That means a thousand posts per year. Not so much, if you think about it.</p> </div> <div class="postsignature postmsg"><hr /><p><span class="bbs">The forum rules prohibit requesting support for distributions other than arch.</span><br /><a href="https://bbs.archlinux.org/viewtopic.php?pid=1551460#p1551460" rel="nofollow">I gave up.</a><a href="https://bbs.archlinux.org/viewtopic.php?id=162768" rel="nofollow"> It was too late.</a><br /><a href="http://pastebin.com/B3fL84bq" rel="nofollow">What I was trying to do</a>.<br /><a href="http://vfio.blogspot.com/" rel="nofollow">The reference about VFIO and KVM VGA passthrough.</a></p></div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1526546">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1526547" class="blockpost rowodd"> <h2><span><span class="conr">#5017</span> <a href="viewtopic.php?pid=1526547#p1526547">2015-05-06 18:54:44</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=75590">aw</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2013-10-04</span></dd> <dd><span>Posts: 921</span></dd> <dd class="usercontacts"><span class="email"><a href="misc.php?email=75590">Email</a></span> <span class="website"><a href="http://vfio.blogspot.com/" rel="nofollow">Website</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>Duelist wrote:</cite><blockquote><div><div class="quotebox"><cite>nbhs wrote:</cite><blockquote><div><div class="quotebox"><cite>aw wrote:</cite><blockquote><div><p>5000!&#160; (sorry, had to do it)</p></div></blockquote></div><p>And it&#039;s also exaclty 2 years old</p></div></blockquote></div><p>That means a thousand posts per year. Not so much, if you think about it.</p></div></blockquote></div><p>MATHS!</p> </div> <div class="postsignature postmsg"><hr /><p><a href="http://vfio.blogspot.com" rel="nofollow">http://vfio.blogspot.com</a><br />Looking for a more open forum to discuss vfio related uses?&#160; Try <a href="https://www.redhat.com/mailman/listinfo/vfio-users" rel="nofollow">https://www.redhat.com/mailman/listinfo/vfio-users</a></p></div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1526547">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1526548" class="blockpost roweven"> <h2><span><span class="conr">#5018</span> <a href="viewtopic.php?pid=1526548#p1526548">2015-05-06 18:57:54</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=85314">Duelist</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2014-09-22</span></dd> <dd><span>Posts: 358</span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>aw wrote:</cite><blockquote><div><div class="quotebox"><cite>Duelist wrote:</cite><blockquote><div><div class="quotebox"><cite>nbhs wrote:</cite><blockquote><div><p>And it&#039;s also exaclty 2 years old</p></div></blockquote></div><p>That means a thousand posts per year. Not so much, if you think about it.</p></div></blockquote></div><p>MATHS!</p></div></blockquote></div><p>Crap. 2500. Still not so much.</p><p>Damn, that was awkward.</p><p>BTW, 772 of them are yours, 234 are mine.</p><br /><p>Aaaalso, cruising through your blogposts.. libvirt doesn&#039;t support x-vga YET? Or there was a claim that it won&#039;t support it at all? That part 5 with selinux looks strange..</p> <p class="postedit"><em>Last edited by Duelist (2015-05-06 19:04:45)</em></p> </div> <div class="postsignature postmsg"><hr /><p><span class="bbs">The forum rules prohibit requesting support for distributions other than arch.</span><br /><a href="https://bbs.archlinux.org/viewtopic.php?pid=1551460#p1551460" rel="nofollow">I gave up.</a><a href="https://bbs.archlinux.org/viewtopic.php?id=162768" rel="nofollow"> It was too late.</a><br /><a href="http://pastebin.com/B3fL84bq" rel="nofollow">What I was trying to do</a>.<br /><a href="http://vfio.blogspot.com/" rel="nofollow">The reference about VFIO and KVM VGA passthrough.</a></p></div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1526548">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1526553" class="blockpost rowodd"> <h2><span><span class="conr">#5019</span> <a href="viewtopic.php?pid=1526553#p1526553">2015-05-06 19:29:34</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=52587">Fira</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2011-09-24</span></dd> <dd><span>Posts: 8</span></dd> <dd class="usercontacts"><span class="email"><a href="misc.php?email=52587">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <p>@aw: I looked further into your post and checked my system and... it appears that EDK2/OVMF doesn&#039;t detect the FAT filesystems on my ISOs. I&#039;m only getting BLK mappings, no FS mappings, and therefore can&#039;t boot since it can&#039;t read EFI partitions..<br />Could you tell me which version you&#039;ve been using ? I believe i&#039;m on the latest from Jenkins. Stable releases don&#039;t appear to boot at all here.</p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1526553">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1526559" class="blockpost roweven"> <h2><span><span class="conr">#5020</span> <a href="viewtopic.php?pid=1526559#p1526559">2015-05-06 19:54:44</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=85314">Duelist</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2014-09-22</span></dd> <dd><span>Posts: 358</span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <p>Just found an article with benchmarks of Citrix XenApp+Grid K2 vGPU.</p><p><a href="http://habrahabr.ru/post/257425/" rel="nofollow">BEWARE, IT&#039;S IN RUSSIAN</a>.</p><p>Anyway, there&#039;s 1131/1183 pts in Unigine on GTX 650, and ~1400pts on K2 <strong>per instance</strong>.<br />So, like, get an expensive K2, and you can do like 4 VMs comparable in performance as... my setup on VFIO+2 HD7750. I get ~1200 when using crossfire. Duct-tape TightVNC server to it, provide tons of bandwidth, and voila.</p> </div> <div class="postsignature postmsg"><hr /><p><span class="bbs">The forum rules prohibit requesting support for distributions other than arch.</span><br /><a href="https://bbs.archlinux.org/viewtopic.php?pid=1551460#p1551460" rel="nofollow">I gave up.</a><a href="https://bbs.archlinux.org/viewtopic.php?id=162768" rel="nofollow"> It was too late.</a><br /><a href="http://pastebin.com/B3fL84bq" rel="nofollow">What I was trying to do</a>.<br /><a href="http://vfio.blogspot.com/" rel="nofollow">The reference about VFIO and KVM VGA passthrough.</a></p></div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1526559">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1526561" class="blockpost rowodd"> <h2><span><span class="conr">#5021</span> <a href="viewtopic.php?pid=1526561#p1526561">2015-05-06 20:03:51</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=75968">deniv</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2013-10-16</span></dd> <dd><span>Posts: 27</span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <p>I&#039;ve seen some people here have GT610 with EFI support. Can anybody share the rom? My card comes only with VGA and I can&#039;t contact the vendor&#039;s support to get a newer rom from them.</p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1526561">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1526578" class="blockpost roweven"> <h2><span><span class="conr">#5022</span> <a href="viewtopic.php?pid=1526578#p1526578">2015-05-06 20:51:32</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=75590">aw</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2013-10-04</span></dd> <dd><span>Posts: 921</span></dd> <dd class="usercontacts"><span class="email"><a href="misc.php?email=75590">Email</a></span> <span class="website"><a href="http://vfio.blogspot.com/" rel="nofollow">Website</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>Duelist wrote:</cite><blockquote><div><p>Aaaalso, cruising through your blogposts.. libvirt doesn&#039;t support x-vga YET? Or there was a claim that it won&#039;t support it at all? That part 5 with selinux looks strange..</p></div></blockquote></div><p>The <strong>x-</strong> in front of the x-vga option is a big warning flag to libvirt to not support this feature because it&#039;s experimental.&#160; It&#039;s experimental because VGA arbitration is so broken on Linux, mostly with the i915 driver.&#160; I don&#039;t see how that&#039;s going to get fixed, so I don&#039;t have any immediate plans to make it non-experimental and I hope that with UEFI becoming more common, VGA may just go away.&#160; Last I tried the selinux stuff worked, I didn&#039;t re-try it for that post though.</p> </div> <div class="postsignature postmsg"><hr /><p><a href="http://vfio.blogspot.com" rel="nofollow">http://vfio.blogspot.com</a><br />Looking for a more open forum to discuss vfio related uses?&#160; Try <a href="https://www.redhat.com/mailman/listinfo/vfio-users" rel="nofollow">https://www.redhat.com/mailman/listinfo/vfio-users</a></p></div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1526578">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1526579" class="blockpost rowodd"> <h2><span><span class="conr">#5023</span> <a href="viewtopic.php?pid=1526579#p1526579">2015-05-06 20:52:48</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=75590">aw</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2013-10-04</span></dd> <dd><span>Posts: 921</span></dd> <dd class="usercontacts"><span class="email"><a href="misc.php?email=75590">Email</a></span> <span class="website"><a href="http://vfio.blogspot.com/" rel="nofollow">Website</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>Fira wrote:</cite><blockquote><div><p>@aw: I looked further into your post and checked my system and... it appears that EDK2/OVMF doesn&#039;t detect the FAT filesystems on my ISOs. I&#039;m only getting BLK mappings, no FS mappings, and therefore can&#039;t boot since it can&#039;t read EFI partitions..<br />Could you tell me which version you&#039;ve been using ? I believe i&#039;m on the latest from Jenkins. Stable releases don&#039;t appear to boot at all here.</p></div></blockquote></div><p>I&#039;m on the latest from Gerd&#039;s repo too, I did a fresh update before doing that demo.&#160; If you&#039;ve got it setup like me, I&#039;d suspect your media vs the guest.</p> </div> <div class="postsignature postmsg"><hr /><p><a href="http://vfio.blogspot.com" rel="nofollow">http://vfio.blogspot.com</a><br />Looking for a more open forum to discuss vfio related uses?&#160; Try <a href="https://www.redhat.com/mailman/listinfo/vfio-users" rel="nofollow">https://www.redhat.com/mailman/listinfo/vfio-users</a></p></div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1526579">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1526582" class="blockpost roweven"> <h2><span><span class="conr">#5024</span> <a href="viewtopic.php?pid=1526582#p1526582">2015-05-06 21:21:00</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=75590">aw</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2013-10-04</span></dd> <dd><span>Posts: 921</span></dd> <dd class="usercontacts"><span class="email"><a href="misc.php?email=75590">Email</a></span> <span class="website"><a href="http://vfio.blogspot.com/" rel="nofollow">Website</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>Duelist wrote:</cite><blockquote><div><p>Just found an article with benchmarks of Citrix XenApp+Grid K2 vGPU.</p><p><a href="http://habrahabr.ru/post/257425/" rel="nofollow">BEWARE, IT&#039;S IN RUSSIAN</a>.</p><p>Anyway, there&#039;s 1131/1183 pts in Unigine on GTX 650, and ~1400pts on K2 <strong>per instance</strong>.<br />So, like, get an expensive K2, and you can do like 4 VMs comparable in performance as... my setup on VFIO+2 HD7750. I get ~1200 when using crossfire. Duct-tape TightVNC server to it, provide tons of bandwidth, and voila.</p></div></blockquote></div><p>A GTX 650 has 384 CUDA cores, a GRID K2 has two separate processor cores, each with 1536 CUDA cores.&#160; Each core is really therefore more equivalent to a GTX 680.&#160; According to the article (google translation), a K280Q configuration is effectively giving each VM a full GPU core, K260Q is half a core, K240Q is a quarter core.&#160; So only in that last config is the core count equivalent to a GTX 650.&#160; Also factor in that a GTX 650 is about $75 USD and a K2 is about $3000 USD and GeForce biting into those GRID margins, if we can run it in a VM, might make you suspect that Nvidia really is trying to prevent GeForce assignment.&#160; But look at it from the other side that it would be completely ridiculous to put eight GTX 650s into a system while a GRID card is only a single double-slot card and you&#039;d think that they&#039;d embrace GeForce assignment as a gateway to a realistic density and far more flexible solution with GRID.</p> </div> <div class="postsignature postmsg"><hr /><p><a href="http://vfio.blogspot.com" rel="nofollow">http://vfio.blogspot.com</a><br />Looking for a more open forum to discuss vfio related uses?&#160; Try <a href="https://www.redhat.com/mailman/listinfo/vfio-users" rel="nofollow">https://www.redhat.com/mailman/listinfo/vfio-users</a></p></div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1526582">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1526585" class="blockpost rowodd"> <h2><span><span class="conr">#5025</span> <a href="viewtopic.php?pid=1526585#p1526585">2015-05-06 21:36:51</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=85314">Duelist</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2014-09-22</span></dd> <dd><span>Posts: 358</span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>aw wrote:</cite><blockquote><div><div class="quotebox"><cite>Duelist wrote:</cite><blockquote><div><p>Just found an article with benchmarks of Citrix XenApp+Grid K2 vGPU.</p><p><a href="http://habrahabr.ru/post/257425/" rel="nofollow">BEWARE, IT&#039;S IN RUSSIAN</a>.</p><p>Anyway, there&#039;s 1131/1183 pts in Unigine on GTX 650, and ~1400pts on K2 <strong>per instance</strong>.<br />So, like, get an expensive K2, and you can do like 4 VMs comparable in performance as... my setup on VFIO+2 HD7750. I get ~1200 when using crossfire. Duct-tape TightVNC server to it, provide tons of bandwidth, and voila.</p></div></blockquote></div><p>A GTX 650 has 384 CUDA cores, a GRID K2 has two separate processor cores, each with 1536 CUDA cores.&#160; Each core is really therefore more equivalent to a GTX 680.&#160; According to the article (google translation), a K280Q configuration is effectively giving each VM a full GPU core, K260Q is half a core, K240Q is a quarter core.&#160; So only in that last config is the core count equivalent to a GTX 650.&#160; Also factor in that a GTX 650 is about $75 USD and a K2 is about $3000 USD and GeForce biting into those GRID margins, if we can run it in a VM, might make you suspect that Nvidia really is trying to prevent GeForce assignment.&#160; But look at it from the other side that it would be completely ridiculous to put eight GTX 650s into a system while a GRID card is only a single double-slot card and you&#039;d think that they&#039;d embrace GeForce assignment as a gateway to a realistic density and far more flexible solution with GRID.</p></div></blockquote></div><p>I agree. I&#039;ve tried to reply or add something, but failed multiple times.</p><br /><div class="quotebox"><cite>deniv wrote:</cite><blockquote><div><p>I&#039;ve seen some people here have GT610 with EFI support. Can anybody share the rom? My card comes only with VGA and I can&#039;t contact the vendor&#039;s support to get a newer rom from them.</p></div></blockquote></div><p>Using <a href="https://github.com/envytools/envytools" rel="nofollow">envytools&#039; nvagetbios -s prom</a>, here&#039;s my GT610&#039;s <a href="http://rghost.net/8BmRpc4r5" rel="nofollow">VBIOS.</a> It&#039;s a <a href="http://www.newegg.com/Product/Product.aspx?Item=N82E16814125427" rel="nofollow">Gigabyte Gigabyte(sic!) GT610</a>.<br />After 90 days the file will be automagically deleted, sorry about that.</p> </div> <div class="postsignature postmsg"><hr /><p><span class="bbs">The forum rules prohibit requesting support for distributions other than arch.</span><br /><a href="https://bbs.archlinux.org/viewtopic.php?pid=1551460#p1551460" rel="nofollow">I gave up.</a><a href="https://bbs.archlinux.org/viewtopic.php?id=162768" rel="nofollow"> It was too late.</a><br /><a href="http://pastebin.com/B3fL84bq" rel="nofollow">What I was trying to do</a>.<br /><a href="http://vfio.blogspot.com/" rel="nofollow">The reference about VFIO and KVM VGA passthrough.</a></p></div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1526585">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div class="postlinksb"> <div class="inbox crumbsplus"> <div class="pagepost"> <p class="pagelink conl"><span class="pages-label">Pages: </span><a rel="prev" class="item1" href="viewtopic.php?id=162768&amp;p=200">Previous</a> <a href="viewtopic.php?id=162768">1</a> <span class="spacer">…</span> <a href="viewtopic.php?id=162768&amp;p=199">199</a> <a href="viewtopic.php?id=162768&amp;p=200">200</a> <strong>201</strong> <a href="viewtopic.php?id=162768&amp;p=202">202</a> <a href="viewtopic.php?id=162768&amp;p=203">203</a> <span class="spacer">…</span> <a href="viewtopic.php?id=162768&amp;p=234">234</a> <a rel="next" href="viewtopic.php?id=162768&amp;p=202">Next</a></p> <p class="postlink conr">Topic closed</p> </div> <ul class="crumbs"> <li><a href="index.php">Index</a></li> <li><span>»&#160;</span><a href="viewforum.php?id=48">Topics Going Nowhere</a></li> <li><span>»&#160;</span><strong><a href="viewtopic.php?id=162768">KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</a></strong></li> </ul> <p class="subscribelink clearb"><a href="misc.php?action=subscribe&amp;tid=162768">Subscribe to this topic</a></p> <div class="clearer"></div> </div> </div> </div> <div id="brdfooter" class="block"> <h2><span>Board footer</span></h2> <div class="box"> <div id="brdfooternav" class="inbox"> <div class="conl"> <form id="qjump" method="get" action="viewforum.php"> <div><label><span>Jump to<br /></span> <select name="id" onchange="window.location=('viewforum.php?id='+this.options[this.selectedIndex].value)"> <optgroup label="Technical Issues and Assistance"> <option value="23">Newbie Corner</option> <option value="17">Installation</option> <option value="22">Kernel &amp; Hardware</option> <option value="18">Applications &amp; Desktop Environments</option> <option value="31">Laptop Issues</option> <option value="8">Networking, Server, and Protection</option> <option value="32">Multimedia and Games</option> <option value="50">System Administration</option> <option value="35">Other Architectures</option> </optgroup> <optgroup label="Arch-centric"> <option value="24">Announcements, Package &amp; Security Advisories</option> <option value="1">Arch Discussion</option> <option value="13">Forum &amp; Wiki discussion</option> </optgroup> <optgroup label="Pacman Upgrades, Packaging &amp; AUR"> <option value="44">Pacman &amp; Package Upgrade Issues</option> <option value="49">[testing] Repo Forum</option> <option value="4">Creating &amp; Modifying Packages</option> <option value="38">AUR Issues, Discussion &amp; PKGBUILD Requests</option> </optgroup> <optgroup label="Contributions &amp; Discussion"> <option value="20">GNU/Linux Discussion</option> <option value="27">Community Contributions</option> <option value="33">Programming &amp; Scripting</option> <option value="30">Other Languages</option> <option value="47">Artwork and Screenshots</option> <option value="42">Try This</option> </optgroup> <optgroup label="/dev/null"> <option value="29">Off-Topic</option> <option value="48" selected="selected">Topics Going Nowhere</option> <option value="36">Dustbin</option> </optgroup> </select></label> <input type="submit" value=" Go " accesskey="g" /> </div> </form> </div> <div class="conr"> <p id="feedlinks"><span class="atom"><a href="extern.php?action=feed&amp;tid=162768&amp;type=atom">Atom topic feed</a></span></p> <p id="poweredby">Powered by <a href="http://fluxbb.org/">FluxBB</a></p> </div> <div class="clearer"></div> </div> </div> </div> </div> <div class="end-box"></div> </div> </body> </html>
