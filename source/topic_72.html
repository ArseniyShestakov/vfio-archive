<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"> <html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en" dir="ltr"> <head> <meta http-equiv="Content-Type" content="text/html; charset=utf-8" /> <title>KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9 (Page 72) / Topics Going Nowhere / Arch Linux Forums</title> <link rel="stylesheet" type="text/css" href="style/ArchLinux.css" /> <link rel="canonical" href="viewtopic.php?id=162768&amp;p=72" title="Page 72" /> <link rel="prev" href="viewtopic.php?id=162768&amp;p=71" title="Page 71" /> <link rel="next" href="viewtopic.php?id=162768&amp;p=73" title="Page 73" /> <link rel="alternate" type="application/atom+xml" href="extern.php?action=feed&amp;tid=162768&amp;type=atom" title="Atom topic feed" /> <link rel="stylesheet" media="screen" href="style/ArchLinux/arch.css?v=3" /> <link rel="stylesheet" media="screen" href="style/ArchLinux/archnavbar.css?v=2" /> <link rel="shortcut icon" href="style/ArchLinux/favicon.ico" /> </head> <body> <div id="archnavbar" class="anb-forum"> <div id="archnavbarlogo"><h1><a href="http://www.archlinux.org/">Arch Linux</a></h1></div> <div id="archnavbarmenu"> <ul id="archnavbarlist"> <li id="anb-home"><a href="http://www.archlinux.org/">Home</a></li><li id="anb-packages"><a href="http://www.archlinux.org/packages/">Packages</a></li><li id="anb-forums" class="anb-selected"><a href="https://bbs.archlinux.org/">Forums</a></li><li id="anb-wiki"><a href="https://wiki.archlinux.org/">Wiki</a></li><li id="anb-bugs"><a href="https://bugs.archlinux.org/">Bugs</a></li><li id="anb-aur"><a href="https://aur.archlinux.org/">AUR</a></li><li id="anb-download"><a href="http://www.archlinux.org/download/">Download</a></li> </ul> </div> </div> <div id="punviewtopic" class="pun"> <div class="top-box"></div> <div class="punwrap"> <div id="brdheader" class="block"> <div class="box"> <div id="brdmenu" class="inbox"> <ul> <li id="navindex" class="isactive"><a href="index.php">Index</a></li> <li id="navuserlist"><a href="userlist.php">User list</a></li> <li id="navsearch"><a href="search.php">Search</a></li> <li id="navprofile"><a href="profile.php?id=80749">Profile</a></li> <li id="navlogout"><a href="login.php?action=out&amp;id=80749&amp;csrf_token=5c20501ec397bb45ef8ee8c84db232c8d8e421c6">Logout</a></li> </ul> </div> <div id="brdwelcome" class="inbox"> <ul class="conl"> <li><span>Logged in as <strong>SXX</strong></span></li> <li><span>Last visit: 2015-08-16 12:20:09</span></li> </ul> <ul class="conr"> <li><span>Topics: <a href="search.php?action=show_replies" title="Find topics you have posted to.">Posted</a> | <a href="search.php?action=show_new" title="Find topics with new posts since your last visit.">New</a> | <a href="search.php?action=show_recent" title="Find topics with recent posts.">Active</a> | <a href="search.php?action=show_unanswered" title="Find topics with no replies.">Unanswered</a></span></li> </ul> <div class="clearer"></div> </div> </div> </div> <div id="brdmain"> <div class="linkst"> <div class="inbox crumbsplus"> <ul class="crumbs"> <li><a href="index.php">Index</a></li> <li><span>»&#160;</span><a href="viewforum.php?id=48">Topics Going Nowhere</a></li> <li><span>»&#160;</span><strong><a href="viewtopic.php?id=162768">KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</a></strong></li> </ul> <div class="pagepost"> <p class="pagelink conl"><span class="pages-label">Pages: </span><a rel="prev" class="item1" href="viewtopic.php?id=162768&amp;p=71">Previous</a> <a href="viewtopic.php?id=162768">1</a> <span class="spacer">…</span> <a href="viewtopic.php?id=162768&amp;p=70">70</a> <a href="viewtopic.php?id=162768&amp;p=71">71</a> <strong>72</strong> <a href="viewtopic.php?id=162768&amp;p=73">73</a> <a href="viewtopic.php?id=162768&amp;p=74">74</a> <span class="spacer">…</span> <a href="viewtopic.php?id=162768&amp;p=234">234</a> <a rel="next" href="viewtopic.php?id=162768&amp;p=73">Next</a></p> <p class="postlink conr">Topic closed</p> </div> <div class="clearer"></div> </div> </div> <div id="p1418564" class="blockpost rowodd blockpost1"> <h2><span><span class="conr">#1776</span> <a href="viewtopic.php?pid=1418564#p1418564">2014-05-23 18:26:07</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=75590">aw</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2013-10-04</span></dd> <dd><span>Posts: 921</span></dd> <dd class="usercontacts"><span class="email"><a href="misc.php?email=75590">Email</a></span> <span class="website"><a href="http://vfio.blogspot.com/" rel="nofollow">Website</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>Slabity wrote:</cite><blockquote><div><div class="quotebox"><cite>aw wrote:</cite><blockquote><div><p>It sounds like VGA arbitration isn&#039;t working when the AMD card is in use by the host.&#160; What does &#039;dmesg | grep vgaarb&#039; show?</p></div></blockquote></div><p>When I run with Intel as the host:</p><div class="codebox"><pre><code>[ 0.333676] vgaarb: device added: PCI:0000:00:02.0,decodes=io+mem,owns=io+mem,locks=none [ 0.333680] vgaarb: device added: PCI:0000:01:00.0,decodes=io+mem,owns=none,locks=none [ 0.333682] vgaarb: device added: PCI:0000:02:00.0,decodes=io+mem,owns=none,locks=none [ 0.333682] vgaarb: loaded [ 0.333683] vgaarb: bridge control possible 0000:02:00.0 [ 0.333683] vgaarb: bridge control possible 0000:01:00.0 [ 0.333684] vgaarb: no bridge control possible 0000:00:02.0 [ 2.855092] vgaarb: device changed decodes: PCI:0000:01:00.0,olddecodes=io+mem,decodes=none:owns=none [ 3.069294] vgaarb: device changed decodes: PCI:0000:00:02.0,olddecodes=io+mem,decodes=io:owns=io</code></pre></div><p>When I run with AMD as the host:</p><div class="codebox"><pre><code>[ 0.330061] vgaarb: device added: PCI:0000:01:00.0,decodes=io+mem,owns=io+mem,locks=none [ 0.330064] vgaarb: device added: PCI:0000:02:00.0,decodes=io+mem,owns=none,locks=none [ 0.330065] vgaarb: loaded [ 0.330065] vgaarb: bridge control possible 0000:02:00.0 [ 0.330066] vgaarb: bridge control possible 0000:01:00.0 [ 2.609390] vgaarb: device changed decodes: PCI:0000:01:00.0,olddecodes=io+mem,decodes=none:owns=none</code></pre></div><p>Doesn&#039;t seem too much different. Anything catch your eye?</p></div></blockquote></div><p>Yep, looks broken to me.&#160; IIRC, without the i915 patch you&#039;d see 00:02.0 setting decodes=none as well.&#160; So my guess to what is happening here is that radeon declares that it opts out of VGA arbitration by setting decodes=none.&#160; We probably then attempt to make use of VGA on the Nvidia card, call into the arbiter to&#160; get the device, it looks at the other registered devices, sees none of them decode VGA space and lets us proceed without actually changing anything.&#160; You might be able to see this in lspci -vvv, look for the bridge with VGA+ set and tell us whether it&#039;s the root port above the radeon or nvidia (after you&#039;ve attempted to start the guest).&#160; This might be an arbiter bug rather than a radeon bug, I&#039;ll need to look.</p> </div> <div class="postsignature postmsg"><hr /><p><a href="http://vfio.blogspot.com" rel="nofollow">http://vfio.blogspot.com</a><br />Looking for a more open forum to discuss vfio related uses?&#160; Try <a href="https://www.redhat.com/mailman/listinfo/vfio-users" rel="nofollow">https://www.redhat.com/mailman/listinfo/vfio-users</a></p></div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1418564">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1418571" class="blockpost roweven"> <h2><span><span class="conr">#1777</span> <a href="viewtopic.php?pid=1418571#p1418571">2014-05-23 18:33:14</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=78080">Slabity</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2013-12-29</span></dd> <dd><span>Posts: 40</span></dd> <dd class="usercontacts"><span class="email"><a href="mailto:tslabinski@mygsc.com">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>aw wrote:</cite><blockquote><div><p>Yep, looks broken to me.&#160; IIRC, without the i915 patch you&#039;d see 00:02.0 setting decodes=none as well.&#160; So my guess to what is happening here is that radeon declares that it opts out of VGA arbitration by setting decodes=none.&#160; We probably then attempt to make use of VGA on the Nvidia card, call into the arbiter to&#160; get the device, it looks at the other registered devices, sees none of them decode VGA space and lets us proceed without actually changing anything.&#160; You might be able to see this in lspci -vvv, look for the bridge with VGA+ set and tell us whether it&#039;s the root port above the radeon or nvidia (after you&#039;ve attempted to start the guest).&#160; This might be an arbiter bug rather than a radeon bug, I&#039;ll need to look.</p></div></blockquote></div><p>Well thank god we finally found the issue, even if I have no idea what the VGA arbiter is.</p><p>Here&#039;s my relevant lspci:</p><p><a href="http://pastebin.com/4YHn4eH0" rel="nofollow">http://pastebin.com/4YHn4eH0</a></p><p>Thanks again for the quick response. Sorry about being pushy earlier, I&#039;m still a bit put around from surgery yesterday.</p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1418571">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1418575" class="blockpost rowodd"> <h2><span><span class="conr">#1778</span> <a href="viewtopic.php?pid=1418575#p1418575">2014-05-23 18:37:55</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=75590">aw</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2013-10-04</span></dd> <dd><span>Posts: 921</span></dd> <dd class="usercontacts"><span class="email"><a href="misc.php?email=75590">Email</a></span> <span class="website"><a href="http://vfio.blogspot.com/" rel="nofollow">Website</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>Slabity wrote:</cite><blockquote><div><div class="quotebox"><cite>aw wrote:</cite><blockquote><div><p>Yep, looks broken to me.&#160; IIRC, without the i915 patch you&#039;d see 00:02.0 setting decodes=none as well.&#160; So my guess to what is happening here is that radeon declares that it opts out of VGA arbitration by setting decodes=none.&#160; We probably then attempt to make use of VGA on the Nvidia card, call into the arbiter to&#160; get the device, it looks at the other registered devices, sees none of them decode VGA space and lets us proceed without actually changing anything.&#160; You might be able to see this in lspci -vvv, look for the bridge with VGA+ set and tell us whether it&#039;s the root port above the radeon or nvidia (after you&#039;ve attempted to start the guest).&#160; This might be an arbiter bug rather than a radeon bug, I&#039;ll need to look.</p></div></blockquote></div><p>Well thank god we finally found the issue, even if I have no idea what the VGA arbiter is.</p><p>Here&#039;s my relevant lspci:</p><p><a href="http://pastebin.com/4YHn4eH0" rel="nofollow">http://pastebin.com/4YHn4eH0</a></p><p>Thanks again for the quick response. Sorry about being pushy earlier, I&#039;m still a bit put around from surgery yesterday.</p></div></blockquote></div><p>VGA+ is set on 00:01.0 which is the root port for the AMD card, so VGA accesses are going there, not to the Nvidia card.&#160; I&#039;ll take a look.</p> </div> <div class="postsignature postmsg"><hr /><p><a href="http://vfio.blogspot.com" rel="nofollow">http://vfio.blogspot.com</a><br />Looking for a more open forum to discuss vfio related uses?&#160; Try <a href="https://www.redhat.com/mailman/listinfo/vfio-users" rel="nofollow">https://www.redhat.com/mailman/listinfo/vfio-users</a></p></div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1418575">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1418601" class="blockpost roweven"> <h2><span><span class="conr">#1779</span> <a href="viewtopic.php?pid=1418601#p1418601">2014-05-23 19:02:26</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=75590">aw</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2013-10-04</span></dd> <dd><span>Posts: 921</span></dd> <dd class="usercontacts"><span class="email"><a href="misc.php?email=75590">Email</a></span> <span class="website"><a href="http://vfio.blogspot.com/" rel="nofollow">Website</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>aw wrote:</cite><blockquote><div><div class="quotebox"><cite>Slabity wrote:</cite><blockquote><div><div class="quotebox"><cite>aw wrote:</cite><blockquote><div><p>Yep, looks broken to me.&#160; IIRC, without the i915 patch you&#039;d see 00:02.0 setting decodes=none as well.&#160; So my guess to what is happening here is that radeon declares that it opts out of VGA arbitration by setting decodes=none.&#160; We probably then attempt to make use of VGA on the Nvidia card, call into the arbiter to&#160; get the device, it looks at the other registered devices, sees none of them decode VGA space and lets us proceed without actually changing anything.&#160; You might be able to see this in lspci -vvv, look for the bridge with VGA+ set and tell us whether it&#039;s the root port above the radeon or nvidia (after you&#039;ve attempted to start the guest).&#160; This might be an arbiter bug rather than a radeon bug, I&#039;ll need to look.</p></div></blockquote></div><p>Well thank god we finally found the issue, even if I have no idea what the VGA arbiter is.</p><p>Here&#039;s my relevant lspci:</p><p><a href="http://pastebin.com/4YHn4eH0" rel="nofollow">http://pastebin.com/4YHn4eH0</a></p><p>Thanks again for the quick response. Sorry about being pushy earlier, I&#039;m still a bit put around from surgery yesterday.</p></div></blockquote></div><p>VGA+ is set on 00:01.0 which is the root port for the AMD card, so VGA accesses are going there, not to the Nvidia card.&#160; I&#039;ll take a look.</p></div></blockquote></div><p>BTW, if you want to make it work in the meantime, try this:</p><p>vga-clear.sh </p><div class="codebox"><pre><code>#!/bin/sh CTRL=$(setpci -s $1 3e.w) CTRL=$(printf %04x $(( 0x$CTRL &amp; ~0x8 ))) setpci -s $1 3e.w=$CTRL</code></pre></div><p>vga-set.sh </p><div class="codebox"><pre><code>#!/bin/sh CTRL=$(setpci -s $1 3e.w) CTRL=$(printf %04x $(( 0x$CTRL | 0x8 ))) setpci -s $1 3e.w=$CTRL</code></pre></div><p>Then before running the guest, do:</p><div class="codebox"><pre><code>sudo vga-clear.sh 00:01.0 sudo vga-set.sh 00:01.1</code></pre></div><p>This is only a workaround and assumes that radeon isn&#039;t just lying about no longer needing VGA access.</p> </div> <div class="postsignature postmsg"><hr /><p><a href="http://vfio.blogspot.com" rel="nofollow">http://vfio.blogspot.com</a><br />Looking for a more open forum to discuss vfio related uses?&#160; Try <a href="https://www.redhat.com/mailman/listinfo/vfio-users" rel="nofollow">https://www.redhat.com/mailman/listinfo/vfio-users</a></p></div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1418601">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1418620" class="blockpost rowodd"> <h2><span><span class="conr">#1780</span> <a href="viewtopic.php?pid=1418620#p1418620">2014-05-23 19:28:51</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=78080">Slabity</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2013-12-29</span></dd> <dd><span>Posts: 40</span></dd> <dd class="usercontacts"><span class="email"><a href="mailto:tslabinski@mygsc.com">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>aw wrote:</cite><blockquote><div><p>BTW, if you want to make it work in the meantime, try this:</p><p>vga-clear.sh </p><div class="codebox"><pre><code>#!/bin/sh CTRL=$(setpci -s $1 3e.w) CTRL=$(printf %04x $(( 0x$CTRL &amp; ~0x8 ))) setpci -s $1 3e.w=$CTRL</code></pre></div><p>vga-set.sh </p><div class="codebox"><pre><code>#!/bin/sh CTRL=$(setpci -s $1 3e.w) CTRL=$(printf %04x $(( 0x$CTRL | 0x8 ))) setpci -s $1 3e.w=$CTRL</code></pre></div><p>Then before running the guest, do:</p><div class="codebox"><pre><code>sudo vga-clear.sh 00:01.0 sudo vga-set.sh 00:01.1</code></pre></div><p>This is only a workaround and assumes that radeon isn&#039;t just lying about no longer needing VGA access.</p></div></blockquote></div><p>Wow, that works perfectly with the test script! Thank you so much!</p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1418620">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1418624" class="blockpost roweven"> <h2><span><span class="conr">#1781</span> <a href="viewtopic.php?pid=1418624#p1418624">2014-05-23 19:36:50</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=75590">aw</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2013-10-04</span></dd> <dd><span>Posts: 921</span></dd> <dd class="usercontacts"><span class="email"><a href="misc.php?email=75590">Email</a></span> <span class="website"><a href="http://vfio.blogspot.com/" rel="nofollow">Website</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>Slabity wrote:</cite><blockquote><div><p>Wow, that works perfectly with the test script! Thank you so much!</p></div></blockquote></div><p>Does radeon still work ok for the host?</p><p>Anyone using radeon on the host (APU users) may want to try this too.</p> </div> <div class="postsignature postmsg"><hr /><p><a href="http://vfio.blogspot.com" rel="nofollow">http://vfio.blogspot.com</a><br />Looking for a more open forum to discuss vfio related uses?&#160; Try <a href="https://www.redhat.com/mailman/listinfo/vfio-users" rel="nofollow">https://www.redhat.com/mailman/listinfo/vfio-users</a></p></div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1418624">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1418640" class="blockpost rowodd"> <h2><span><span class="conr">#1782</span> <a href="viewtopic.php?pid=1418640#p1418640">2014-05-23 20:15:09</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=78080">Slabity</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2013-12-29</span></dd> <dd><span>Posts: 40</span></dd> <dd class="usercontacts"><span class="email"><a href="mailto:tslabinski@mygsc.com">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>aw wrote:</cite><blockquote><div><div class="quotebox"><cite>Slabity wrote:</cite><blockquote><div><p>Wow, that works perfectly with the test script! Thank you so much!</p></div></blockquote></div><p>Does radeon still work ok for the host?</p><p>Anyone using radeon on the host (APU users) may want to try this too.</p></div></blockquote></div><p>Yep, my AMD card didn&#039;t even noticeably react through the process.</p><p>It&#039;s a good thing too, my monitor doesn&#039;t like the output that the graphics card gives for some reason...</p><p>Now I just gotta get this set up with virsh.</p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1418640">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1418651" class="blockpost roweven"> <h2><span><span class="conr">#1783</span> <a href="viewtopic.php?pid=1418651#p1418651">2014-05-23 20:34:52</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=82227">HPvirt</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2014-05-23</span></dd> <dd><span>Posts: 6</span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <p>Hi everybody</p><p>That post is AWESOME! It fits perfectly in what I was wondering these last years: playing in windows (or other tasks without Linux counterpart, as BluRay reading) and use Linux for everyday tasks without to reboot everytime I need to go from one to the other.</p><p>I played with Virtual Box and use it for testing Linux, but gaming is a no way.<br />I&#039;ve seen Xen, but it&#039;s lack of support for NVidia mainstream videocards slowed me.</p><p>KVM seems the way to go for, thanks to you nbhs and this topic.</p><p>Before buying some pieces, I would like to have your opinion on them.<br />I&#039;m planning to buy:<br />- AsRock Z97 Extreme6<br />- Core i7-4790 (Haswell)<br />Both supports VT-d.</p><p>I already have 16Go of Ram and a NVidia 680.</p><p>My wish:<br />- Use Linux Mint as host with i7 IGP to display onto a Dell U3014 (DisplayPort) with the Intel LAN<br />- Use Win7 as guest with GTX 680 to display onto a Dell 3007 (DVI Dual Link) with the Realtek LAN<br />--&gt; Passthrough for to Win7: GTX 680, Realtek LAN, the ASMedia USB3 controller and the ASMedia SATA Controler.</p><p>Linux and Win7 would be installed on 2 different SSDs.</p><p>I&#039;ve read like 25 pages of the topic, and planned to read all. But I&#039;ve an opportunity to buy these 2 pieces at a good price, so I ask now.</p><p>At first glance, does anyone see an impossibility in my project?</p><p>I think that I can launch the Win7 VM with more or less memory (playing with -m value of qemu), depending on tasks I planned to do on Win7: <br />- FullHD Video editing =&gt; 12Go or more<br />- Gaming =&gt; 4-8Go<br />For my Win7 it would be like adding or removing ram. I&#039;m right?<br />Later, I planned to go to 24 or 32Go Ram if 16Go are not enough.</p><p>thanks</p><p>(And I beg your pardon for my poor english wording <img src="https://bbs.archlinux.org/img/smilies/sad.png" width="15" height="15" alt="sad" />)</p> <p class="postedit"><em>Last edited by HPvirt (2014-05-23 20:49:36)</em></p> </div> <div class="postsignature postmsg"><hr /><p>Hardware: ASRock Z97 Extreme 6 - Intel Core i7 4790 - NVidia GTX680<br />Host: Linux Mint 17 Qiana, Kernel 3.15.8 (custom)<br />Guest: Windows Seven Ultimate SP1</p></div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1418651">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1418657" class="blockpost rowodd"> <h2><span><span class="conr">#1784</span> <a href="viewtopic.php?pid=1418657#p1418657">2014-05-23 20:43:36</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=75590">aw</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2013-10-04</span></dd> <dd><span>Posts: 921</span></dd> <dd class="usercontacts"><span class="email"><a href="misc.php?email=75590">Email</a></span> <span class="website"><a href="http://vfio.blogspot.com/" rel="nofollow">Website</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>HPvirt wrote:</cite><blockquote><div><p>Hi everybody</p><p>That post is AWESOME! It fits perfectly in what I was wondering these last years: playing in windows (or other tasks without Linux counterpart, as BluRay reading) and use Linux for everyday tasks without to reboot everytime I need to go from one to the other.</p><p>I played with Virtual Box and use it for testing Linux, but gaming is a no way.<br />I&#039;ve seen Xen, but it&#039;s lack of support for NVidia mainstream videocards slowed me.</p><p>KVM seems the way to go for, thanks to you nbhs and this topic.</p><p>Before buying some pieces, I would like to have your opinion on them.<br />I&#039;m planning to buy:<br />- AsRock Z97 Extreme6<br />- Core i7-4790 (Haswell)<br />Both supports VT-d.</p><p>I already have 16Go of Ram and a NVidia 680.</p><p>My wish:<br />- Use Linux Mint as host with i7 IGP to display onto a Dell U3014 (DisplayPort) with the Intel LAN<br />- Use Win7 as guest with GTX 680 to display onto a Dell 3007 (DVI Dual Link) with the Realtek LAN<br />--&gt; Passthrough for to Win7: GTX 680, Realtek LAN, the ASMedia USB3 controller and the ASMedia SATA Controler.</p><p>Linux and Win7 would be installed on 2 different SSDs.</p><p>I&#039;ve read like 25 pages of the topic, and planned to read all. But I&#039;ve an opportunity to buy these 2 pieces at a good price, so I ask now.</p><p>At first glance, does anyone see an impossibility in my project?</p><p>I think that I can launch the Win7 VM with more or less memory (playing with -m value of qemu), depending on tasks I planned to do on Win7: <br />- FullHD Video editing =&gt; 12Go or more<br />- Gaming =&gt; 4-8Go<br />For my Win7 it would be like adding or removing ram. I&#039;m right?<br />Later, I planned to go to 24 or 32Go Ram if 16Go are not enough.</p><p>thanks</p></div></blockquote></div><p>I would not recommend doing device assignment of a Realtek LAN, I&#039;ve only recently made it work and it&#039;s just scary.&#160; IMHO there&#039;s not sufficient value in passing LAN or disk controllers to a guest in a home environment.&#160; Virtio LAN and disk controllers will provide you with 90% of the performance with less hassle.&#160; I don&#039;t know if you&#039;re asking about dynamically changing memory, but you can certainly adjust the memory for a guest between boots.&#160; If you plan to use IGD for the host, you will need the i915 patches.&#160; I don&#039;t know the state of Z97 wrt the PCH root port ACS support, so you may need the ACS override patches as well.</p> </div> <div class="postsignature postmsg"><hr /><p><a href="http://vfio.blogspot.com" rel="nofollow">http://vfio.blogspot.com</a><br />Looking for a more open forum to discuss vfio related uses?&#160; Try <a href="https://www.redhat.com/mailman/listinfo/vfio-users" rel="nofollow">https://www.redhat.com/mailman/listinfo/vfio-users</a></p></div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1418657">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1418663" class="blockpost roweven"> <h2><span><span class="conr">#1785</span> <a href="viewtopic.php?pid=1418663#p1418663">2014-05-23 21:03:55</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=78080">Slabity</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2013-12-29</span></dd> <dd><span>Posts: 40</span></dd> <dd class="usercontacts"><span class="email"><a href="mailto:tslabinski@mygsc.com">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <p>To add what aw said, I recently just got the 4790 when I found out the 4770K did not support Vt-d.</p><p>The only reason I got it was because it was on sale for cheaper than the normal 4770. I&#039;ve only recently compared the two, and honestly it&#039;s not worth the extra $15. Hell, it&#039;s not even worth an extra $5 in my opinion. The speed is completely unnoticeable, as the <em>only</em> difference is the clock speed. Unless you can find the 4790 someplace cheaper than the 4770, stick with the 4770. I will absolutely guarantee that you will not notice any.</p><p>Second, that motherboard is designed for overclocking and high end gaming. The non-k series can not be overclocked, and if you&#039;re gaming in a VM then I doubt you&#039;ll be taking advantage of the &#039;gamer features&#039; that the motherboard is flaunting.</p><p>I&#039;m not saying that you shouldn&#039;t get these things, but there are cheaper options that&#039;ll suit your needs perfectly fine.</p> <p class="postedit"><em>Last edited by Slabity (2014-05-23 21:07:27)</em></p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1418663">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1418671" class="blockpost rowodd"> <h2><span><span class="conr">#1786</span> <a href="viewtopic.php?pid=1418671#p1418671">2014-05-23 21:18:06</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=82227">HPvirt</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2014-05-23</span></dd> <dd><span>Posts: 6</span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>aw wrote:</cite><blockquote><div><p>I would not recommend doing device assignment of a Realtek LAN, I&#039;ve only recently made it work and it&#039;s just scary.&#160; IMHO there&#039;s not sufficient value in passing LAN or disk controllers to a guest in a home environment.&#160; Virtio LAN and disk controllers will provide you with 90% of the performance with less hassle.</p></div></blockquote></div><p>Device management under Linux is not the domain I have the most knowledge in. But I&#039;m eager to learn. <img src="https://bbs.archlinux.org/img/smilies/smile.png" width="15" height="15" alt="smile" /></p><p>If I do device assignment of the Intel LAN, it would be easier? <br />Performance is a need I have.<br />But, I will try anyway, for the challenge and to learn.</p><div class="quotebox"><cite>aw wrote:</cite><blockquote><div><p>I don&#039;t know if you&#039;re asking about dynamically changing memory, but you can certainly adjust the memory for a guest between boots.</p></div></blockquote></div><p>It was at boot time. It seems clear it&#039;s possible, but I prefer ask and not assume anything.</p><div class="quotebox"><cite>aw wrote:</cite><blockquote><div><p>If you plan to use IGD for the host, you will need the i915 patches.&#160; I don&#039;t know the state of Z97 wrt the PCH root port ACS support, so you may need the ACS override patches as well.</p></div></blockquote></div><p>Yes the IGP will be for the host. I planned to have 2 keayboards and 2 mouses: my son will be able to play while I do something else. And if the need to have a secondary GPU arises, I&#039;ll buy another, but right now, my wallet and my banker would scream if I buy a top GPU. <img src="https://bbs.archlinux.org/img/smilies/big_smile.png" width="15" height="15" alt="big_smile" /></p> </div> <div class="postsignature postmsg"><hr /><p>Hardware: ASRock Z97 Extreme 6 - Intel Core i7 4790 - NVidia GTX680<br />Host: Linux Mint 17 Qiana, Kernel 3.15.8 (custom)<br />Guest: Windows Seven Ultimate SP1</p></div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1418671">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1418674" class="blockpost roweven"> <h2><span><span class="conr">#1787</span> <a href="viewtopic.php?pid=1418674#p1418674">2014-05-23 21:22:15</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=75590">aw</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2013-10-04</span></dd> <dd><span>Posts: 921</span></dd> <dd class="usercontacts"><span class="email"><a href="misc.php?email=75590">Email</a></span> <span class="website"><a href="http://vfio.blogspot.com/" rel="nofollow">Website</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>HPvirt wrote:</cite><blockquote><div><div class="quotebox"><cite>aw wrote:</cite><blockquote><div><p>I would not recommend doing device assignment of a Realtek LAN, I&#039;ve only recently made it work and it&#039;s just scary.&#160; IMHO there&#039;s not sufficient value in passing LAN or disk controllers to a guest in a home environment.&#160; Virtio LAN and disk controllers will provide you with 90% of the performance with less hassle.</p></div></blockquote></div><p>Device management under Linux is not the domain I have the most knowledge in. But I&#039;m eager to learn. <img src="https://bbs.archlinux.org/img/smilies/smile.png" width="15" height="15" alt="smile" /></p><p>If I do device assignment of the Intel LAN, it would be easier? <br />Performance is a need I have.<br />But, I will try anyway, for the challenge and to learn.</p></div></blockquote></div><p>Yes, Intel NICs are more amenable to device assignment, but really virtio can easily handle gigabit networks.</p> </div> <div class="postsignature postmsg"><hr /><p><a href="http://vfio.blogspot.com" rel="nofollow">http://vfio.blogspot.com</a><br />Looking for a more open forum to discuss vfio related uses?&#160; Try <a href="https://www.redhat.com/mailman/listinfo/vfio-users" rel="nofollow">https://www.redhat.com/mailman/listinfo/vfio-users</a></p></div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1418674">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1418679" class="blockpost rowodd"> <h2><span><span class="conr">#1788</span> <a href="viewtopic.php?pid=1418679#p1418679">2014-05-23 21:35:03</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=75590">aw</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2013-10-04</span></dd> <dd><span>Posts: 921</span></dd> <dd class="usercontacts"><span class="email"><a href="misc.php?email=75590">Email</a></span> <span class="website"><a href="http://vfio.blogspot.com/" rel="nofollow">Website</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>Slabity wrote:</cite><blockquote><div><div class="quotebox"><cite>aw wrote:</cite><blockquote><div><p>BTW, if you want to make it work in the meantime, try this:</p><p>vga-clear.sh </p><div class="codebox"><pre><code>#!/bin/sh CTRL=$(setpci -s $1 3e.w) CTRL=$(printf %04x $(( 0x$CTRL &amp; ~0x8 ))) setpci -s $1 3e.w=$CTRL</code></pre></div><p>vga-set.sh </p><div class="codebox"><pre><code>#!/bin/sh CTRL=$(setpci -s $1 3e.w) CTRL=$(printf %04x $(( 0x$CTRL | 0x8 ))) setpci -s $1 3e.w=$CTRL</code></pre></div><p>Then before running the guest, do:</p><div class="codebox"><pre><code>sudo vga-clear.sh 00:01.0 sudo vga-set.sh 00:01.1</code></pre></div><p>This is only a workaround and assumes that radeon isn&#039;t just lying about no longer needing VGA access.</p></div></blockquote></div><p>Wow, that works perfectly with the test script! Thank you so much!</p></div></blockquote></div><p>Slabity, if you&#039;d be willing to test it, I think this might resolve the problem (kernel patch):&#160; <a href="http://pastebin.com/2ukyQbkG" rel="nofollow">http://pastebin.com/2ukyQbkG</a></p><p>I&#039;ll need to swap around some hardware to make my AMD card the default before I can test it (curses to Asus and their BIOS that doesn&#039;t let me select _which_ PCIe graphics card to use)</p> </div> <div class="postsignature postmsg"><hr /><p><a href="http://vfio.blogspot.com" rel="nofollow">http://vfio.blogspot.com</a><br />Looking for a more open forum to discuss vfio related uses?&#160; Try <a href="https://www.redhat.com/mailman/listinfo/vfio-users" rel="nofollow">https://www.redhat.com/mailman/listinfo/vfio-users</a></p></div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1418679">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1418687" class="blockpost roweven"> <h2><span><span class="conr">#1789</span> <a href="viewtopic.php?pid=1418687#p1418687">2014-05-23 21:51:05</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=79991">mv0lnicky</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2014-03-05</span></dd> <dd><span>Posts: 16</span></dd> <dd class="usercontacts"><span class="email"><a href="misc.php?email=79991">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>aw wrote:</cite><blockquote><div><p>(curses to Asus and their BIOS that doesn&#039;t let me select _which_ PCIe graphics card to use)</p></div></blockquote></div><p>Is there even such a thing? I&#039;ve yet to see more options than PCI or PEG (and AGP back in the days).</p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1418687">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1418688" class="blockpost rowodd"> <h2><span><span class="conr">#1790</span> <a href="viewtopic.php?pid=1418688#p1418688">2014-05-23 21:52:49</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=75590">aw</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2013-10-04</span></dd> <dd><span>Posts: 921</span></dd> <dd class="usercontacts"><span class="email"><a href="misc.php?email=75590">Email</a></span> <span class="website"><a href="http://vfio.blogspot.com/" rel="nofollow">Website</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>mv0lnicky wrote:</cite><blockquote><div><div class="quotebox"><cite>aw wrote:</cite><blockquote><div><p>(curses to Asus and their BIOS that doesn&#039;t let me select _which_ PCIe graphics card to use)</p></div></blockquote></div><p>Is there even such a thing? I&#039;ve yet to see more options than PCI or PEG (and AGP back in the days).</p></div></blockquote></div><p>I&#039;ve seen it.&#160; I can&#039;t remember where, but I&#039;m pretty sure at least one of my systems lets me do it (which means it&#039;s either Gigabyte or Lenovo).</p> </div> <div class="postsignature postmsg"><hr /><p><a href="http://vfio.blogspot.com" rel="nofollow">http://vfio.blogspot.com</a><br />Looking for a more open forum to discuss vfio related uses?&#160; Try <a href="https://www.redhat.com/mailman/listinfo/vfio-users" rel="nofollow">https://www.redhat.com/mailman/listinfo/vfio-users</a></p></div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1418688">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1418689" class="blockpost roweven"> <h2><span><span class="conr">#1791</span> <a href="viewtopic.php?pid=1418689#p1418689">2014-05-23 21:53:55</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=78080">Slabity</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2013-12-29</span></dd> <dd><span>Posts: 40</span></dd> <dd class="usercontacts"><span class="email"><a href="mailto:tslabinski@mygsc.com">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>aw wrote:</cite><blockquote><div><p>Slabity, if you&#039;d be willing to test it, I think this might resolve the problem (kernel patch):&#160; <a href="http://pastebin.com/2ukyQbkG" rel="nofollow">http://pastebin.com/2ukyQbkG</a></p></div></blockquote></div><p>Sure! I&#039;ll try it out immediately!</p><div class="quotebox"><cite>aw wrote:</cite><blockquote><div><p>I&#039;ll need to swap around some hardware to make my AMD card the default before I can test it (curses to Asus and their BIOS that doesn&#039;t let me select _which_ PCIe graphics card to use)</p></div></blockquote></div><p>Blargh, I know what you mean. I always loved ASUS years ago when I was just into overclocking. But now it feels like their boards have no utility. And their technical support is hell. But I&#039;m stuck with them for the time being.</p> <p class="postedit"><em>Last edited by Slabity (2014-05-23 21:54:40)</em></p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1418689">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1418691" class="blockpost rowodd"> <h2><span><span class="conr">#1792</span> <a href="viewtopic.php?pid=1418691#p1418691">2014-05-23 21:56:17</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=82227">HPvirt</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2014-05-23</span></dd> <dd><span>Posts: 6</span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>Slabity wrote:</cite><blockquote><div><p>To add what aw said, I recently just got the 4790 when I found out the 4770K did not support Vt-d.</p><p>The only reason I got it was because it was on sale for cheaper than the normal 4770. I&#039;ve only recently compared the two, and honestly it&#039;s not worth the extra $15. Hell, it&#039;s not even worth an extra $5 in my opinion. The speed is completely unnoticeable, as the <em>only</em> difference is the clock speed. Unless you can find the 4790 someplace cheaper than the 4770, stick with the 4770. I will absolutely guarantee that you will not notice any.</p></div></blockquote></div><p>I&#039;ll have the 4790 cheaper than a 4770 <img src="https://bbs.archlinux.org/img/smilies/smile.png" width="15" height="15" alt="smile" /></p><div class="quotebox"><cite>Slabity wrote:</cite><blockquote><div><p>Second, that motherboard is designed for overclocking and high end gaming. The non-k series can not be overclocked, and if you&#039;re gaming in a VM then I doubt you&#039;ll be taking advantage of the &#039;gamer features&#039; that the motherboard is flaunting.<br />I&#039;m not saying that you shouldn&#039;t get these things, but there are cheaper options that&#039;ll suit your needs perfectly fine.</p></div></blockquote></div><p>During my search for the MB, I&#039;ve seen that VT-d support is random for Asus, Gigabyte, MSI as it&#039;s not officialy supported. And when it&#039;s working, it&#039;s mostly haphazardly. Updating a bios can remove the support, which come back with the next update... or not.<br />So AsRock was the way to go.<br />As I want to passthrough Sata &amp; LAN &amp; USB, I need 2 controllers of each type if I&#039;ve understand how the passthrough works (my flaw is perhaps here), and I don&#039;t want to buy LAN and SATA card. So choices are limited. &quot;Gamer features&quot; are not the reason I choose this MB.</p><p>But, I take into account all advices, so if you know a MB compliant with my needs, I&#039;ll check it and see if I can buy it in France.</p><p>Go back to the topic: I&#039;ll repost here during the configuration of my system, for help (most probably), or, if it works flawlessly, to record my conf as working <img src="https://bbs.archlinux.org/img/smilies/smile.png" width="15" height="15" alt="smile" /></p> <p class="postedit"><em>Last edited by HPvirt (2014-05-23 22:02:06)</em></p> </div> <div class="postsignature postmsg"><hr /><p>Hardware: ASRock Z97 Extreme 6 - Intel Core i7 4790 - NVidia GTX680<br />Host: Linux Mint 17 Qiana, Kernel 3.15.8 (custom)<br />Guest: Windows Seven Ultimate SP1</p></div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1418691">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1418701" class="blockpost roweven"> <h2><span><span class="conr">#1793</span> <a href="viewtopic.php?pid=1418701#p1418701">2014-05-23 22:14:40</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=75590">aw</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2013-10-04</span></dd> <dd><span>Posts: 921</span></dd> <dd class="usercontacts"><span class="email"><a href="misc.php?email=75590">Email</a></span> <span class="website"><a href="http://vfio.blogspot.com/" rel="nofollow">Website</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>Slabity wrote:</cite><blockquote><div><div class="quotebox"><cite>aw wrote:</cite><blockquote><div><p>Slabity, if you&#039;d be willing to test it, I think this might resolve the problem (kernel patch):&#160; <a href="http://pastebin.com/2ukyQbkG" rel="nofollow">http://pastebin.com/2ukyQbkG</a></p></div></blockquote></div><p>Sure! I&#039;ll try it out immediately!</p></div></blockquote></div><p>Hmm, it&#039;s not working.&#160; I can reproduce it now, so I&#039;ll keep poking at it.</p> </div> <div class="postsignature postmsg"><hr /><p><a href="http://vfio.blogspot.com" rel="nofollow">http://vfio.blogspot.com</a><br />Looking for a more open forum to discuss vfio related uses?&#160; Try <a href="https://www.redhat.com/mailman/listinfo/vfio-users" rel="nofollow">https://www.redhat.com/mailman/listinfo/vfio-users</a></p></div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1418701">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1418743" class="blockpost rowodd"> <h2><span><span class="conr">#1794</span> <a href="viewtopic.php?pid=1418743#p1418743">2014-05-24 01:54:06</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=79578">AKSN74</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd class="postavatar"><img src="https://bbs.archlinux.org/img/avatars/79578.jpg?m=1423108340" width="80" height="80" alt="" /></dd> <dd><span>From: Taichung, Taiwan</span></dd> <dd><span>Registered: 2014-02-18</span></dd> <dd><span>Posts: 52</span></dd> <dd class="usercontacts"><span class="email"><a href="mailto:missile0407@gmail.com">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <p>I tried in these days that I want to make CUDA works in guest OS.<br />I&#039;ve tested many possible reasons cause CUDA can&#039;t work if guest OS is Ubuntu.</p><p>If I use Windows 7 as guest, it can work perfectly.<br />But if I use Ubuntu as guest, it can install graphic driver, can install CUDA SDK, can compile sample codes, but when execute CUDA application, it still gets error.</p><p>At beginnig, I thought it&#039;s driver compatible problem, so I changed to older version, and still didn&#039;t work.<br />Now I&#039;m try to upgrade guest&#039;s kernel and see it work or not.</p><p>But I think out there is another problem may cause it happen.<br />Because when we tried to launch QEMU, KVM is required. But my KVM is installed from Ubuntu ( sudo apt-get install kvm ) , and install KVM first, then QEMU 2.0 .<br />From Ubuntu official version, this modules may not compatible with newer QEMU or our settings.<br />Is that possible?</p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1418743">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1418753" class="blockpost roweven"> <h2><span><span class="conr">#1795</span> <a href="viewtopic.php?pid=1418753#p1418753">2014-05-24 03:10:15</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=78080">Slabity</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2013-12-29</span></dd> <dd><span>Posts: 40</span></dd> <dd class="usercontacts"><span class="email"><a href="mailto:tslabinski@mygsc.com">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>aw wrote:</cite><blockquote><div><p>Hmm, it&#039;s not working.&#160; I can reproduce it now, so I&#039;ll keep poking at it.</p></div></blockquote></div><p>Nope, it didn&#039;t work for me either. I added those scripts to the vfio-bind service though, so it seems to work perfectly fine. My Windows VM allows me to to run the passthrough and view the results on another monitor.</p><p>However, I&#039;d like to know if it&#039;s possible to connect to the VM using virt-manager. I have my configuration file as such:</p><p><a href="http://pastebin.com/L2Exj8bR" rel="nofollow">http://pastebin.com/L2Exj8bR</a></p><p>I see other users online have been able to achieve this sort of thing, but they do not explain how. Essentially I&#039;d like it to run a Spice display so that I could view it from my host, but still use the passthrough card for the actual processing.</p><p>Any ideas of where to look?</p> <p class="postedit"><em>Last edited by Slabity (2014-05-24 03:31:22)</em></p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1418753">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1418756" class="blockpost rowodd"> <h2><span><span class="conr">#1796</span> <a href="viewtopic.php?pid=1418756#p1418756">2014-05-24 05:14:52</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=81794">Destroy</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2014-05-05</span></dd> <dd><span>Posts: 10</span></dd> <dd class="usercontacts"><span class="email"><a href="misc.php?email=81794">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>Slabity wrote:</cite><blockquote><div><p>I see other users online have been able to achieve this sort of thing, but they do not explain how. Essentially I&#039;d like it to run a Spice display so that I could view it from my host, but still use the passthrough card for the actual processing.</p><p>Any ideas of where to look?</p></div></blockquote></div><p>Could you point us where did you looked that?</p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1418756">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1418758" class="blockpost roweven"> <h2><span><span class="conr">#1797</span> <a href="viewtopic.php?pid=1418758#p1418758">2014-05-24 05:26:20</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=75590">aw</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2013-10-04</span></dd> <dd><span>Posts: 921</span></dd> <dd class="usercontacts"><span class="email"><a href="misc.php?email=75590">Email</a></span> <span class="website"><a href="http://vfio.blogspot.com/" rel="nofollow">Website</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>Slabity wrote:</cite><blockquote><div><p>However, I&#039;d like to know if it&#039;s possible to connect to the VM using virt-manager. I have my configuration file as such:</p><p><a href="http://pastebin.com/L2Exj8bR" rel="nofollow">http://pastebin.com/L2Exj8bR</a></p><p>I see other users online have been able to achieve this sort of thing, but they do not explain how. Essentially I&#039;d like it to run a Spice display so that I could view it from my host, but still use the passthrough card for the actual processing.</p><p>Any ideas of where to look?</p></div></blockquote></div><p>No, it&#039;s not possible with current code.&#160; When you use GPU assignment, the guest own the display, the host has no visibility to it.&#160; Things like Spice are out-of-band, host driven protocols.&#160; Once you assign a GPU you&#039;re left with in-band, guest driven protocols.&#160; You have the same ability to get to the display remotely as you do a separate physical system, which does not currently involved libvirt/virt-manager.</p> </div> <div class="postsignature postmsg"><hr /><p><a href="http://vfio.blogspot.com" rel="nofollow">http://vfio.blogspot.com</a><br />Looking for a more open forum to discuss vfio related uses?&#160; Try <a href="https://www.redhat.com/mailman/listinfo/vfio-users" rel="nofollow">https://www.redhat.com/mailman/listinfo/vfio-users</a></p></div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1418758">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1418760" class="blockpost rowodd"> <h2><span><span class="conr">#1798</span> <a href="viewtopic.php?pid=1418760#p1418760">2014-05-24 05:36:44</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=78080">Slabity</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2013-12-29</span></dd> <dd><span>Posts: 40</span></dd> <dd class="usercontacts"><span class="email"><a href="mailto:tslabinski@mygsc.com">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>Destroy wrote:</cite><blockquote><div><div class="quotebox"><cite>Slabity wrote:</cite><blockquote><div><p>I see other users online have been able to achieve this sort of thing, but they do not explain how. Essentially I&#039;d like it to run a Spice display so that I could view it from my host, but still use the passthrough card for the actual processing.</p><p>Any ideas of where to look?</p></div></blockquote></div><p>Could you point us where did you looked that?</p></div></blockquote></div><p>Hmm, well it seems like I may have been sorta wrong. Here&#039;s the original video I was looking at:</p><p><a href="https://www.youtube.com/watch?v=Qi1LdFkRzIs&amp;html5=1" rel="nofollow">https://www.youtube.com/watch?v=Qi1LdFkRzIs&amp;html5=1</a></p><p>It seems he used a combination of a spice display and a VNC server to run this.</p><p>This one:</p><p><a href="https://www.youtube.com/watch?v=37D2bRsthfI&amp;html5=1" rel="nofollow">https://www.youtube.com/watch?v=37D2bRsthfI&amp;html5=1</a></p><p>Used some xrandr magic and synergy to synchronize his desktops.</p><p>There were 2 more videos that I can&#039;t seem to find right now. But I don&#039;t know what sort of setup would be useful for this.</p><p>So I guess that sort of rephrases my question (since I don&#039;t think Linux can grab the video output of a passthrough card). What would you do if you were trying to accomplish this sort of thing? I&#039;m gonna try and see if VNC is fast enough for 60 FPS output, but I suppose I&#039;ll see.</p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1418760">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1418764" class="blockpost roweven"> <h2><span><span class="conr">#1799</span> <a href="viewtopic.php?pid=1418764#p1418764">2014-05-24 05:42:46</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=75590">aw</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2013-10-04</span></dd> <dd><span>Posts: 921</span></dd> <dd class="usercontacts"><span class="email"><a href="misc.php?email=75590">Email</a></span> <span class="website"><a href="http://vfio.blogspot.com/" rel="nofollow">Website</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>Slabity wrote:</cite><blockquote><div><div class="quotebox"><cite>Destroy wrote:</cite><blockquote><div><div class="quotebox"><cite>Slabity wrote:</cite><blockquote><div><p>I see other users online have been able to achieve this sort of thing, but they do not explain how. Essentially I&#039;d like it to run a Spice display so that I could view it from my host, but still use the passthrough card for the actual processing.</p><p>Any ideas of where to look?</p></div></blockquote></div><p>Could you point us where did you looked that?</p></div></blockquote></div><p>Hmm, well it seems like I may have been sorta wrong. Here&#039;s the original video I was looking at:</p><p><a href="https://www.youtube.com/watch?v=Qi1LdFkRzIs&amp;html5=1" rel="nofollow">https://www.youtube.com/watch?v=Qi1LdFkRzIs&amp;html5=1</a></p><p>It seems he used a combination of a spice display and a VNC server to run this.</p></div></blockquote></div><p>No spice, clearly running tigervnc in the host as the view and a vnc server in the guest.&#160; You can see the icon in the toolbar.</p><div class="quotebox"><blockquote><div><p>This one:</p><p><a href="https://www.youtube.com/watch?v=37D2bRsthfI&amp;html5=1" rel="nofollow">https://www.youtube.com/watch?v=37D2bRsthfI&amp;html5=1</a></p><p>Used some xrandr magic and synergy to synchronize his desktops.</p></div></blockquote></div><p>Yep, no remote display at all, xrandr releases the display, which is then assigned to a guest.</p> </div> <div class="postsignature postmsg"><hr /><p><a href="http://vfio.blogspot.com" rel="nofollow">http://vfio.blogspot.com</a><br />Looking for a more open forum to discuss vfio related uses?&#160; Try <a href="https://www.redhat.com/mailman/listinfo/vfio-users" rel="nofollow">https://www.redhat.com/mailman/listinfo/vfio-users</a></p></div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1418764">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1418787" class="blockpost rowodd"> <h2><span><span class="conr">#1800</span> <a href="viewtopic.php?pid=1418787#p1418787">2014-05-24 09:19:59</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=82238">sinny</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2014-05-24</span></dd> <dd><span>Posts: 75</span></dd> <dd class="usercontacts"><span class="email"><a href="misc.php?email=82238">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <p>i know that it is kinda wrong to bring my problems to arch linux boards, but i am pretty desperate at that point )</p><p>MB: asrock z87 pro4<br />CPU: intel i7 4770<br />OS: fedora 20</p><p>host vga: IGD (details below)</p><p>kernel (with i915 module being recompiled with i915_314.patch from linux-mainline.tar.gz in first post):</p><div class="codebox"><pre><code>[s@localhost ~]$ uname -r 3.14.4-200.fc20.x86_64 [s@localhost ~]$ modinfo i915 | head -n1 filename: /lib/modules/3.14.4-200.fc20.x86_64/updates/i915.ko [s@localhost ~]$ </code></pre></div><p>couldnt have any success at all for 5 days while trying different variations, completely out of ideas for now on what may be wrong - too much outdated info out there</p><p>target guest os is win7</p><p>when trying to passthrough HD 6450:<br /> - [test command from first post] host screen usually gets screwed (looking like pallete was overwritten randomly, i doubt X is running in indexed mode though) - fixable by switching to tty console and then back to X<br /> - [virt-manager/kvm] Code 10 (device cannot be started) in device manager, latest catalyst drivers setup terminates while trying to detect hardware</p><p>when trying to passthrough GT 430:<br /> - [test command from first post] seen this:</p><div class="codebox"><pre><code>KVM internal error. Suberror: 1 emulation failure EAX=0000b422 EBX=0000b4b4 ECX=00005dd7 EDX=000003d4 ESI=00009e48 EDI=000018d2 EBP=0000d494 ESP=000018ca EIP=0000b4b4 EFL=00010082 [--S----] CPL=0 II=0 A20=1 SMM=0 HLT=0 ES =0000 00000000 ffffffff 00809300 CS =b4b4 000b4b40 ffffffff 00809b00 SS =0000 00000000 ffffffff 00809300 DS =0000 00000000 ffffffff 00809300 FS =0000 00000000 ffffffff 00809300 GS =0000 00000000 ffffffff 00809300 LDT=0000 00000000 0000ffff 00008200 TR =0000 00000000 0000ffff 00008b00 GDT= 000f6c48 00000037 IDT= 00000000 000003ff CR0=00000010 CR2=00000000 CR3=00000000 CR4=00000000 DR0=0000000000000000 DR1=0000000000000000 DR2=0000000000000000 DR3=0000000000000000 DR6=00000000ffff0ff0 DR7=0000000000000400 EFER=0000000000000000 Code=20 07 20 07 20 07 20 07 20 07 20 07 20 07 20 07 20 07 20 07 &lt;20&gt; 07 20 07 20 07 20 07 20 07 20 07 55 aa 6d eb 4b 37 34 30 30 e9 4c 19 77 cc 56 49 44 45</code></pre></div><p> - [virt-manager/kvm] Code 43 (windows stopped the device) in device manager</p><p>if someone could point me to the direction to look at, that would be great<br />thanks in advance<br />some environment info:</p><div class="codebox"><pre class="vscroll"><code>[s@localhost ~]$ lspci -nn | grep VGA 00:02.0 VGA compatible controller [0300]: Intel Corporation Xeon E3-1200 v3/4th Gen Core Processor Integrated Graphics Controller [8086:0412] (rev 06) 01:00.0 VGA compatible controller [0300]: Advanced Micro Devices, Inc. [AMD/ATI] Caicos [Radeon HD 6450/7450/8450 / R5 230 OEM] [1002:6779] 05:00.0 VGA compatible controller [0300]: NVIDIA Corporation GF108 [GeForce GT 430] [10de:0de1] (rev a1) [s@localhost ~]$ [s@localhost ~]$ sudo lspci -s0:2.0 -k 00:02.0 VGA compatible controller: Intel Corporation Xeon E3-1200 v3/4th Gen Core Processor Integrated Graphics Controller (rev 06) Subsystem: ASRock Incorporation Device 0412 Kernel driver in use: i915 Kernel modules: i915 [s@localhost ~]$ sudo lspci -s1:0.0 -k 01:00.0 VGA compatible controller: Advanced Micro Devices, Inc. [AMD/ATI] Caicos [Radeon HD 6450/7450/8450 / R5 230 OEM] Subsystem: Gigabyte Technology Co., Ltd Device 2549 Kernel driver in use: vfio-pci Kernel modules: radeon [s@localhost ~]$ sudo lspci -s5:0.0 -k 05:00.0 VGA compatible controller: NVIDIA Corporation GF108 [GeForce GT 430] (rev a1) Kernel driver in use: vfio-pci Kernel modules: nouveau [s@localhost ~]$ [s@localhost ~]$ readlink /sys/bus/pci/devices/0000\:01\:00.0/iommu_group ../../../../kernel/iommu_groups/1 [s@localhost ~]$ readlink /sys/bus/pci/devices/0000\:05\:00.0/iommu_group ../../../../kernel/iommu_groups/9 [s@localhost ~]$ ls /dev/vfio/ total 0 drwxr-xr-x 2 root root 100 May 24 11:22 . drwxr-xr-x 22 root root 3780 May 24 12:31 .. crw------- 1 root root 247, 0 May 24 11:22 1 crw------- 1 root root 247, 1 May 24 11:22 9 crw-rw-rw- 1 root root 10, 196 May 24 11:22 vfio [s@localhost ~]$ [s@localhost ~]$ cat /proc/cmdline BOOT_IMAGE=/boot/vmlinuz-3.14.4-200.fc20.x86_64 root=UUID=588911d3-23f7-4544-9d46-0b06b85f287c ro nouveau.modeset=0 rd.driver.blacklist=nouveau video=vesa:off pci-stub.ids=1002:6779,1002:aa98,10de:0de1,10de:0bea intel_iommu=on [s@localhost ~]$ [s@localhost ~]$ tail -n100 /etc/modprobe.d/alsa-base.conf /etc/modprobe.d/blacklist-ath_pci.conf /etc/modprobe.d/blacklist.conf /etc/modprobe.d/blacklist-firewire.conf /etc/modprobe.d/blacklist-framebuffer.conf /etc/modprobe.d/blacklist-gpu.conf /etc/modprobe.d/blacklist-modem.conf /etc/modprobe.d/blacklist-oss.conf /etc/modprobe.d/blacklist-rare-network.conf /etc/modprobe.d/blacklist-watchdog.conf /etc/modprobe.d/dkms.conf /etc/modprobe.d/fbdev-blacklist.conf /etc/modprobe.d/iwlwifi.conf /etc/modprobe.d/mlx4.conf /etc/modprobe.d/modprobe.conf /etc/modprobe.d/pci-stub.conf /etc/modprobe.d/qemu-system-x86.conf /etc/modprobe.d/vfio_iommu_type1.conf /etc/modprobe.d/vmwgfx-fbdev.conf ==&gt; /etc/modprobe.d/kvm.conf &lt;== options kvm ignore_msrs=1 ==&gt; /etc/modprobe.d/pci-stub.conf &lt;== blacklist nouveau blacklist radeon ==&gt; /etc/modprobe.d/vfio_iommu_type1.conf &lt;== options vfio_iommu_type1 allow_unsafe_interrupts=1 [s@localhost ~]$ [s@localhost ~]$ sudo grep -v &quot;^#&quot; /etc/libvirt/qemu.conf | grep -v &quot;^[ \t]*$&quot; user = &quot;root&quot; group = &quot;root&quot; clear_emulator_capabilities = 0 [s@localhost ~]$ [s@localhost ~]$ rpm -qa | grep &quot;qemu\|seabios\|virt&quot; | sort ipxe-roms-qemu-20140303-1.gitff1e7fc7.fc20.noarch libgovirt-0.3.0-3.fc20.x86_64 libvirt-client-1.2.4-1.fc20.x86_64 libvirt-daemon-1.2.4-1.fc20.x86_64 libvirt-daemon-driver-interface-1.2.4-1.fc20.x86_64 libvirt-daemon-driver-network-1.2.4-1.fc20.x86_64 libvirt-daemon-driver-nodedev-1.2.4-1.fc20.x86_64 libvirt-daemon-driver-nwfilter-1.2.4-1.fc20.x86_64 libvirt-daemon-driver-qemu-1.2.4-1.fc20.x86_64 libvirt-daemon-driver-secret-1.2.4-1.fc20.x86_64 libvirt-daemon-driver-storage-1.2.4-1.fc20.x86_64 libvirt-daemon-kvm-1.2.4-1.fc20.x86_64 libvirt-glib-0.1.7-2.fc20.x86_64 libvirt-python-1.2.4-1.fc20.x86_64 qemu-common-2.0.0-4.fc20.x86_64 qemu-img-2.0.0-4.fc20.x86_64 qemu-kvm-2.0.0-4.fc20.x86_64 qemu-system-x86-2.0.0-4.fc20.x86_64 seabios-bin-1.7.4-5.fc20.noarch virt-install-1.0.1-3.fc20.noarch virt-manager-1.0.1-3.fc20.noarch virt-manager-common-1.0.1-3.fc20.noarch virt-top-1.0.8-7.fc20.x86_64 virt-viewer-0.6.0-1.fc20.x86_64 [s@localhost ~]$ </code></pre></div> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1418787">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div class="postlinksb"> <div class="inbox crumbsplus"> <div class="pagepost"> <p class="pagelink conl"><span class="pages-label">Pages: </span><a rel="prev" class="item1" href="viewtopic.php?id=162768&amp;p=71">Previous</a> <a href="viewtopic.php?id=162768">1</a> <span class="spacer">…</span> <a href="viewtopic.php?id=162768&amp;p=70">70</a> <a href="viewtopic.php?id=162768&amp;p=71">71</a> <strong>72</strong> <a href="viewtopic.php?id=162768&amp;p=73">73</a> <a href="viewtopic.php?id=162768&amp;p=74">74</a> <span class="spacer">…</span> <a href="viewtopic.php?id=162768&amp;p=234">234</a> <a rel="next" href="viewtopic.php?id=162768&amp;p=73">Next</a></p> <p class="postlink conr">Topic closed</p> </div> <ul class="crumbs"> <li><a href="index.php">Index</a></li> <li><span>»&#160;</span><a href="viewforum.php?id=48">Topics Going Nowhere</a></li> <li><span>»&#160;</span><strong><a href="viewtopic.php?id=162768">KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</a></strong></li> </ul> <p class="subscribelink clearb"><a href="misc.php?action=subscribe&amp;tid=162768">Subscribe to this topic</a></p> <div class="clearer"></div> </div> </div> </div> <div id="brdfooter" class="block"> <h2><span>Board footer</span></h2> <div class="box"> <div id="brdfooternav" class="inbox"> <div class="conl"> <form id="qjump" method="get" action="viewforum.php"> <div><label><span>Jump to<br /></span> <select name="id" onchange="window.location=('viewforum.php?id='+this.options[this.selectedIndex].value)"> <optgroup label="Technical Issues and Assistance"> <option value="23">Newbie Corner</option> <option value="17">Installation</option> <option value="22">Kernel &amp; Hardware</option> <option value="18">Applications &amp; Desktop Environments</option> <option value="31">Laptop Issues</option> <option value="8">Networking, Server, and Protection</option> <option value="32">Multimedia and Games</option> <option value="50">System Administration</option> <option value="35">Other Architectures</option> </optgroup> <optgroup label="Arch-centric"> <option value="24">Announcements, Package &amp; Security Advisories</option> <option value="1">Arch Discussion</option> <option value="13">Forum &amp; Wiki discussion</option> </optgroup> <optgroup label="Pacman Upgrades, Packaging &amp; AUR"> <option value="44">Pacman &amp; Package Upgrade Issues</option> <option value="49">[testing] Repo Forum</option> <option value="4">Creating &amp; Modifying Packages</option> <option value="38">AUR Issues, Discussion &amp; PKGBUILD Requests</option> </optgroup> <optgroup label="Contributions &amp; Discussion"> <option value="20">GNU/Linux Discussion</option> <option value="27">Community Contributions</option> <option value="33">Programming &amp; Scripting</option> <option value="30">Other Languages</option> <option value="47">Artwork and Screenshots</option> <option value="42">Try This</option> </optgroup> <optgroup label="/dev/null"> <option value="29">Off-Topic</option> <option value="48" selected="selected">Topics Going Nowhere</option> <option value="36">Dustbin</option> </optgroup> </select></label> <input type="submit" value=" Go " accesskey="g" /> </div> </form> </div> <div class="conr"> <p id="feedlinks"><span class="atom"><a href="extern.php?action=feed&amp;tid=162768&amp;type=atom">Atom topic feed</a></span></p> <p id="poweredby">Powered by <a href="http://fluxbb.org/">FluxBB</a></p> </div> <div class="clearer"></div> </div> </div> </div> </div> <div class="end-box"></div> </div> </body> </html>
