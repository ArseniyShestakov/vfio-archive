<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"> <html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en" dir="ltr"> <head> <meta http-equiv="Content-Type" content="text/html; charset=utf-8" /> <title>KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9 (Page 76) / Topics Going Nowhere / Arch Linux Forums</title> <link rel="stylesheet" type="text/css" href="style/ArchLinux.css" /> <link rel="canonical" href="viewtopic.php?id=162768&amp;p=76" title="Page 76" /> <link rel="prev" href="viewtopic.php?id=162768&amp;p=75" title="Page 75" /> <link rel="next" href="viewtopic.php?id=162768&amp;p=77" title="Page 77" /> <link rel="alternate" type="application/atom+xml" href="extern.php?action=feed&amp;tid=162768&amp;type=atom" title="Atom topic feed" /> <link rel="stylesheet" media="screen" href="style/ArchLinux/arch.css?v=3" /> <link rel="stylesheet" media="screen" href="style/ArchLinux/archnavbar.css?v=2" /> <link rel="shortcut icon" href="style/ArchLinux/favicon.ico" /> </head> <body> <div id="archnavbar" class="anb-forum"> <div id="archnavbarlogo"><h1><a href="http://www.archlinux.org/">Arch Linux</a></h1></div> <div id="archnavbarmenu"> <ul id="archnavbarlist"> <li id="anb-home"><a href="http://www.archlinux.org/">Home</a></li><li id="anb-packages"><a href="http://www.archlinux.org/packages/">Packages</a></li><li id="anb-forums" class="anb-selected"><a href="https://bbs.archlinux.org/">Forums</a></li><li id="anb-wiki"><a href="https://wiki.archlinux.org/">Wiki</a></li><li id="anb-bugs"><a href="https://bugs.archlinux.org/">Bugs</a></li><li id="anb-aur"><a href="https://aur.archlinux.org/">AUR</a></li><li id="anb-download"><a href="http://www.archlinux.org/download/">Download</a></li> </ul> </div> </div> <div id="punviewtopic" class="pun"> <div class="top-box"></div> <div class="punwrap"> <div id="brdheader" class="block"> <div class="box"> <div id="brdmenu" class="inbox"> <ul> <li id="navindex" class="isactive"><a href="index.php">Index</a></li> <li id="navuserlist"><a href="userlist.php">User list</a></li> <li id="navsearch"><a href="search.php">Search</a></li> <li id="navprofile"><a href="profile.php?id=80749">Profile</a></li> <li id="navlogout"><a href="login.php?action=out&amp;id=80749&amp;csrf_token=5c20501ec397bb45ef8ee8c84db232c8d8e421c6">Logout</a></li> </ul> </div> <div id="brdwelcome" class="inbox"> <ul class="conl"> <li><span>Logged in as <strong>SXX</strong></span></li> <li><span>Last visit: 2015-08-16 12:20:09</span></li> </ul> <ul class="conr"> <li><span>Topics: <a href="search.php?action=show_replies" title="Find topics you have posted to.">Posted</a> | <a href="search.php?action=show_new" title="Find topics with new posts since your last visit.">New</a> | <a href="search.php?action=show_recent" title="Find topics with recent posts.">Active</a> | <a href="search.php?action=show_unanswered" title="Find topics with no replies.">Unanswered</a></span></li> </ul> <div class="clearer"></div> </div> </div> </div> <div id="brdmain"> <div class="linkst"> <div class="inbox crumbsplus"> <ul class="crumbs"> <li><a href="index.php">Index</a></li> <li><span>»&#160;</span><a href="viewforum.php?id=48">Topics Going Nowhere</a></li> <li><span>»&#160;</span><strong><a href="viewtopic.php?id=162768">KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</a></strong></li> </ul> <div class="pagepost"> <p class="pagelink conl"><span class="pages-label">Pages: </span><a rel="prev" class="item1" href="viewtopic.php?id=162768&amp;p=75">Previous</a> <a href="viewtopic.php?id=162768">1</a> <span class="spacer">…</span> <a href="viewtopic.php?id=162768&amp;p=74">74</a> <a href="viewtopic.php?id=162768&amp;p=75">75</a> <strong>76</strong> <a href="viewtopic.php?id=162768&amp;p=77">77</a> <a href="viewtopic.php?id=162768&amp;p=78">78</a> <span class="spacer">…</span> <a href="viewtopic.php?id=162768&amp;p=234">234</a> <a rel="next" href="viewtopic.php?id=162768&amp;p=77">Next</a></p> <p class="postlink conr">Topic closed</p> </div> <div class="clearer"></div> </div> </div> <div id="p1420268" class="blockpost rowodd blockpost1"> <h2><span><span class="conr">#1876</span> <a href="viewtopic.php?pid=1420268#p1420268">2014-05-29 04:52:51</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=82357">gutleib</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2014-05-29</span></dd> <dd><span>Posts: 5</span></dd> <dd class="usercontacts"><span class="email"><a href="misc.php?email=82357">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <p>The thing is, gpu is gtx590, which is basically two 580 on single board. Not sure how it will behave with only one &quot;half&quot; passthru&#039;ed.<br />The kernel is Ubuntu 14.04 from updates repo, no patches. Only some modules.<br />Host gpu is radeon HD2600, afair, but generaly it&#039;s a smallest radeon hd with passive heatsink I could find.<br />Qemu is also ubuntu 14.04 stock, which is 2.0.<br />I am trying to make gpu passthrough with minimal tinkering, since I have quite a bunch of 3d workstations. Windows and custom linux builds equally suck.</p><div class="quotebox"><cite>aw wrote:</cite><blockquote><div><p>...Besides, you&#039;ve made a non-standard PCIe configuration in the guest by using PCI slots 0 and 1 behind your root port.&#160; Typically only slot 0 is scanned by the guest.&#160; Once you get your VGA card working, add another ioh3420 and put the other card behind it.</p></div></blockquote></div><p>Ummm... Didn&#039;t know that.<br />Will check.</p><p>But would be really great if you could explain the whole ioh3420 argument. Or point to where I could read the short version <img src="https://bbs.archlinux.org/img/smilies/smile.png" width="15" height="15" alt="smile" /><br />So far, I don&#039;t understand which variables should be changed for second ioh.</p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1420268">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1420269" class="blockpost roweven"> <h2><span><span class="conr">#1877</span> <a href="viewtopic.php?pid=1420269#p1420269">2014-05-29 04:57:04</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=75590">aw</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2013-10-04</span></dd> <dd><span>Posts: 921</span></dd> <dd class="usercontacts"><span class="email"><a href="misc.php?email=75590">Email</a></span> <span class="website"><a href="http://vfio.blogspot.com/" rel="nofollow">Website</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <p>You need the VGA arbiter patch from a page or two back</p> </div> <div class="postsignature postmsg"><hr /><p><a href="http://vfio.blogspot.com" rel="nofollow">http://vfio.blogspot.com</a><br />Looking for a more open forum to discuss vfio related uses?&#160; Try <a href="https://www.redhat.com/mailman/listinfo/vfio-users" rel="nofollow">https://www.redhat.com/mailman/listinfo/vfio-users</a></p></div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1420269">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1420274" class="blockpost rowodd"> <h2><span><span class="conr">#1878</span> <a href="viewtopic.php?pid=1420274#p1420274">2014-05-29 05:26:17</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=79578">AKSN74</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd class="postavatar"><img src="https://bbs.archlinux.org/img/avatars/79578.jpg?m=1423108340" width="80" height="80" alt="" /></dd> <dd><span>From: Taichung, Taiwan</span></dd> <dd><span>Registered: 2014-02-18</span></dd> <dd><span>Posts: 52</span></dd> <dd class="usercontacts"><span class="email"><a href="mailto:missile0407@gmail.com">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <p>Today test again with Kernel 3.15-rc7, still without any luck.</p><p>The VM still hangs during reboot when Guest OS is Ubuntu Server.<br />And CUDA still get &quot;InvalidDevice&quot; error to me, even I tried use dumped VGA BIOS and -cpu using qemu64.</p><p>I still can&#039;t understand that with same settings, same functions, why Windows 7 can run CUDA but Ubuntu Server can&#039;t.<br />Now update the kernel of guest Ubuntu is my only hope for now.</p><p>But I&#039;m not get rid of the possibility that maybe I&#039;m doing a wrong installation.<br />If update the kernel still can&#039;t fix the problem. I&#039;ll really have no idea.</p><p>Does anyone tried run CUDA in guest Ubuntu and works?</p> <p class="postedit"><em>Last edited by AKSN74 (2014-05-29 05:27:27)</em></p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1420274">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1420293" class="blockpost roweven"> <h2><span><span class="conr">#1879</span> <a href="viewtopic.php?pid=1420293#p1420293">2014-05-29 08:44:32</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=71440">cdrjameson</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd class="postavatar"><img src="https://bbs.archlinux.org/img/avatars/71440.png?m=1392914202" width="80" height="73" alt="" /></dd> <dd><span>Registered: 2013-05-19</span></dd> <dd><span>Posts: 33</span></dd> <dd class="usercontacts"><span class="email"><a href="misc.php?email=71440">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <p>For a while I have been a lurker on this thread and been very impressed by the efforts and time of nhbs, aw and others to get peoples set-up working. I would like a quick feasibility check of my hardware from the other veterans of this thread.</p><p>I have the <a href="http://ark.intel.com/products/77656/Intel-Core-i7-4771-Processor-8M-Cache-up-to-3_90-GHz" rel="nofollow">i7-4771</a> with HD 4600 IGP, AMD 7950 GPU and AsRock Extreme 6 Z87 Motherboard with 16GB RAM. I did my research (hopefully it&#039;s right) and this hardware does support the necessary technologies.</p><p>I want the host to use the IGP, and passthrough the GPU. I have read mixed reports in this thread about the success for this type of setup, what is the current thinking? In the future I will add an Nvidia GPU for the host.</p><p>I have read the Wiki pages on the <a href="https://wiki.archlinux.org/index.php/Arch_Build_System" rel="nofollow">ABS</a>, <a href="https://wiki.archlinux.org/index.php/Creating_packages" rel="nofollow">Creating Packages</a> and <a href="https://wiki.archlinux.org/index.php/Kernels" rel="nofollow">Kernels</a>. I haven&#039;t seen an easy-to-follow guide how I would compile the <a href="https://aur.archlinux.org/packages/linux-mainline" rel="nofollow">linux-mainline</a> kernel from the AUR. And I&#039;ve been directed to the Gentoo handbook for more info or Kernel configurations; interesting stuff, but a little over my head and, I think, my needs too.</p><p>I haven&#039;t touched my Arch partition yet but I have created a seperate Arch install and installed qemu, seabios and abs. I will be creating the virtual machine there and writing down all the steps I take to get it working before transferring that work and attempting it in my main install. Hopefully this method will give me the fewest headaches in the future.</p><p>But in relative-newbie terms, how does one install the linux-mainline?</p><p>BTW if anyone is interested there is an <a href="https://bbs.archlinux.org/viewtopic.php?pid=1415472#p1415472" rel="nofollow">Arch Linux Class</a> this Saturday on the Linux Kernel and will cover things like compiling your own.</p> <p class="postedit"><em>Last edited by cdrjameson (2014-05-29 08:54:16)</em></p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1420293">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1420298" class="blockpost rowodd"> <h2><span><span class="conr">#1880</span> <a href="viewtopic.php?pid=1420298#p1420298">2014-05-29 09:38:16</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=82238">sinny</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2014-05-24</span></dd> <dd><span>Posts: 75</span></dd> <dd class="usercontacts"><span class="email"><a href="misc.php?email=82238">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>cdrjameson wrote:</cite><blockquote><div><p>For a while I have been a lurker on this thread and been very impressed by the efforts and time of nhbs, aw and others to get peoples set-up working. I would like a quick feasibility check of my hardware from the other veterans of this thread.</p><p>I have the <a href="http://ark.intel.com/products/77656/Intel-Core-i7-4771-Processor-8M-Cache-up-to-3_90-GHz" rel="nofollow">i7-4771</a> with HD 4600 IGP, AMD 7950 GPU and AsRock Extreme 6 Z87 Motherboard with 16GB RAM. I did my research (hopefully it&#039;s right) and this hardware does support the necessary technologies.</p><p>I want the host to use the IGP, and passthrough the GPU. I have read mixed reports in this thread about the success for this type of setup, what is the current thinking? In the future I will add an Nvidia GPU for the host.</p><p>I have read the Wiki pages on the <a href="https://wiki.archlinux.org/index.php/Arch_Build_System" rel="nofollow">ABS</a>, <a href="https://wiki.archlinux.org/index.php/Creating_packages" rel="nofollow">Creating Packages</a> and <a href="https://wiki.archlinux.org/index.php/Kernels" rel="nofollow">Kernels</a>. I haven&#039;t seen an easy-to-follow guide how I would compile the <a href="https://aur.archlinux.org/packages/linux-mainline" rel="nofollow">linux-mainline</a> kernel from the AUR. And I&#039;ve been directed to the Gentoo handbook for more info or Kernel configurations; interesting stuff, but a little over my head and, I think, my needs too.</p><p>I haven&#039;t touched my Arch partition yet but I have created a seperate Arch install and installed qemu, seabios and abs. I will be creating the virtual machine there and writing down all the steps I take to get it working before transferring that work and attempting it in my main install. Hopefully this method will give me the fewest headaches in the future.</p><p>But in relative-newbie terms, how does one install the linux-mainline?</p><p>BTW if anyone is interested there is an <a href="https://bbs.archlinux.org/viewtopic.php?pid=1415472#p1415472" rel="nofollow">Arch Linux Class</a> this Saturday on the Linux Kernel and will cover things like compiling your own.</p></div></blockquote></div><p>i can confirm the following setupd working:<br />MB: asrock z87 pro4<br />CPU: intel i7 4770<br />OS: fedora 20 x86_64 (with additional repositories: <a href="http://fedoraproject.org/wiki/Kernel_Vanilla_Repositories" rel="nofollow">kernel-vanilla-mainline</a> and <a href="http://fedoraproject.org/wiki/Virtualization_Preview_Repository" rel="nofollow">virt-preview</a>)<br />kernel: kernel-3.15.0-0.rc5.git2.8.vanilla.mainline.knurd.1.fc20.x86_64.rpm <br />host GPU: integrated (intel i7 4770)<br />guest GPU0: radeon hd 6450 (Gigabyte GV-R645-1GI)<br />guest GPU1: nvidia gt 430 // not used at the moment - pending</p><p>kernel patchwork performed (basic info for fedora: <a href="http://fedoraproject.org/wiki/Building_a_custom_kernel" rel="nofollow">here</a>), $DST_VER refers to destination kernel version:</p><ol class="decimal"><li><p>grab kernel source (.srpm, as described above) for mainline kernel being used</p></li><li><p>modify EXTRAVERSION variable in Makefile at root level of mainline kernel source (NOTE: needed for vermagic, see step 6 below)</p></li><li><p>&quot;make prepare scripts&quot; at root level of mainline kernel source</p></li><li><p>apply <a href="https://lkml.org/lkml/2014/5/9/517" rel="nofollow">vga arbiter patch</a> (NOTE: this modifies only i915 kernel module)</p></li><li><p>&quot;make modules SUBDIRS=drivers/gpu/drm/i915&quot; at root level of mainline kernel source</p></li><li><p>if &quot;modinfo /lib/modules/$DST_VER/kernel/drivers/gpu/drm/i915/i915.ko drivers/gpu/drm/i915/i915.ko | grep vermagic&quot; does not match - restart from step 2</p></li><li><p>copy built i915.ko module to &quot;/lib/modules/$DST_VER/updates&quot;</p></li><li><p>perform &quot;depmod&quot; as root</p></li><li><p>rebuild initramfs (something like &quot;dracut /boot/initramfs-$DST_VER.img $DST_VER&quot;) - you might want to save previous initramfs or build initramfs to different filename to enable it by modifying grub2 initrd parameter</p></li></ol><p>this is &quot;easy&quot; but pretty inconvenient way to do things: easy because only one kernel module is rebuilt, unconvenient because on every kernel update the rebuild procedure should be remade from scratch<br />NOTE: vermagic of built module not matching with running kernel may result in module not being loaded, which in turn (in my case) resulted in X server start rendering host system completely unusable (hang with screen showing garbage-colored lines)</p><p>more info bits may be found in my previous posts here</p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1420298">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1420342" class="blockpost roweven"> <h2><span><span class="conr">#1881</span> <a href="viewtopic.php?pid=1420342#p1420342">2014-05-29 12:40:13</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=81883">derbroti</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2014-05-09</span></dd> <dd><span>Posts: 1</span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <p>Hello,</p><p>I have a working setup with win7 as guest:</p><p>intel e3-1230v3<br />asus p9d ws<br />sapphire radeon 9200 SE Lite (PCI - host)<br />sapphire radeon R9 280 (PCIe - guest)<br />silverstone card Marvell 88SE9130 (PCIe)</p><br /><p>I am using the PCI graphics card to be able to set that one as primary in the bios (there is no possibility to manually select the primary when two pcie cards are installed)<br />The Marvell sata card is primarily used because of its hyperduo (combining ssd + hdd) feature.</p><p>One sad thing is, that I can not boot from the Marvell card, if i use passthrough on it. The cards bios shows up but does not detect a single drive... The only working card i found was a LSI card with a sas2008 chip but the ssd caching feature of the marvell was more convenient through... so now I am using virtio-scsi as I gave up on the idea to be able to boot from the passed through marvell controller.</p><p>I am using a mainline 3.13 kernel with acs-override patch, because I was unable to build ZFS with &gt;= 3.14 </p><p>One &quot;problem&quot; i have left:</p><p>I am using an old dma-alias patch, that i found on the &quot;Bug 42679 - DMA Read on Marvell 88SE9128 fails&quot; kernel bugzilla post.</p><p>Is there any chance to get a patchfile for the new dma-alias-v4 without using aw&#039;s whole kernel?</p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1420342">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1420358" class="blockpost rowodd"> <h2><span><span class="conr">#1882</span> <a href="viewtopic.php?pid=1420358#p1420358">2014-05-29 14:16:12</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=78080">Slabity</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2013-12-29</span></dd> <dd><span>Posts: 40</span></dd> <dd class="usercontacts"><span class="email"><a href="mailto:tslabinski@mygsc.com">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <p>Okay, I can&#039;t seem to get this to work anymore. I can pass the card to the guest, and I get video output from it, but Windows keeps reporting error code 43 in the device manager whenever I install the device drivers.</p><p>My setup consists of an AMD 6780 host card (open source drivers) and an Nvidia 780 guest card. I&#039;ve also installed linux-mainline with all the patches on the front page.</p><p>My kernel options are as such:</p><div class="codebox"><pre><code>root=/dev/sda2 rw initrd=/initramfs-linux-mainline.img pci-stub.ids=10de:1004,10de:0e1a intel_iommu=on pcie_acs_override=downstream</code></pre></div><p>My qemu command:</p><div class="codebox"><pre><code>qemu-system-x86_64 \ -enable-kvm -M q35 -m 8192 -cpu host \ -smp 6,sockets=1,cores=4,threads=1 \ -bios /usr/share/qemu/bios.bin -vga none \ -device ioh3420,bus=pcie.0,addr=1c.0,multifunction=on,port=1,chassis=1,id=root.1 \ -device vfio-pci,host=02:00.0,bus=root.1,addr=00.0,multifunction=on,x-vga=on \ -device vfio-pci,host=02:00.1,bus=root.1,addr=00.1 \ -device virtio-scsi-pci,id=scsi \ -drive file=/dev/sdb,id=disk,format=raw -device ide-hd,bus=ide.0,drive=disk</code></pre></div><p>Before I run the VM, I run:</p><div class="codebox"><pre><code>sudo vfio-bind 0000:02:00.0 0000:02:00.1 sudo vga-clear 00:01.0 sudo vga-set 00:01.1</code></pre></div><p>I feel like I&#039;m missing one simple thing, but I&#039;ve scanned the thread and can&#039;t figure out what that is.</p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1420358">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1420359" class="blockpost roweven"> <h2><span><span class="conr">#1883</span> <a href="viewtopic.php?pid=1420359#p1420359">2014-05-29 14:18:16</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=75590">aw</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2013-10-04</span></dd> <dd><span>Posts: 921</span></dd> <dd class="usercontacts"><span class="email"><a href="misc.php?email=75590">Email</a></span> <span class="website"><a href="http://vfio.blogspot.com/" rel="nofollow">Website</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>Slabity wrote:</cite><blockquote><div><p>Okay, I can&#039;t seem to get this to work anymore. I can pass the card to the guest, and I get video output from it, but Windows keeps reporting error code 43 in the device manager whenever I install the device drivers.</p><p>My setup consists of an AMD 6780 host card (open source drivers) and an Nvidia 780 guest card. I&#039;ve also installed linux-mainline with all the patches on the front page.</p><p>My kernel options are as such:</p><div class="codebox"><pre><code>root=/dev/sda2 rw initrd=/initramfs-linux-mainline.img pci-stub.ids=10de:1004,10de:0e1a intel_iommu=on pcie_acs_override=downstream</code></pre></div><p>My qemu command:</p><div class="codebox"><pre><code>qemu-system-x86_64 \ -enable-kvm -M q35 -m 8192 -cpu host \ -smp 6,sockets=1,cores=4,threads=1 \ -bios /usr/share/qemu/bios.bin -vga none \ -device ioh3420,bus=pcie.0,addr=1c.0,multifunction=on,port=1,chassis=1,id=root.1 \ -device vfio-pci,host=02:00.0,bus=root.1,addr=00.0,multifunction=on,x-vga=on \ -device vfio-pci,host=02:00.1,bus=root.1,addr=00.1 \ -device virtio-scsi-pci,id=scsi \ -drive file=/dev/sdb,id=disk,format=raw -device ide-hd,bus=ide.0,drive=disk</code></pre></div><p>Before I run the VM, I run:</p><div class="codebox"><pre><code>sudo vfio-bind 0000:02:00.0 0000:02:00.1 sudo vga-clear 00:01.0 sudo vga-set 00:01.1</code></pre></div><p>I feel like I&#039;m missing one simple thing, but I&#039;ve scanned the thread and can&#039;t figure out what that is.</p></div></blockquote></div><p>Did you upgrade the guest to the 337.88 Nvidia driver?&#160; We&#039;re all having trouble with the new driver.</p> </div> <div class="postsignature postmsg"><hr /><p><a href="http://vfio.blogspot.com" rel="nofollow">http://vfio.blogspot.com</a><br />Looking for a more open forum to discuss vfio related uses?&#160; Try <a href="https://www.redhat.com/mailman/listinfo/vfio-users" rel="nofollow">https://www.redhat.com/mailman/listinfo/vfio-users</a></p></div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1420359">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1420365" class="blockpost rowodd"> <h2><span><span class="conr">#1884</span> <a href="viewtopic.php?pid=1420365#p1420365">2014-05-29 14:38:41</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=75590">aw</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2013-10-04</span></dd> <dd><span>Posts: 921</span></dd> <dd class="usercontacts"><span class="email"><a href="misc.php?email=75590">Email</a></span> <span class="website"><a href="http://vfio.blogspot.com/" rel="nofollow">Website</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>Slabity wrote:</cite><blockquote><div><p>Before I run the VM, I run:</p><div class="codebox"><pre><code>sudo vfio-bind 0000:02:00.0 0000:02:00.1 sudo vga-clear 00:01.0 sudo vga-set 00:01.1</code></pre></div></div></blockquote></div><p>There&#039;s a kernel patch for this, use it.</p> </div> <div class="postsignature postmsg"><hr /><p><a href="http://vfio.blogspot.com" rel="nofollow">http://vfio.blogspot.com</a><br />Looking for a more open forum to discuss vfio related uses?&#160; Try <a href="https://www.redhat.com/mailman/listinfo/vfio-users" rel="nofollow">https://www.redhat.com/mailman/listinfo/vfio-users</a></p></div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1420365">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1420376" class="blockpost roweven"> <h2><span><span class="conr">#1885</span> <a href="viewtopic.php?pid=1420376#p1420376">2014-05-29 15:04:47</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=78080">Slabity</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2013-12-29</span></dd> <dd><span>Posts: 40</span></dd> <dd class="usercontacts"><span class="email"><a href="mailto:tslabinski@mygsc.com">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>aw wrote:</cite><blockquote><div><p>Did you upgrade the guest to the 337.88 Nvidia driver?&#160; We&#039;re all having trouble with the new driver.</p></div></blockquote></div><p>Damnit, that explains it. Downgrading to the previous driver fixes it...</p><div class="quotebox"><cite>aw wrote:</cite><blockquote><div><p>There&#039;s a kernel patch for this, use it.</p></div></blockquote></div><p>Hey thanks!</p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1420376">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1420452" class="blockpost rowodd"> <h2><span><span class="conr">#1886</span> <a href="viewtopic.php?pid=1420452#p1420452">2014-05-29 20:27:15</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=80701">apex8</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2014-03-29</span></dd> <dd><span>Posts: 47</span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <p>Hey together,</p><p>I achieved to run my qemu script without root priviledges. I needed to set priviledges to three devices, I pass through to my VM. My Script looks as follows:</p><div class="codebox"><pre><code>#!/bin/bash #QEMU settings for user access chown :kvm /dev/vfio/13 chmod g+rw /dev/vfio/13 chown :kvm /dev/vfio/14 chmod g+rw /dev/vfio/14 chown :kvm /dev/vfio/17 chmod g+rw /dev/vfio/17</code></pre></div><p>To automatically run this script, I made a systemd service file:</p><div class="codebox"><pre><code>[Unit] Description=grants members of group kvm access to passthroughed devices After=syslog.target [Service] #EnvironmentFile=-/etc/vfio-pci.cfg Type=oneshot RemainAfterExit=yes ExecStart=-/usr/bin/vfiouseraccess [Install] WantedBy=multi-user.target</code></pre></div><p>My problems is, that this doesn&#039;t work:</p><div class="codebox"><pre><code>systemctl status vfiouseraccess.service ⏎ ● vfiouseraccess.service - grants members of group kvm access to passthroughed devices Loaded: loaded (/usr/lib/systemd/system/vfiouseraccess.service; enabled) Active: active (exited) since Do 2014-05-29 22:15:35 CEST; 8min ago Process: 337 ExecStart=/usr/bin/vfiouseraccess (code=exited, status=1/FAILURE) Main PID: 337 (code=exited, status=1/FAILURE) CGroup: /system.slice/vfiouseraccess.service chown: cannot access ‘/dev/vfio/13’: No such file or directory chmod: cannot access ‘/dev/vfio/13’: No such file or directory chown: cannot access ‘/dev/vfio/14’: No such file or directory chmod: cannot access ‘/dev/vfio/14’: No such file or directory chown: cannot access ‘/dev/vfio/17’: No such file or directory chmod: cannot access ‘/dev/vfio/17’: No such file or directory</code></pre></div><p>It seems, that a the point where my script is called, the devices aren&#039;t present. Can someone tell my, how I could fix this?</p><p>Thanks in advance <br />apex8</p><p>EDIT: I forgot to mention: Once the system has started and I logged in, I can easily run my script manually and its setting the priviledges as intended.</p> <p class="postedit"><em>Last edited by apex8 (2014-05-29 20:28:21)</em></p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1420452">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1420479" class="blockpost roweven"> <h2><span><span class="conr">#1887</span> <a href="viewtopic.php?pid=1420479#p1420479">2014-05-29 22:01:31</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=75590">aw</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2013-10-04</span></dd> <dd><span>Posts: 921</span></dd> <dd class="usercontacts"><span class="email"><a href="misc.php?email=75590">Email</a></span> <span class="website"><a href="http://vfio.blogspot.com/" rel="nofollow">Website</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>aw wrote:</cite><blockquote><div><div class="quotebox"><cite>Flyser wrote:</cite><blockquote><div><div class="quotebox"><cite>dwe11er wrote:</cite><blockquote><div><p>Is it only me or new NVIDIA 337.88 driver still has issues with virtualized Windows? I&#039;m getting code 43, 335.23 doesn&#039;t have this issue.</p></div></blockquote></div><p>It&#039;s not only you. Same here for my gtx660</p><p>EDIT: Downgrading worked</p></div></blockquote></div><p>Same here *sigh* time to start comparing traces :-\</p></div></blockquote></div><p>The driver doesn&#039;t even seem to be trying to work, I&#039;ve reported it to the GeForce Forums, not sure what more to do about it other than hope it gets fixed&#160; <a href="https://forums.geforce.com/default/topic/746026/geforce-drivers/official-nvidia-337-88-whql-performance-display-driver-feedback-thread-5-26-14-/post/4229739/#4229739" rel="nofollow">https://forums.geforce.com/default/topi … 9/#4229739</a></p> </div> <div class="postsignature postmsg"><hr /><p><a href="http://vfio.blogspot.com" rel="nofollow">http://vfio.blogspot.com</a><br />Looking for a more open forum to discuss vfio related uses?&#160; Try <a href="https://www.redhat.com/mailman/listinfo/vfio-users" rel="nofollow">https://www.redhat.com/mailman/listinfo/vfio-users</a></p></div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1420479">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1420511" class="blockpost rowodd"> <h2><span><span class="conr">#1888</span> <a href="viewtopic.php?pid=1420511#p1420511">2014-05-30 00:44:25</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=82357">gutleib</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2014-05-29</span></dd> <dd><span>Posts: 5</span></dd> <dd class="usercontacts"><span class="email"><a href="misc.php?email=82357">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>aw wrote:</cite><blockquote><div><p>You need the VGA arbiter patch from a page or two back</p></div></blockquote></div><p>Could you explain? I don&#039;t have any intel graphics in my pc at all...</p><p>Also: I tried passthrugh&#039;ing only &quot;vga controller&quot; half of gtx590, and also tried different pcie addresses. Results are:<br />apparently, if I use the line <br />&quot;sudo qemu-system-x86_64 -enable-kvm -M q35 -m 1024 -cpu host -smp 6,sockets=1,cores=6,threads=1 <br />-bios /usr/share/qemu/bios.bin <br />-device ioh3420,bus=pcie.0,addr=1c.0,multifunction=on,port=1,chassis=1,id=root.1 <br />-device vfio-pci,host=05:00.0,bus=root.1,addr=00.0,multifunction=on,romfile=/root/Gigabyte.GTX590.1536.110223.rom&#160; <br />-device vfio-pci,host=05:00.1,bus=root.1,addr=00.1 <br />-device vfio-pci,host=06:00.0,bus=root.1,addr=01.0,multifunction=on,romfile=/root/Gigabyte.GTX590.1536.110223.rom,x-vga=on <br />-device vfio-pci,host=06:00.1,bus=root.1,addr=01.1 <br />-vga cirrus&quot;, <br />the bios boot process doesn&#039;t complete. It goes first &quot;seabios...&quot; line in vnc, then the second, &quot;ipxe...&quot; then (in second line) &quot;PnP PNN...&quot; and lots of numbers. then it just sits there.<br />If I use only one pci device (the vga half, not the 3d controller), <br />&quot;sudo qemu-system-x86_64 -enable-kvm -M q35 -m 1024 -cpu host -smp 6,sockets=1,cores=6,threads=1 <br />-bios /usr/share/qemu/bios.bin <br />-device ioh3420,bus=pcie.0,addr=1c.0,multifunction=on,port=1,chassis=1,id=root.1 <br />-device vfio-pci,host=06:00.0,bus=root.1,addr=00.0,multifunction=on,romfile=/root/Gigabyte.GTX590.1536.110223.rom,x-vga=on <br />-device vfio-pci,host=06:00.1,bus=root.1,addr=00.1 &quot;,<br />it goes through full seabios routine, yet on vnc (note no -vga cirrus, but...).</p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1420511">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1420534" class="blockpost roweven"> <h2><span><span class="conr">#1889</span> <a href="viewtopic.php?pid=1420534#p1420534">2014-05-30 05:14:30</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=82238">sinny</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2014-05-24</span></dd> <dd><span>Posts: 75</span></dd> <dd class="usercontacts"><span class="email"><a href="misc.php?email=82238">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>gutleib wrote:</cite><blockquote><div><div class="quotebox"><cite>aw wrote:</cite><blockquote><div><p>You need the VGA arbiter patch from a page or two back</p></div></blockquote></div><p>Could you explain? I don&#039;t have any intel graphics in my pc at all...</p><p>Also: I tried passthrugh&#039;ing only &quot;vga controller&quot; half of gtx590, and also tried different pcie addresses. Results are:<br />apparently, if I use the line <br />&quot;sudo qemu-system-x86_64 -enable-kvm -M q35 -m 1024 -cpu host -smp 6,sockets=1,cores=6,threads=1 <br />-bios /usr/share/qemu/bios.bin <br />-device ioh3420,bus=pcie.0,addr=1c.0,multifunction=on,port=1,chassis=1,id=root.1 <br />-device vfio-pci,host=05:00.0,bus=root.1,addr=00.0,multifunction=on,romfile=/root/Gigabyte.GTX590.1536.110223.rom&#160; <br />-device vfio-pci,host=05:00.1,bus=root.1,addr=00.1 <br />-device vfio-pci,host=06:00.0,bus=root.1,addr=01.0,multifunction=on,romfile=/root/Gigabyte.GTX590.1536.110223.rom,x-vga=on <br />-device vfio-pci,host=06:00.1,bus=root.1,addr=01.1 <br />-vga cirrus&quot;, <br />the bios boot process doesn&#039;t complete. It goes first &quot;seabios...&quot; line in vnc, then the second, &quot;ipxe...&quot; then (in second line) &quot;PnP PNN...&quot; and lots of numbers. then it just sits there.<br />If I use only one pci device (the vga half, not the 3d controller), <br />&quot;sudo qemu-system-x86_64 -enable-kvm -M q35 -m 1024 -cpu host -smp 6,sockets=1,cores=6,threads=1 <br />-bios /usr/share/qemu/bios.bin <br />-device ioh3420,bus=pcie.0,addr=1c.0,multifunction=on,port=1,chassis=1,id=root.1 <br />-device vfio-pci,host=06:00.0,bus=root.1,addr=00.0,multifunction=on,romfile=/root/Gigabyte.GTX590.1536.110223.rom,x-vga=on <br />-device vfio-pci,host=06:00.1,bus=root.1,addr=00.1 &quot;,<br />it goes through full seabios routine, yet on vnc (note no -vga cirrus, but...).</p></div></blockquote></div><p>did you mean to use &quot;-vga none&quot;?</p><div class="quotebox"><blockquote><div><p>[s@localhost ~]$ man qemu-system-x86_64 | grep &quot;cirrus&quot; -4</p><p>&#160; &#160; &#160; &#160;-vga type<br />&#160; &#160; &#160; &#160; &#160; &#160;Select type of VGA card to emulate. Valid values for type are</p><p>&#160; &#160; &#160; &#160; &#160; &#160;cirrus<br />&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;Cirrus Logic GD5446 Video card. All Windows versions starting from Windows 95 should recognize and use this graphic card. For optimal performances, use 16 bit color depth in the guest and the host OS.&#160; <strong>(This one is the default)</strong></p><p>&#160; &#160; &#160; &#160; &#160; &#160;std Standard VGA card with Bochs VBE extensions.&#160; If your guest OS supports the VESA 2.0 VBE extensions (e.g. Windows XP) and if you want to use high resolution modes (&gt;= 1280x1024x16) then you should use this option.</p><p>[s@localhost ~]$</p></div></blockquote></div> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1420534">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1420610" class="blockpost rowodd"> <h2><span><span class="conr">#1890</span> <a href="viewtopic.php?pid=1420610#p1420610">2014-05-30 10:26:35</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=82357">gutleib</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2014-05-29</span></dd> <dd><span>Posts: 5</span></dd> <dd class="usercontacts"><span class="email"><a href="misc.php?email=82357">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <p>&gt; sinny</p><p>Dang! forgot it&#039;s default!</p><p>With vga none, vnc and display are off.</p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1420610">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1420635" class="blockpost roweven"> <h2><span><span class="conr">#1891</span> <a href="viewtopic.php?pid=1420635#p1420635">2014-05-30 12:16:26</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=68201">rabcor</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2013-02-09</span></dd> <dd><span>Posts: 457</span></dd> <dd class="usercontacts"><span class="email"><a href="misc.php?email=68201">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <p>I&#039;m having a problem applying the <a href="https://lkml.org/lkml/2013/5/30/513" rel="nofollow">ACS Override patch</a> in Gentoo, can anyone help me figure out what&#039;s up?</p><p>I copied it from the page starting at:</p><div class="quotebox"><blockquote><div><p>---- <br />Documentation/kernel-parameters.txt |&#160; &#160;10 +++<br />...</p></div></blockquote></div><p>This is the output I get from portage when I emerge the gentoo-sources (that&#039;s gentoo&#039;s default kernel):</p><div class="codebox"><pre class="vscroll"><code>***** ACS_Override.patch 1.sh topic_10.html topic_11.html topic_12.html topic_13.html topic_14.html topic_15.html topic_16.html topic_17.html topic_18.html topic_19.html topic_1.html topic_20.html topic_21.html topic_22.html topic_23.html topic_24.html topic_25.html topic_26.html topic_27.html topic_28.html topic_29.html topic_2.html topic_30.html topic_31.html topic_32.html topic_33.html topic_34.html topic_35.html topic_36.html topic_37.html topic_38.html topic_39.html topic_3.html topic_40.html topic_41.html topic_42.html topic_43.html topic_44.html topic_45.html topic_46.html topic_47.html topic_48.html topic_49.html topic_4.html topic_50.html topic_51.html topic_52.html topic_53.html topic_54.html topic_55.html topic_56.html topic_57.html topic_58.html topic_59.html topic_5.html topic_60.html topic_61.html topic_62.html topic_63.html topic_64.html topic_65.html topic_66.html topic_67.html topic_68.html topic_69.html topic_6.html topic_70.html topic_71.html topic_72.html topic_73.html topic_74.html topic_75.html topic_7.html topic_8.html topic_9.html PWD: /var/tmp/portage/sys-kernel/gentoo-sources-3.14.4/work/linux-3.14.4-gentoo ============================== PATCH COMMAND: patch -p0 -g0 -E --no-backup-if-mismatch &lt; &#039;/etc/portage/patches/sys-kernel/gentoo-sources/ACS_Override.patch&#039; ============================== can&#039;t find file to patch at input line 9 Perhaps you used the wrong -p or --strip option? The text leading up to this was: -------------------------- |--- | Documentation/kernel-parameters.txt | 10 +++ | drivers/pci/quirks.c | 102 +++++++++++++++++++++++++++++++++++ | 2 files changed, 112 insertions(+) |diff --git a/Documentation/kernel-parameters.txt b/Documentation/kernel-parameters.txt |index 47bb23c..a60e6ad 100644 |--- a/Documentation/kernel-parameters.txt |+++ b/Documentation/kernel-parameters.txt -------------------------- No file to patch. Skipping patch. 1 out of 1 hunk ignored can&#039;t find file to patch at input line 30 Perhaps you used the wrong -p or --strip option? The text leading up to this was: -------------------------- |diff --git a/drivers/pci/quirks.c b/drivers/pci/quirks.c |index 0369fb6..c7609f6 100644 |--- a/drivers/pci/quirks.c |+++ b/drivers/pci/quirks.c -------------------------- No file to patch. Skipping patch. patch unexpectedly ends in middle of line 1 out of 1 hunk ignored patch program exited with status 1</code></pre></div><p>I have no idea what to do here, I&#039;m a total noob when it comes to &quot;patch&quot; and &quot;diff&quot;. I know it fails at line 9 and 30 (i.e. the &quot;@@&quot; lines in the patch) but how to fix it I have no clue. The Nvidia Proprietary driver patch applied just fine though.</p><p>The lines it&#039;s failing at are these:</p><div class="codebox"><pre><code>9: @@ -2349,6 +2349,16 @@ bytes respectively. Such letter suffixes can also be entirely omitted. 30: @@ -3292,11 +3292,113 @@ struct pci_dev *pci_get_dma_source(struct pci_dev *dev)</code></pre></div> </div> <div class="postsignature postmsg"><hr /><p><a href="https://bbs.archlinux.org/viewtopic.php?pid=1421825" rel="nofollow">Making Logitech G510 Work on Linux!</a></p></div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1420635">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1420653" class="blockpost rowodd"> <h2><span><span class="conr">#1892</span> <a href="viewtopic.php?pid=1420653#p1420653">2014-05-30 14:24:29</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=79237">mbroemme</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>From: Cologne</span></dd> <dd><span>Registered: 2014-02-05</span></dd> <dd><span>Posts: 39</span></dd> <dd class="usercontacts"><span class="email"><a href="misc.php?email=79237">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>rabcor wrote:</cite><blockquote><div><div class="codebox"><pre><code>PATCH COMMAND: patch -p0 -g0 -E --no-backup-if-mismatch &lt; &#039;/etc/portage/patches/sys-kernel/gentoo-sources/ACS_Override.patch&#039;</code></pre></div><p>I have no idea what to do here, I&#039;m a total noob when it comes to &quot;patch&quot; and &quot;diff&quot;. I know it fails at line 9 and 30 (i.e. the &quot;@@&quot; lines in the patch) but how to fix it I have no clue. The Nvidia Proprietary driver patch applied just fine though.</p></div></blockquote></div><p>Try it with -p1</p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1420653">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1420666" class="blockpost roweven"> <h2><span><span class="conr">#1893</span> <a href="viewtopic.php?pid=1420666#p1420666">2014-05-30 15:17:42</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=71440">cdrjameson</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd class="postavatar"><img src="https://bbs.archlinux.org/img/avatars/71440.png?m=1392914202" width="80" height="73" alt="" /></dd> <dd><span>Registered: 2013-05-19</span></dd> <dd><span>Posts: 33</span></dd> <dd class="usercontacts"><span class="email"><a href="misc.php?email=71440">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>sinny wrote:</cite><blockquote><div><p>i can confirm the following setupd working:<br />MB: asrock z87 pro4<br />CPU: intel i7 4770<br />OS: fedora 20 x86_64 (with additional repositories: ...)<br />kernel: kernel-3.15.0-0.rc5.git2.8.vanilla.mainline.knurd.1.fc20.x86_64.rpm <br />host GPU: integrated (intel i7 4770)<br />guest GPU0: radeon hd 6450 (Gigabyte GV-R645-1GI)</p></div></blockquote></div><p>Well that is good to know, thanks for the info. Apart from the OS the only thing massively different is my knowledge!</p><p>I am attempting to follow #1 and have a few (very basic) questions, suffice to say it is not working yet.</p><p><strong>Question 1</strong> All I did to get the linux-mainline was: </p><div class="codebox"><pre><code>yaourt linux-mainline</code></pre></div><p>followed by </p><div class="codebox"><pre><code>mkinitcpio -p linux-mainline</code></pre></div><p> should I have done anything else?</p><p><strong>Question 2</strong> I copied the vfio-bind script and used it to bind my gpu which was </p><div class="codebox"><pre><code>vfio-bind 0000:01:00.0 0000:01:00.1</code></pre></div><p> but after I start the systemd service I cannot see any output from the next command: </p><div class="codebox"><pre><code>[cdrjameson@experiment ~]$ cat /etc/vfio-pci.cfg cat: /etc/vfio-pci.cfg: No such file or directory</code></pre></div><p>I called my systemd service file vfiobind.service and there didn&#039;t look to be anything in the file that was specific or needed changing per user. Did I miss something?</p><p><strong>Question 3</strong> The next step: to test if working fails. I changed the qemu test invocation nbhs uses for my processor (4 cores instead of 6), gave more memory and changed the address of the vfio-pci. </p><div class="codebox"><pre><code>qemu-system-x86_64 -enable-kvm -M q35 -m 4096 -cpu host -smp 4,sockets=1,cores=4,threads=1 -bios /usr/share/qemu/bios.bin -vga none -device ioh3420,bus=pcie.0,addr=1c.0,multifunction=on,port=1,chassis=1,id=root.1 -device vfio-pci,host=01:00.0,bus=root.1,addr=00.0,multifunction=on,x-vga=on -device vfio-pci,host=01:00.1,bus=root.1,addr=00.1</code></pre></div><p>Are these sane defaults...?<br />The errors read: </p><div class="codebox"><pre><code>qemu-system-x86_64: -device vfio-pci,host=01:00.0,bus=root.1,addr=00.0,multifunction=on,x-vga=on: vfio: error no iommu_group for device qemu-system-x86_64: -device vfio-pci,host=01:00.0,bus=root.1,addr=00.0,multifunction=on,x-vga=on: Device initialization failed. qemu-system-x86_64: -device vfio-pci,host=01:00.0,bus=root.1,addr=00.0,multifunction=on,x-vga=on: Device &#039;vfio-pci&#039; could not be initialized</code></pre></div><p>After I create the blank windows.img file I am able to start qemu by a very simple </p><div class="codebox"><pre><code> qemu-system-x86_64 windows.img</code></pre></div><p> which then opens the VM, proving qemu is working...<br />I dont want to/cant go any further without fixing these fundamental issues.</p> <p class="postedit"><em>Last edited by cdrjameson (2014-05-30 15:24:09)</em></p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1420666">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1420669" class="blockpost rowodd"> <h2><span><span class="conr">#1894</span> <a href="viewtopic.php?pid=1420669#p1420669">2014-05-30 15:23:30</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=80701">apex8</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2014-03-29</span></dd> <dd><span>Posts: 47</span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <p>Hey,<br />in #1 there are mentioned two links for linux-mainline. Use &quot;linux-mainline.tar.gz (3.14.1 includes acs override patch, i935 vga arbiter fixes, debug registers patch)&quot; right unter &quot;Ingredients&quot;.<br />You need to build this kernel for yourself, but there are all required patches already included. If you have all required packages for building an arch package yourself installed, you just need to unzip this file, cd into the new directory and run &quot;makepkg&quot;.</p><p>If you don&#039;t have the necessary packages installed, read <a href="https://wiki.archlinux.org/index.php/Arch_User_Repository#Installing_packages" rel="nofollow">this</a></p><p>Once the kernel is build you will find a package file in your build directory. You can install the kernel via</p><div class="codebox"><pre><code>yaourt -U &lt;package filename&gt; </code></pre></div> <p class="postedit"><em>Last edited by apex8 (2014-05-30 15:25:58)</em></p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1420669">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1420670" class="blockpost roweven"> <h2><span><span class="conr">#1895</span> <a href="viewtopic.php?pid=1420670#p1420670">2014-05-30 15:31:09</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=71440">cdrjameson</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd class="postavatar"><img src="https://bbs.archlinux.org/img/avatars/71440.png?m=1392914202" width="80" height="73" alt="" /></dd> <dd><span>Registered: 2013-05-19</span></dd> <dd><span>Posts: 33</span></dd> <dd class="usercontacts"><span class="email"><a href="misc.php?email=71440">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>apex8 wrote:</cite><blockquote><div><p>Hey,<br />in #1 there are mentioned two links for linux-mainline. Use &quot;linux-mainline.tar.gz</p></div></blockquote></div><p>That link is broken for me, I get to the download page but cant download it... so I used the second link which is the AUR package. Is there another location for the first link?</p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1420670">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1420672" class="blockpost rowodd"> <h2><span><span class="conr">#1896</span> <a href="viewtopic.php?pid=1420672#p1420672">2014-05-30 15:33:27</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=80701">apex8</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2014-03-29</span></dd> <dd><span>Posts: 47</span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <p>I tested it. The links isn&#039;t broken. Click on it and then on slow download.</p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1420672">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1420674" class="blockpost roweven"> <h2><span><span class="conr">#1897</span> <a href="viewtopic.php?pid=1420674#p1420674">2014-05-30 15:38:11</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=71440">cdrjameson</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd class="postavatar"><img src="https://bbs.archlinux.org/img/avatars/71440.png?m=1392914202" width="80" height="73" alt="" /></dd> <dd><span>Registered: 2013-05-19</span></dd> <dd><span>Posts: 33</span></dd> <dd class="usercontacts"><span class="email"><a href="misc.php?email=71440">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <p>I&#039;ve tried on two computers and after selecting slow download I just get &#039;invalid download link&#039;. Using firefox and chromium. Did the link actually take you to the download page?</p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1420674">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1420677" class="blockpost rowodd"> <h2><span><span class="conr">#1898</span> <a href="viewtopic.php?pid=1420677#p1420677">2014-05-30 15:41:37</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=80701">apex8</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2014-03-29</span></dd> <dd><span>Posts: 47</span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <p>Yes, it takes you to a download page. Could you try <a href="http://dl18.fileswap.com/download/?id=ZB0cw5%2FpCEreo6DzP8Zb8o8c7xuSO9L6gR2gItom6Be4ZpFsQrA%2BnPp%2FTZ6Bx%2BeMjs7m3XbiZJBZ54oTq40x2IhGTa9d5qE7JYndH6UjkFVWVDCT9igRY2lPO1bl2mkol9QZ8I6EO4PQHkiR41nlHT87UuEBmMM%2FOXu1U7unTe8%3D&amp;h=907a274e9ce95e2be0134a02f3500a47&amp;t=5388ad89" rel="nofollow">this</a> link?</p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1420677">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1420678" class="blockpost roweven"> <h2><span><span class="conr">#1899</span> <a href="viewtopic.php?pid=1420678#p1420678">2014-05-30 15:47:09</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=82246">shawly</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2014-05-24</span></dd> <dd><span>Posts: 22</span></dd> <dd class="usercontacts"><span class="email"><a href="misc.php?email=82246">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <p>Hey Guys,</p><p>I finally managed to get my VM started and installed Windows 8.1, Passthrough works since I get the output from my GTX 770 and the device-manager also says that it uses a NVIDIA GTX 770.<br />But I got two problems, first, I can&#039;t install the Nvidia drivers, because it says the Windows version is incompatible and no compatible graphics hardware was found.. The driver IS for Win8.1 x64 which IS installed and like I said, the device-manager in Windows says, that there is a GTX 770 and it has NO yellow exclamation mark or something else, so I guess it&#039;s working but yeah, I have no idea how to fix this problem..</p><p>Second problem, I can&#039;t get the EFI-BIOS to work (OVMF).. I installed the version from the repository with pacman but I only get a black screen and nothing happens when I start the VM, then I tried to compile the AUR version of ovmf-svn but it doesn&#039;t want to compile so I gave up.. Tbh I don&#039;t really need EFI, but I want it so the Windows Bootlogo is in the full resolution, which is way sexier and I can use the UEFI features like secure boot. I tried all parameters like -boot -pflash and -L, it finds and uses the OVMF-Bios, but as I said, when I start the VM I only get a black screen and it doesn&#039;t boot anything.</p><p>I hope someone atleast can give me an answer to the problem with the nvidia gpu drivers.. everything works fine, except I can&#039;t install them.</p><br /><p>And I got another little offtopic question, is there anything BESIDES Synergy to seamlessly integrate the VM with my desktop? <br />I don&#039;t want to pass my keyboard to my VM directly, because when there are problems and the VM is stuck for example, I&#039;m pretty screwed. <img src="https://bbs.archlinux.org/img/smilies/big_smile.png" width="15" height="15" alt="big_smile" /></p> <p class="postedit"><em>Last edited by shawly (2014-05-30 15:49:59)</em></p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1420678">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1420680" class="blockpost rowodd"> <h2><span><span class="conr">#1900</span> <a href="viewtopic.php?pid=1420680#p1420680">2014-05-30 15:53:43</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=80701">apex8</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2014-03-29</span></dd> <dd><span>Posts: 47</span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <p>@shawly regarding synergy: It should be the normal case, that your VM works flawlessly. Whenever there is a serious problem, e.g. an bsod, you can go to the qemu console and enter system_reset; the vm will reboot. If this doesn&#039;t solve the problem you could prepare a second qemu script, which runs the vm in a window where you are able to use your keyboad and mouse.<br />This strategy works good enough for me, because like I said: the normal case is that the VM runs without any problems.</p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1420680">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div class="postlinksb"> <div class="inbox crumbsplus"> <div class="pagepost"> <p class="pagelink conl"><span class="pages-label">Pages: </span><a rel="prev" class="item1" href="viewtopic.php?id=162768&amp;p=75">Previous</a> <a href="viewtopic.php?id=162768">1</a> <span class="spacer">…</span> <a href="viewtopic.php?id=162768&amp;p=74">74</a> <a href="viewtopic.php?id=162768&amp;p=75">75</a> <strong>76</strong> <a href="viewtopic.php?id=162768&amp;p=77">77</a> <a href="viewtopic.php?id=162768&amp;p=78">78</a> <span class="spacer">…</span> <a href="viewtopic.php?id=162768&amp;p=234">234</a> <a rel="next" href="viewtopic.php?id=162768&amp;p=77">Next</a></p> <p class="postlink conr">Topic closed</p> </div> <ul class="crumbs"> <li><a href="index.php">Index</a></li> <li><span>»&#160;</span><a href="viewforum.php?id=48">Topics Going Nowhere</a></li> <li><span>»&#160;</span><strong><a href="viewtopic.php?id=162768">KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</a></strong></li> </ul> <p class="subscribelink clearb"><a href="misc.php?action=subscribe&amp;tid=162768">Subscribe to this topic</a></p> <div class="clearer"></div> </div> </div> </div> <div id="brdfooter" class="block"> <h2><span>Board footer</span></h2> <div class="box"> <div id="brdfooternav" class="inbox"> <div class="conl"> <form id="qjump" method="get" action="viewforum.php"> <div><label><span>Jump to<br /></span> <select name="id" onchange="window.location=('viewforum.php?id='+this.options[this.selectedIndex].value)"> <optgroup label="Technical Issues and Assistance"> <option value="23">Newbie Corner</option> <option value="17">Installation</option> <option value="22">Kernel &amp; Hardware</option> <option value="18">Applications &amp; Desktop Environments</option> <option value="31">Laptop Issues</option> <option value="8">Networking, Server, and Protection</option> <option value="32">Multimedia and Games</option> <option value="50">System Administration</option> <option value="35">Other Architectures</option> </optgroup> <optgroup label="Arch-centric"> <option value="24">Announcements, Package &amp; Security Advisories</option> <option value="1">Arch Discussion</option> <option value="13">Forum &amp; Wiki discussion</option> </optgroup> <optgroup label="Pacman Upgrades, Packaging &amp; AUR"> <option value="44">Pacman &amp; Package Upgrade Issues</option> <option value="49">[testing] Repo Forum</option> <option value="4">Creating &amp; Modifying Packages</option> <option value="38">AUR Issues, Discussion &amp; PKGBUILD Requests</option> </optgroup> <optgroup label="Contributions &amp; Discussion"> <option value="20">GNU/Linux Discussion</option> <option value="27">Community Contributions</option> <option value="33">Programming &amp; Scripting</option> <option value="30">Other Languages</option> <option value="47">Artwork and Screenshots</option> <option value="42">Try This</option> </optgroup> <optgroup label="/dev/null"> <option value="29">Off-Topic</option> <option value="48" selected="selected">Topics Going Nowhere</option> <option value="36">Dustbin</option> </optgroup> </select></label> <input type="submit" value=" Go " accesskey="g" /> </div> </form> </div> <div class="conr"> <p id="feedlinks"><span class="atom"><a href="extern.php?action=feed&amp;tid=162768&amp;type=atom">Atom topic feed</a></span></p> <p id="poweredby">Powered by <a href="http://fluxbb.org/">FluxBB</a></p> </div> <div class="clearer"></div> </div> </div> </div> </div> <div class="end-box"></div> </div> </body> </html>
