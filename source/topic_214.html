<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"> <html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en" dir="ltr"> <head> <meta http-equiv="Content-Type" content="text/html; charset=utf-8" /> <title>KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9 (Page 214) / Topics Going Nowhere / Arch Linux Forums</title> <link rel="stylesheet" type="text/css" href="style/ArchLinux.css" /> <link rel="canonical" href="viewtopic.php?id=162768&amp;p=214" title="Page 214" /> <link rel="prev" href="viewtopic.php?id=162768&amp;p=213" title="Page 213" /> <link rel="next" href="viewtopic.php?id=162768&amp;p=215" title="Page 215" /> <link rel="alternate" type="application/atom+xml" href="extern.php?action=feed&amp;tid=162768&amp;type=atom" title="Atom topic feed" /> <link rel="stylesheet" media="screen" href="style/ArchLinux/arch.css?v=3" /> <link rel="stylesheet" media="screen" href="style/ArchLinux/archnavbar.css?v=2" /> <link rel="shortcut icon" href="style/ArchLinux/favicon.ico" /> </head> <body> <div id="archnavbar" class="anb-forum"> <div id="archnavbarlogo"><h1><a href="http://www.archlinux.org/">Arch Linux</a></h1></div> <div id="archnavbarmenu"> <ul id="archnavbarlist"> <li id="anb-home"><a href="http://www.archlinux.org/">Home</a></li><li id="anb-packages"><a href="http://www.archlinux.org/packages/">Packages</a></li><li id="anb-forums" class="anb-selected"><a href="https://bbs.archlinux.org/">Forums</a></li><li id="anb-wiki"><a href="https://wiki.archlinux.org/">Wiki</a></li><li id="anb-bugs"><a href="https://bugs.archlinux.org/">Bugs</a></li><li id="anb-aur"><a href="https://aur.archlinux.org/">AUR</a></li><li id="anb-download"><a href="http://www.archlinux.org/download/">Download</a></li> </ul> </div> </div> <div id="punviewtopic" class="pun"> <div class="top-box"></div> <div class="punwrap"> <div id="brdheader" class="block"> <div class="box"> <div id="brdmenu" class="inbox"> <ul> <li id="navindex" class="isactive"><a href="index.php">Index</a></li> <li id="navuserlist"><a href="userlist.php">User list</a></li> <li id="navsearch"><a href="search.php">Search</a></li> <li id="navprofile"><a href="profile.php?id=80749">Profile</a></li> <li id="navlogout"><a href="login.php?action=out&amp;id=80749&amp;csrf_token=5c20501ec397bb45ef8ee8c84db232c8d8e421c6">Logout</a></li> </ul> </div> <div id="brdwelcome" class="inbox"> <ul class="conl"> <li><span>Logged in as <strong>SXX</strong></span></li> <li><span>Last visit: 2015-08-16 12:20:09</span></li> </ul> <ul class="conr"> <li><span>Topics: <a href="search.php?action=show_replies" title="Find topics you have posted to.">Posted</a> | <a href="search.php?action=show_new" title="Find topics with new posts since your last visit.">New</a> | <a href="search.php?action=show_recent" title="Find topics with recent posts.">Active</a> | <a href="search.php?action=show_unanswered" title="Find topics with no replies.">Unanswered</a></span></li> </ul> <div class="clearer"></div> </div> </div> </div> <div id="brdmain"> <div class="linkst"> <div class="inbox crumbsplus"> <ul class="crumbs"> <li><a href="index.php">Index</a></li> <li><span>»&#160;</span><a href="viewforum.php?id=48">Topics Going Nowhere</a></li> <li><span>»&#160;</span><strong><a href="viewtopic.php?id=162768">KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</a></strong></li> </ul> <div class="pagepost"> <p class="pagelink conl"><span class="pages-label">Pages: </span><a rel="prev" class="item1" href="viewtopic.php?id=162768&amp;p=213">Previous</a> <a href="viewtopic.php?id=162768">1</a> <span class="spacer">…</span> <a href="viewtopic.php?id=162768&amp;p=212">212</a> <a href="viewtopic.php?id=162768&amp;p=213">213</a> <strong>214</strong> <a href="viewtopic.php?id=162768&amp;p=215">215</a> <a href="viewtopic.php?id=162768&amp;p=216">216</a> <span class="spacer">…</span> <a href="viewtopic.php?id=162768&amp;p=234">234</a> <a rel="next" href="viewtopic.php?id=162768&amp;p=215">Next</a></p> <p class="postlink conr">Topic closed</p> </div> <div class="clearer"></div> </div> </div> <div id="p1536350" class="blockpost rowodd blockpost1"> <h2><span><span class="conr">#5326</span> <a href="viewtopic.php?pid=1536350#p1536350">2015-06-12 02:59:05</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=91638">PrinzipDesSees</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2015-06-04</span></dd> <dd><span>Posts: 5</span></dd> <dd class="usercontacts"><span class="email"><a href="misc.php?email=91638">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <p>Another thing:</p><p>My host has no X installed.<br />Can I pass the output of a virtual machine to a second display?&#160; As in completely not passing through any GPU but just having a virtual GPU throw the image on monitor 2 without installing X.</p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1536350">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1536354" class="blockpost roweven"> <h2><span><span class="conr">#5327</span> <a href="viewtopic.php?pid=1536354#p1536354">2015-06-12 03:19:30</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=85314">Duelist</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2014-09-22</span></dd> <dd><span>Posts: 358</span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>PrinzipDesSees wrote:</cite><blockquote><div><p>Another thing:</p><p>My host has no X installed.<br />Can I pass the output of a virtual machine to a second display?&#160; As in completely not passing through any GPU but just having a virtual GPU throw the image on monitor 2 without installing X.</p></div></blockquote></div><p>You want to make QXL output on some hardware screen, right?</p><p>You could make the host headless(without X or any other video output) by passing through your main GPU inside some VM and having no other GPU left for host.</p> <p class="postedit"><em>Last edited by Duelist (2015-06-12 03:20:15)</em></p> </div> <div class="postsignature postmsg"><hr /><p><span class="bbs">The forum rules prohibit requesting support for distributions other than arch.</span><br /><a href="https://bbs.archlinux.org/viewtopic.php?pid=1551460#p1551460" rel="nofollow">I gave up.</a><a href="https://bbs.archlinux.org/viewtopic.php?id=162768" rel="nofollow"> It was too late.</a><br /><a href="http://pastebin.com/B3fL84bq" rel="nofollow">What I was trying to do</a>.<br /><a href="http://vfio.blogspot.com/" rel="nofollow">The reference about VFIO and KVM VGA passthrough.</a></p></div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1536354">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1536398" class="blockpost rowodd"> <h2><span><span class="conr">#5328</span> <a href="viewtopic.php?pid=1536398#p1536398">2015-06-12 09:25:03</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=48315">TripleSpeeder</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2011-05-02</span></dd> <dd><span>Posts: 43</span></dd> <dd class="usercontacts"><span class="email"><a href="misc.php?email=48315">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <p>Hi,</p><p>I installed ovmf-svn from aur and now have the following files:</p><div class="codebox"><pre><code>[michael@stingray ~]$ find /usr/share/ovmf/ /usr/share/ovmf/ /usr/share/ovmf/ia32 /usr/share/ovmf/ia32/ovmf_vars_ia32.bin /usr/share/ovmf/ia32/ovmf_code_ia32.bin /usr/share/ovmf/ia32/ovmf_ia32.bin /usr/share/ovmf/x64 /usr/share/ovmf/x64/ovmf_vars_x64.bin /usr/share/ovmf/x64/ovmf_code_x64.bin /usr/share/ovmf/x64/ovmf_x64.bin</code></pre></div><p>Trying to set up a new VM with virt-manager complains that libvirt did not detect any UEFI Bios, so i can&#039;t switch the firmware to UEFI. For which files is libvirt/virtmanager looking? Probably for some *.fd instead of .bin?</p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1536398">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1536401" class="blockpost roweven"> <h2><span><span class="conr">#5329</span> <a href="viewtopic.php?pid=1536401#p1536401">2015-06-12 09:55:05</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=91638">PrinzipDesSees</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2015-06-04</span></dd> <dd><span>Posts: 5</span></dd> <dd class="usercontacts"><span class="email"><a href="misc.php?email=91638">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>Duelist wrote:</cite><blockquote><div><p>You want to make QXL output on some hardware screen, right?</p><p>You could make the host headless(without X or any other video output) by passing through your main GPU inside some VM and having no other GPU left for host.</p></div></blockquote></div><br /><p>Yes.</p><p>That seems excessive, cant I make it use just the monitor?</p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1536401">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1536426" class="blockpost rowodd"> <h2><span><span class="conr">#5330</span> <a href="viewtopic.php?pid=1536426#p1536426">2015-06-12 11:44:57</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=75590">aw</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2013-10-04</span></dd> <dd><span>Posts: 921</span></dd> <dd class="usercontacts"><span class="email"><a href="misc.php?email=75590">Email</a></span> <span class="website"><a href="http://vfio.blogspot.com/" rel="nofollow">Website</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <p>[facepalm]</p><p>EDIT: QEMU does support SDL and SDL does not necessarily require X.&#160; But, if you&#039;re not doing VGA/GPU device assignment, it&#039;s not relevant to this thread.</p> <p class="postedit"><em>Last edited by aw (2015-06-12 14:09:59)</em></p> </div> <div class="postsignature postmsg"><hr /><p><a href="http://vfio.blogspot.com" rel="nofollow">http://vfio.blogspot.com</a><br />Looking for a more open forum to discuss vfio related uses?&#160; Try <a href="https://www.redhat.com/mailman/listinfo/vfio-users" rel="nofollow">https://www.redhat.com/mailman/listinfo/vfio-users</a></p></div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1536426">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1536718" class="blockpost roweven"> <h2><span><span class="conr">#5331</span> <a href="viewtopic.php?pid=1536718#p1536718">2015-06-13 17:47:43</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=91723">supertrampx</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2015-06-07</span></dd> <dd><span>Posts: 11</span></dd> <dd class="usercontacts"><span class="email"><a href="mailto:joe.cayouette@gmail.com">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <p>Vga passthrough working with gtx 970 on sr-2 classified and dual xeon 5680s. The only issue I have noticed is a freeze on first boot of a new&#160; game. I reboot qemu / wondows and the issue is gone and game loads. Any ideas? Also sound stutters slightly.</p><p>Thanks in advance.</p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1536718">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1536765" class="blockpost rowodd"> <h2><span><span class="conr">#5332</span> <a href="viewtopic.php?pid=1536765#p1536765">2015-06-13 20:06:46</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=85314">Duelist</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2014-09-22</span></dd> <dd><span>Posts: 358</span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>TripleSpeeder wrote:</cite><blockquote><div><p>Hi,</p><p>I installed ovmf-svn from aur and now have the following files:</p><div class="codebox"><pre><code>[michael@stingray ~]$ find /usr/share/ovmf/ /usr/share/ovmf/ /usr/share/ovmf/ia32 /usr/share/ovmf/ia32/ovmf_vars_ia32.bin /usr/share/ovmf/ia32/ovmf_code_ia32.bin /usr/share/ovmf/ia32/ovmf_ia32.bin /usr/share/ovmf/x64 /usr/share/ovmf/x64/ovmf_vars_x64.bin /usr/share/ovmf/x64/ovmf_code_x64.bin /usr/share/ovmf/x64/ovmf_x64.bin</code></pre></div><p>Trying to set up a new VM with virt-manager complains that libvirt did not detect any UEFI Bios, so i can&#039;t switch the firmware to UEFI. For which files is libvirt/virtmanager looking? Probably for some *.fd instead of .bin?</p></div></blockquote></div><p><a href="https://awilliam.github.io/presentations/KVM-Forum-2014/#/4/2" rel="nofollow">The old way</a></p><p>The right way:<br />/etc/libvirt/qemu.conf <br /># Location of master nvram file<br />#<br /># When a domain is configured to use UEFI instead of standard<br /># BIOS it may use a separate storage for UEFI variables. If<br /># that&#039;s the case libvirt creates the variable store per domain<br /># using this master file as image. Each UEFI firmware can,<br /># however, have different variables store. Therefore the nvram is<br /># a list of strings when a single item is in form of:<br />#&#160; &#160;${PATH_TO_UEFI_FW}:${PATH_TO_UEFI_VARS}.<br /># Later, when libvirt creates per domain variable store, this<br /># list is searched for the master image.<br />nvram = [ &quot;/usr/share/edk2.git/ovmf-x64/OVMF_CODE-pure-efi.fd:/usr/share/edk2.git/ovmf-x64/OVMF_VARS-pure-efi.fd&quot; ]</p><p><strong>BUT!</strong> As noted in <a href="http://vfio.blogspot.com/2015/05/vfio-gpu-how-to-series-part-4-our-first.html" rel="nofollow">aw&#039;s blog</a>: </p><div class="quotebox"><blockquote><div><p>If UEFI is not available, your libvirt and virt manager tools may be too old.</p></div></blockquote></div><p>So the above lines are needed only for old versions.</p><br /><div class="quotebox"><cite>supertrampx wrote:</cite><blockquote><div><p>Vga passthrough working with gtx 970 on sr-2 classified and dual xeon 5680s. The only issue I have noticed is a freeze on first boot of a new&#160; game. I reboot qemu / wondows and the issue is gone and game loads. Any ideas? Also sound stutters slightly.</p><p>Thanks in advance.</p></div></blockquote></div><p>Maybe your &quot;game&quot; tries to detect your GPU and as we know - all &quot;auto-detecting&quot; software like driver-detect stuff generate BSODs or some other weird behaviour. A strange example is GeForce Experience not allowing you to capture video if you don&#039;t have a &quot;real&quot; CPUID.<br />A workaround would be to use host-passthrough CPU model and ignore_msrs=1 in kvm module options for some weird software to work right.<br />You can see CPU-z query the CPU by doing rdmsr calls and dmesg tells you that that msrs are unknown.<br />Another reason for that would be... Maan, dual xeon? Socket 771, am i right? I&#039;d crash the first time i&#039;d see that system, not just a game. In other words - you have a very, very, very <span class="bbu">WEIRD</span> config from VM&#039;s view.</p><p>@aw, does your face hurt?.. If so - what was there before the edit?..</p> <p class="postedit"><em>Last edited by Duelist (2015-06-13 20:11:30)</em></p> </div> <div class="postsignature postmsg"><hr /><p><span class="bbs">The forum rules prohibit requesting support for distributions other than arch.</span><br /><a href="https://bbs.archlinux.org/viewtopic.php?pid=1551460#p1551460" rel="nofollow">I gave up.</a><a href="https://bbs.archlinux.org/viewtopic.php?id=162768" rel="nofollow"> It was too late.</a><br /><a href="http://pastebin.com/B3fL84bq" rel="nofollow">What I was trying to do</a>.<br /><a href="http://vfio.blogspot.com/" rel="nofollow">The reference about VFIO and KVM VGA passthrough.</a></p></div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1536765">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1536773" class="blockpost roweven"> <h2><span><span class="conr">#5333</span> <a href="viewtopic.php?pid=1536773#p1536773">2015-06-13 20:31:40</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=75590">aw</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2013-10-04</span></dd> <dd><span>Posts: 921</span></dd> <dd class="usercontacts"><span class="email"><a href="misc.php?email=75590">Email</a></span> <span class="website"><a href="http://vfio.blogspot.com/" rel="nofollow">Website</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>supertrampx wrote:</cite><blockquote><div><p>Vga passthrough working with gtx 970 on sr-2 classified and dual xeon 5680s. The only issue I have noticed is a freeze on first boot of a new&#160; game. I reboot qemu / wondows and the issue is gone and game loads. Any ideas? Also sound stutters slightly.</p><p>Thanks in advance.</p></div></blockquote></div><p><a href="http://vfio.blogspot.com/2014/09/vfio-interrupts-and-how-to-coax-windows.html" rel="nofollow">http://vfio.blogspot.com/2014/09/vfio-i … ndows.html</a></p> </div> <div class="postsignature postmsg"><hr /><p><a href="http://vfio.blogspot.com" rel="nofollow">http://vfio.blogspot.com</a><br />Looking for a more open forum to discuss vfio related uses?&#160; Try <a href="https://www.redhat.com/mailman/listinfo/vfio-users" rel="nofollow">https://www.redhat.com/mailman/listinfo/vfio-users</a></p></div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1536773">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1536860" class="blockpost rowodd"> <h2><span><span class="conr">#5334</span> <a href="viewtopic.php?pid=1536860#p1536860">2015-06-14 08:25:58</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=91723">supertrampx</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2015-06-07</span></dd> <dd><span>Posts: 11</span></dd> <dd class="usercontacts"><span class="email"><a href="mailto:joe.cayouette@gmail.com">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <p>Awesome thanks guys for the leads. <img src="https://bbs.archlinux.org/img/smilies/tongue.png" width="15" height="15" alt="tongue" /> yes this setup is weird and fast &quot;wink&quot;, and to make it even more fun, my pci-e ports are behind an Nvidia NF200 controller. <br />&quot;Socket 771, am i right?&quot;&#160; actually socket : 1366 <img src="https://bbs.archlinux.org/img/smilies/tongue.png" width="15" height="15" alt="tongue" /><br />So from what I understand, specify a cpu in my vm file so that special software calls wont detect that its in a vm and cause a BSOD? <br />I am unsure of host-passthrough cpu model and what you mean.</p><br /><p>Current VM Config<br />----------------------------------------------------------------------------------------------------------------------------------------<br />#!/bin/bash</p><p>configfile=/etc/vfio-pci1.cfg</p><p>vfiobind() {<br />&#160; &#160; dev=&quot;$1&quot;<br />&#160; &#160; &#160; &#160; vendor=$(cat /sys/bus/pci/devices/$dev/vendor)<br />&#160; &#160; &#160; &#160; device=$(cat /sys/bus/pci/devices/$dev/device)<br />&#160; &#160; &#160; &#160; if [ -e /sys/bus/pci/devices/$dev/driver ]; then<br />&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; echo $dev &gt; /sys/bus/pci/devices/$dev/driver/unbind<br />&#160; &#160; &#160; &#160; fi<br />&#160; &#160; &#160; &#160; echo $vendor $device &gt; /sys/bus/pci/drivers/vfio-pci/new_id</p><p>}</p><p>modprobe vfio-pci</p><p>cat $configfile | while read line;do<br />&#160; &#160; echo $line | grep ^# &gt;/dev/null 2&gt;&amp;1 &amp;&amp; continue<br />&#160; &#160; &#160; &#160; vfiobind $line<br />done</p><p>#Startup Windows 7 Guest with VGA-Passthrough<br />qemu-system-x86_64 -name win7 -enable-kvm -m 12000 -cpu host,kvm=off \<br />-smp 6,sockets=1,cores=4,threads=2 \<br />-rtc base=localtime -realtime mlock=off \<br />-bios /home/coyote/seabios/out/bios.bin \<br />-device vfio-pci,host=04:00.0,x-vga=on -device vfio-pci,host=04:00.1 \<br />-usb -usbdevice host:046d:c068 -usbdevice host:046d:c22d -usbdevice host:047f:c010 \<br />-device virtio-scsi-pci,id=scsi \<br />-drive file=/home/coyote/win7.img,id=win,format=raw,if=none -device scsi-hd,drive=win \<br />-drive file=/home/coyote/virtio.iso,id=virtiocd,if=none -device ide-cd,bus=ide.1,drive=virtiocd \<br />-drive file=/home/coyote/windows7.iso,id=isocd,if=none -device scsi-cd,drive=isocd \<br />-vga none <br />exit 0</p><p>----------------------------------------------------------------------------------------------------------------------------------------------<br />Info on my machine</p><p>Motherboard : <a href="http://www.evga.com/articles/00537/" rel="nofollow">http://www.evga.com/articles/00537/</a><br />Processors : <a href="http://ark.intel.com/products/47916/Intel-Xeon-Processor-X5680-12M-Cache-3_33-GHz-6_40-GTs-Intel-QPI" rel="nofollow">http://ark.intel.com/products/47916/Int … -Intel-QPI</a><br />RAM : 24 GB ecc 1600 &quot;would be using 48 but if you fill all slots, the ram is forced to run at 1300&quot; <br />Graphics : <a href="http://us.msi.com/product/vga/GTX-970-GAMING-4G.html#hero-overview" rel="nofollow">http://us.msi.com/product/vga/GTX-970-G … o-overview</a> &quot;run this card in passthrough to windows kvm&quot;<br />Graphics Host : An old GTX 260 with Nouveau drivers<br />HD : PNY SSD 250 GB and Crucial c300 250GB<br />6x&#160; 1TB Hard drives for backup in hot swap bays <br />1x Dell 30 inch ultra sharp for windows<br />1x Samsung 24 inch HD monitor Linux<br />OS openSUSE Tumbleweed 4.0.4-3<br />OS passthrough Windows 7</p> <p class="postedit"><em>Last edited by supertrampx (2015-06-14 08:41:52)</em></p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1536860">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1536861" class="blockpost roweven"> <h2><span><span class="conr">#5335</span> <a href="viewtopic.php?pid=1536861#p1536861">2015-06-14 08:27:06</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=91723">supertrampx</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2015-06-07</span></dd> <dd><span>Posts: 11</span></dd> <dd class="usercontacts"><span class="email"><a href="mailto:joe.cayouette@gmail.com">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <p>If I can get this running, I may try with 4 graphics cards, as I have the slots for it.</p><p>I am also getting some warnings when I run the vm</p><p>WARNING: Image format was not specified for &#039;/home/coyote/virtio.iso&#039; and probing guessed raw.<br />&#160; &#160; &#160; &#160; &#160;Automatically detecting the format is dangerous for raw images, write operations on block 0 will be restricted.<br />&#160; &#160; &#160; &#160; &#160;Specify the &#039;raw&#039; format explicitly to remove the restrictions.</p><p>WARNING: Image format was not specified for &#039;/home/coyote/windows7.iso&#039; and probing guessed raw.<br />&#160; &#160; &#160; &#160; &#160;Automatically detecting the format is dangerous for raw images, write operations on block 0 will be restricted.<br />&#160; &#160; &#160; &#160; &#160;Specify the &#039;raw&#039; format explicitly to remove the restrictions.</p> <p class="postedit"><em>Last edited by supertrampx (2015-06-14 08:38:02)</em></p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1536861">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1536862" class="blockpost rowodd"> <h2><span><span class="conr">#5336</span> <a href="viewtopic.php?pid=1536862#p1536862">2015-06-14 08:31:27</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=91723">supertrampx</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2015-06-07</span></dd> <dd><span>Posts: 11</span></dd> <dd class="usercontacts"><span class="email"><a href="mailto:joe.cayouette@gmail.com">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <p>If you wish here are some project photos <img src="https://bbs.archlinux.org/img/smilies/tongue.png" width="15" height="15" alt="tongue" /> Little bragging here sorry <img src="https://bbs.archlinux.org/img/smilies/smile.png" width="15" height="15" alt="smile" /> But I am proud and it has been a rocking project!</p><p><a href="http://s560.photobucket.com/user/joecayouette/library/sr2" rel="nofollow">http://s560.photobucket.com/user/joecay … ibrary/sr2</a></p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1536862">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1536865" class="blockpost roweven"> <h2><span><span class="conr">#5337</span> <a href="viewtopic.php?pid=1536865#p1536865">2015-06-14 09:05:55</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=82442">slis</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2014-06-02</span></dd> <dd><span>Posts: 125</span></dd> <dd class="usercontacts"><span class="email"><a href="mailto:xslisx@gmail.com">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <p>Thanks to this thread, for making this possible <img src="https://bbs.archlinux.org/img/smilies/smile.png" width="15" height="15" alt="smile" /></p><p>Here is my project:<br />6 hosts in lan for gaming<br />gigabyte z77, i7 2600, 20gb ram, 120gb ssd, 3tb sata, 2x gtx680 = 12 players/seats<br />Debian jessie with 3.19 kernel, custom win7 for guests. Running steam instead explorer, with everything locked down hard.</p><p><a href="https://www.youtube.com/watch?v=YoLLHKzXbC8" rel="nofollow">https://www.youtube.com/watch?v=YoLLHKzXbC8</a></p><p>It&#039;s been running for 6 months, No problems so far, everything is remote managed. And hosts happen to be on 10user 100mbps local wifi network, so they all can remote play over steam in-home streaming.</p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1536865">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1536892" class="blockpost rowodd"> <h2><span><span class="conr">#5338</span> <a href="viewtopic.php?pid=1536892#p1536892">2015-06-14 12:16:29</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=48315">TripleSpeeder</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2011-05-02</span></dd> <dd><span>Posts: 43</span></dd> <dd class="usercontacts"><span class="email"><a href="misc.php?email=48315">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>Duelist wrote:</cite><blockquote><div><div class="quotebox"><cite>TripleSpeeder wrote:</cite><blockquote><div><p>Hi,</p><p>I installed ovmf-svn from aur and now have the following files:</p><div class="codebox"><pre><code>[michael@stingray ~]$ find /usr/share/ovmf/ /usr/share/ovmf/ /usr/share/ovmf/ia32 /usr/share/ovmf/ia32/ovmf_vars_ia32.bin /usr/share/ovmf/ia32/ovmf_code_ia32.bin /usr/share/ovmf/ia32/ovmf_ia32.bin /usr/share/ovmf/x64 /usr/share/ovmf/x64/ovmf_vars_x64.bin /usr/share/ovmf/x64/ovmf_code_x64.bin /usr/share/ovmf/x64/ovmf_x64.bin</code></pre></div><p>Trying to set up a new VM with virt-manager complains that libvirt did not detect any UEFI Bios, so i can&#039;t switch the firmware to UEFI. For which files is libvirt/virtmanager looking? Probably for some *.fd instead of .bin?</p></div></blockquote></div><p>The right way:<br />/etc/libvirt/qemu.conf <br /># Location of master nvram file<br />#<br /># When a domain is configured to use UEFI instead of standard<br /># BIOS it may use a separate storage for UEFI variables. If<br /># that&#039;s the case libvirt creates the variable store per domain<br /># using this master file as image. Each UEFI firmware can,<br /># however, have different variables store. Therefore the nvram is<br /># a list of strings when a single item is in form of:<br />#&#160; &#160;${PATH_TO_UEFI_FW}:${PATH_TO_UEFI_VARS}.<br /># Later, when libvirt creates per domain variable store, this<br /># list is searched for the master image.<br />nvram = [ &quot;/usr/share/edk2.git/ovmf-x64/OVMF_CODE-pure-efi.fd:/usr/share/edk2.git/ovmf-x64/OVMF_VARS-pure-efi.fd&quot; ]</p></div></blockquote></div><p>Hmm, but these are .fd files, while ovmf-svn builds only .bin files as shown above. I suppose they&#039;re not interchangeable, or are they?</p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1536892">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1536918" class="blockpost roweven"> <h2><span><span class="conr">#5339</span> <a href="viewtopic.php?pid=1536918#p1536918">2015-06-14 14:19:02</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=85314">Duelist</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2014-09-22</span></dd> <dd><span>Posts: 358</span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>supertrampx wrote:</cite><blockquote><div><p>If I can get this running, I may try with 4 graphics cards, as I have the slots for it.</p><p>I am also getting some warnings when I run the vm</p><p>WARNING: Image format was not specified for &#039;/home/coyote/virtio.iso&#039; and probing guessed raw.<br />&#160; &#160; &#160; &#160; &#160;Automatically detecting the format is dangerous for raw images, write operations on block 0 will be restricted.<br />&#160; &#160; &#160; &#160; &#160;Specify the &#039;raw&#039; format explicitly to remove the restrictions.</p><p>WARNING: Image format was not specified for &#039;/home/coyote/windows7.iso&#039; and probing guessed raw.<br />&#160; &#160; &#160; &#160; &#160;Automatically detecting the format is dangerous for raw images, write operations on block 0 will be restricted.<br />&#160; &#160; &#160; &#160; &#160;Specify the &#039;raw&#039; format explicitly to remove the restrictions.</p></div></blockquote></div><p>The warnings tell that you should specify the format of your images.</p><div class="codebox"><pre><code>-drive file=/home/coyote/win7.img,id=win,format=raw,if=none -device scsi-hd,drive=win \ -drive file=/home/coyote/virtio.iso,id=virtiocd,if=none -device ide-cd,bus=ide.1,drive=virtiocd \ -drive file=/home/coyote/windows7.iso,id=isocd,if=none -device scsi-cd,drive=isocd</code></pre></div><p>You&#039;ve only specified the format for win7.img. So it should be like this:</p><div class="codebox"><pre><code>-drive file=/home/coyote/virtio.iso,id=virtiocd,,format=raw,if=none -device ide-cd,bus=ide.1,drive=virtiocd \ -drive file=/home/coyote/windows7.iso,id=isocd,format=raw,if=none -device scsi-cd,drive=isocd</code></pre></div><p>And you&#039;re using cpu host model already, so try following aw&#039;s advice and make everything use MSI(interrupts, not the vendor).</p><p>MultiGPU setup... SLI on nvidia hasn&#039;t been observed working yet. I&#039;ve seen(and using) only CrossFire multiGPU configs. Maybe slis have a different opinion on this.<br />I&#039;ve suggested one guy to use HyperSLI to trick nvidia&#039;s driver, but it didn&#039;t work.</p><br /><div class="quotebox"><cite>slis wrote:</cite><blockquote><div><p>Thanks to this thread, for making this possible <img src="https://bbs.archlinux.org/img/smilies/smile.png" width="15" height="15" alt="smile" /></p><p>Here is my project:<br />6 hosts in lan for gaming<br />gigabyte z77, i7 2600, 20gb ram, 120gb ssd, 3tb sata, 2x gtx680 = 12 players/seats<br />Debian jessie with 3.19 kernel, custom win7 for guests. Running steam instead explorer, with everything locked down hard.</p><p><a href="https://www.youtube.com/watch?v=YoLLHKzXbC8" rel="nofollow">https://www.youtube.com/watch?v=YoLLHKzXbC8</a></p><p>It&#039;s been running for 6 months, No problems so far, everything is remote managed. And hosts happen to be on 10user 100mbps local wifi network, so they all can remote play over steam in-home streaming.</p></div></blockquote></div><p>Yeah, that&#039;s the right usecase for that tech. But you have two 680s... How does it work? One gpu per VM? Quadrified them and split into many VMs? Or what?</p> </div> <div class="postsignature postmsg"><hr /><p><span class="bbs">The forum rules prohibit requesting support for distributions other than arch.</span><br /><a href="https://bbs.archlinux.org/viewtopic.php?pid=1551460#p1551460" rel="nofollow">I gave up.</a><a href="https://bbs.archlinux.org/viewtopic.php?id=162768" rel="nofollow"> It was too late.</a><br /><a href="http://pastebin.com/B3fL84bq" rel="nofollow">What I was trying to do</a>.<br /><a href="http://vfio.blogspot.com/" rel="nofollow">The reference about VFIO and KVM VGA passthrough.</a></p></div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1536918">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1536942" class="blockpost rowodd"> <h2><span><span class="conr">#5340</span> <a href="viewtopic.php?pid=1536942#p1536942">2015-06-14 16:22:40</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=82442">slis</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2014-06-02</span></dd> <dd><span>Posts: 125</span></dd> <dd class="usercontacts"><span class="email"><a href="mailto:xslisx@gmail.com">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <p>Yeah it&#039;s one gpu per vm, splitting doesn&#039;t work, Quadrified (to grid k2) them just for hyper-v and latest driver.</p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1536942">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1536967" class="blockpost roweven"> <h2><span><span class="conr">#5341</span> <a href="viewtopic.php?pid=1536967#p1536967">2015-06-14 18:32:33</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=85314">Duelist</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2014-09-22</span></dd> <dd><span>Posts: 358</span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>slis wrote:</cite><blockquote><div><p>Yeah it&#039;s one gpu per vm, splitting doesn&#039;t work, Quadrified (to grid k2) them just for hyper-v and latest driver.</p></div></blockquote></div><p>So how does it gets 12 players?..</p> </div> <div class="postsignature postmsg"><hr /><p><span class="bbs">The forum rules prohibit requesting support for distributions other than arch.</span><br /><a href="https://bbs.archlinux.org/viewtopic.php?pid=1551460#p1551460" rel="nofollow">I gave up.</a><a href="https://bbs.archlinux.org/viewtopic.php?id=162768" rel="nofollow"> It was too late.</a><br /><a href="http://pastebin.com/B3fL84bq" rel="nofollow">What I was trying to do</a>.<br /><a href="http://vfio.blogspot.com/" rel="nofollow">The reference about VFIO and KVM VGA passthrough.</a></p></div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1536967">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1537018" class="blockpost rowodd"> <h2><span><span class="conr">#5342</span> <a href="viewtopic.php?pid=1537018#p1537018">2015-06-14 22:25:12</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=82442">slis</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2014-06-02</span></dd> <dd><span>Posts: 125</span></dd> <dd class="usercontacts"><span class="email"><a href="mailto:xslisx@gmail.com">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>Duelist wrote:</cite><blockquote><div><div class="quotebox"><cite>slis wrote:</cite><blockquote><div><p>Yeah it&#039;s one gpu per vm, splitting doesn&#039;t work, Quadrified (to grid k2) them just for hyper-v and latest driver.</p></div></blockquote></div><p>So how does it gets 12 players?..</p></div></blockquote></div><p>6 hosts with 2x 680, 2vms per host, one gpu each <img src="https://bbs.archlinux.org/img/smilies/smile.png" width="15" height="15" alt="smile" /></p> <p class="postedit"><em>Last edited by slis (2015-06-14 22:26:42)</em></p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1537018">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1537028" class="blockpost roweven"> <h2><span><span class="conr">#5343</span> <a href="viewtopic.php?pid=1537028#p1537028">2015-06-14 23:34:17</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=85314">Duelist</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2014-09-22</span></dd> <dd><span>Posts: 358</span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>slis wrote:</cite><blockquote><div><div class="quotebox"><cite>Duelist wrote:</cite><blockquote><div><div class="quotebox"><cite>slis wrote:</cite><blockquote><div><p>Yeah it&#039;s one gpu per vm, splitting doesn&#039;t work, Quadrified (to grid k2) them just for hyper-v and latest driver.</p></div></blockquote></div><p>So how does it gets 12 players?..</p></div></blockquote></div><p>6 hosts with 2x 680, 2vms per host, one gpu each <img src="https://bbs.archlinux.org/img/smilies/smile.png" width="15" height="15" alt="smile" /></p></div></blockquote></div><p>Aww, come on! That&#039;s not so fun. But fun anyway.</p><p>Why it doesn&#039;t split? It&#039;d be extra awesome to do four VMs per one GPU, making 8 guests out of one host.</p> </div> <div class="postsignature postmsg"><hr /><p><span class="bbs">The forum rules prohibit requesting support for distributions other than arch.</span><br /><a href="https://bbs.archlinux.org/viewtopic.php?pid=1551460#p1551460" rel="nofollow">I gave up.</a><a href="https://bbs.archlinux.org/viewtopic.php?id=162768" rel="nofollow"> It was too late.</a><br /><a href="http://pastebin.com/B3fL84bq" rel="nofollow">What I was trying to do</a>.<br /><a href="http://vfio.blogspot.com/" rel="nofollow">The reference about VFIO and KVM VGA passthrough.</a></p></div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1537028">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1537030" class="blockpost rowodd"> <h2><span><span class="conr">#5344</span> <a href="viewtopic.php?pid=1537030#p1537030">2015-06-14 23:36:16</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=82442">slis</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2014-06-02</span></dd> <dd><span>Posts: 125</span></dd> <dd class="usercontacts"><span class="email"><a href="mailto:xslisx@gmail.com">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <p>Yeah it would be nice, but I tried with citrix xen and it wouldn&#039;t work, passing worked.</p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1537030">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1537116" class="blockpost roweven"> <h2><span><span class="conr">#5345</span> <a href="viewtopic.php?pid=1537116#p1537116">2015-06-15 09:51:52</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=90593">mqddb</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2015-04-24</span></dd> <dd><span>Posts: 5</span></dd> <dd class="usercontacts"><span class="email"><a href="mailto:maqiang@shencloudtech.com">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>Punkbob wrote:</cite><blockquote><div><div class="quotebox"><cite>aw wrote:</cite><blockquote><div><div class="quotebox"><cite>aw wrote:</cite><blockquote><div><p>8.1, AIUI 10 has numerous issues running as a VM</p></div></blockquote></div><p>@Punkbob</p><p>What build of Windows 10 are you using and did you need to do anything special to get it installed?&#160; I see one <a href="https://social.msdn.microsoft.com/Forums/en-US/695c8997-52cf-4c30-a3f7-f26a40dc703a/failed-install-of-build-10041-in-the-kvm-virtual-machine-system-thread-exception-not-handled?forum=WinPreview2014Setup" rel="nofollow">report</a> that installing build 10041 requires at least one hyper-v extension to be enabled, which isn&#039;t going to sit well with Nvidia drivers.</p></div></blockquote></div><p>I am using build 9926 on my most recent VM, and I didn&#039;t change anything or enable anything different then I would with a normal Windows 10 install. When I first switched over to Windows 10 a few months ago it initially didn&#039;t have any specific display drivers from Nvidia, so I just used the ones from Windows 8.1. However once I try drivers that are specifically released for Windows 10, the screen goes black, and when I reboot it just spits the code 43 error back at me.</p><p>Edit: Let me try a later build real quick, I thought I was using one that was more recent, but I think I confused which iso I grabbed off my NAS.</p></div></blockquote></div><p>Hi All:<br />&#160; &#160; Is there an method to solve this code 43 issue? I also face this boring problem.</p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1537116">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1537132" class="blockpost rowodd"> <h2><span><span class="conr">#5346</span> <a href="viewtopic.php?pid=1537132#p1537132">2015-06-15 11:11:54</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=82442">slis</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2014-06-02</span></dd> <dd><span>Posts: 125</span></dd> <dd class="usercontacts"><span class="email"><a href="mailto:xslisx@gmail.com">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <p>For me Windows10_InsiderPreview_x64_EN-US_10074.iso, is working fine with 352.84 on gtx680.</p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1537132">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1537138" class="blockpost roweven"> <h2><span><span class="conr">#5347</span> <a href="viewtopic.php?pid=1537138#p1537138">2015-06-15 11:39:18</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=91715">WildyLion</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2015-06-07</span></dd> <dd><span>Posts: 4</span></dd> <dd class="usercontacts"><span class="email"><a href="misc.php?email=91715">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <p>Hi guys,</p><p>Could anybody advise me on how to solve subtle timing issues with a 8.1 guest?<br />When I&#039;m playing music in foobar, the EQ would stop for a second and the sound will stutter, and when I&#039;m playing games, I still get sudden FPS dropouts.</p><p>My hardware<br />* FX-8350 CPU<br />* M5A99FX PRO 2.0 M/B<br />* Sapphire Vapor-X Radeon R9 290 as passthrough GPU (VFIO mode)<br />* USB controller with k/b, mouse and Xonar U7 passed to the VM via PCI passthrough<br />* I switch k/b and mouse between the motherboard USB ports with an ATEN CS22U KVM</p><p>What I&#039;ve already done:</p><p>* Using i440FX vChipset at the moment (with OVMF)<br />* kvm-amd nested pages disabled<br />* Hyper-V extensions enabled for the VM at install time<br />* Host CPU (FX-8350) cpufreq set to performance<br />* Hugepages memory backing enabled, with hugetlbfs<br />* 6 VCPUs pinned to 6 real cores (0-5 respectively)</p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1537138">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1537201" class="blockpost rowodd"> <h2><span><span class="conr">#5348</span> <a href="viewtopic.php?pid=1537201#p1537201">2015-06-15 16:53:22</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=84760">Denso</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd class="postavatar"><img src="https://bbs.archlinux.org/img/avatars/84760.png?m=1412533733" width="71" height="80" alt="" /></dd> <dd><span>Registered: 2014-08-30</span></dd> <dd><span>Posts: 179</span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <p>Hi <img src="https://bbs.archlinux.org/img/smilies/smile.png" width="15" height="15" alt="smile" /></p><p>So my X99-Deluxe exploded out of sudden and took my 5930k with it ! <img src="https://bbs.archlinux.org/img/smilies/sad.png" width="15" height="15" alt="sad" /></p><p>Been a month and I finally replaced it with a X99-E WS + 5820k .</p><p>Everything is working fine , but I couldn&#039;t get VFIO to bind to my NVIDIA using modprobe.d . Binding my devices using the vfio-bind script is fine .</p><p>Modules are loaded early in initramfs , and &quot;options vfio-pci ids=&quot; are specified correctly . My other devices get bound correctly using this method , only NVIDIA cards don&#039;t .</p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1537201">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1537214" class="blockpost roweven"> <h2><span><span class="conr">#5349</span> <a href="viewtopic.php?pid=1537214#p1537214">2015-06-15 17:28:52</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=75590">aw</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2013-10-04</span></dd> <dd><span>Posts: 921</span></dd> <dd class="usercontacts"><span class="email"><a href="misc.php?email=75590">Email</a></span> <span class="website"><a href="http://vfio.blogspot.com/" rel="nofollow">Website</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <p>@Denso</p><p>If vfio-pci is a module, you need to do something to make sure it gets loaded before the native driver has already claimed the device.&#160; Using the modprobe.d softdep option might be a way to handle this, or you can use the techniques I provide in <a href="http://vfio.blogspot.com/2015/05/vfio-gpu-how-to-series-part-3-host.html" rel="nofollow">part 3 of my howto series</a></p> </div> <div class="postsignature postmsg"><hr /><p><a href="http://vfio.blogspot.com" rel="nofollow">http://vfio.blogspot.com</a><br />Looking for a more open forum to discuss vfio related uses?&#160; Try <a href="https://www.redhat.com/mailman/listinfo/vfio-users" rel="nofollow">https://www.redhat.com/mailman/listinfo/vfio-users</a></p></div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1537214">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1537230" class="blockpost rowodd"> <h2><span><span class="conr">#5350</span> <a href="viewtopic.php?pid=1537230#p1537230">2015-06-15 18:46:57</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=84760">Denso</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd class="postavatar"><img src="https://bbs.archlinux.org/img/avatars/84760.png?m=1412533733" width="71" height="80" alt="" /></dd> <dd><span>Registered: 2014-08-30</span></dd> <dd><span>Posts: 179</span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <p>@aw :</p><p>Thanks , but I am blacklisting nouveau too . In fact when I issue lspci -k , there is no driver claiming the devices at all . Not the native drivers nor vfio-pci . Changing from universal NVIDIA&#039;s PCI IDs to GPU&#039;s specific doesn&#039;t solve the issue either .</p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1537230">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div class="postlinksb"> <div class="inbox crumbsplus"> <div class="pagepost"> <p class="pagelink conl"><span class="pages-label">Pages: </span><a rel="prev" class="item1" href="viewtopic.php?id=162768&amp;p=213">Previous</a> <a href="viewtopic.php?id=162768">1</a> <span class="spacer">…</span> <a href="viewtopic.php?id=162768&amp;p=212">212</a> <a href="viewtopic.php?id=162768&amp;p=213">213</a> <strong>214</strong> <a href="viewtopic.php?id=162768&amp;p=215">215</a> <a href="viewtopic.php?id=162768&amp;p=216">216</a> <span class="spacer">…</span> <a href="viewtopic.php?id=162768&amp;p=234">234</a> <a rel="next" href="viewtopic.php?id=162768&amp;p=215">Next</a></p> <p class="postlink conr">Topic closed</p> </div> <ul class="crumbs"> <li><a href="index.php">Index</a></li> <li><span>»&#160;</span><a href="viewforum.php?id=48">Topics Going Nowhere</a></li> <li><span>»&#160;</span><strong><a href="viewtopic.php?id=162768">KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</a></strong></li> </ul> <p class="subscribelink clearb"><a href="misc.php?action=subscribe&amp;tid=162768">Subscribe to this topic</a></p> <div class="clearer"></div> </div> </div> </div> <div id="brdfooter" class="block"> <h2><span>Board footer</span></h2> <div class="box"> <div id="brdfooternav" class="inbox"> <div class="conl"> <form id="qjump" method="get" action="viewforum.php"> <div><label><span>Jump to<br /></span> <select name="id" onchange="window.location=('viewforum.php?id='+this.options[this.selectedIndex].value)"> <optgroup label="Technical Issues and Assistance"> <option value="23">Newbie Corner</option> <option value="17">Installation</option> <option value="22">Kernel &amp; Hardware</option> <option value="18">Applications &amp; Desktop Environments</option> <option value="31">Laptop Issues</option> <option value="8">Networking, Server, and Protection</option> <option value="32">Multimedia and Games</option> <option value="50">System Administration</option> <option value="35">Other Architectures</option> </optgroup> <optgroup label="Arch-centric"> <option value="24">Announcements, Package &amp; Security Advisories</option> <option value="1">Arch Discussion</option> <option value="13">Forum &amp; Wiki discussion</option> </optgroup> <optgroup label="Pacman Upgrades, Packaging &amp; AUR"> <option value="44">Pacman &amp; Package Upgrade Issues</option> <option value="49">[testing] Repo Forum</option> <option value="4">Creating &amp; Modifying Packages</option> <option value="38">AUR Issues, Discussion &amp; PKGBUILD Requests</option> </optgroup> <optgroup label="Contributions &amp; Discussion"> <option value="20">GNU/Linux Discussion</option> <option value="27">Community Contributions</option> <option value="33">Programming &amp; Scripting</option> <option value="30">Other Languages</option> <option value="47">Artwork and Screenshots</option> <option value="42">Try This</option> </optgroup> <optgroup label="/dev/null"> <option value="29">Off-Topic</option> <option value="48" selected="selected">Topics Going Nowhere</option> <option value="36">Dustbin</option> </optgroup> </select></label> <input type="submit" value=" Go " accesskey="g" /> </div> </form> </div> <div class="conr"> <p id="feedlinks"><span class="atom"><a href="extern.php?action=feed&amp;tid=162768&amp;type=atom">Atom topic feed</a></span></p> <p id="poweredby">Powered by <a href="http://fluxbb.org/">FluxBB</a></p> </div> <div class="clearer"></div> </div> </div> </div> </div> <div class="end-box"></div> </div> </body> </html>
