<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"> <html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en" dir="ltr"> <head> <meta http-equiv="Content-Type" content="text/html; charset=utf-8" /> <title>KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9 (Page 196) / Topics Going Nowhere / Arch Linux Forums</title> <link rel="stylesheet" type="text/css" href="style/ArchLinux.css" /> <link rel="canonical" href="viewtopic.php?id=162768&amp;p=196" title="Page 196" /> <link rel="prev" href="viewtopic.php?id=162768&amp;p=195" title="Page 195" /> <link rel="next" href="viewtopic.php?id=162768&amp;p=197" title="Page 197" /> <link rel="alternate" type="application/atom+xml" href="extern.php?action=feed&amp;tid=162768&amp;type=atom" title="Atom topic feed" /> <link rel="stylesheet" media="screen" href="style/ArchLinux/arch.css?v=3" /> <link rel="stylesheet" media="screen" href="style/ArchLinux/archnavbar.css?v=2" /> <link rel="shortcut icon" href="style/ArchLinux/favicon.ico" /> </head> <body> <div id="archnavbar" class="anb-forum"> <div id="archnavbarlogo"><h1><a href="http://www.archlinux.org/">Arch Linux</a></h1></div> <div id="archnavbarmenu"> <ul id="archnavbarlist"> <li id="anb-home"><a href="http://www.archlinux.org/">Home</a></li><li id="anb-packages"><a href="http://www.archlinux.org/packages/">Packages</a></li><li id="anb-forums" class="anb-selected"><a href="https://bbs.archlinux.org/">Forums</a></li><li id="anb-wiki"><a href="https://wiki.archlinux.org/">Wiki</a></li><li id="anb-bugs"><a href="https://bugs.archlinux.org/">Bugs</a></li><li id="anb-aur"><a href="https://aur.archlinux.org/">AUR</a></li><li id="anb-download"><a href="http://www.archlinux.org/download/">Download</a></li> </ul> </div> </div> <div id="punviewtopic" class="pun"> <div class="top-box"></div> <div class="punwrap"> <div id="brdheader" class="block"> <div class="box"> <div id="brdmenu" class="inbox"> <ul> <li id="navindex" class="isactive"><a href="index.php">Index</a></li> <li id="navuserlist"><a href="userlist.php">User list</a></li> <li id="navsearch"><a href="search.php">Search</a></li> <li id="navprofile"><a href="profile.php?id=80749">Profile</a></li> <li id="navlogout"><a href="login.php?action=out&amp;id=80749&amp;csrf_token=5c20501ec397bb45ef8ee8c84db232c8d8e421c6">Logout</a></li> </ul> </div> <div id="brdwelcome" class="inbox"> <ul class="conl"> <li><span>Logged in as <strong>SXX</strong></span></li> <li><span>Last visit: 2015-08-16 12:20:09</span></li> </ul> <ul class="conr"> <li><span>Topics: <a href="search.php?action=show_replies" title="Find topics you have posted to.">Posted</a> | <a href="search.php?action=show_new" title="Find topics with new posts since your last visit.">New</a> | <a href="search.php?action=show_recent" title="Find topics with recent posts.">Active</a> | <a href="search.php?action=show_unanswered" title="Find topics with no replies.">Unanswered</a></span></li> </ul> <div class="clearer"></div> </div> </div> </div> <div id="brdmain"> <div class="linkst"> <div class="inbox crumbsplus"> <ul class="crumbs"> <li><a href="index.php">Index</a></li> <li><span>»&#160;</span><a href="viewforum.php?id=48">Topics Going Nowhere</a></li> <li><span>»&#160;</span><strong><a href="viewtopic.php?id=162768">KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</a></strong></li> </ul> <div class="pagepost"> <p class="pagelink conl"><span class="pages-label">Pages: </span><a rel="prev" class="item1" href="viewtopic.php?id=162768&amp;p=195">Previous</a> <a href="viewtopic.php?id=162768">1</a> <span class="spacer">…</span> <a href="viewtopic.php?id=162768&amp;p=194">194</a> <a href="viewtopic.php?id=162768&amp;p=195">195</a> <strong>196</strong> <a href="viewtopic.php?id=162768&amp;p=197">197</a> <a href="viewtopic.php?id=162768&amp;p=198">198</a> <span class="spacer">…</span> <a href="viewtopic.php?id=162768&amp;p=234">234</a> <a rel="next" href="viewtopic.php?id=162768&amp;p=197">Next</a></p> <p class="postlink conr">Topic closed</p> </div> <div class="clearer"></div> </div> </div> <div id="p1522438" class="blockpost rowodd blockpost1"> <h2><span><span class="conr">#4876</span> <a href="viewtopic.php?pid=1522438#p1522438">2015-04-23 12:56:43</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=84760">Denso</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd class="postavatar"><img src="https://bbs.archlinux.org/img/avatars/84760.png?m=1412533733" width="71" height="80" alt="" /></dd> <dd><span>Registered: 2014-08-30</span></dd> <dd><span>Posts: 179</span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>aw wrote:</cite><blockquote><div><div class="quotebox"><cite>Denso wrote:</cite><blockquote><div><div class="quotebox"><cite>aw wrote:</cite><blockquote><div><p><strong>AMD Bonaire and Hawaii users with reset issues</strong>, please try this QEMU patch (against v2.3.0-rc4): <a href="http://fpaste.org/214053/" rel="nofollow">http://fpaste.org/214053/</a>&#160; Report back your GPU device ID and whether resets are resolved.&#160; As noted in the patch, I expect the ultimate resolution will be a device specific reset in the kernel, this is just a prototype of that.&#160; If you do not have an AMD GPU affected by reset problems (ie. one guest boot per host boot), please don&#039;t bother with this patch.</p></div></blockquote></div><p>Anything for Nvidia&#039;s GPUs with reset issues ? XD</p></div></blockquote></div><p>I&#039;m not aware of any widespread reset issues on nvidia.</p></div></blockquote></div><p>Well . It only happens after I install the nvidia&#039;s drivers . Using the Microsoft Basic one is fine . When the drivers are installed , rebooting the VM works , I can see the OVMF screen + Windows logo , then just before it shows the desktop it goes black . The VM doesn&#039;t crash nor the host . No dmesg errors . One guest boot per host boot . GT610 .</p><div class="codebox"><pre class="vscroll"><code>lspci -vvv : 02:00.0 VGA compatible controller: NVIDIA Corporation GF119 [GeForce GT 610] (rev a1) (prog-if 00 [VGA controller]) Subsystem: Gigabyte Technology Co., Ltd Device 3549 Physical Slot: 6 Control: I/O+ Mem+ BusMaster+ SpecCycle- MemWINV- VGASnoop- ParErr- Stepping- SERR+ FastB2B- DisINTx- Status: Cap+ 66MHz- UDF- FastB2B- ParErr- DEVSEL=fast &gt;TAbort- &lt;TAbort- &lt;MAbort- &gt;SERR- &lt;PERR- INTx- Latency: 0, Cache Line Size: 32 bytes Interrupt: pin A routed to IRQ 29 Region 0: Memory at f8000000 (32-bit, non-prefetchable) [size=16M] Region 1: Memory at c0000000 (64-bit, prefetchable) [size=128M] Region 3: Memory at c8000000 (64-bit, prefetchable) [size=32M] Region 5: I/O ports at d000 [size=128] Expansion ROM at f9000000 [disabled] [size=512K] Capabilities: [60] Power Management version 3 Flags: PMEClk- DSI- D1- D2- AuxCurrent=0mA PME(D0-,D1-,D2-,D3hot-,D3cold-) Status: D0 NoSoftRst+ PME-Enable- DSel=0 DScale=0 PME- Capabilities: [68] MSI: Enable- Count=1/1 Maskable- 64bit+ Address: 0000000000000000 Data: 0000 Capabilities: [78] Express (v2) Endpoint, MSI 00 DevCap: MaxPayload 128 bytes, PhantFunc 0, Latency L0s unlimited, L1 &lt;64us ExtTag+ AttnBtn- AttnInd- PwrInd- RBE+ FLReset- DevCtl: Report errors: Correctable- Non-Fatal- Fatal- Unsupported- RlxdOrd+ ExtTag+ PhantFunc- AuxPwr- NoSnoop+ MaxPayload 128 bytes, MaxReadReq 512 bytes DevSta: CorrErr- UncorrErr- FatalErr- UnsuppReq- AuxPwr- TransPend- LnkCap: Port #0, Speed 2.5GT/s, Width x16, ASPM L0s L1, Exit Latency L0s &lt;256ns, L1 &lt;4us ClockPM+ Surprise- LLActRep- BwNot- ASPMOptComp- LnkCtl: ASPM Disabled; RCB 64 bytes Disabled- CommClk+ ExtSynch- ClockPM- AutWidDis- BWInt- AutBWInt- LnkSta: Speed 2.5GT/s, Width x16, TrErr- Train- SlotClk+ DLActive- BWMgmt- ABWMgmt- DevCap2: Completion Timeout: Not Supported, TimeoutDis+, LTR-, OBFF Not Supported DevCtl2: Completion Timeout: 50us to 50ms, TimeoutDis-, LTR-, OBFF Disabled LnkCtl2: Target Link Speed: 2.5GT/s, EnterCompliance- SpeedDis- Transmit Margin: Normal Operating Range, EnterModifiedCompliance- ComplianceSOS- Compliance De-emphasis: -6dB LnkSta2: Current De-emphasis Level: -6dB, EqualizationComplete-, EqualizationPhase1- EqualizationPhase2-, EqualizationPhase3-, LinkEqualizationRequest- Capabilities: [b4] Vendor Specific Information: Len=14 &lt;?&gt; Capabilities: [100 v1] Virtual Channel Caps: LPEVC=0 RefClk=100ns PATEntryBits=1 Arb: Fixed- WRR32- WRR64- WRR128- Ctrl: ArbSelect=Fixed Status: InProgress- VC0: Caps: PATOffset=00 MaxTimeSlots=1 RejSnoopTrans- Arb: Fixed- WRR32- WRR64- WRR128- TWRR128- WRR256- Ctrl: Enable+ ID=0 ArbSelect=Fixed TC/VC=01 Status: NegoPending- InProgress- Capabilities: [128 v1] Power Budgeting &lt;?&gt; Capabilities: [600 v1] Vendor Specific Information: ID=0001 Rev=1 Len=024 &lt;?&gt; Kernel driver in use: vfio-pci Kernel modules: nouveau</code></pre></div> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1522438">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1522439" class="blockpost roweven"> <h2><span><span class="conr">#4877</span> <a href="viewtopic.php?pid=1522439#p1522439">2015-04-23 13:01:14</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=75590">aw</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2013-10-04</span></dd> <dd><span>Posts: 921</span></dd> <dd class="usercontacts"><span class="email"><a href="misc.php?email=75590">Email</a></span> <span class="website"><a href="http://vfio.blogspot.com/" rel="nofollow">Website</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>Denso wrote:</cite><blockquote><div><div class="quotebox"><cite>aw wrote:</cite><blockquote><div><div class="quotebox"><cite>Denso wrote:</cite><blockquote><div><p>Anything for Nvidia&#039;s GPUs with reset issues ? XD</p></div></blockquote></div><p>I&#039;m not aware of any widespread reset issues on nvidia.</p></div></blockquote></div><p>Well . It only happens after I install the nvidia&#039;s drivers . Using the Microsoft Basic one is fine . When the drivers are installed , rebooting the VM works , I can see the OVMF screen + Windows logo , then just before it shows the desktop it goes black . The VM doesn&#039;t crash nor the host . No dmesg errors . One guest boot per host boot . GT610 .</p></div></blockquote></div><p><strong>widespread...</strong></p><p>Sorry, one user having trouble with a low-end Fermi-based card does not make for a class problem.</p> </div> <div class="postsignature postmsg"><hr /><p><a href="http://vfio.blogspot.com" rel="nofollow">http://vfio.blogspot.com</a><br />Looking for a more open forum to discuss vfio related uses?&#160; Try <a href="https://www.redhat.com/mailman/listinfo/vfio-users" rel="nofollow">https://www.redhat.com/mailman/listinfo/vfio-users</a></p></div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1522439">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1522451" class="blockpost rowodd"> <h2><span><span class="conr">#4878</span> <a href="viewtopic.php?pid=1522451#p1522451">2015-04-23 14:13:10</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=90574">Parzival</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2015-04-23</span></dd> <dd><span>Posts: 3</span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <p>I have a problem with passing through Intel HD 5000 on Intel NUC. I&#039;ve followed the guide on the first pinned page of the thread:</p><ul><li><p>Installed linux-vfio kernel from aur</p></li><li><p>loaded pci-stub on boot</p></li><li><p>added the right boot options</p></li></ul><p><strong>This is the device:</strong></p><div class="codebox"><pre><code>00:02.0 VGA compatible controller: Intel Corporation Haswell-ULT Integrated Graphics Controller (rev 09) DeviceName: CPU1 Subsystem: Intel Corporation Device 2054 Kernel driver in use: pci-stub Kernel modules: i915</code></pre></div><p><strong>The resulting fault message:</strong></p><div class="codebox"><pre><code>qemu-system-i386: -device vfio-pci,host=0000:00:02.0: vfio: failed to set iommu for container: Operation not permitted qemu-system-i386: -device vfio-pci,host=0000:00:02.0: vfio: failed to setup container for group 1 qemu-system-i386: -device vfio-pci,host=0000:00:02.0: vfio: failed to get group 1 qemu-system-i386: -device vfio-pci,host=0000:00:02.0: Device initialization failed. qemu-system-i386: -device vfio-pci,host=0000:00:02.0: Device &#039;vfio-pci&#039; could not be initialized</code></pre></div><p><strong>dmesg</strong></p><div class="codebox"><pre><code>vfio-pci 0000:00:02.0: Device is ineligible for IOMMU domain attach due to platform RMRR requirement. Contact your platform vendor.</code></pre></div><p>So, I&#039;m interested to know :</p><ul><li><p>whether anyone had the same problem and was able to solve it</p></li><li><p>what/how should I ask the vendor (Intel I suppose) so I can resolve the above issue</p></li></ul><p>Thanks</p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1522451">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1522453" class="blockpost roweven"> <h2><span><span class="conr">#4879</span> <a href="viewtopic.php?pid=1522453#p1522453">2015-04-23 14:14:41</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=75590">aw</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2013-10-04</span></dd> <dd><span>Posts: 921</span></dd> <dd class="usercontacts"><span class="email"><a href="misc.php?email=75590">Email</a></span> <span class="website"><a href="http://vfio.blogspot.com/" rel="nofollow">Website</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>Denso wrote:</cite><blockquote><div><p>Well . It only happens after I install the nvidia&#039;s drivers . Using the Microsoft Basic one is fine . When the drivers are installed , rebooting the VM works , I can see the OVMF screen + Windows logo , then just before it shows the desktop it goes black . The VM doesn&#039;t crash nor the host . No dmesg errors . One guest boot per host boot . GT610 .</p><div class="codebox"><pre><code> Capabilities: [100 v1] Virtual Channel Caps: LPEVC=0 RefClk=100ns PATEntryBits=1 Arb: Fixed- WRR32- WRR64- WRR128- Ctrl: ArbSelect=Fixed Status: InProgress- VC0: Caps: PATOffset=00 MaxTimeSlots=1 RejSnoopTrans- Arb: Fixed- WRR32- WRR64- WRR128- TWRR128- WRR256- Ctrl: Enable+ ID=0 ArbSelect=Fixed TC/VC=01 Status: NegoPending- InProgress-</code></pre></div></div></blockquote></div><p>Does the TC/VC map reported in the Virtual Channel capability (01 above) change from the first host boot to after a guest failure?&#160; I had to add VC save/restore for platforms that use non-default TC/VC maps.&#160; Kernels 3.14 and newer should already include this though.</p> </div> <div class="postsignature postmsg"><hr /><p><a href="http://vfio.blogspot.com" rel="nofollow">http://vfio.blogspot.com</a><br />Looking for a more open forum to discuss vfio related uses?&#160; Try <a href="https://www.redhat.com/mailman/listinfo/vfio-users" rel="nofollow">https://www.redhat.com/mailman/listinfo/vfio-users</a></p></div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1522453">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1522454" class="blockpost rowodd"> <h2><span><span class="conr">#4880</span> <a href="viewtopic.php?pid=1522454#p1522454">2015-04-23 14:15:34</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=75590">aw</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2013-10-04</span></dd> <dd><span>Posts: 921</span></dd> <dd class="usercontacts"><span class="email"><a href="misc.php?email=75590">Email</a></span> <span class="website"><a href="http://vfio.blogspot.com/" rel="nofollow">Website</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>Parzival wrote:</cite><blockquote><div><p>I have a problem with passing through Intel HD 5000 on Intel NUC.</p></div></blockquote></div><p>IGD assignment does not work.</p> </div> <div class="postsignature postmsg"><hr /><p><a href="http://vfio.blogspot.com" rel="nofollow">http://vfio.blogspot.com</a><br />Looking for a more open forum to discuss vfio related uses?&#160; Try <a href="https://www.redhat.com/mailman/listinfo/vfio-users" rel="nofollow">https://www.redhat.com/mailman/listinfo/vfio-users</a></p></div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1522454">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1522462" class="blockpost roweven"> <h2><span><span class="conr">#4881</span> <a href="viewtopic.php?pid=1522462#p1522462">2015-04-23 14:24:56</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=90574">Parzival</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2015-04-23</span></dd> <dd><span>Posts: 3</span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>aw wrote:</cite><blockquote><div><div class="quotebox"><cite>Parzival wrote:</cite><blockquote><div><p>I have a problem with passing through Intel HD 5000 on Intel NUC.</p></div></blockquote></div><p>IGD assignment does not work.</p></div></blockquote></div><p>Can you explain why? Will it be supported in the near future?</p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1522462">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1522467" class="blockpost rowodd"> <h2><span><span class="conr">#4882</span> <a href="viewtopic.php?pid=1522467#p1522467">2015-04-23 14:32:47</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=75590">aw</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2013-10-04</span></dd> <dd><span>Posts: 921</span></dd> <dd class="usercontacts"><span class="email"><a href="misc.php?email=75590">Email</a></span> <span class="website"><a href="http://vfio.blogspot.com/" rel="nofollow">Website</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>Parzival wrote:</cite><blockquote><div><div class="quotebox"><cite>aw wrote:</cite><blockquote><div><div class="quotebox"><cite>Parzival wrote:</cite><blockquote><div><p>I have a problem with passing through Intel HD 5000 on Intel NUC.</p></div></blockquote></div><p>IGD assignment does not work.</p></div></blockquote></div><p>Can you explain why? Will it be supported in the near future?</p></div></blockquote></div><p>Because not only is IGD not a discrete device in the sense that it&#039;s integrated, but also it&#039;s current driver requirements extend beyond the individual PCI device.&#160; It requires various operation regions outside of the device to be poked through, it requires registers on the host bridge to be assigned, it requires specific PCI IDs matching the host chipset on the host bridge and PCH device, etc.&#160; There are proof-of-concept level patches available, but I wouldn&#039;t recommend them unless you plan to contribute to their development.&#160; Likely the only way we&#039;ll see progress is in a new driver from Intel that confines the platform requirements for IGD to the PCI device itself.</p> </div> <div class="postsignature postmsg"><hr /><p><a href="http://vfio.blogspot.com" rel="nofollow">http://vfio.blogspot.com</a><br />Looking for a more open forum to discuss vfio related uses?&#160; Try <a href="https://www.redhat.com/mailman/listinfo/vfio-users" rel="nofollow">https://www.redhat.com/mailman/listinfo/vfio-users</a></p></div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1522467">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1522469" class="blockpost roweven"> <h2><span><span class="conr">#4883</span> <a href="viewtopic.php?pid=1522469#p1522469">2015-04-23 14:39:01</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=84760">Denso</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd class="postavatar"><img src="https://bbs.archlinux.org/img/avatars/84760.png?m=1412533733" width="71" height="80" alt="" /></dd> <dd><span>Registered: 2014-08-30</span></dd> <dd><span>Posts: 179</span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>aw wrote:</cite><blockquote><div><p>Does the TC/VC map reported in the Virtual Channel capability (01 above) change from the first host boot to after a guest failure?&#160; I had to add VC save/restore for platforms that use non-default TC/VC maps.&#160; Kernels 3.14 and newer should already include this though.</p></div></blockquote></div><p>No , nothing in the GPU or the integrated HDMI audio devices changes when the guest got rebooted .</p><p>On a side note , ASUS released a new BIOS update for X99-Deluxe . After applying it , I no longer recieve the &quot;AER: Multiple Corrected error&quot; in dmesg anymore <img src="https://bbs.archlinux.org/img/smilies/smile.png" width="15" height="15" alt="smile" /></p><p>It seems to be a widespread issue with X99 . This platform&#039;s stability is not good compared to my old Z77 .</p><p>EDIT :</p><p>I am passing through the Intel Audio device to the same VM . This device gets TC/VC changes after guest reboot :</p><div class="codebox"><pre><code>Before VM reboot : VC0: Caps: PATOffset=00 MaxTimeSlots=1 RejSnoopTrans- Arb: Fixed- WRR32- WRR64- WRR128- TWRR128- WRR256- Ctrl: Enable+ ID=0 ArbSelect=Fixed TC/VC=01 Status: NegoPending- InProgress- VC1: Caps: PATOffset=00 MaxTimeSlots=1 RejSnoopTrans- Arb: Fixed- WRR32- WRR64- WRR128- TWRR128- WRR256- Ctrl: Enable+ ID=2 ArbSelect=Fixed TC/VC=04 Status: NegoPending- InProgress- Kernel driver in use: vfio-pci Kernel modules: snd_hda_intel</code></pre></div><div class="codebox"><pre><code>After VM reboot : VC0: Caps: PATOffset=00 MaxTimeSlots=1 RejSnoopTrans- Arb: Fixed- WRR32- WRR64- WRR128- TWRR128- WRR256- Ctrl: Enable+ ID=0 ArbSelect=Fixed TC/VC=ff Status: NegoPending- InProgress- VC1: Caps: PATOffset=00 MaxTimeSlots=1 RejSnoopTrans- Arb: Fixed- WRR32- WRR64- WRR128- TWRR128- WRR256- Ctrl: Enable+ ID=2 ArbSelect=Fixed TC/VC=00 Status: NegoPending- InProgress- Kernel driver in use: vfio-pci Kernel modules: snd_hda_intel </code></pre></div><p>I&#039;ll reboot the host &amp; VM without attaching it , and will see if it is to blame .</p> <p class="postedit"><em>Last edited by Denso (2015-04-23 14:46:27)</em></p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1522469">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1522473" class="blockpost rowodd"> <h2><span><span class="conr">#4884</span> <a href="viewtopic.php?pid=1522473#p1522473">2015-04-23 14:43:52</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=90574">Parzival</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2015-04-23</span></dd> <dd><span>Posts: 3</span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>aw wrote:</cite><blockquote><div><div class="quotebox"><cite>Parzival wrote:</cite><blockquote><div><div class="quotebox"><cite>aw wrote:</cite><blockquote><div><p>IGD assignment does not work.</p></div></blockquote></div><p>Can you explain why? Will it be supported in the near future?</p></div></blockquote></div><p>Because not only is IGD not a discrete device in the sense that it&#039;s integrated, but also it&#039;s current driver requirements extend beyond the individual PCI device.&#160; It requires various operation regions outside of the device to be poked through, it requires registers on the host bridge to be assigned, it requires specific PCI IDs matching the host chipset on the host bridge and PCH device, etc.&#160; There are proof-of-concept level patches available, but I wouldn&#039;t recommend them unless you plan to contribute to their development.&#160; Likely the only way we&#039;ll see progress is in a new driver from Intel that confines the platform requirements for IGD to the PCI device itself.</p></div></blockquote></div><p>Thanks.<br />I know that this could be a broad answer, but still, I&#039;ll appreciate if you can explain why I do able to pass through IGD using Xen? What&#039;s the difference?</p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1522473">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1522474" class="blockpost roweven"> <h2><span><span class="conr">#4885</span> <a href="viewtopic.php?pid=1522474#p1522474">2015-04-23 14:47:31</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=75590">aw</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2013-10-04</span></dd> <dd><span>Posts: 921</span></dd> <dd class="usercontacts"><span class="email"><a href="misc.php?email=75590">Email</a></span> <span class="website"><a href="http://vfio.blogspot.com/" rel="nofollow">Website</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>Parzival wrote:</cite><blockquote><div><div class="quotebox"><cite>aw wrote:</cite><blockquote><div><div class="quotebox"><cite>Parzival wrote:</cite><blockquote><div><p>Can you explain why? Will it be supported in the near future?</p></div></blockquote></div><p>Because not only is IGD not a discrete device in the sense that it&#039;s integrated, but also it&#039;s current driver requirements extend beyond the individual PCI device.&#160; It requires various operation regions outside of the device to be poked through, it requires registers on the host bridge to be assigned, it requires specific PCI IDs matching the host chipset on the host bridge and PCH device, etc.&#160; There are proof-of-concept level patches available, but I wouldn&#039;t recommend them unless you plan to contribute to their development.&#160; Likely the only way we&#039;ll see progress is in a new driver from Intel that confines the platform requirements for IGD to the PCI device itself.</p></div></blockquote></div><p>Thanks.<br />I know that this could be a broad answer, but still, I&#039;ll appreciate if you can explain why I do able to pass through IGD using Xen? What&#039;s the difference?</p></div></blockquote></div><p>Because Xen is willing to hack their VM to bits, regardless of the support-ability of the solution in order to make something work.&#160; When they tried to merge those hacks into upstream QEMU is when we started talking to Intel about how to do this correctly.</p> </div> <div class="postsignature postmsg"><hr /><p><a href="http://vfio.blogspot.com" rel="nofollow">http://vfio.blogspot.com</a><br />Looking for a more open forum to discuss vfio related uses?&#160; Try <a href="https://www.redhat.com/mailman/listinfo/vfio-users" rel="nofollow">https://www.redhat.com/mailman/listinfo/vfio-users</a></p></div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1522474">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1522482" class="blockpost rowodd"> <h2><span><span class="conr">#4886</span> <a href="viewtopic.php?pid=1522482#p1522482">2015-04-23 15:23:51</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=85100">Tyrewt</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2014-09-13</span></dd> <dd><span>Posts: 14</span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>aw wrote:</cite><blockquote><div><p><strong>AMD Bonaire and Hawaii users with reset issues</strong>, please try this QEMU patch (against v2.3.0-rc4): <a href="http://fpaste.org/214053/" rel="nofollow">http://fpaste.org/214053/</a>&#160; Report back your GPU device ID and whether resets are resolved.&#160; As noted in the patch, I expect the ultimate resolution will be a device specific reset in the kernel, this is just a prototype of that.&#160; If you do not have an AMD GPU affected by reset problems (ie. one guest boot per host boot), please don&#039;t bother with this patch.</p></div></blockquote></div><p>I&#039;m willing to test, but Ubuntu 14.04 LTS is at qemu-kvm 2.0.0+dfsg-2ubuntu1.9, would this patch still be applicable?</p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1522482">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1522515" class="blockpost roweven"> <h2><span><span class="conr">#4887</span> <a href="viewtopic.php?pid=1522515#p1522515">2015-04-23 17:31:54</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=85314">Duelist</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2014-09-22</span></dd> <dd><span>Posts: 358</span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>Parzival wrote:</cite><blockquote><div><div class="quotebox"><cite>aw wrote:</cite><blockquote><div><div class="quotebox"><cite>Parzival wrote:</cite><blockquote><div><p>I have a problem with passing through Intel HD 5000 on Intel NUC.</p></div></blockquote></div><p>IGD assignment does not work.</p></div></blockquote></div><p>Can you explain why? Will it be supported in the near future?</p></div></blockquote></div><p>You can try looking into KVMGT... As i understood their talk and presentation - they&#039;re willing to allow VMs access intel&#039;s IGD and stuff. But there&#039;s only a prototype yet.</p> </div> <div class="postsignature postmsg"><hr /><p><span class="bbs">The forum rules prohibit requesting support for distributions other than arch.</span><br /><a href="https://bbs.archlinux.org/viewtopic.php?pid=1551460#p1551460" rel="nofollow">I gave up.</a><a href="https://bbs.archlinux.org/viewtopic.php?id=162768" rel="nofollow"> It was too late.</a><br /><a href="http://pastebin.com/B3fL84bq" rel="nofollow">What I was trying to do</a>.<br /><a href="http://vfio.blogspot.com/" rel="nofollow">The reference about VFIO and KVM VGA passthrough.</a></p></div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1522515">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1522521" class="blockpost rowodd"> <h2><span><span class="conr">#4888</span> <a href="viewtopic.php?pid=1522521#p1522521">2015-04-23 17:53:40</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=77641">zir_blazer</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2013-12-12</span></dd> <dd><span>Posts: 35</span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <p>This a random comment, but I suppose it may be useful for someone. I have -finally- discovered what the Intel VT-d enabled Chipsets (Q and C Series) are useful for when compared to the non VT-d ones.</p><p>This is my lspci output, with IOMMU Group data manually added:</p><div class="codebox"><pre class="vscroll"><code>00:00.0 Host bridge: Intel Corporation Xeon E3-1200 v3 Processor DRAM Controller (rev 06) -- GROUP 0 00:01.0 PCI bridge: Intel Corporation Xeon E3-1200 v3/4th Gen Core Processor PCI Express x16 Controller (rev 06) -- GROUP 1 00:02.0 VGA compatible controller: Intel Corporation Xeon E3-1200 v3 Processor Integrated Graphics Controller (rev 06) -- GROUP 2 00:03.0 Audio device: Intel Corporation Xeon E3-1200 v3/4th Gen Core Processor HD Audio Controller (rev 06) -- GROUP 3 00:14.0 USB controller: Intel Corporation 8 Series/C220 Series Chipset Family USB xHCI (rev 05) -- GROUP 4 00:16.0 Communication controller: Intel Corporation 8 Series/C220 Series Chipset Family MEI Controller #1 (rev 04) -- GROUP 5 00:19.0 Ethernet controller: Intel Corporation Ethernet Connection I217-LM (rev 05) -- GROUP 6 00:1a.0 USB controller: Intel Corporation 8 Series/C220 Series Chipset Family USB EHCI #2 (rev 05) -- GROUP 7 00:1b.0 Audio device: Intel Corporation 8 Series/C220 Series Chipset High Definition Audio Controller (rev 05) -- GROUP 8 00:1c.0 PCI bridge: Intel Corporation 8 Series/C220 Series Chipset Family PCI Express Root Port #1 (rev d5) -- GROUP 9 00:1c.1 PCI bridge: Intel Corporation 8 Series/C220 Series Chipset Family PCI Express Root Port #2 (rev d5) -- GROUP 10 00:1c.3 PCI bridge: Intel Corporation 8 Series/C220 Series Chipset Family PCI Express Root Port #4 (rev d5) -- GROUP 11 00:1c.4 PCI bridge: Intel Corporation 8 Series/C220 Series Chipset Family PCI Express Root Port #5 (rev d5) -- GROUP 12 00:1d.0 USB controller: Intel Corporation 8 Series/C220 Series Chipset Family USB EHCI #1 (rev 05) -- GROUP 13 00:1f.0 ISA bridge: Intel Corporation C226 Series Chipset Family Server Advanced SKU LPC Controller (rev 05) -- GROUP 14 00:1f.2 SATA controller: Intel Corporation 8 Series/C220 Series Chipset Family 6-port SATA Controller 1 [AHCI mode] (rev 05) -- GROUP 14 00:1f.3 SMBus: Intel Corporation 8 Series/C220 Series Chipset Family SMBus Controller (rev 05) -- GROUP 14 00:1f.6 Signal processing controller: Intel Corporation 8 Series Chipset Family Thermal Management Controller (rev 05) -- GROUP 14 01:00.0 VGA compatible controller: Advanced Micro Devices, Inc. [AMD/ATI] Juniper XT [Radeon HD 5770] -- GROUP 1 01:00.1 Audio device: Advanced Micro Devices, Inc. [AMD/ATI] Juniper HDMI Audio [Radeon HD 5700 Series] -- GROUP 1 02:00.0 SATA controller: ASMedia Technology Inc. ASM1062 Serial ATA Controller (rev 01) -- GROUP 15 03:00.0 PCI bridge: PLX Technology, Inc. PEX 8606 6 Lane, 6 Port PCI Express Gen 2 (5.0 GT/s) Switch (rev ba) -- GROUP 16 04:01.0 PCI bridge: PLX Technology, Inc. PEX 8606 6 Lane, 6 Port PCI Express Gen 2 (5.0 GT/s) Switch (rev ba) -- GROUP 17 04:04.0 PCI bridge: PLX Technology, Inc. PEX 8606 6 Lane, 6 Port PCI Express Gen 2 (5.0 GT/s) Switch (rev ba) -- GROUP 18 04:05.0 PCI bridge: PLX Technology, Inc. PEX 8606 6 Lane, 6 Port PCI Express Gen 2 (5.0 GT/s) Switch (rev ba) -- GROUP 19 04:07.0 PCI bridge: PLX Technology, Inc. PEX 8606 6 Lane, 6 Port PCI Express Gen 2 (5.0 GT/s) Switch (rev ba) -- GROUP 20 04:09.0 PCI bridge: PLX Technology, Inc. PEX 8606 6 Lane, 6 Port PCI Express Gen 2 (5.0 GT/s) Switch (rev ba) -- GROUP 21 08:00.0 USB controller: Renesas Technology Corp. uPD720201 USB 3.0 Host Controller (rev 03) -- GROUP 22 09:00.0 PCI bridge: Texas Instruments XIO2213A/B/XIO2221 PCI Express to PCI Bridge [Cheetah Express] (rev 01) -- GROUP 23 0a:00.0 FireWire (IEEE 1394): Texas Instruments XIO2213A/B/XIO2221 IEEE-1394b OHCI Controller [Cheetah Express] (rev 01) -- GROUP 23 0b:00.0 Ethernet controller: Intel Corporation I210 Gigabit Network Connection (rev 03) -- GROUP 24</code></pre></div><br /><p>This is how a Z97 Chipset IOMMU Grouping looks like:</p><div class="codebox"><pre class="vscroll"><code>### Group 0 ### 00:00.0 Host bridge: Intel Corporation 4th Gen Core Processor DRAM Controller (rev 06) ### Group 1 ### 00:01.0 PCI bridge: Intel Corporation Xeon E3-1200 v3/4th Gen Core Processor PCI Express x16 Controller (rev 06) 01:00.0 VGA compatible controller: NVIDIA Corporation GK106 [GeForce GTX 650 OEM] (rev a1) 01:00.1 Audio device: NVIDIA Corporation GK106 HDMI Audio Controller (rev a1) ### Group 2 ### 00:02.0 VGA compatible controller: Intel Corporation Xeon E3-1200 v3/4th Gen Core Processor Integrated Graphics Controller (rev 06) ### Group 3 ### 00:03.0 Audio device: Intel Corporation Xeon E3-1200 v3/4th Gen Core Processor HD Audio Controller (rev 06) ### Group 4 ### 00:14.0 USB controller: Intel Corporation 9 Series Chipset Family USB xHCI Controller ### Group 5 ### 00:16.0 Communication controller: Intel Corporation 9 Series Chipset Family ME Interface #1 ### Group 6 ### 00:19.0 Ethernet controller: Intel Corporation Ethernet Connection (2) I218-V ### Group 7 ### 00:1a.0 USB controller: Intel Corporation 9 Series Chipset Family USB EHCI Controller #2 ### Group 8 ### 00:1b.0 Audio device: Intel Corporation 9 Series Chipset Family HD Audio Controller ### Group 9 ### 00:1c.0 PCI bridge: Intel Corporation 9 Series Chipset Family PCI Express Root Port 1 (rev d0) 00:1c.3 PCI bridge: Intel Corporation 9 Series Chipset Family PCI Express Root Port 4 (rev d0) 00:1c.6 PCI bridge: Intel Corporation 9 Series Chipset Family PCI Express Root Port 7 (rev d0) 03:00.0 PCI bridge: ASMedia Technology Inc. Device 1184 04:01.0 PCI bridge: ASMedia Technology Inc. Device 1184 04:03.0 PCI bridge: ASMedia Technology Inc. Device 1184 04:05.0 PCI bridge: ASMedia Technology Inc. Device 1184 04:07.0 PCI bridge: ASMedia Technology Inc. Device 1184 06:00.0 SATA controller: ASMedia Technology Inc. ASM1062 Serial ATA Controller (rev 02) 08:00.0 SATA controller: ASMedia Technology Inc. ASM1062 Serial ATA Controller (rev 02) 09:00.0 USB controller: ASMedia Technology Inc. ASM1042A USB 3.0 Host Controller ### Group 10 ### 00:1d.0 USB controller: Intel Corporation 9 Series Chipset Family USB EHCI Controller #1 ### Group 11 ### 00:1f.0 ISA bridge: Intel Corporation 9 Series Chipset Family Z97 LPC Controller 00:1f.2 SATA controller: Intel Corporation 9 Series Chipset Family SATA Controller [AHCI Mode] 00:1f.3 SMBus: Intel Corporation 9 Series Chipset Family SMBus Controller</code></pre></div><p>Notice Group 9. Everything that is attached to the Chipset PCIe Lanes is one stupid big group, while I have nearly everything in its own Group. So for anyone that is interesed in using proper Server Motherboards, you will have more isolating capabilities.</p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1522521">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1522524" class="blockpost roweven"> <h2><span><span class="conr">#4889</span> <a href="viewtopic.php?pid=1522524#p1522524">2015-04-23 17:59:59</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=75590">aw</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2013-10-04</span></dd> <dd><span>Posts: 921</span></dd> <dd class="usercontacts"><span class="email"><a href="misc.php?email=75590">Email</a></span> <span class="website"><a href="http://vfio.blogspot.com/" rel="nofollow">Website</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>zir_blazer wrote:</cite><blockquote><div><p>Notice Group 9. Everything that is attached to the Chipset PCIe Lanes is one stupid big group, while I have nearly everything in its own Group. So for anyone that is interesed in using proper Server Motherboards, you will have more isolating capabilities.</p></div></blockquote></div><p>Update your kernel, quirks for Lynxpoint PCH root ports were added in 3.15.</p> </div> <div class="postsignature postmsg"><hr /><p><a href="http://vfio.blogspot.com" rel="nofollow">http://vfio.blogspot.com</a><br />Looking for a more open forum to discuss vfio related uses?&#160; Try <a href="https://www.redhat.com/mailman/listinfo/vfio-users" rel="nofollow">https://www.redhat.com/mailman/listinfo/vfio-users</a></p></div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1522524">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1522530" class="blockpost rowodd"> <h2><span><span class="conr">#4890</span> <a href="viewtopic.php?pid=1522530#p1522530">2015-04-23 18:24:46</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=77641">zir_blazer</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2013-12-12</span></dd> <dd><span>Posts: 35</span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>aw wrote:</cite><blockquote><div><div class="quotebox"><cite>zir_blazer wrote:</cite><blockquote><div><p>Notice Group 9. Everything that is attached to the Chipset PCIe Lanes is one stupid big group, while I have nearly everything in its own Group. So for anyone that is interesed in using proper Server Motherboards, you will have more isolating capabilities.</p></div></blockquote></div><p>Update your kernel, quirks for Lynxpoint PCH root ports were added in 3.15.</p></div></blockquote></div><p>My computer is the first one with a C226, the other is from here:<br /><a href="http://ubuntuforums.org/showthread.php?t=2267428&amp;p=13237568#post13237568" rel="nofollow">http://ubuntuforums.org/showthread.php? … st13237568</a></p><p>I&#039;m using Kernel 3.17.1, the other guy says he has 3.16. I wasn&#039;t aware that the grouping was related to a quirck. Got a more recent IOMMU Group list on a non-Q or C Chipset too see it fixed?<br />So far, I was unable to find what makes the VT-d support on these Chipsets useful for. I through than the IOMMU Grouping difference made sense.</p> <p class="postedit"><em>Last edited by zir_blazer (2015-04-23 18:27:28)</em></p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1522530">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1522540" class="blockpost roweven"> <h2><span><span class="conr">#4891</span> <a href="viewtopic.php?pid=1522540#p1522540">2015-04-23 19:01:04</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=75590">aw</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2013-10-04</span></dd> <dd><span>Posts: 921</span></dd> <dd class="usercontacts"><span class="email"><a href="misc.php?email=75590">Email</a></span> <span class="website"><a href="http://vfio.blogspot.com/" rel="nofollow">Website</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>zir_blazer wrote:</cite><blockquote><div><div class="quotebox"><cite>aw wrote:</cite><blockquote><div><div class="quotebox"><cite>zir_blazer wrote:</cite><blockquote><div><p>Notice Group 9. Everything that is attached to the Chipset PCIe Lanes is one stupid big group, while I have nearly everything in its own Group. So for anyone that is interesed in using proper Server Motherboards, you will have more isolating capabilities.</p></div></blockquote></div><p>Update your kernel, quirks for Lynxpoint PCH root ports were added in 3.15.</p></div></blockquote></div><p>My computer is the first one with a C226, the other is from here:<br /><a href="http://ubuntuforums.org/showthread.php?t=2267428&amp;p=13237568#post13237568" rel="nofollow">http://ubuntuforums.org/showthread.php? … st13237568</a></p><p>I&#039;m using Kernel 3.17.1, the other guy says he has 3.16. I wasn&#039;t aware that the grouping was related to a quirck. Got a more recent IOMMU Group list on a non-Q or C Chipset too see it fixed?<br />So far, I was unable to find what makes the VT-d support on these Chipsets useful for. I through than the IOMMU Grouping difference made sense.</p></div></blockquote></div><p>Ah, sorry I keyed on the 8-series chipset, that one is quirked and I&#039;m currently harassing Intel about the 9-series.&#160; TBH, I have no idea what you&#039;re talking about with Q vs C chipsets.&#160; The reason that anything without native ACS allows smaller IOMMU groups is because we have quirks in the kernel that enable non-standard isolation within the chipset/device.</p> </div> <div class="postsignature postmsg"><hr /><p><a href="http://vfio.blogspot.com" rel="nofollow">http://vfio.blogspot.com</a><br />Looking for a more open forum to discuss vfio related uses?&#160; Try <a href="https://www.redhat.com/mailman/listinfo/vfio-users" rel="nofollow">https://www.redhat.com/mailman/listinfo/vfio-users</a></p></div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1522540">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1522547" class="blockpost rowodd"> <h2><span><span class="conr">#4892</span> <a href="viewtopic.php?pid=1522547#p1522547">2015-04-23 19:27:04</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=77641">zir_blazer</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2013-12-12</span></dd> <dd><span>Posts: 35</span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <p>I&#039;m talking about this: <a href="http://ark.intel.com/compare/75522,75016,75010,75019,75004,75007,75013,75516,75519,82010,82012,40711,27215" rel="nofollow">http://ark.intel.com/compare/75522,7501 … 0711,27215</a></p><p>Intel says that for LGA 1150, only the Q87 and C222, C224 and C226 Chipsets supports VT-d. The point is, what you actually need VT-d Chipset support for? Before I builded my current system (Xeon E3-1245V3 and a Supermicro X10SAT), I spend around six months researching if you needed Chipset support or not, since there was a lot of contradicting info. Some people said and proved that with only Processor VT-d support you could get Passthrough working, but you had manufacturers like ASUS that instead claimed that they didn&#039;t supported VT-d on typical H or Z-Chipsets based Motherboard since a VT-d Chipset was required too. I decided to play safe and go Server.<br />What I found out by looking at a few lists of IOMMU Groups like the one I linked, is that on consumer Motherboards, they usually have a single huge group for the Chipset&#039;s PCIe Lanes. Instead, on mine, nearly each device has its own group. Keep in mind that this is using only intel_iommu=on on the Boot Loader config file, there is no Kernel patch or anything else applied, its pretty much a very dull Arch Linux install, since I am using it as Dom0 for Xen, but I&#039;m looking at KVM in case I get a new GeForce. Because during an entire year I found no other explanation with a practical example, I concluded that Intel calls VT-d support on the Chipset, one that implements IOMMU for the devices connected to its PCIe Controller. I think I saw some people that applied the ACS override patch and their IOMMU Group list looked like mine, but not out of the box. But I didn&#039;t paid attention to other details like the Kernel, or quircks like the one that you mention, so I don&#039;t know if my theory is true or not.</p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1522547">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1522553" class="blockpost roweven"> <h2><span><span class="conr">#4893</span> <a href="viewtopic.php?pid=1522553#p1522553">2015-04-23 19:41:28</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=75590">aw</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2013-10-04</span></dd> <dd><span>Posts: 921</span></dd> <dd class="usercontacts"><span class="email"><a href="misc.php?email=75590">Email</a></span> <span class="website"><a href="http://vfio.blogspot.com/" rel="nofollow">Website</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>zir_blazer wrote:</cite><blockquote><div><p>I&#039;m talking about this: <a href="http://ark.intel.com/compare/75522,75016,75010,75019,75004,75007,75013,75516,75519,82010,82012,40711,27215" rel="nofollow">http://ark.intel.com/compare/75522,7501 … 0711,27215</a></p><p>Intel says that for LGA 1150, only the Q87 and C222, C224 and C226 Chipsets supports VT-d. The point is, what you actually need VT-d Chipset support for? Before I builded my current system (Xeon E3-1245V3 and a Supermicro X10SAT), I spend around six months researching if you needed Chipset support or not, since there was a lot of contradicting info. Some people said and proved that with only Processor VT-d support you could get Passthrough working, but you had manufacturers like ASUS that instead claimed that they didn&#039;t supported VT-d on typical H or Z-Chipsets based Motherboard since a VT-d Chipset was required too. I decided to play safe and go Server.<br />What I found out by looking at a few lists of IOMMU Groups like the one I linked, is that on consumer Motherboards, they usually have a single huge group for the Chipset&#039;s PCIe Lanes. Instead, on mine, nearly each device has its own group. Keep in mind that this is using only intel_iommu=on on the Boot Loader config file, there is no Kernel patch or anything else applied, its pretty much a very dull Arch Linux install, since I am using it as Dom0 for Xen, but I&#039;m looking at KVM in case I get a new GeForce. Because during an entire year I found no other explanation with a practical example, I concluded that Intel calls VT-d support on the Chipset, one that implements IOMMU for the devices connected to its PCIe Controller. I think I saw some people that applied the ACS override patch and their IOMMU Group list looked like mine, but not out of the box. But I didn&#039;t paid attention to other details like the Kernel, or quircks like the one that you mention, so I don&#039;t know if my theory is true or not.</p></div></blockquote></div><p>I guess I should stop using VT-d on my H67 desktop then, Intel® Virtualization Technology for Directed I/O (VT-d):&#160; &#160; No</p><p>It is a good idea to use server-class hardware, but you really need to go up to Xeon E5 or better to make any difference or make Intel actually care about supporting native ACS.&#160; In the early days of VT-d, back when there was an MCH (Memory Controller HUB) and IOH (I/O Hub), VT-d support in the chipset was required.&#160; The processor wasn&#039;t involved in the IOMMU.&#160; The IOMMU needed to live between I/O and memory, which the processor was not.&#160; However, when the memory controller was pulled into the CPU, along with (sometimes) integrated graphics, and high speed root ports, VT-d also needed to move into the processor.&#160; I don&#039;t really know what Intel is trying to say with that entry in ARK, whether it&#039;s any indication of actual support, or just a glitch in their database, but I&#039;m pretty sure the difference between your 8-series having separate IOMMU groups and the 9-series not is software, not hardware.&#160; Maybe Intel will be less willing to provide us with quirks if there&#039;s no server versions of a given chipset.</p> </div> <div class="postsignature postmsg"><hr /><p><a href="http://vfio.blogspot.com" rel="nofollow">http://vfio.blogspot.com</a><br />Looking for a more open forum to discuss vfio related uses?&#160; Try <a href="https://www.redhat.com/mailman/listinfo/vfio-users" rel="nofollow">https://www.redhat.com/mailman/listinfo/vfio-users</a></p></div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1522553">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1522601" class="blockpost rowodd"> <h2><span><span class="conr">#4894</span> <a href="viewtopic.php?pid=1522601#p1522601">2015-04-23 21:58:20</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=85314">Duelist</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2014-09-22</span></dd> <dd><span>Posts: 358</span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>aw wrote:</cite><blockquote><div><p>It is a good idea to use server-class hardware, but you really need to go up to Xeon E5 or better to make any difference or make Intel actually care about supporting native ACS.</p></div></blockquote></div><p>So we&#039;re back to basics, eh?<br />&quot;If you want stability and even some support from the manufacturer - use expensive server-class hardware.&quot;<br />Cheapest Xeon E5 costs more that my whole PC.<br />Are you sure that this breakage and lack of isolation and more quirks coming from newer hardware isn&#039;t &quot;accidental&quot; like it was with nvidia?</p> </div> <div class="postsignature postmsg"><hr /><p><span class="bbs">The forum rules prohibit requesting support for distributions other than arch.</span><br /><a href="https://bbs.archlinux.org/viewtopic.php?pid=1551460#p1551460" rel="nofollow">I gave up.</a><a href="https://bbs.archlinux.org/viewtopic.php?id=162768" rel="nofollow"> It was too late.</a><br /><a href="http://pastebin.com/B3fL84bq" rel="nofollow">What I was trying to do</a>.<br /><a href="http://vfio.blogspot.com/" rel="nofollow">The reference about VFIO and KVM VGA passthrough.</a></p></div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1522601">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1522605" class="blockpost roweven"> <h2><span><span class="conr">#4895</span> <a href="viewtopic.php?pid=1522605#p1522605">2015-04-23 22:18:30</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=75590">aw</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2013-10-04</span></dd> <dd><span>Posts: 921</span></dd> <dd class="usercontacts"><span class="email"><a href="misc.php?email=75590">Email</a></span> <span class="website"><a href="http://vfio.blogspot.com/" rel="nofollow">Website</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>Duelist wrote:</cite><blockquote><div><div class="quotebox"><cite>aw wrote:</cite><blockquote><div><p>It is a good idea to use server-class hardware, but you really need to go up to Xeon E5 or better to make any difference or make Intel actually care about supporting native ACS.</p></div></blockquote></div><p>So we&#039;re back to basics, eh?<br />&quot;If you want stability and even some support from the manufacturer - use expensive server-class hardware.&quot;<br />Cheapest Xeon E5 costs more that my whole PC.<br />Are you sure that this breakage and lack of isolation and more quirks coming from newer hardware isn&#039;t &quot;accidental&quot; like it was with nvidia?</p></div></blockquote></div><p>Oh come on, is invoking Nvidia the new Godwin&#039;s law for this thread?&#160; ACS and device isolation is a high-end feature.&#160; I think it&#039;s caught Intel by surprise that yes, they do need to advertise the isolation of devices and no, VT-d isn&#039;t much use without it.&#160; We&#039;ve also been quirking Intel 10G NICs to expose isolation, along with workstation and server class chipsets like X79 and X99.&#160; How does that fit into your conspiracy theory?&#160; If we&#039;ve sparked change in the consumer class products, it may be a couple years before those products start leaving the fab.&#160; In the meantime, we&#039;re getting pretty good cooperation.&#160; Maybe there are technical reasons why we&#039;re not getting quirks for client CPUs.&#160; Maybe the thing that enables SLI/Crossfire is lack of isolation.&#160; I don&#039;t know.</p><p>Furthermore, the cheapest E5 Xeons I see on newegg are around $200US, so if your PC is that crappy, maybe you could use an upgrade.</p> <p class="postedit"><em>Last edited by aw (2015-04-23 22:22:48)</em></p> </div> <div class="postsignature postmsg"><hr /><p><a href="http://vfio.blogspot.com" rel="nofollow">http://vfio.blogspot.com</a><br />Looking for a more open forum to discuss vfio related uses?&#160; Try <a href="https://www.redhat.com/mailman/listinfo/vfio-users" rel="nofollow">https://www.redhat.com/mailman/listinfo/vfio-users</a></p></div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1522605">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1522635" class="blockpost rowodd"> <h2><span><span class="conr">#4896</span> <a href="viewtopic.php?pid=1522635#p1522635">2015-04-24 01:16:21</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=85314">Duelist</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2014-09-22</span></dd> <dd><span>Posts: 358</span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>aw wrote:</cite><blockquote><div><div class="quotebox"><cite>Duelist wrote:</cite><blockquote><div><div class="quotebox"><cite>aw wrote:</cite><blockquote><div><p>It is a good idea to use server-class hardware, but you really need to go up to Xeon E5 or better to make any difference or make Intel actually care about supporting native ACS.</p></div></blockquote></div><p>So we&#039;re back to basics, eh?<br />&quot;If you want stability and even some support from the manufacturer - use expensive server-class hardware.&quot;<br />Cheapest Xeon E5 costs more that my whole PC.<br />Are you sure that this breakage and lack of isolation and more quirks coming from newer hardware isn&#039;t &quot;accidental&quot; like it was with nvidia?</p></div></blockquote></div><p>Oh come on, is invoking Nvidia the new Godwin&#039;s law for this thread?&#160; ACS and device isolation is a high-end feature.&#160; I think it&#039;s caught Intel by surprise that yes, they do need to advertise the isolation of devices and no, VT-d isn&#039;t much use without it.&#160; We&#039;ve also been quirking Intel 10G NICs to expose isolation, along with workstation and server class chipsets like X79 and X99.&#160; How does that fit into your conspiracy theory?&#160; If we&#039;ve sparked change in the consumer class products, it may be a couple years before those products start leaving the fab.&#160; In the meantime, we&#039;re getting pretty good cooperation.&#160; Maybe there are technical reasons why we&#039;re not getting quirks for client CPUs.&#160; Maybe the thing that enables SLI/Crossfire is lack of isolation.&#160; I don&#039;t know.</p><p>Furthermore, the cheapest E5 Xeons I see on newegg are around $200US, so if your PC is that crappy, maybe you could use an upgrade.</p></div></blockquote></div><p>I just find it strange that AMD, being the main and the only &quot;rival&quot; of intel on HPC and desktop markets have no problems with this... right? I agree, sometimes they have different problems, like <a href="http://support.amd.com/TechDocs/42300_15h_Mod_10h-1Fh_BKDG.pdf" rel="nofollow">minor or major bugs</a> or firmware support. Their problems are different.<br />If i recall correctly, IOMMU feature was present and was even working on athlon 64 x2 series of CPUs, that was, like, eight years ago. That sparkles my curiosity to try using vfio on these platforms and see how it works. (sadly, my local hardware mess-market was closed some time ago due to fire safety concerns)</p><p>I just can&#039;t conclude anything viable from this situation - all I see now is a lot of quirks and patches and cooperation related solely to intel.<br />Maybe their CPUs are more widespread?.. Or they are more &quot;open&quot; to the community(considering the open-source work they do)? Or, maybe, their hardware is more troublesome? Or this ACS isn&#039;t even present on AMD systems, and nobody noticed it?</p><p>P.S.<br />Cheapest modern Xeon E5 <span class="bbu">in my <span class="bbs">area</span>country</span> costs around 1000$.<br />P.P.S.<br />Godwin&#039;s law, heh, I see what you did there.</p> </div> <div class="postsignature postmsg"><hr /><p><span class="bbs">The forum rules prohibit requesting support for distributions other than arch.</span><br /><a href="https://bbs.archlinux.org/viewtopic.php?pid=1551460#p1551460" rel="nofollow">I gave up.</a><a href="https://bbs.archlinux.org/viewtopic.php?id=162768" rel="nofollow"> It was too late.</a><br /><a href="http://pastebin.com/B3fL84bq" rel="nofollow">What I was trying to do</a>.<br /><a href="http://vfio.blogspot.com/" rel="nofollow">The reference about VFIO and KVM VGA passthrough.</a></p></div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1522635">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1522638" class="blockpost roweven"> <h2><span><span class="conr">#4897</span> <a href="viewtopic.php?pid=1522638#p1522638">2015-04-24 01:39:16</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=75590">aw</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2013-10-04</span></dd> <dd><span>Posts: 921</span></dd> <dd class="usercontacts"><span class="email"><a href="misc.php?email=75590">Email</a></span> <span class="website"><a href="http://vfio.blogspot.com/" rel="nofollow">Website</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>Duelist wrote:</cite><blockquote><div><p>I just find it strange that AMD, being the main and the only &quot;rival&quot; of intel on HPC and desktop markets have no problems with this... right? I agree, sometimes they have different problems, like <a href="http://support.amd.com/TechDocs/42300_15h_Mod_10h-1Fh_BKDG.pdf" rel="nofollow">minor or major bugs</a> or firmware support. Their problems are different.</p></div></blockquote></div><p>False, while AMD did manage to get ACS on root ports, we still have ACS quirks for other AMD devices.</p><div class="quotebox"><blockquote><div><p>If i recall correctly, IOMMU feature was present and was even working on athlon 64 x2 series of CPUs, that was, like, eight years ago. That sparkles my curiosity to try using vfio on these platforms and see how it works. (sadly, my local hardware mess-market was closed some time ago due to fire safety concerns)</p></div></blockquote></div><p>False, while AMD-IOMMU specs were maybe out before VT-d, it was incredibly difficult to get actual AMD-Vi hardware until well after Intel.&#160; You certainly won&#039;t find it on Athlon 64 hardware with AMD-Vi.</p><div class="quotebox"><blockquote><div><p>I just can&#039;t conclude anything viable from this situation - all I see now is a lot of quirks and patches and cooperation related solely to intel.<br />Maybe their CPUs are more widespread?.. Or they are more &quot;open&quot; to the community(considering the open-source work they do)? Or, maybe, their hardware is more troublesome? Or this ACS isn&#039;t even present on AMD systems, and nobody noticed it?</p></div></blockquote></div><p>Intel is <strong>far</strong> more widespread than AMD and they make far more devices.&#160; They not only have more chipsets, but they rev them more often.&#160; Take for instance the AMD 900-series chipset that started shipping in 2011 and is <strong>still</strong> the latest chipset for non-APU AMD processors.&#160; That was about the same time Intel was shipping the 6-series chipset.&#160; Since then Intel also shipped the 7-series, 8-series, and 9-series as well as X79 and X99.&#160; Not to mention all the peripherals.</p> </div> <div class="postsignature postmsg"><hr /><p><a href="http://vfio.blogspot.com" rel="nofollow">http://vfio.blogspot.com</a><br />Looking for a more open forum to discuss vfio related uses?&#160; Try <a href="https://www.redhat.com/mailman/listinfo/vfio-users" rel="nofollow">https://www.redhat.com/mailman/listinfo/vfio-users</a></p></div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1522638">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1522668" class="blockpost rowodd"> <h2><span><span class="conr">#4898</span> <a href="viewtopic.php?pid=1522668#p1522668">2015-04-24 06:05:43</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=90593">mqddb</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2015-04-24</span></dd> <dd><span>Posts: 5</span></dd> <dd class="usercontacts"><span class="email"><a href="mailto:maqiang@shencloudtech.com">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <p>Hello everyone:<br />&#160; &#160; &#160; Will this vga-passthrough can support spice protocol? currently, spice only support qxl vga.</p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1522668">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1522678" class="blockpost roweven"> <h2><span><span class="conr">#4899</span> <a href="viewtopic.php?pid=1522678#p1522678">2015-04-24 06:49:30</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=77641">zir_blazer</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2013-12-12</span></dd> <dd><span>Posts: 35</span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>aw wrote:</cite><blockquote><div><p>I don&#039;t really know what Intel is trying to say with that entry in ARK, whether it&#039;s any indication of actual support, or just a glitch in their database, but I&#039;m pretty sure the difference between your 8-series having separate IOMMU groups and the 9-series not is software, not hardware.&#160; Maybe Intel will be less willing to provide us with quirks if there&#039;s no server versions of a given chipset.</p></div></blockquote></div><div class="quotebox"><cite>aw wrote:</cite><blockquote><div><p>ACS and device isolation is a high-end feature.</p></div></blockquote></div><p>That is my point. What I try to say is that is intentional that on consumer Chipsets you get a single group with the PCI Controller Ports and everything else below it. On C226 I got it working out of the box since its a Workstation/Server Chipset, I didn&#039;t had to apply patchs or anything to see nearly everything in its own group. It seems that what you&#039;re applying quircks to, is to force to enable it anyways (Similar to Intel only allowing you to use the Unlocked Multiplier of their K Series Processors on Z Chipset Motherboards, while some manufacturers discovered ways to bypass that to overclock in cheaper Chipsets: <a href="http://www.xbitlabs.com/news/mainboards/display/20130627185823_Asrock_Confirms_Non_Z_CPU_Multiplier_Overclocking_Feature_on_Mainstream_Mainboards.html" rel="nofollow">http://www.xbitlabs.com/news/mainboards … oards.html</a> ). Since you were unaware that Intel sells VT-d support as an extra feature in some Chipsets at the first place, its probable that these quircks are related to that.<br />What I&#039;m missing is having a lot of IOMMU Groups examples on different platforms. I know how mine in a C226 looks. I know the guy with the Z97 that I posted (Which I think he mentioned to not be using the ACS Override patch), and recall a few more consumer platforms with that same arrangement on other Desktop 8-Series. It is not in-depth enough to confirm this, but I&#039;m inclined to believe than that is what VT-d support on the Chipset means for Intel. It seems that the IOMMU isolation capabilities are exclusive for the Chipset PCIe Controller instead of a global one.</p><div class="quotebox"><cite>aw wrote:</cite><blockquote><div><p>along with workstation and server class chipsets like X79 and X99.</p></div></blockquote></div><p>These are high end Desktop. Workstation and Server class are their same-silicon and more expensive C counterparts, C202, C204 and C206 for Sandy Bridge-E/Ivy Bridge-E, and C216 for Haswell-E.</p><br /><div class="quotebox"><cite>Duelist wrote:</cite><blockquote><div><p>If i recall correctly, IOMMU feature was present and was even working on athlon 64 x2 series of CPUs, that was, like, eight years ago. That sparkles my curiosity to try using vfio on these platforms and see how it works. (sadly, my local hardware mess-market was closed some time ago due to fire safety concerns)</p></div></blockquote></div><p>AMD-Vi was first supported on Desktop Chipsets with the 890FX, that was during the Phenom II era. 990FX supports it too. However, Bulldozer and derivated processors also incorporate their own IOMMU, so you don&#039;t need Chipset (Similar to Intel).</p> <p class="postedit"><em>Last edited by zir_blazer (2015-04-24 06:50:40)</em></p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1522678">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1522754" class="blockpost rowodd"> <h2><span><span class="conr">#4900</span> <a href="viewtopic.php?pid=1522754#p1522754">2015-04-24 12:50:00</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=75590">aw</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2013-10-04</span></dd> <dd><span>Posts: 921</span></dd> <dd class="usercontacts"><span class="email"><a href="misc.php?email=75590">Email</a></span> <span class="website"><a href="http://vfio.blogspot.com/" rel="nofollow">Website</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>mqddb wrote:</cite><blockquote><div><p>Hello everyone:<br />&#160; &#160; &#160; Will this vga-passthrough can support spice protocol? currently, spice only support qxl vga.</p></div></blockquote></div><p>No, an assigned GPU does not support any of the -display methods.&#160; Remote displays with GPU assignment requires guest-based solutions.</p> </div> <div class="postsignature postmsg"><hr /><p><a href="http://vfio.blogspot.com" rel="nofollow">http://vfio.blogspot.com</a><br />Looking for a more open forum to discuss vfio related uses?&#160; Try <a href="https://www.redhat.com/mailman/listinfo/vfio-users" rel="nofollow">https://www.redhat.com/mailman/listinfo/vfio-users</a></p></div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1522754">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div class="postlinksb"> <div class="inbox crumbsplus"> <div class="pagepost"> <p class="pagelink conl"><span class="pages-label">Pages: </span><a rel="prev" class="item1" href="viewtopic.php?id=162768&amp;p=195">Previous</a> <a href="viewtopic.php?id=162768">1</a> <span class="spacer">…</span> <a href="viewtopic.php?id=162768&amp;p=194">194</a> <a href="viewtopic.php?id=162768&amp;p=195">195</a> <strong>196</strong> <a href="viewtopic.php?id=162768&amp;p=197">197</a> <a href="viewtopic.php?id=162768&amp;p=198">198</a> <span class="spacer">…</span> <a href="viewtopic.php?id=162768&amp;p=234">234</a> <a rel="next" href="viewtopic.php?id=162768&amp;p=197">Next</a></p> <p class="postlink conr">Topic closed</p> </div> <ul class="crumbs"> <li><a href="index.php">Index</a></li> <li><span>»&#160;</span><a href="viewforum.php?id=48">Topics Going Nowhere</a></li> <li><span>»&#160;</span><strong><a href="viewtopic.php?id=162768">KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</a></strong></li> </ul> <p class="subscribelink clearb"><a href="misc.php?action=subscribe&amp;tid=162768">Subscribe to this topic</a></p> <div class="clearer"></div> </div> </div> </div> <div id="brdfooter" class="block"> <h2><span>Board footer</span></h2> <div class="box"> <div id="brdfooternav" class="inbox"> <div class="conl"> <form id="qjump" method="get" action="viewforum.php"> <div><label><span>Jump to<br /></span> <select name="id" onchange="window.location=('viewforum.php?id='+this.options[this.selectedIndex].value)"> <optgroup label="Technical Issues and Assistance"> <option value="23">Newbie Corner</option> <option value="17">Installation</option> <option value="22">Kernel &amp; Hardware</option> <option value="18">Applications &amp; Desktop Environments</option> <option value="31">Laptop Issues</option> <option value="8">Networking, Server, and Protection</option> <option value="32">Multimedia and Games</option> <option value="50">System Administration</option> <option value="35">Other Architectures</option> </optgroup> <optgroup label="Arch-centric"> <option value="24">Announcements, Package &amp; Security Advisories</option> <option value="1">Arch Discussion</option> <option value="13">Forum &amp; Wiki discussion</option> </optgroup> <optgroup label="Pacman Upgrades, Packaging &amp; AUR"> <option value="44">Pacman &amp; Package Upgrade Issues</option> <option value="49">[testing] Repo Forum</option> <option value="4">Creating &amp; Modifying Packages</option> <option value="38">AUR Issues, Discussion &amp; PKGBUILD Requests</option> </optgroup> <optgroup label="Contributions &amp; Discussion"> <option value="20">GNU/Linux Discussion</option> <option value="27">Community Contributions</option> <option value="33">Programming &amp; Scripting</option> <option value="30">Other Languages</option> <option value="47">Artwork and Screenshots</option> <option value="42">Try This</option> </optgroup> <optgroup label="/dev/null"> <option value="29">Off-Topic</option> <option value="48" selected="selected">Topics Going Nowhere</option> <option value="36">Dustbin</option> </optgroup> </select></label> <input type="submit" value=" Go " accesskey="g" /> </div> </form> </div> <div class="conr"> <p id="feedlinks"><span class="atom"><a href="extern.php?action=feed&amp;tid=162768&amp;type=atom">Atom topic feed</a></span></p> <p id="poweredby">Powered by <a href="http://fluxbb.org/">FluxBB</a></p> </div> <div class="clearer"></div> </div> </div> </div> </div> <div class="end-box"></div> </div> </body> </html>
