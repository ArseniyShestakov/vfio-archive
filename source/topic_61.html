<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"> <html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en" dir="ltr"> <head> <meta http-equiv="Content-Type" content="text/html; charset=utf-8" /> <title>KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9 (Page 61) / Topics Going Nowhere / Arch Linux Forums</title> <link rel="stylesheet" type="text/css" href="style/ArchLinux.css" /> <link rel="canonical" href="viewtopic.php?id=162768&amp;p=61" title="Page 61" /> <link rel="prev" href="viewtopic.php?id=162768&amp;p=60" title="Page 60" /> <link rel="next" href="viewtopic.php?id=162768&amp;p=62" title="Page 62" /> <link rel="alternate" type="application/atom+xml" href="extern.php?action=feed&amp;tid=162768&amp;type=atom" title="Atom topic feed" /> <link rel="stylesheet" media="screen" href="style/ArchLinux/arch.css?v=3" /> <link rel="stylesheet" media="screen" href="style/ArchLinux/archnavbar.css?v=2" /> <link rel="shortcut icon" href="style/ArchLinux/favicon.ico" /> </head> <body> <div id="archnavbar" class="anb-forum"> <div id="archnavbarlogo"><h1><a href="http://www.archlinux.org/">Arch Linux</a></h1></div> <div id="archnavbarmenu"> <ul id="archnavbarlist"> <li id="anb-home"><a href="http://www.archlinux.org/">Home</a></li><li id="anb-packages"><a href="http://www.archlinux.org/packages/">Packages</a></li><li id="anb-forums" class="anb-selected"><a href="https://bbs.archlinux.org/">Forums</a></li><li id="anb-wiki"><a href="https://wiki.archlinux.org/">Wiki</a></li><li id="anb-bugs"><a href="https://bugs.archlinux.org/">Bugs</a></li><li id="anb-aur"><a href="https://aur.archlinux.org/">AUR</a></li><li id="anb-download"><a href="http://www.archlinux.org/download/">Download</a></li> </ul> </div> </div> <div id="punviewtopic" class="pun"> <div class="top-box"></div> <div class="punwrap"> <div id="brdheader" class="block"> <div class="box"> <div id="brdmenu" class="inbox"> <ul> <li id="navindex" class="isactive"><a href="index.php">Index</a></li> <li id="navuserlist"><a href="userlist.php">User list</a></li> <li id="navsearch"><a href="search.php">Search</a></li> <li id="navprofile"><a href="profile.php?id=80749">Profile</a></li> <li id="navlogout"><a href="login.php?action=out&amp;id=80749&amp;csrf_token=5c20501ec397bb45ef8ee8c84db232c8d8e421c6">Logout</a></li> </ul> </div> <div id="brdwelcome" class="inbox"> <ul class="conl"> <li><span>Logged in as <strong>SXX</strong></span></li> <li><span>Last visit: 2015-08-16 12:20:09</span></li> </ul> <ul class="conr"> <li><span>Topics: <a href="search.php?action=show_replies" title="Find topics you have posted to.">Posted</a> | <a href="search.php?action=show_new" title="Find topics with new posts since your last visit.">New</a> | <a href="search.php?action=show_recent" title="Find topics with recent posts.">Active</a> | <a href="search.php?action=show_unanswered" title="Find topics with no replies.">Unanswered</a></span></li> </ul> <div class="clearer"></div> </div> </div> </div> <div id="brdmain"> <div class="linkst"> <div class="inbox crumbsplus"> <ul class="crumbs"> <li><a href="index.php">Index</a></li> <li><span>»&#160;</span><a href="viewforum.php?id=48">Topics Going Nowhere</a></li> <li><span>»&#160;</span><strong><a href="viewtopic.php?id=162768">KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</a></strong></li> </ul> <div class="pagepost"> <p class="pagelink conl"><span class="pages-label">Pages: </span><a rel="prev" class="item1" href="viewtopic.php?id=162768&amp;p=60">Previous</a> <a href="viewtopic.php?id=162768">1</a> <span class="spacer">…</span> <a href="viewtopic.php?id=162768&amp;p=59">59</a> <a href="viewtopic.php?id=162768&amp;p=60">60</a> <strong>61</strong> <a href="viewtopic.php?id=162768&amp;p=62">62</a> <a href="viewtopic.php?id=162768&amp;p=63">63</a> <span class="spacer">…</span> <a href="viewtopic.php?id=162768&amp;p=234">234</a> <a rel="next" href="viewtopic.php?id=162768&amp;p=62">Next</a></p> <p class="postlink conr">Topic closed</p> </div> <div class="clearer"></div> </div> </div> <div id="p1401444" class="blockpost rowodd blockpost1"> <h2><span><span class="conr">#1501</span> <a href="viewtopic.php?pid=1401444#p1401444">2014-04-07 01:23:31</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=80920">Nex7</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2014-04-06</span></dd> <dd><span>Posts: 5</span></dd> <dd class="usercontacts"><span class="email"><a href="misc.php?email=80920">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>Cubex wrote:</cite><blockquote><div><p>Hello Nex7, I am issuing the same problems, everything works until I install the nvidia driver on Win7</p></div></blockquote></div><p>Hey Cubex, I haven&#039;t yet gotten this to work, BUT, I have good news for you, IF you have qemu-1.7.4 or less (you probably have 1.7.0 like I did, from &#039;pacman -S qemu&#039;). You need 1.7.5+. I can confirm that with the latest &#039;qemu-git&#039; (and &#039;seabios-git&#039;), my VM was able to boot into Windows with graphics, but a bunch of other crap was screwed up. I am currently attributing this to TOO NEW a qemu, since the qemu-git package seems to be grabbing the absolute bleeding edge. After dinner I will try to get the package to pull down something post 1.7.5 but not bleeding edge.</p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1401444">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1401511" class="blockpost roweven"> <h2><span><span class="conr">#1502</span> <a href="viewtopic.php?pid=1401511#p1401511">2014-04-07 09:08:41</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=80028">trimm</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2014-03-06</span></dd> <dd><span>Posts: 31</span></dd> <dd class="usercontacts"><span class="email"><a href="misc.php?email=80028">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <p>nbhs: Could you perhaps tell us when you update qemu-git and seabios-git aswell? Or are these the same packages we get from AUR?</p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1401511">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1401801" class="blockpost rowodd"> <h2><span><span class="conr">#1503</span> <a href="viewtopic.php?pid=1401801#p1401801">2014-04-08 03:56:38</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=70922">nbhs</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd class="postavatar"><img src="https://bbs.archlinux.org/img/avatars/70922.jpg?m=1367773811" width="80" height="80" alt="" /></dd> <dd><span>From: Montevideo, Uruguay</span></dd> <dd><span>Registered: 2013-05-02</span></dd> <dd><span>Posts: 402</span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>trimm wrote:</cite><blockquote><div><p>nbhs: Could you perhaps tell us when you update qemu-git and seabios-git aswell? Or are these the same packages we get from AUR?</p></div></blockquote></div><p>These are git versions, so unless something breaks or fails to build theres no reason to update the package, you can use the AUR versions if you want since there are no extra patches needed</p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1401801">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1402043" class="blockpost roweven"> <h2><span><span class="conr">#1504</span> <a href="viewtopic.php?pid=1402043#p1402043">2014-04-08 18:40:26</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=76834">Val532</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2013-11-13</span></dd> <dd><span>Posts: 35</span></dd> <dd class="usercontacts"><span class="email"><a href="misc.php?email=76834">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <p>Hi all,</p><p>I have a small probleme, on my VM i want to start OCCT and i got a BSOD &quot;driver_irql_not_less_or_equal&quot; i have not any other information on the BSOD screen.</p><p>I run on qemu 2.0.0-RC1 and kernel 3.14, i have two graphique card AMD HD 6870 (crossfire not enable) on the VM (just for testing).</p><p>On dmesg i have : </p><div class="codebox"><pre><code>[ 8704.000634] kvm_get_msr_common: 82 callbacks suppressed [ 8704.000643] kvm [6821]: vcpu0 unhandled rdmsr: 0xce [ 8704.000686] kvm [6821]: vcpu0 unhandled rdmsr: 0xce [ 8704.004952] kvm [6821]: vcpu0 unhandled rdmsr: 0x637 [ 8704.004976] kvm [6821]: vcpu0 unhandled rdmsr: 0xe8 [ 8704.004989] kvm [6821]: vcpu0 unhandled rdmsr: 0xe7 [ 8704.005013] kvm [6821]: vcpu0 unhandled rdmsr: 0x31 [ 8704.005030] kvm [6821]: vcpu0 unhandled rdmsr: 0x35 [ 8704.005050] kvm [6821]: vcpu0 unhandled rdmsr: 0x39 [ 8704.005095] kvm [6821]: vcpu0 unhandled rdmsr: 0xce [ 8704.005108] kvm [6821]: vcpu0 unhandled rdmsr: 0x194</code></pre></div><p>Any help ? <br />Thanks</p> <p class="postedit"><em>Last edited by Val532 (2014-04-08 18:40:56)</em></p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1402043">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1402051" class="blockpost rowodd"> <h2><span><span class="conr">#1505</span> <a href="viewtopic.php?pid=1402051#p1402051">2014-04-08 19:03:24</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=70922">nbhs</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd class="postavatar"><img src="https://bbs.archlinux.org/img/avatars/70922.jpg?m=1367773811" width="80" height="80" alt="" /></dd> <dd><span>From: Montevideo, Uruguay</span></dd> <dd><span>Registered: 2013-05-02</span></dd> <dd><span>Posts: 402</span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>Val532 wrote:</cite><blockquote><div><p>Hi all,</p><p>I have a small probleme, on my VM i want to start OCCT and i got a BSOD &quot;driver_irql_not_less_or_equal&quot; i have not any other information on the BSOD screen.</p><p>I run on qemu 2.0.0-RC1 and kernel 3.14, i have two graphique card AMD HD 6870 (crossfire not enable) on the VM (just for testing).</p><p>On dmesg i have : </p><div class="codebox"><pre><code>[ 8704.000634] kvm_get_msr_common: 82 callbacks suppressed [ 8704.000643] kvm [6821]: vcpu0 unhandled rdmsr: 0xce [ 8704.000686] kvm [6821]: vcpu0 unhandled rdmsr: 0xce [ 8704.004952] kvm [6821]: vcpu0 unhandled rdmsr: 0x637 [ 8704.004976] kvm [6821]: vcpu0 unhandled rdmsr: 0xe8 [ 8704.004989] kvm [6821]: vcpu0 unhandled rdmsr: 0xe7 [ 8704.005013] kvm [6821]: vcpu0 unhandled rdmsr: 0x31 [ 8704.005030] kvm [6821]: vcpu0 unhandled rdmsr: 0x35 [ 8704.005050] kvm [6821]: vcpu0 unhandled rdmsr: 0x39 [ 8704.005095] kvm [6821]: vcpu0 unhandled rdmsr: 0xce [ 8704.005108] kvm [6821]: vcpu0 unhandled rdmsr: 0x194</code></pre></div><p>Any help ? <br />Thanks</p></div></blockquote></div><p>try </p><div class="codebox"><pre><code>echo &quot;options kvm ignore_msrs=1&quot; &gt;&gt; /etc/modprobe.d/kvm.conf</code></pre></div> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1402051">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1402083" class="blockpost roweven"> <h2><span><span class="conr">#1506</span> <a href="viewtopic.php?pid=1402083#p1402083">2014-04-08 20:45:39</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=80335">beckend</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2014-03-16</span></dd> <dd><span>Posts: 5</span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <p>Hours of tests, 3.14 posted on OP for me was SLOW to a crawl, 3.13 old kernel posted before gets me almost native speed.</p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1402083">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1402283" class="blockpost rowodd"> <h2><span><span class="conr">#1507</span> <a href="viewtopic.php?pid=1402283#p1402283">2014-04-09 10:30:49</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=80279">novist</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2014-03-14</span></dd> <dd><span>Posts: 34</span></dd> <dd class="usercontacts"><span class="email"><a href="misc.php?email=80279">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>beckend wrote:</cite><blockquote><div><p>Hours of tests, 3.14 posted on OP for me was SLOW to a crawl, 3.13 old kernel posted before gets me almost native speed.</p></div></blockquote></div><p>i am experiencing unexpected slowdown too. could you please specify your hardware, exact kernel version (if its 3.13.something) and patches?</p><br /><p>For others if anyone cares i managed to get my R9 270X gpu running as secondary on libvirt i440fx (default) chipset. here is xml:</p><div class="codebox"><pre class="vscroll"><code>&lt;!-- WARNING: THIS IS AN AUTO-GENERATED FILE. CHANGES TO IT ARE LIKELY TO BE OVERWRITTEN AND LOST. Changes to this xml configuration should be made using: virsh edit win or other application using the libvirt API. --&gt; &lt;domain type=&#039;kvm&#039;&gt; &lt;name&gt;win&lt;/name&gt; &lt;uuid&gt;9d99f9e4-c66f-427e-89a2-0285358ce620&lt;/uuid&gt; &lt;memory unit=&#039;KiB&#039;&gt;4194304&lt;/memory&gt; &lt;currentMemory unit=&#039;KiB&#039;&gt;4194304&lt;/currentMemory&gt; &lt;vcpu placement=&#039;static&#039;&gt;8&lt;/vcpu&gt; &lt;os&gt; &lt;type arch=&#039;x86_64&#039; machine=&#039;pc-i440fx-2.0&#039;&gt;hvm&lt;/type&gt; &lt;boot dev=&#039;hd&#039;/&gt; &lt;/os&gt; &lt;features&gt; &lt;acpi/&gt; &lt;apic/&gt; &lt;pae/&gt; &lt;/features&gt; &lt;cpu mode=&#039;host-passthrough&#039;&gt; &lt;topology sockets=&#039;1&#039; cores=&#039;4&#039; threads=&#039;2&#039;/&gt; &lt;/cpu&gt; &lt;clock offset=&#039;localtime&#039;&gt; &lt;timer name=&#039;rtc&#039; tickpolicy=&#039;catchup&#039;/&gt; &lt;timer name=&#039;pit&#039; tickpolicy=&#039;delay&#039;/&gt; &lt;timer name=&#039;hpet&#039; present=&#039;no&#039;/&gt; &lt;/clock&gt; &lt;on_poweroff&gt;destroy&lt;/on_poweroff&gt; &lt;on_reboot&gt;restart&lt;/on_reboot&gt; &lt;on_crash&gt;restart&lt;/on_crash&gt; &lt;pm&gt; &lt;suspend-to-mem enabled=&#039;no&#039;/&gt; &lt;suspend-to-disk enabled=&#039;no&#039;/&gt; &lt;/pm&gt; &lt;devices&gt; &lt;emulator&gt;/usr/local/bin/qemu-system-x86_64&lt;/emulator&gt; &lt;disk type=&#039;block&#039; device=&#039;disk&#039;&gt; &lt;driver name=&#039;qemu&#039; type=&#039;raw&#039; cache=&#039;none&#039; io=&#039;native&#039;/&gt; &lt;source dev=&#039;/dev/mapper/lvm-vm&#039;/&gt; &lt;target dev=&#039;vda&#039; bus=&#039;virtio&#039;/&gt; &lt;address type=&#039;pci&#039; domain=&#039;0x0000&#039; bus=&#039;0x00&#039; slot=&#039;0x05&#039; function=&#039;0x0&#039;/&gt; &lt;/disk&gt; &lt;controller type=&#039;usb&#039; index=&#039;0&#039; model=&#039;ich9-ehci1&#039;&gt; &lt;address type=&#039;pci&#039; domain=&#039;0x0000&#039; bus=&#039;0x00&#039; slot=&#039;0x04&#039; function=&#039;0x7&#039;/&gt; &lt;/controller&gt; &lt;controller type=&#039;usb&#039; index=&#039;0&#039; model=&#039;ich9-uhci1&#039;&gt; &lt;master startport=&#039;0&#039;/&gt; &lt;address type=&#039;pci&#039; domain=&#039;0x0000&#039; bus=&#039;0x00&#039; slot=&#039;0x04&#039; function=&#039;0x0&#039; multifunction=&#039;on&#039;/&gt; &lt;/controller&gt; &lt;controller type=&#039;usb&#039; index=&#039;0&#039; model=&#039;ich9-uhci2&#039;&gt; &lt;master startport=&#039;2&#039;/&gt; &lt;address type=&#039;pci&#039; domain=&#039;0x0000&#039; bus=&#039;0x00&#039; slot=&#039;0x04&#039; function=&#039;0x1&#039;/&gt; &lt;/controller&gt; &lt;controller type=&#039;usb&#039; index=&#039;0&#039; model=&#039;ich9-uhci3&#039;&gt; &lt;master startport=&#039;4&#039;/&gt; &lt;address type=&#039;pci&#039; domain=&#039;0x0000&#039; bus=&#039;0x00&#039; slot=&#039;0x04&#039; function=&#039;0x2&#039;/&gt; &lt;/controller&gt; &lt;controller type=&#039;pci&#039; index=&#039;0&#039; model=&#039;pci-root&#039;/&gt; &lt;interface type=&#039;network&#039;&gt; &lt;mac address=&#039;50:64:11:7c:b6:85&#039;/&gt; &lt;source network=&#039;default&#039;/&gt; &lt;model type=&#039;virtio&#039;/&gt; &lt;address type=&#039;pci&#039; domain=&#039;0x0000&#039; bus=&#039;0x00&#039; slot=&#039;0x03&#039; function=&#039;0x0&#039;/&gt; &lt;/interface&gt; &lt;input type=&#039;mouse&#039; bus=&#039;ps2&#039;/&gt; &lt;input type=&#039;keyboard&#039; bus=&#039;ps2&#039;/&gt; &lt;graphics type=&#039;vnc&#039; port=&#039;-1&#039; autoport=&#039;yes&#039; keymap=&#039;en-us&#039;/&gt; &lt;video&gt; &lt;model type=&#039;vga&#039; vram=&#039;9216&#039; heads=&#039;1&#039;/&gt; &lt;address type=&#039;pci&#039; domain=&#039;0x0000&#039; bus=&#039;0x00&#039; slot=&#039;0x02&#039; function=&#039;0x0&#039;/&gt; &lt;/video&gt; &lt;hostdev mode=&#039;subsystem&#039; type=&#039;pci&#039; managed=&#039;yes&#039;&gt; &lt;source&gt; &lt;address domain=&#039;0x0000&#039; bus=&#039;0x06&#039; slot=&#039;0x00&#039; function=&#039;0x0&#039;/&gt; &lt;/source&gt; &lt;address type=&#039;pci&#039; domain=&#039;0x0000&#039; bus=&#039;0x00&#039; slot=&#039;0x07&#039; function=&#039;0x0&#039;/&gt; &lt;/hostdev&gt; &lt;hostdev mode=&#039;subsystem&#039; type=&#039;pci&#039; managed=&#039;yes&#039;&gt; &lt;source&gt; &lt;address domain=&#039;0x0000&#039; bus=&#039;0x06&#039; slot=&#039;0x00&#039; function=&#039;0x1&#039;/&gt; &lt;/source&gt; &lt;address type=&#039;pci&#039; domain=&#039;0x0000&#039; bus=&#039;0x00&#039; slot=&#039;0x09&#039; function=&#039;0x0&#039;/&gt; &lt;/hostdev&gt; &lt;hostdev mode=&#039;subsystem&#039; type=&#039;pci&#039; managed=&#039;yes&#039;&gt; &lt;source&gt; &lt;address domain=&#039;0x0000&#039; bus=&#039;0x00&#039; slot=&#039;0x13&#039; function=&#039;0x0&#039;/&gt; &lt;/source&gt; &lt;address type=&#039;pci&#039; domain=&#039;0x0000&#039; bus=&#039;0x00&#039; slot=&#039;0x0a&#039; function=&#039;0x0&#039;/&gt; &lt;/hostdev&gt; &lt;hostdev mode=&#039;subsystem&#039; type=&#039;pci&#039; managed=&#039;yes&#039;&gt; &lt;source&gt; &lt;address domain=&#039;0x0000&#039; bus=&#039;0x00&#039; slot=&#039;0x13&#039; function=&#039;0x2&#039;/&gt; &lt;/source&gt; &lt;address type=&#039;pci&#039; domain=&#039;0x0000&#039; bus=&#039;0x00&#039; slot=&#039;0x0b&#039; function=&#039;0x0&#039;/&gt; &lt;/hostdev&gt; &lt;memballoon model=&#039;virtio&#039;&gt; &lt;address type=&#039;pci&#039; domain=&#039;0x0000&#039; bus=&#039;0x00&#039; slot=&#039;0x08&#039; function=&#039;0x0&#039;/&gt; &lt;/memballoon&gt; &lt;/devices&gt; &lt;/domain&gt;</code></pre></div> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1402283">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1402299" class="blockpost roweven"> <h2><span><span class="conr">#1508</span> <a href="viewtopic.php?pid=1402299#p1402299">2014-04-09 11:45:21</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=80335">beckend</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2014-03-16</span></dd> <dd><span>Posts: 5</span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <p>3.14 In the OP when he posted it the first time, and I dont see that changed.<br />If u want to know without decompressing the posted PKGBUILD file, here it is:<br />&#160; &#160; &#160; &#160; &#039;change-default-console-loglevel.patch&#039;<br />&#160; &#160; &#160; &#160; &#039;0001-Bluetooth-allocate-static-minor-for-vhci.patch&#039;<br />&#160; &#160; &#160; &#160; &#039;0002-module-allow-multiple-calls-to-MODULE_DEVICE_TABLE-p.patch&#039;<br />&#160; &#160; &#160; &#160; &#039;0003-module-remove-MODULE_GENERIC_TABLE.patch&#039;<br />&#160; &#160; &#160; &#160; &#039;0004-Revert-syscalls.h-use-gcc-alias-instead-of-assembler.patch&#039;<br />&#160; &#160; &#160; &#160; &#039;http://repo-ck.com/source/gcc_patch/enable_additional_cpu_optimizations_for_gcc.patch$<br />&#160; &#160; &#160; &#160; &#039;radeon_load_vbios_from_file.patch&#039;<br />&#160; &#160; &#160; &#160; &#039;acs.patch&#039;<br />&#160; &#160; &#160; &#160; &#039;i915_314.patch&#039;<br />&#160; &#160; &#160; &#160; &#039;debug_registers.patch&#039;</p><p>Kernel version is pkgver=3.14 pkgrel=2 all from PKGBUILD. I dont use the &#039;override_for_missing_acs_capabilities.patch&#039; since it did not work for me, however I edited the the the PKGBUILD to include a newer patch to fix the IOMMU group isolation from:&#160; <a href="http://linux-kernel.2935.n7.nabble.com/PATCH-v2-0-3-Quirk-Intel-PCH-root-ports-for-ACS-like-features-td796884.html" rel="nofollow">http://linux-kernel.2935.n7.nabble.com/ … 96884.html</a><br />pasted the patch into &#039;acs.patch&#039;. The same thing was done for 3.13.6 (posted earlier from OP).</p><p>Hardware is a Lenovo W530, Ivy Bridge 3740QM, 8GB Ram. What was passthoughed is an external GPU, 680GTX to the virtual machine as mostly instructed from OP except I replaced all to virtio drivers. Performance of 3.13 is quite astounding, I still can&#039;t belive it.</p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1402299">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1402357" class="blockpost rowodd"> <h2><span><span class="conr">#1509</span> <a href="viewtopic.php?pid=1402357#p1402357">2014-04-09 16:25:53</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=80990">Eb</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2014-04-08</span></dd> <dd><span>Posts: 11</span></dd> <dd class="usercontacts"><span class="email"><a href="misc.php?email=80990">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <p>I&#039;m unable to get qemu to boot the guest os. I&#039;ve followed the instructions and used the packages in the main post, and have looked around the thread for a solution but I&#039;m still clueless as to what could be wrong. Below is everything I could think of that will be helpful to troubleshoot, sorry that it&#039;s a bit much. Let me know if any more information would be helpful.</p><p>Command Run:</p><div class="codebox"><pre><code>sudo qemu-system-x86_64 \ -enable-kvm \ -M q35 \ -m 1024 \ -cpu host \ -smp 6,sockets=1,cores=6,threads=1 \ -bios /usr/share/qemu/bios.bin \ -vga none \ -device ioh3420,bus=pcie.0,addr=1c.0,multifunction=on,port=1,chassis=1,id=root.1 \ -device vfio-pci,host=03:00.0,bus=root.1,addr=00.0,multifunction=on,x-vga=on \ -device vfio-pci,host=03:00.1,bus=root.1,addr=00.1</code></pre></div><p>Error:</p><div class="codebox"><pre><code>qemu-system-x86_64: -device vfio-pci,host=03:00.0,bus=root.1,addr=00.0,multifunction=on,x-vga=on: vfio: error, group 1 is not viable, please ensure all devices within the iommu_group are bound to their vfio bus driver. qemu-system-x86_64: -device vfio-pci,host=03:00.0,bus=root.1,addr=00.0,multifunction=on,x-vga=on: vfio: failed to get group 1 qemu-system-x86_64: -device vfio-pci,host=03:00.0,bus=root.1,addr=00.0,multifunction=on,x-vga=on: Device initialization failed. qemu-system-x86_64: -device vfio-pci,host=03:00.0,bus=root.1,addr=00.0,multifunction=on,x-vga=on: Device &#039;vfio-pci&#039; could not be initialized</code></pre></div><br /><p>Setup:</p><p>Asrock z87 Extreme9<br />Intel Integrated Graphics (not in use, aside for post and bios)<br />Radeon R9 270x (guest) [03:00.0 and 03:00.1, pci-stubbed]<br />Radeon HD 6670 (host)&#160; [04:00.0 and 04:00.1]</p><br /><br /><p>Drivers Tried:</p><p>radeon<br />fglrx (current)</p><p>Please note that both drivers have the same issue.</p><br /><br /><p>Boot Options:</p><div class="codebox"><pre><code>intel_iommu=on pcie_acs_override=downstream pci-stub.ids=1002:6810,1002:aab0</code></pre></div><p>IOMMU Group 1:</p><div class="codebox"><pre><code>ls -l /sys/kernel/iommu_groups/1/devices total 0 lrwxrwxrwx 1 root root 0 Apr 9 11:33 0000:00:01.0 -&gt; ../../../../devices/pci0000:00/0000:00:01.0 lrwxrwxrwx 1 root root 0 Apr 9 11:33 0000:01:00.0 -&gt; ../../../../devices/pci0000:00/0000:00:01.0/0000:01:00.0 lrwxrwxrwx 1 root root 0 Apr 9 11:33 0000:02:08.0 -&gt; ../../../../devices/pci0000:00/0000:00:01.0/0000:01:00.0/0000:02:08.0 lrwxrwxrwx 1 root root 0 Apr 9 11:33 0000:02:10.0 -&gt; ../../../../devices/pci0000:00/0000:00:01.0/0000:01:00.0/0000:02:10.0 lrwxrwxrwx 1 root root 0 Apr 9 11:33 0000:02:11.0 -&gt; ../../../../devices/pci0000:00/0000:00:01.0/0000:01:00.0/0000:02:11.0 lrwxrwxrwx 1 root root 0 Apr 9 11:33 0000:03:00.0 -&gt; ../../../../devices/pci0000:00/0000:00:01.0/0000:01:00.0/0000:02:08.0/0000:03:00.0 lrwxrwxrwx 1 root root 0 Apr 9 11:33 0000:03:00.1 -&gt; ../../../../devices/pci0000:00/0000:00:01.0/0000:01:00.0/0000:02:08.0/0000:03:00.1 lrwxrwxrwx 1 root root 0 Apr 9 11:33 0000:04:00.0 -&gt; ../../../../devices/pci0000:00/0000:00:01.0/0000:01:00.0/0000:02:10.0/0000:04:00.0 lrwxrwxrwx 1 root root 0 Apr 9 11:33 0000:04:00.1 -&gt; ../../../../devices/pci0000:00/0000:00:01.0/0000:01:00.0/0000:02:10.0/0000:04:00.1</code></pre></div><p>Details For each device:</p><br /><p>00.01.0:</p><div class="codebox"><pre class="vscroll"><code>00:01.0 PCI bridge: Intel Corporation Xeon E3-1200 v3/4th Gen Core Processor PCI Express x16 Controller (rev 06) (prog-if 00 [Normal decode]) Control: I/O+ Mem+ BusMaster+ SpecCycle- MemWINV- VGASnoop- ParErr- Stepping- SERR- FastB2B- DisINTx+ Status: Cap+ 66MHz- UDF- FastB2B- ParErr- DEVSEL=fast &gt;TAbort- &lt;TAbort- &lt;MAbort- &gt;SERR- &lt;PERR- INTx- Latency: 0, Cache Line Size: 64 bytes Bus: primary=00, secondary=01, subordinate=05, sec-latency=0 I/O behind bridge: 0000a000-0000bfff Memory behind bridge: dc900000-dcbfffff Prefetchable memory behind bridge: 00000000a0000000-00000000bfffffff Secondary status: 66MHz- FastB2B- ParErr- DEVSEL=fast &gt;TAbort- &lt;TAbort- &lt;MAbort- &lt;SERR- &lt;PERR- BridgeCtl: Parity- SERR- NoISA- VGA+ MAbort- &gt;Reset- FastB2B- PriDiscTmr- SecDiscTmr- DiscTmrStat- DiscTmrSERREn- Capabilities: [88] Subsystem: ASRock Incorporation Device 0c01 Capabilities: [80] Power Management version 3 Flags: PMEClk- DSI- D1- D2- AuxCurrent=0mA PME(D0+,D1-,D2-,D3hot+,D3cold+) Status: D0 NoSoftRst+ PME-Enable- DSel=0 DScale=0 PME- Capabilities: [90] MSI: Enable+ Count=1/1 Maskable- 64bit- Address: fee00298 Data: 0000 Capabilities: [a0] Express (v2) Root Port (Slot+), MSI 00 DevCap: MaxPayload 256 bytes, PhantFunc 0 ExtTag- RBE+ DevCtl: Report errors: Correctable- Non-Fatal- Fatal- Unsupported- RlxdOrd- ExtTag- PhantFunc- AuxPwr- NoSnoop- MaxPayload 256 bytes, MaxReadReq 128 bytes DevSta: CorrErr- UncorrErr- FatalErr+ UnsuppReq- AuxPwr- TransPend- LnkCap: Port #2, Speed 8GT/s, Width x16, ASPM L0s L1, Exit Latency L0s &lt;1us, L1 &lt;8us ClockPM- Surprise- LLActRep- BwNot+ LnkCtl: ASPM Disabled; RCB 64 bytes Disabled- CommClk- ExtSynch- ClockPM- AutWidDis- BWInt- AutBWInt- LnkSta: Speed 8GT/s, Width x16, TrErr- Train- SlotClk+ DLActive- BWMgmt+ ABWMgmt+ SltCap: AttnBtn- PwrCtrl- MRL- AttnInd- PwrInd- HotPlug- Surprise- Slot #1, PowerLimit 75.000W; Interlock- NoCompl+ SltCtl: Enable: AttnBtn- PwrFlt- MRL- PresDet- CmdCplt- HPIrq- LinkChg- Control: AttnInd Unknown, PwrInd Unknown, Power- Interlock- SltSta: Status: AttnBtn- PowerFlt- MRL- CmdCplt- PresDet+ Interlock- Changed: MRL- PresDet- LinkState- RootCtl: ErrCorrectable- ErrNon-Fatal- ErrFatal- PMEIntEna- CRSVisible- RootCap: CRSVisible- RootSta: PME ReqID 0000, PMEStatus- PMEPending- DevCap2: Completion Timeout: Not Supported, TimeoutDis-, LTR+, OBFF Via WAKE# ARIFwd- DevCtl2: Completion Timeout: 50us to 50ms, TimeoutDis-, LTR+, OBFF Via WAKE# ARIFwd- LnkCtl2: Target Link Speed: 8GT/s, EnterCompliance- SpeedDis- Transmit Margin: Normal Operating Range, EnterModifiedCompliance- ComplianceSOS- Compliance De-emphasis: -6dB LnkSta2: Current De-emphasis Level: -6dB, EqualizationComplete+, EqualizationPhase1+ EqualizationPhase2+, EqualizationPhase3+, LinkEqualizationRequest- Capabilities: [100 v1] Virtual Channel Caps: LPEVC=0 RefClk=100ns PATEntryBits=1 Arb: Fixed- WRR32- WRR64- WRR128- Ctrl: ArbSelect=Fixed Status: InProgress- VC0: Caps: PATOffset=00 MaxTimeSlots=1 RejSnoopTrans- Arb: Fixed+ WRR32- WRR64- WRR128- TWRR128- WRR256- Ctrl: Enable+ ID=0 ArbSelect=Fixed TC/VC=ff Status: NegoPending- InProgress- Capabilities: [140 v1] Root Complex Link Desc: PortNumber=02 ComponentID=01 EltType=Config Link0: Desc: TargetPort=00 TargetComponent=01 AssocRCRB- LinkType=MemMapped LinkValid+ Addr: 00000000fed19000 Capabilities: [d94 v1] #19 Kernel driver in use: pcieport Kernel modules: shpchp</code></pre></div><p>&#160; &#160; <br />01:00.0:</p><div class="codebox"><pre class="vscroll"><code>01:00.0 PCI bridge: PLX Technology, Inc. Device 8747 (rev ba) (prog-if 00 [Normal decode]) Control: I/O+ Mem+ BusMaster+ SpecCycle- MemWINV- VGASnoop- ParErr- Stepping- SERR- FastB2B- DisINTx+ Status: Cap+ 66MHz- UDF- FastB2B- ParErr- DEVSEL=fast &gt;TAbort- &lt;TAbort- &lt;MAbort- &gt;SERR- &lt;PERR- INTx- Latency: 0, Cache Line Size: 64 bytes Region 0: Memory at dcb00000 (32-bit, non-prefetchable) [size=256K] Bus: primary=01, secondary=02, subordinate=05, sec-latency=0 I/O behind bridge: 0000a000-0000bfff Memory behind bridge: dc900000-dcafffff Prefetchable memory behind bridge: 00000000a0000000-00000000bfffffff Secondary status: 66MHz- FastB2B- ParErr- DEVSEL=fast &gt;TAbort- &lt;TAbort- &lt;MAbort- &lt;SERR- &lt;PERR- BridgeCtl: Parity- SERR- NoISA- VGA+ MAbort- &gt;Reset- FastB2B- PriDiscTmr- SecDiscTmr- DiscTmrStat- DiscTmrSERREn- Capabilities: [40] Power Management version 3 Flags: PMEClk- DSI- D1- D2- AuxCurrent=0mA PME(D0+,D1-,D2-,D3hot+,D3cold+) Status: D0 NoSoftRst+ PME-Enable- DSel=0 DScale=0 PME- Capabilities: [48] MSI: Enable+ Count=1/8 Maskable+ 64bit+ Address: 00000000fee002f8 Data: 0000 Masking: 000000ff Pending: 00000000 Capabilities: [68] Express (v2) Upstream Port, MSI 00 DevCap: MaxPayload 2048 bytes, PhantFunc 0 ExtTag- AttnBtn- AttnInd- PwrInd- RBE+ SlotPowerLimit 75.000W DevCtl: Report errors: Correctable- Non-Fatal- Fatal- Unsupported- RlxdOrd- ExtTag- PhantFunc- AuxPwr- NoSnoop+ MaxPayload 256 bytes, MaxReadReq 128 bytes DevSta: CorrErr+ UncorrErr- FatalErr- UnsuppReq+ AuxPwr- TransPend- LnkCap: Port #0, Speed 8GT/s, Width x16, ASPM L1, Exit Latency L0s &lt;4us, L1 &lt;4us ClockPM- Surprise- LLActRep- BwNot- LnkCtl: ASPM Disabled; Disabled- CommClk- ExtSynch- ClockPM- AutWidDis- BWInt- AutBWInt- LnkSta: Speed 8GT/s, Width x16, TrErr- Train- SlotClk- DLActive- BWMgmt- ABWMgmt- DevCap2: Completion Timeout: Not Supported, TimeoutDis-, LTR+, OBFF Via message DevCtl2: Completion Timeout: 50us to 50ms, TimeoutDis-, LTR+, OBFF Disabled LnkCtl2: Target Link Speed: 8GT/s, EnterCompliance- SpeedDis- Transmit Margin: Normal Operating Range, EnterModifiedCompliance- ComplianceSOS- Compliance De-emphasis: -6dB LnkSta2: Current De-emphasis Level: -6dB, EqualizationComplete+, EqualizationPhase1+ EqualizationPhase2+, EqualizationPhase3+, LinkEqualizationRequest- Capabilities: [a4] Subsystem: PLX Technology, Inc. Device 8747 Capabilities: [100 v1] Device Serial Number ba-87-00-10-b5-df-0e-00 Capabilities: [fb4 v1] Advanced Error Reporting UESta: DLP- SDES- TLP- FCP- CmpltTO- CmpltAbrt- UnxCmplt- RxOF- MalfTLP- ECRC- UnsupReq- ACSViol- UEMsk: DLP- SDES- TLP- FCP- CmpltTO- CmpltAbrt- UnxCmplt- RxOF- MalfTLP- ECRC- UnsupReq- ACSViol- UESvrt: DLP+ SDES+ TLP- FCP+ CmpltTO- CmpltAbrt- UnxCmplt- RxOF+ MalfTLP+ ECRC- UnsupReq- ACSViol- CESta: RxErr- BadTLP- BadDLLP- Rollover- Timeout- NonFatalErr+ CEMsk: RxErr- BadTLP- BadDLLP- Rollover- Timeout- NonFatalErr+ AERCap: First Error Pointer: 1f, GenCap+ CGenEn- ChkCap+ ChkEn- Capabilities: [138 v1] Power Budgeting &lt;?&gt; Capabilities: [10c v1] #19 Capabilities: [148 v1] Virtual Channel Caps: LPEVC=0 RefClk=100ns PATEntryBits=8 Arb: Fixed- WRR32- WRR64- WRR128- Ctrl: ArbSelect=Fixed Status: InProgress- VC0: Caps: PATOffset=03 MaxTimeSlots=1 RejSnoopTrans- Arb: Fixed- WRR32- WRR64+ WRR128- TWRR128- WRR256- Ctrl: Enable+ ID=0 ArbSelect=WRR64 TC/VC=ff Status: NegoPending- InProgress- Port Arbitration Table &lt;?&gt; Capabilities: [e00 v1] #12 Capabilities: [b00 v1] Latency Tolerance Reporting Max snoop latency: 71680ns Max no snoop latency: 71680ns Capabilities: [b70 v1] Vendor Specific Information: ID=0001 Rev=0 Len=010 &lt;?&gt; Kernel driver in use: pcieport Kernel modules: shpchp</code></pre></div><p>02:08.0</p><div class="codebox"><pre class="vscroll"><code>02:08.0 PCI bridge: PLX Technology, Inc. Device 8747 (rev ba) (prog-if 00 [Normal decode]) Control: I/O+ Mem+ BusMaster+ SpecCycle- MemWINV- VGASnoop- ParErr- Stepping- SERR- FastB2B- DisINTx+ Status: Cap+ 66MHz- UDF- FastB2B- ParErr- DEVSEL=fast &gt;TAbort- &lt;TAbort- &lt;MAbort- &gt;SERR- &lt;PERR- INTx- Latency: 0, Cache Line Size: 64 bytes Bus: primary=02, secondary=03, subordinate=03, sec-latency=0 I/O behind bridge: 0000b000-0000bfff Memory behind bridge: dca00000-dcafffff Prefetchable memory behind bridge: 00000000b0000000-00000000bfffffff Secondary status: 66MHz- FastB2B- ParErr- DEVSEL=fast &gt;TAbort- &lt;TAbort- &lt;MAbort- &lt;SERR- &lt;PERR- BridgeCtl: Parity- SERR- NoISA- VGA- MAbort- &gt;Reset- FastB2B- PriDiscTmr- SecDiscTmr- DiscTmrStat- DiscTmrSERREn- Capabilities: [40] Power Management version 3 Flags: PMEClk- DSI- D1- D2- AuxCurrent=0mA PME(D0+,D1-,D2-,D3hot+,D3cold+) Status: D0 NoSoftRst+ PME-Enable- DSel=0 DScale=0 PME- Capabilities: [48] MSI: Enable+ Count=1/8 Maskable+ 64bit+ Address: 00000000fee00318 Data: 0000 Masking: 000000ff Pending: 00000000 Capabilities: [68] Express (v2) Downstream Port (Slot+), MSI 00 DevCap: MaxPayload 2048 bytes, PhantFunc 0 ExtTag- RBE+ DevCtl: Report errors: Correctable- Non-Fatal- Fatal- Unsupported- RlxdOrd- ExtTag- PhantFunc- AuxPwr- NoSnoop+ MaxPayload 256 bytes, MaxReadReq 128 bytes DevSta: CorrErr+ UncorrErr- FatalErr- UnsuppReq+ AuxPwr- TransPend- LnkCap: Port #8, Speed 8GT/s, Width x16, ASPM L1, Exit Latency L0s &lt;4us, L1 &lt;4us ClockPM- Surprise+ LLActRep+ BwNot+ LnkCtl: ASPM Disabled; Disabled- CommClk- ExtSynch- ClockPM- AutWidDis- BWInt- AutBWInt- LnkSta: Speed 8GT/s, Width x16, TrErr- Train- SlotClk- DLActive+ BWMgmt+ ABWMgmt+ SltCap: AttnBtn- PwrCtrl- MRL- AttnInd- PwrInd- HotPlug- Surprise- Slot #72, PowerLimit 25.000W; Interlock- NoCompl- SltCtl: Enable: AttnBtn- PwrFlt- MRL- PresDet- CmdCplt- HPIrq- LinkChg- Control: AttnInd Unknown, PwrInd Unknown, Power- Interlock- SltSta: Status: AttnBtn- PowerFlt- MRL- CmdCplt- PresDet+ Interlock- Changed: MRL- PresDet- LinkState- DevCap2: Completion Timeout: Not Supported, TimeoutDis-, LTR+, OBFF Via message ARIFwd+ DevCtl2: Completion Timeout: 50us to 50ms, TimeoutDis-, LTR+, OBFF Disabled ARIFwd- LnkCtl2: Target Link Speed: 8GT/s, EnterCompliance- SpeedDis-, Selectable De-emphasis: -6dB Transmit Margin: Normal Operating Range, EnterModifiedCompliance- ComplianceSOS- Compliance De-emphasis: -6dB LnkSta2: Current De-emphasis Level: -6dB, EqualizationComplete+, EqualizationPhase1+ EqualizationPhase2+, EqualizationPhase3+, LinkEqualizationRequest- Capabilities: [a4] Subsystem: PLX Technology, Inc. Device 8747 Capabilities: [100 v1] Device Serial Number ba-87-00-10-b5-df-0e-00 Capabilities: [fb4 v1] Advanced Error Reporting UESta: DLP- SDES- TLP- FCP- CmpltTO- CmpltAbrt- UnxCmplt- RxOF- MalfTLP- ECRC- UnsupReq- ACSViol- UEMsk: DLP- SDES- TLP- FCP- CmpltTO- CmpltAbrt- UnxCmplt- RxOF- MalfTLP- ECRC- UnsupReq- ACSViol- UESvrt: DLP+ SDES+ TLP- FCP+ CmpltTO- CmpltAbrt- UnxCmplt- RxOF+ MalfTLP+ ECRC- UnsupReq- ACSViol- CESta: RxErr- BadTLP- BadDLLP- Rollover- Timeout- NonFatalErr+ CEMsk: RxErr- BadTLP- BadDLLP- Rollover- Timeout- NonFatalErr+ AERCap: First Error Pointer: 1f, GenCap+ CGenEn- ChkCap+ ChkEn- Capabilities: [138 v1] Power Budgeting &lt;?&gt; Capabilities: [10c v1] #19 Capabilities: [148 v1] Virtual Channel Caps: LPEVC=0 RefClk=100ns PATEntryBits=8 Arb: Fixed- WRR32- WRR64- WRR128- Ctrl: ArbSelect=Fixed Status: InProgress- VC0: Caps: PATOffset=03 MaxTimeSlots=1 RejSnoopTrans- Arb: Fixed- WRR32- WRR64+ WRR128- TWRR128- WRR256- Ctrl: Enable+ ID=0 ArbSelect=WRR64 TC/VC=ff Status: NegoPending- InProgress- Port Arbitration Table &lt;?&gt; Capabilities: [e00 v1] #12 Capabilities: [f24 v1] Access Control Services ACSCap: SrcValid+ TransBlk+ ReqRedir+ CmpltRedir+ UpstreamFwd+ EgressCtrl+ DirectTrans+ ACSCtl: SrcValid+ TransBlk- ReqRedir+ CmpltRedir+ UpstreamFwd+ EgressCtrl- DirectTrans- Capabilities: [b70 v1] Vendor Specific Information: ID=0001 Rev=0 Len=010 &lt;?&gt; Kernel driver in use: pcieport Kernel modules: shpchp</code></pre></div><p>02:10.0</p><div class="codebox"><pre class="vscroll"><code>02:10.0 PCI bridge: PLX Technology, Inc. Device 8747 (rev ba) (prog-if 00 [Normal decode]) Control: I/O+ Mem+ BusMaster+ SpecCycle- MemWINV- VGASnoop- ParErr- Stepping- SERR- FastB2B- DisINTx+ Status: Cap+ 66MHz- UDF- FastB2B- ParErr- DEVSEL=fast &gt;TAbort- &lt;TAbort- &lt;MAbort- &gt;SERR- &lt;PERR- INTx- Latency: 0, Cache Line Size: 64 bytes Bus: primary=02, secondary=04, subordinate=04, sec-latency=0 I/O behind bridge: 0000a000-0000afff Memory behind bridge: dc900000-dc9fffff Prefetchable memory behind bridge: 00000000a0000000-00000000afffffff Secondary status: 66MHz- FastB2B- ParErr- DEVSEL=fast &gt;TAbort- &lt;TAbort- &lt;MAbort- &lt;SERR- &lt;PERR- BridgeCtl: Parity- SERR- NoISA- VGA+ MAbort- &gt;Reset- FastB2B- PriDiscTmr- SecDiscTmr- DiscTmrStat- DiscTmrSERREn- Capabilities: [40] Power Management version 3 Flags: PMEClk- DSI- D1- D2- AuxCurrent=0mA PME(D0+,D1-,D2-,D3hot+,D3cold+) Status: D0 NoSoftRst+ PME-Enable- DSel=0 DScale=0 PME- Capabilities: [48] MSI: Enable+ Count=1/8 Maskable+ 64bit+ Address: 00000000fee00338 Data: 0000 Masking: 000000ff Pending: 00000000 Capabilities: [68] Express (v2) Downstream Port (Slot+), MSI 00 DevCap: MaxPayload 2048 bytes, PhantFunc 0 ExtTag- RBE+ DevCtl: Report errors: Correctable- Non-Fatal- Fatal- Unsupported- RlxdOrd- ExtTag- PhantFunc- AuxPwr- NoSnoop+ MaxPayload 256 bytes, MaxReadReq 128 bytes DevSta: CorrErr+ UncorrErr- FatalErr- UnsuppReq+ AuxPwr- TransPend- LnkCap: Port #16, Speed 8GT/s, Width x8, ASPM L1, Exit Latency L0s &lt;2us, L1 &lt;4us ClockPM- Surprise+ LLActRep+ BwNot+ LnkCtl: ASPM Disabled; Disabled- CommClk- ExtSynch- ClockPM- AutWidDis- BWInt- AutBWInt- LnkSta: Speed 5GT/s, Width x8, TrErr- Train- SlotClk- DLActive+ BWMgmt+ ABWMgmt+ SltCap: AttnBtn- PwrCtrl- MRL- AttnInd- PwrInd- HotPlug- Surprise- Slot #80, PowerLimit 25.000W; Interlock- NoCompl- SltCtl: Enable: AttnBtn- PwrFlt- MRL- PresDet- CmdCplt- HPIrq- LinkChg- Control: AttnInd Unknown, PwrInd Unknown, Power- Interlock- SltSta: Status: AttnBtn- PowerFlt- MRL- CmdCplt- PresDet+ Interlock- Changed: MRL- PresDet- LinkState- DevCap2: Completion Timeout: Not Supported, TimeoutDis-, LTR+, OBFF Via message ARIFwd+ DevCtl2: Completion Timeout: 50us to 50ms, TimeoutDis-, LTR+, OBFF Disabled ARIFwd- LnkCtl2: Target Link Speed: 8GT/s, EnterCompliance- SpeedDis-, Selectable De-emphasis: -6dB Transmit Margin: Normal Operating Range, EnterModifiedCompliance- ComplianceSOS- Compliance De-emphasis: -6dB LnkSta2: Current De-emphasis Level: -3.5dB, EqualizationComplete-, EqualizationPhase1- EqualizationPhase2-, EqualizationPhase3-, LinkEqualizationRequest- Capabilities: [a4] Subsystem: PLX Technology, Inc. Device 8747 Capabilities: [100 v1] Device Serial Number ba-87-00-10-b5-df-0e-00 Capabilities: [fb4 v1] Advanced Error Reporting UESta: DLP- SDES- TLP- FCP- CmpltTO- CmpltAbrt- UnxCmplt- RxOF- MalfTLP- ECRC- UnsupReq- ACSViol- UEMsk: DLP- SDES- TLP- FCP- CmpltTO- CmpltAbrt- UnxCmplt- RxOF- MalfTLP- ECRC- UnsupReq- ACSViol- UESvrt: DLP+ SDES+ TLP- FCP+ CmpltTO- CmpltAbrt- UnxCmplt- RxOF+ MalfTLP+ ECRC- UnsupReq- ACSViol- CESta: RxErr- BadTLP- BadDLLP- Rollover- Timeout- NonFatalErr+ CEMsk: RxErr- BadTLP- BadDLLP- Rollover- Timeout- NonFatalErr+ AERCap: First Error Pointer: 1f, GenCap+ CGenEn- ChkCap+ ChkEn- Capabilities: [138 v1] Power Budgeting &lt;?&gt; Capabilities: [10c v1] #19 Capabilities: [148 v1] Virtual Channel Caps: LPEVC=0 RefClk=100ns PATEntryBits=8 Arb: Fixed- WRR32- WRR64- WRR128- Ctrl: ArbSelect=Fixed Status: InProgress- VC0: Caps: PATOffset=03 MaxTimeSlots=1 RejSnoopTrans- Arb: Fixed- WRR32- WRR64+ WRR128- TWRR128- WRR256- Ctrl: Enable+ ID=0 ArbSelect=WRR64 TC/VC=ff Status: NegoPending- InProgress- Port Arbitration Table &lt;?&gt; Capabilities: [e00 v1] #12 Capabilities: [f24 v1] Access Control Services ACSCap: SrcValid+ TransBlk+ ReqRedir+ CmpltRedir+ UpstreamFwd+ EgressCtrl+ DirectTrans+ ACSCtl: SrcValid+ TransBlk- ReqRedir+ CmpltRedir+ UpstreamFwd+ EgressCtrl- DirectTrans- Capabilities: [b70 v1] Vendor Specific Information: ID=0001 Rev=0 Len=010 &lt;?&gt; Kernel driver in use: pcieport Kernel modules: shpchp</code></pre></div><p>02:11.0</p><div class="codebox"><pre class="vscroll"><code>02:11.0 PCI bridge: PLX Technology, Inc. Device 8747 (rev ba) (prog-if 00 [Normal decode]) Control: I/O+ Mem+ BusMaster+ SpecCycle- MemWINV- VGASnoop- ParErr- Stepping- SERR- FastB2B- DisINTx+ Status: Cap+ 66MHz- UDF- FastB2B- ParErr- DEVSEL=fast &gt;TAbort- &lt;TAbort- &lt;MAbort- &gt;SERR- &lt;PERR- INTx- Latency: 0, Cache Line Size: 64 bytes Bus: primary=02, secondary=05, subordinate=05, sec-latency=0 I/O behind bridge: 0000f000-00000fff Memory behind bridge: fff00000-000fffff Prefetchable memory behind bridge: 00000000fff00000-00000000000fffff Secondary status: 66MHz- FastB2B- ParErr- DEVSEL=fast &gt;TAbort- &lt;TAbort- &lt;MAbort- &lt;SERR- &lt;PERR- BridgeCtl: Parity- SERR- NoISA- VGA- MAbort- &gt;Reset- FastB2B- PriDiscTmr- SecDiscTmr- DiscTmrStat- DiscTmrSERREn- Capabilities: [40] Power Management version 3 Flags: PMEClk- DSI- D1- D2- AuxCurrent=0mA PME(D0+,D1-,D2-,D3hot+,D3cold+) Status: D0 NoSoftRst+ PME-Enable- DSel=0 DScale=0 PME- Capabilities: [48] MSI: Enable+ Count=1/8 Maskable+ 64bit+ Address: 00000000fee00358 Data: 0000 Masking: 000000ff Pending: 00000000 Capabilities: [68] Express (v2) Downstream Port (Slot+), MSI 00 DevCap: MaxPayload 2048 bytes, PhantFunc 0 ExtTag- RBE+ DevCtl: Report errors: Correctable- Non-Fatal- Fatal- Unsupported- RlxdOrd+ ExtTag- PhantFunc- AuxPwr- NoSnoop+ MaxPayload 256 bytes, MaxReadReq 128 bytes DevSta: CorrErr+ UncorrErr- FatalErr- UnsuppReq+ AuxPwr- TransPend- LnkCap: Port #17, Speed 8GT/s, Width x8, ASPM L1, Exit Latency L0s &lt;4us, L1 &lt;4us ClockPM- Surprise+ LLActRep+ BwNot+ LnkCtl: ASPM Disabled; Disabled- CommClk- ExtSynch- ClockPM- AutWidDis- BWInt- AutBWInt- LnkSta: Speed 2.5GT/s, Width x0, TrErr- Train- SlotClk- DLActive- BWMgmt- ABWMgmt- SltCap: AttnBtn- PwrCtrl- MRL- AttnInd- PwrInd- HotPlug- Surprise- Slot #81, PowerLimit 25.000W; Interlock- NoCompl- SltCtl: Enable: AttnBtn- PwrFlt- MRL- PresDet- CmdCplt- HPIrq- LinkChg- Control: AttnInd Unknown, PwrInd Unknown, Power- Interlock- SltSta: Status: AttnBtn- PowerFlt- MRL- CmdCplt- PresDet- Interlock- Changed: MRL- PresDet- LinkState- DevCap2: Completion Timeout: Not Supported, TimeoutDis-, LTR+, OBFF Via message ARIFwd+ DevCtl2: Completion Timeout: 50us to 50ms, TimeoutDis-, LTR-, OBFF Disabled ARIFwd- LnkCtl2: Target Link Speed: 8GT/s, EnterCompliance- SpeedDis-, Selectable De-emphasis: -6dB Transmit Margin: Normal Operating Range, EnterModifiedCompliance- ComplianceSOS- Compliance De-emphasis: -6dB LnkSta2: Current De-emphasis Level: -3.5dB, EqualizationComplete-, EqualizationPhase1- EqualizationPhase2-, EqualizationPhase3-, LinkEqualizationRequest- Capabilities: [a4] Subsystem: PLX Technology, Inc. Device 8747 Capabilities: [100 v1] Device Serial Number ba-87-00-10-b5-df-0e-00 Capabilities: [fb4 v1] Advanced Error Reporting UESta: DLP- SDES- TLP- FCP- CmpltTO- CmpltAbrt- UnxCmplt- RxOF- MalfTLP- ECRC- UnsupReq- ACSViol- UEMsk: DLP- SDES- TLP- FCP- CmpltTO- CmpltAbrt- UnxCmplt- RxOF- MalfTLP- ECRC- UnsupReq- ACSViol- UESvrt: DLP+ SDES+ TLP- FCP+ CmpltTO- CmpltAbrt- UnxCmplt- RxOF+ MalfTLP+ ECRC- UnsupReq- ACSViol- CESta: RxErr- BadTLP- BadDLLP- Rollover- Timeout- NonFatalErr+ CEMsk: RxErr- BadTLP- BadDLLP- Rollover- Timeout- NonFatalErr+ AERCap: First Error Pointer: 1f, GenCap+ CGenEn- ChkCap+ ChkEn- Capabilities: [138 v1] Power Budgeting &lt;?&gt; Capabilities: [10c v1] #19 Capabilities: [148 v1] Virtual Channel Caps: LPEVC=0 RefClk=100ns PATEntryBits=8 Arb: Fixed- WRR32- WRR64- WRR128- Ctrl: ArbSelect=Fixed Status: InProgress- VC0: Caps: PATOffset=03 MaxTimeSlots=1 RejSnoopTrans- Arb: Fixed- WRR32- WRR64+ WRR128- TWRR128- WRR256- Ctrl: Enable+ ID=0 ArbSelect=WRR64 TC/VC=ff Status: NegoPending+ InProgress- Port Arbitration Table &lt;?&gt; Capabilities: [e00 v1] #12 Capabilities: [f24 v1] Access Control Services ACSCap: SrcValid+ TransBlk+ ReqRedir+ CmpltRedir+ UpstreamFwd+ EgressCtrl+ DirectTrans+ ACSCtl: SrcValid+ TransBlk- ReqRedir+ CmpltRedir+ UpstreamFwd+ EgressCtrl- DirectTrans- Capabilities: [b70 v1] Vendor Specific Information: ID=0001 Rev=0 Len=010 &lt;?&gt; Kernel driver in use: pcieport Kernel modules: shpchp</code></pre></div><p>03:00.0</p><div class="codebox"><pre class="vscroll"><code>02:11.0 PCI bridge: PLX Technology, Inc. Device 8747 (rev ba) (prog-if 00 [Normal decode]) Control: I/O+ Mem+ BusMaster+ SpecCycle- MemWINV- VGASnoop- ParErr- Stepping- SERR- FastB2B- DisINTx+ Status: Cap+ 66MHz- UDF- FastB2B- ParErr- DEVSEL=fast &gt;TAbort- &lt;TAbort- &lt;MAbort- &gt;SERR- &lt;PERR- INTx- Latency: 0, Cache Line Size: 64 bytes Bus: primary=02, secondary=05, subordinate=05, sec-latency=0 I/O behind bridge: 0000f000-00000fff Memory behind bridge: fff00000-000fffff Prefetchable memory behind bridge: 00000000fff00000-00000000000fffff Secondary status: 66MHz- FastB2B- ParErr- DEVSEL=fast &gt;TAbort- &lt;TAbort- &lt;MAbort- &lt;SERR- &lt;PERR- BridgeCtl: Parity- SERR- NoISA- VGA- MAbort- &gt;Reset- FastB2B- PriDiscTmr- SecDiscTmr- DiscTmrStat- DiscTmrSERREn- Capabilities: [40] Power Management version 3 Flags: PMEClk- DSI- D1- D2- AuxCurrent=0mA PME(D0+,D1-,D2-,D3hot+,D3cold+) Status: D0 NoSoftRst+ PME-Enable- DSel=0 DScale=0 PME- Capabilities: [48] MSI: Enable+ Count=1/8 Maskable+ 64bit+ Address: 00000000fee00358 Data: 0000 Masking: 000000ff Pending: 00000000 Capabilities: [68] Express (v2) Downstream Port (Slot+), MSI 00 DevCap: MaxPayload 2048 bytes, PhantFunc 0 ExtTag- RBE+ DevCtl: Report errors: Correctable- Non-Fatal- Fatal- Unsupported- RlxdOrd+ ExtTag- PhantFunc- AuxPwr- NoSnoop+ MaxPayload 256 bytes, MaxReadReq 128 bytes DevSta: CorrErr+ UncorrErr- FatalErr- UnsuppReq+ AuxPwr- TransPend- LnkCap: Port #17, Speed 8GT/s, Width x8, ASPM L1, Exit Latency L0s &lt;4us, L1 &lt;4us ClockPM- Surprise+ LLActRep+ BwNot+ LnkCtl: ASPM Disabled; Disabled- CommClk- ExtSynch- ClockPM- AutWidDis- BWInt- AutBWInt- LnkSta: Speed 2.5GT/s, Width x0, TrErr- Train- SlotClk- DLActive- BWMgmt- ABWMgmt- SltCap: AttnBtn- PwrCtrl- MRL- AttnInd- PwrInd- HotPlug- Surprise- Slot #81, PowerLimit 25.000W; Interlock- NoCompl- SltCtl: Enable: AttnBtn- PwrFlt- MRL- PresDet- CmdCplt- HPIrq- LinkChg- Control: AttnInd Unknown, PwrInd Unknown, Power- Interlock- SltSta: Status: AttnBtn- PowerFlt- MRL- CmdCplt- PresDet- Interlock- Changed: MRL- PresDet- LinkState- DevCap2: Completion Timeout: Not Supported, TimeoutDis-, LTR+, OBFF Via message ARIFwd+ DevCtl2: Completion Timeout: 50us to 50ms, TimeoutDis-, LTR-, OBFF Disabled ARIFwd- LnkCtl2: Target Link Speed: 8GT/s, EnterCompliance- SpeedDis-, Selectable De-emphasis: -6dB Transmit Margin: Normal Operating Range, EnterModifiedCompliance- ComplianceSOS- Compliance De-emphasis: -6dB LnkSta2: Current De-emphasis Level: -3.5dB, EqualizationComplete-, EqualizationPhase1- EqualizationPhase2-, EqualizationPhase3-, LinkEqualizationRequest- Capabilities: [a4] Subsystem: PLX Technology, Inc. Device 8747 Capabilities: [100 v1] Device Serial Number ba-87-00-10-b5-df-0e-00 Capabilities: [fb4 v1] Advanced Error Reporting UESta: DLP- SDES- TLP- FCP- CmpltTO- CmpltAbrt- UnxCmplt- RxOF- MalfTLP- ECRC- UnsupReq- ACSViol- UEMsk: DLP- SDES- TLP- FCP- CmpltTO- CmpltAbrt- UnxCmplt- RxOF- MalfTLP- ECRC- UnsupReq- ACSViol- UESvrt: DLP+ SDES+ TLP- FCP+ CmpltTO- CmpltAbrt- UnxCmplt- RxOF+ MalfTLP+ ECRC- UnsupReq- ACSViol- CESta: RxErr- BadTLP- BadDLLP- Rollover- Timeout- NonFatalErr+ CEMsk: RxErr- BadTLP- BadDLLP- Rollover- Timeout- NonFatalErr+ AERCap: First Error Pointer: 1f, GenCap+ CGenEn- ChkCap+ ChkEn- Capabilities: [138 v1] Power Budgeting &lt;?&gt; Capabilities: [10c v1] #19 Capabilities: [148 v1] Virtual Channel Caps: LPEVC=0 RefClk=100ns PATEntryBits=8 Arb: Fixed- WRR32- WRR64- WRR128- Ctrl: ArbSelect=Fixed Status: InProgress- VC0: Caps: PATOffset=03 MaxTimeSlots=1 RejSnoopTrans- Arb: Fixed- WRR32- WRR64+ WRR128- TWRR128- WRR256- Ctrl: Enable+ ID=0 ArbSelect=WRR64 TC/VC=ff Status: NegoPending+ InProgress- Port Arbitration Table &lt;?&gt; Capabilities: [e00 v1] #12 Capabilities: [f24 v1] Access Control Services ACSCap: SrcValid+ TransBlk+ ReqRedir+ CmpltRedir+ UpstreamFwd+ EgressCtrl+ DirectTrans+ ACSCtl: SrcValid+ TransBlk- ReqRedir+ CmpltRedir+ UpstreamFwd+ EgressCtrl- DirectTrans- Capabilities: [b70 v1] Vendor Specific Information: ID=0001 Rev=0 Len=010 &lt;?&gt; Kernel driver in use: pcieport Kernel modules: shpchp</code></pre></div><p>03.00.1</p><div class="codebox"><pre class="vscroll"><code>03:00.1 Audio device: Advanced Micro Devices, Inc. [AMD/ATI] Cape Verde/Pitcairn HDMI Audio [Radeon HD 7700/7800 Series] Subsystem: Gigabyte Technology Co., Ltd Device aab0 Control: I/O+ Mem+ BusMaster+ SpecCycle- MemWINV- VGASnoop- ParErr- Stepping- SERR- FastB2B- DisINTx- Status: Cap+ 66MHz- UDF- FastB2B- ParErr- DEVSEL=fast &gt;TAbort- &lt;TAbort- &lt;MAbort- &gt;SERR- &lt;PERR- INTx- Latency: 0, Cache Line Size: 64 bytes Interrupt: pin B routed to IRQ 10 Region 0: Memory at dca60000 (64-bit, non-prefetchable) [size=16K] Capabilities: [48] Vendor Specific Information: Len=08 &lt;?&gt; Capabilities: [50] Power Management version 3 Flags: PMEClk- DSI- D1+ D2+ AuxCurrent=0mA PME(D0-,D1-,D2-,D3hot-,D3cold-) Status: D0 NoSoftRst- PME-Enable- DSel=0 DScale=0 PME- Capabilities: [58] Express (v2) Legacy Endpoint, MSI 00 DevCap: MaxPayload 256 bytes, PhantFunc 0, Latency L0s &lt;4us, L1 unlimited ExtTag+ AttnBtn- AttnInd- PwrInd- RBE+ FLReset- DevCtl: Report errors: Correctable- Non-Fatal- Fatal- Unsupported- RlxdOrd- ExtTag+ PhantFunc- AuxPwr- NoSnoop+ MaxPayload 256 bytes, MaxReadReq 512 bytes DevSta: CorrErr- UncorrErr- FatalErr- UnsuppReq- AuxPwr- TransPend- LnkCap: Port #8, Speed 8GT/s, Width x16, ASPM L0s L1, Exit Latency L0s &lt;64ns, L1 &lt;1us ClockPM- Surprise- LLActRep- BwNot- LnkCtl: ASPM Disabled; RCB 64 bytes Disabled- CommClk- ExtSynch- ClockPM- AutWidDis- BWInt- AutBWInt- LnkSta: Speed 8GT/s, Width x16, TrErr- Train- SlotClk+ DLActive- BWMgmt- ABWMgmt- DevCap2: Completion Timeout: Not Supported, TimeoutDis-, LTR-, OBFF Not Supported DevCtl2: Completion Timeout: 50us to 50ms, TimeoutDis-, LTR-, OBFF Disabled LnkSta2: Current De-emphasis Level: -6dB, EqualizationComplete-, EqualizationPhase1- EqualizationPhase2-, EqualizationPhase3-, LinkEqualizationRequest- Capabilities: [a0] MSI: Enable- Count=1/1 Maskable- 64bit+ Address: 0000000000000000 Data: 0000 Capabilities: [100 v1] Vendor Specific Information: ID=0001 Rev=1 Len=010 &lt;?&gt; Capabilities: [150 v2] Advanced Error Reporting UESta: DLP- SDES- TLP- FCP- CmpltTO- CmpltAbrt- UnxCmplt- RxOF- MalfTLP- ECRC- UnsupReq- ACSViol- UEMsk: DLP- SDES- TLP- FCP- CmpltTO- CmpltAbrt- UnxCmplt- RxOF- MalfTLP- ECRC- UnsupReq- ACSViol- UESvrt: DLP+ SDES+ TLP- FCP+ CmpltTO- CmpltAbrt- UnxCmplt- RxOF+ MalfTLP+ ECRC- UnsupReq- ACSViol- CESta: RxErr- BadTLP- BadDLLP- Rollover- Timeout- NonFatalErr+ CEMsk: RxErr- BadTLP- BadDLLP- Rollover- Timeout- NonFatalErr+ AERCap: First Error Pointer: 00, GenCap+ CGenEn- ChkCap+ ChkEn- Kernel driver in use: vfio-pci Kernel modules: snd_hda_intel</code></pre></div><p>04.00.0</p><div class="codebox"><pre class="vscroll"><code>04:00.0 VGA compatible controller: Advanced Micro Devices, Inc. [AMD/ATI] Turks XT [Radeon HD 6670/7670] (prog-if 00 [VGA controller]) Subsystem: ASUSTeK Computer Inc. Device 0443 Control: I/O+ Mem+ BusMaster+ SpecCycle- MemWINV- VGASnoop- ParErr- Stepping- SERR- FastB2B- DisINTx+ Status: Cap+ 66MHz- UDF- FastB2B- ParErr- DEVSEL=fast &gt;TAbort- &lt;TAbort- &lt;MAbort- &gt;SERR- &lt;PERR- INTx- Latency: 0, Cache Line Size: 64 bytes Interrupt: pin A routed to IRQ 66 Region 0: Memory at a0000000 (64-bit, prefetchable) [size=256M] Region 2: Memory at dc920000 (64-bit, non-prefetchable) [size=128K] Region 4: I/O ports at a000 [size=256] Expansion ROM at dc900000 [disabled] [size=128K] Capabilities: [50] Power Management version 3 Flags: PMEClk- DSI- D1+ D2+ AuxCurrent=0mA PME(D0-,D1-,D2-,D3hot-,D3cold-) Status: D0 NoSoftRst- PME-Enable- DSel=0 DScale=0 PME- Capabilities: [58] Express (v2) Legacy Endpoint, MSI 00 DevCap: MaxPayload 256 bytes, PhantFunc 0, Latency L0s &lt;4us, L1 unlimited ExtTag+ AttnBtn- AttnInd- PwrInd- RBE+ FLReset- DevCtl: Report errors: Correctable- Non-Fatal- Fatal- Unsupported- RlxdOrd- ExtTag+ PhantFunc- AuxPwr- NoSnoop+ MaxPayload 256 bytes, MaxReadReq 512 bytes DevSta: CorrErr- UncorrErr- FatalErr- UnsuppReq- AuxPwr- TransPend- LnkCap: Port #16, Speed 5GT/s, Width x16, ASPM L0s L1, Exit Latency L0s &lt;64ns, L1 &lt;1us ClockPM- Surprise- LLActRep- BwNot- LnkCtl: ASPM Disabled; RCB 64 bytes Disabled- CommClk- ExtSynch- ClockPM- AutWidDis- BWInt- AutBWInt- LnkSta: Speed 5GT/s, Width x8, TrErr- Train- SlotClk+ DLActive- BWMgmt- ABWMgmt- DevCap2: Completion Timeout: Not Supported, TimeoutDis-, LTR-, OBFF Not Supported DevCtl2: Completion Timeout: 50us to 50ms, TimeoutDis-, LTR-, OBFF Disabled LnkCtl2: Target Link Speed: 5GT/s, EnterCompliance- SpeedDis- Transmit Margin: Normal Operating Range, EnterModifiedCompliance- ComplianceSOS- Compliance De-emphasis: -6dB LnkSta2: Current De-emphasis Level: -6dB, EqualizationComplete-, EqualizationPhase1- EqualizationPhase2-, EqualizationPhase3-, LinkEqualizationRequest- Capabilities: [a0] MSI: Enable+ Count=1/1 Maskable- 64bit+ Address: 00000000fee00678 Data: 0000 Capabilities: [100 v1] Vendor Specific Information: ID=0001 Rev=1 Len=010 &lt;?&gt; Capabilities: [150 v1] Advanced Error Reporting UESta: DLP- SDES- TLP- FCP- CmpltTO- CmpltAbrt- UnxCmplt- RxOF- MalfTLP- ECRC- UnsupReq- ACSViol- UEMsk: DLP- SDES- TLP- FCP- CmpltTO- CmpltAbrt- UnxCmplt- RxOF- MalfTLP- ECRC- UnsupReq- ACSViol- UESvrt: DLP+ SDES+ TLP- FCP+ CmpltTO- CmpltAbrt- UnxCmplt- RxOF+ MalfTLP+ ECRC- UnsupReq- ACSViol- CESta: RxErr- BadTLP- BadDLLP- Rollover- Timeout- NonFatalErr+ CEMsk: RxErr- BadTLP- BadDLLP- Rollover- Timeout- NonFatalErr+ AERCap: First Error Pointer: 00, GenCap+ CGenEn- ChkCap+ ChkEn- Kernel driver in use: fglrx_pci Kernel modules: radeon, fglrx</code></pre></div><p>04.00.1</p><div class="codebox"><pre class="vscroll"><code>04:00.1 Audio device: Advanced Micro Devices, Inc. [AMD/ATI] Turks/Whistler HDMI Audio [Radeon HD 6000 Series] Subsystem: ASUSTeK Computer Inc. Device aa90 Control: I/O+ Mem+ BusMaster+ SpecCycle- MemWINV- VGASnoop- ParErr- Stepping- SERR- FastB2B- DisINTx+ Status: Cap+ 66MHz- UDF- FastB2B- ParErr- DEVSEL=fast &gt;TAbort- &lt;TAbort- &lt;MAbort- &gt;SERR- &lt;PERR- INTx- Latency: 0, Cache Line Size: 64 bytes Interrupt: pin B routed to IRQ 65 Region 0: Memory at dc940000 (64-bit, non-prefetchable) [size=16K] Capabilities: [50] Power Management version 3 Flags: PMEClk- DSI- D1+ D2+ AuxCurrent=0mA PME(D0-,D1-,D2-,D3hot-,D3cold-) Status: D0 NoSoftRst- PME-Enable- DSel=0 DScale=0 PME- Capabilities: [58] Express (v2) Legacy Endpoint, MSI 00 DevCap: MaxPayload 256 bytes, PhantFunc 0, Latency L0s &lt;4us, L1 unlimited ExtTag+ AttnBtn- AttnInd- PwrInd- RBE+ FLReset- DevCtl: Report errors: Correctable- Non-Fatal- Fatal- Unsupported- RlxdOrd- ExtTag+ PhantFunc- AuxPwr- NoSnoop+ MaxPayload 256 bytes, MaxReadReq 512 bytes DevSta: CorrErr- UncorrErr- FatalErr- UnsuppReq- AuxPwr- TransPend- LnkCap: Port #16, Speed 5GT/s, Width x16, ASPM L0s L1, Exit Latency L0s &lt;64ns, L1 &lt;1us ClockPM- Surprise- LLActRep- BwNot- LnkCtl: ASPM Disabled; RCB 64 bytes Disabled- CommClk- ExtSynch- ClockPM- AutWidDis- BWInt- AutBWInt- LnkSta: Speed 5GT/s, Width x8, TrErr- Train- SlotClk+ DLActive- BWMgmt- ABWMgmt- DevCap2: Completion Timeout: Not Supported, TimeoutDis-, LTR-, OBFF Not Supported DevCtl2: Completion Timeout: 50us to 50ms, TimeoutDis-, LTR-, OBFF Disabled LnkSta2: Current De-emphasis Level: -6dB, EqualizationComplete-, EqualizationPhase1- EqualizationPhase2-, EqualizationPhase3-, LinkEqualizationRequest- Capabilities: [a0] MSI: Enable+ Count=1/1 Maskable- 64bit+ Address: 00000000fee00658 Data: 0000 Capabilities: [100 v1] Vendor Specific Information: ID=0001 Rev=1 Len=010 &lt;?&gt; Capabilities: [150 v1] Advanced Error Reporting UESta: DLP- SDES- TLP- FCP- CmpltTO- CmpltAbrt- UnxCmplt- RxOF- MalfTLP- ECRC- UnsupReq- ACSViol- UEMsk: DLP- SDES- TLP- FCP- CmpltTO- CmpltAbrt- UnxCmplt- RxOF- MalfTLP- ECRC- UnsupReq- ACSViol- UESvrt: DLP+ SDES+ TLP- FCP+ CmpltTO- CmpltAbrt- UnxCmplt- RxOF+ MalfTLP+ ECRC- UnsupReq- ACSViol- CESta: RxErr- BadTLP- BadDLLP- Rollover- Timeout- NonFatalErr+ CEMsk: RxErr- BadTLP- BadDLLP- Rollover- Timeout- NonFatalErr+ AERCap: First Error Pointer: 00, GenCap+ CGenEn- ChkCap+ ChkEn- Kernel driver in use: snd_hda_intel Kernel modules: snd_hda_intel</code></pre></div><p>I&#039;m on week two of trying to get this set up, so any help at all is greatly appreciated!</p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1402357">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1402380" class="blockpost roweven"> <h2><span><span class="conr">#1510</span> <a href="viewtopic.php?pid=1402380#p1402380">2014-04-09 17:45:39</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=80279">novist</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2014-03-14</span></dd> <dd><span>Posts: 34</span></dd> <dd class="usercontacts"><span class="email"><a href="misc.php?email=80279">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <p>@Eb: read the error. it says exactly what you have not done - you have not bound devices to vfio driver using vfio-bind script that you were supposed to make.</p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1402380">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1402383" class="blockpost rowodd"> <h2><span><span class="conr">#1511</span> <a href="viewtopic.php?pid=1402383#p1402383">2014-04-09 17:49:58</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=80990">Eb</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2014-04-08</span></dd> <dd><span>Posts: 11</span></dd> <dd class="usercontacts"><span class="email"><a href="misc.php?email=80990">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>novist wrote:</cite><blockquote><div><p>@Eb: read the error. it says exactly what you have not done - you have not bound devices to vfio driver using vfio-bind script that you were supposed to make.</p></div></blockquote></div><p>I knew I forgot to mention something. I have the script created, and before attempting to run the KVM I run the script binding 03:00.0 and its subdevice 03:00.1</p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1402383">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1402387" class="blockpost roweven"> <h2><span><span class="conr">#1512</span> <a href="viewtopic.php?pid=1402387#p1402387">2014-04-09 18:02:01</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=75590">aw</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2013-10-04</span></dd> <dd><span>Posts: 921</span></dd> <dd class="usercontacts"><span class="email"><a href="misc.php?email=75590">Email</a></span> <span class="website"><a href="http://vfio.blogspot.com/" rel="nofollow">Website</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>Eb wrote:</cite><blockquote><div><div class="quotebox"><cite>novist wrote:</cite><blockquote><div><p>@Eb: read the error. it says exactly what you have not done - you have not bound devices to vfio driver using vfio-bind script that you were supposed to make.</p></div></blockquote></div><p>I knew I forgot to mention something. I have the script created, and before attempting to run the KVM I run the script binding 03:00.0 and its subdevice 03:00.1</p></div></blockquote></div><p>The error message says to make sure <strong>all</strong> of the devices in the group are bound to vfio.&#160; The group, as you reported contains far more than just the secondary function of the device.&#160; The IOMMU group on your system is large because the root port lacks PCIe ACS support.&#160; If you wish to override that, look for the ACS override patch and options to use it (and caveats that enabling it implies).</p> </div> <div class="postsignature postmsg"><hr /><p><a href="http://vfio.blogspot.com" rel="nofollow">http://vfio.blogspot.com</a><br />Looking for a more open forum to discuss vfio related uses?&#160; Try <a href="https://www.redhat.com/mailman/listinfo/vfio-users" rel="nofollow">https://www.redhat.com/mailman/listinfo/vfio-users</a></p></div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1402387">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1402388" class="blockpost rowodd"> <h2><span><span class="conr">#1513</span> <a href="viewtopic.php?pid=1402388#p1402388">2014-04-09 18:02:07</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=80028">trimm</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2014-03-06</span></dd> <dd><span>Posts: 31</span></dd> <dd class="usercontacts"><span class="email"><a href="misc.php?email=80028">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <p>Just bought a PCIe USB 3.0 card for my machine. I was going to use it solely for passthroughing but Im having difficulty getting it to work.</p><p>Error Im receiving: </p><div class="codebox"><pre><code>(qemu) qemu-system-x86_64: -device vfio-pci,host=07:00.0,bus=pcie.0: vfio: error, group 9 is not viable, please ensure all devices within the iommu_group are bound to their vfio bus driver. qemu-system-x86_64: -device vfio-pci,host=07:00.0,bus=pcie.0: vfio: failed to get group 9 qemu-system-x86_64: -device vfio-pci,host=07:00.0,bus=pcie.0: Device initialization failed. qemu-system-x86_64: -device vfio-pci,host=07:00.0,bus=pcie.0: Device &#039;vfio-pci&#039; could not be initialized Done</code></pre></div><p>lsgroup:</p><div class="codebox"><pre class="vscroll"><code>### Group 0 ### 00:00.0 Host bridge: Intel Corporation 4th Gen Core Processor DRAM Controller (rev 06) ### Group 1 ### 00:01.0 PCI bridge: Intel Corporation Xeon E3-1200 v3/4th Gen Core Processor PCI Express x16 Controller (rev 06) 01:00.0 VGA compatible controller: NVIDIA Corporation GK104 [GeForce GTX 670] (rev a1) 01:00.1 Audio device: NVIDIA Corporation GK104 HDMI Audio Controller (rev a1) ### Group 2 ### 00:02.0 VGA compatible controller: Intel Corporation Xeon E3-1200 v3/4th Gen Core Processor Integrated Graphics Controller (rev 06) ### Group 3 ### 00:03.0 Audio device: Intel Corporation Xeon E3-1200 v3/4th Gen Core Processor HD Audio Controller (rev 06) ### Group 4 ### 00:14.0 USB controller: Intel Corporation 8 Series/C220 Series Chipset Family USB xHCI (rev 05) ### Group 5 ### 00:16.0 Communication controller: Intel Corporation 8 Series/C220 Series Chipset Family MEI Controller #1 (rev 04) ### Group 6 ### 00:19.0 Ethernet controller: Intel Corporation Ethernet Connection I217-V (rev 05) ### Group 7 ### 00:1a.0 USB controller: Intel Corporation 8 Series/C220 Series Chipset Family USB EHCI #2 (rev 05) ### Group 8 ### 00:1b.0 Audio device: Intel Corporation 8 Series/C220 Series Chipset High Definition Audio Controller (rev 05) ### Group 9 ### 00:1c.0 PCI bridge: Intel Corporation 8 Series/C220 Series Chipset Family PCI Express Root Port #1 (rev d5) 00:1c.1 PCI bridge: Intel Corporation 8 Series/C220 Series Chipset Family PCI Express Root Port #2 (rev d5) 00:1c.2 PCI bridge: Intel Corporation 8 Series/C220 Series Chipset Family PCI Express Root Port #3 (rev d5) 00:1c.3 PCI bridge: Intel Corporation 8 Series/C220 Series Chipset Family PCI Express Root Port #4 (rev d5) 00:1c.4 PCI bridge: Intel Corporation 8 Series/C220 Series Chipset Family PCI Express Root Port #5 (rev d5) 00:1c.5 PCI bridge: Intel Corporation 8 Series/C220 Series Chipset Family PCI Express Root Port #6 (rev d5) 03:00.0 Network controller: Broadcom Corporation BCM4352 802.11ac Wireless Network Adapter (rev 03) 04:00.0 SATA controller: ASMedia Technology Inc. ASM1062 Serial ATA Controller (rev 01) 05:00.0 Ethernet controller: Intel Corporation I211 Gigabit Network Connection (rev 03) 06:00.0 SATA controller: ASMedia Technology Inc. ASM1062 Serial ATA Controller (rev 01) 07:00.0 USB controller: NEC Corporation uPD720200 USB 3.0 Host Controller (rev 04) ### Group 10 ### 00:1d.0 USB controller: Intel Corporation 8 Series/C220 Series Chipset Family USB EHCI #1 (rev 05) ### Group 11 ### 00:1f.0 ISA bridge: Intel Corporation Z87 Express LPC Controller (rev 05) 00:1f.2 SATA controller: Intel Corporation 8 Series/C220 Series Chipset Family 6-port SATA Controller 1 [AHCI mode] (rev 05) 00:1f.3 SMBus: Intel Corporation 8 Series/C220 Series Chipset Family SMBus Controller (rev 05)</code></pre></div><p>Im running with acs override patch included with nbhs kernel(3.13.6-1-mainline) at the moment. <br />I can see there are just too many devices in group 9, many of them I do not want to pass through. (It seems Intel didnt follow some standards here)</p><p>I see beckend found a new acs override patch written by awilliams, but this would be the first time I wouldve manually copy a patch for myself. </p><p>I get the following while trying to compile:</p><div class="codebox"><pre><code>patching file drivers/pci/quirks.c patch: 1.sh topic_10.html topic_11.html topic_12.html topic_13.html topic_14.html topic_15.html topic_16.html topic_17.html topic_18.html topic_19.html topic_1.html topic_20.html topic_21.html topic_22.html topic_23.html topic_24.html topic_25.html topic_26.html topic_27.html topic_28.html topic_29.html topic_2.html topic_30.html topic_31.html topic_32.html topic_33.html topic_34.html topic_35.html topic_36.html topic_37.html topic_38.html topic_39.html topic_3.html topic_40.html topic_41.html topic_42.html topic_43.html topic_44.html topic_45.html topic_46.html topic_47.html topic_48.html topic_49.html topic_4.html topic_50.html topic_51.html topic_52.html topic_53.html topic_54.html topic_55.html topic_56.html topic_57.html topic_58.html topic_59.html topic_5.html topic_60.html topic_6.html topic_7.html topic_8.html topic_9.html malformed patch at line 67: u16 device;</code></pre></div><p>Any help is appreciated, still got a lot to learn <img src="https://bbs.archlinux.org/img/smilies/smile.png" width="15" height="15" alt="smile" /></p><p>Update: Managed to implement the patch myself. The pci devices are now divided much more than before and I got my USB PCie card passthrough working!</p> <p class="postedit"><em>Last edited by trimm (2014-04-10 08:41:28)</em></p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1402388">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1402389" class="blockpost roweven"> <h2><span><span class="conr">#1514</span> <a href="viewtopic.php?pid=1402389#p1402389">2014-04-09 18:02:59</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=80279">novist</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2014-03-14</span></dd> <dd><span>Posts: 34</span></dd> <dd class="usercontacts"><span class="email"><a href="misc.php?email=80279">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <p>Still check if they are bound to vfio driver. For example my passed-through usb port 0000:00:13.0:</p><div class="codebox"><pre><code>ls -la /sys/devices/pci0000:00/0000:00:13.0/driver/module/drivers</code></pre></div><p>prints</p><div class="codebox"><pre><code>pci:vfio-pci</code></pre></div><p>Hope you can get it working. We have same GPU and im dying to find out if terrible performance im having is fault of GPU or what (hope its not discouraging!).</p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1402389">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1402390" class="blockpost rowodd"> <h2><span><span class="conr">#1515</span> <a href="viewtopic.php?pid=1402390#p1402390">2014-04-09 18:05:20</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=80990">Eb</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2014-04-08</span></dd> <dd><span>Posts: 11</span></dd> <dd class="usercontacts"><span class="email"><a href="misc.php?email=80990">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>aw wrote:</cite><blockquote><div><div class="quotebox"><cite>Eb wrote:</cite><blockquote><div><div class="quotebox"><cite>novist wrote:</cite><blockquote><div><p>@Eb: read the error. it says exactly what you have not done - you have not bound devices to vfio driver using vfio-bind script that you were supposed to make.</p></div></blockquote></div><p>I knew I forgot to mention something. I have the script created, and before attempting to run the KVM I run the script binding 03:00.0 and its subdevice 03:00.1</p></div></blockquote></div><p>The error message says to make sure <strong>all</strong> of the devices in the group are bound to vfio.&#160; The group, as you reported contains far more than just the secondary function of the device.&#160; The IOMMU group on your system is large because the root port lacks PCIe ACS support.&#160; If you wish to override that, look for the ACS override patch and options to use it (and caveats that enabling it implies).</p></div></blockquote></div><p>Could of sworn I already applied the patch, I&#039;ll look into it when i&#039;m back at my system. Thanks.</p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1402390">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1402427" class="blockpost roweven"> <h2><span><span class="conr">#1516</span> <a href="viewtopic.php?pid=1402427#p1402427">2014-04-09 20:07:57</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=80933">Cubex</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2014-04-06</span></dd> <dd><span>Posts: 24</span></dd> <dd class="usercontacts"><span class="email"><a href="mailto:cubexed@gmail.com">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <p>Yeah 770 works great under new qemu and using ubuntu kernel +&#160; pci acs patch, what problem where you facing Nex7?</p><p>I got net working and now im looking at audio, seems that is somewhat laggy and cuts often... tried both nbhs way of adding soundcard and using -soundhw parametere but result is same, all tried with alsa and pulseaudio as driver and still the same <img src="https://bbs.archlinux.org/img/smilies/hmm.png" width="15" height="15" alt="hmm" /></p><p>EDIT: Also I changed a bit the vfio-bind script to ignore already binded pci devices, so I can add vfio-bind on the qemu script</p><div class="codebox"><pre><code>#!/bin/bash if [ ! $USER = &quot;root&quot; ]; then echo &quot;Run as root!&quot; exit fi modprobe vfio-pci base=&quot;/tmp/vfio-bind&quot; mkdir $base -p for dev in &quot;$@&quot;; do path=&quot;$base/$dev&quot; if [ ! -f $path ]; then touch $path vendor=$(cat /sys/bus/pci/devices/$dev/vendor) device=$(cat /sys/bus/pci/devices/$dev/device) if [ -e /sys/bus/pci/devices/$dev/driver ]; then echo $dev &gt; /sys/bus/pci/devices/$dev/driver/unbind fi echo $vendor $device &gt; /sys/bus/pci/drivers/vfio-pci/new_id fi done</code></pre></div> <p class="postedit"><em>Last edited by Cubex (2014-04-09 22:06:50)</em></p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1402427">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1402438" class="blockpost rowodd"> <h2><span><span class="conr">#1517</span> <a href="viewtopic.php?pid=1402438#p1402438">2014-04-09 20:41:35</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=80990">Eb</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2014-04-08</span></dd> <dd><span>Posts: 11</span></dd> <dd class="usercontacts"><span class="email"><a href="misc.php?email=80990">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>Eb wrote:</cite><blockquote><div><div class="quotebox"><cite>aw wrote:</cite><blockquote><div><div class="quotebox"><cite>Eb wrote:</cite><blockquote><div><p>I knew I forgot to mention something. I have the script created, and before attempting to run the KVM I run the script binding 03:00.0 and its subdevice 03:00.1</p></div></blockquote></div><p>The error message says to make sure <strong>all</strong> of the devices in the group are bound to vfio.&#160; The group, as you reported contains far more than just the secondary function of the device.&#160; The IOMMU group on your system is large because the root port lacks PCIe ACS support.&#160; If you wish to override that, look for the ACS override patch and options to use it (and caveats that enabling it implies).</p></div></blockquote></div><p>Could of sworn I already applied the patch, I&#039;ll look into it when i&#039;m back at my system. Thanks.</p></div></blockquote></div><p>I&#039;ve re-installed the patched linux-mainline package listed on the main page, but I&#039;m still having the same issue of all my graphics devices being in the same IOMMU group. I&#039;m running a Z87 chipset, would that cause any issues? Is there a specific patch I should apply for this chipset? Thanks a ton for the help.</p><p>Edit: </p><p>I&#039;ve also read that this can potentially disable dri, which is something I need. Am I looking at a lost cause here?</p> <p class="postedit"><em>Last edited by Eb (2014-04-09 20:42:42)</em></p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1402438">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1402445" class="blockpost roweven"> <h2><span><span class="conr">#1518</span> <a href="viewtopic.php?pid=1402445#p1402445">2014-04-09 21:06:09</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=80335">beckend</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2014-03-16</span></dd> <dd><span>Posts: 5</span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <p>Try the V2 of the IOMMU patch: <a href="http://linux-kernel.2935.n7.nabble.com/PATCH-v2-0-3-Quirk-Intel-PCH-root-ports-for-ACS-like-features-td796884.html" rel="nofollow">http://linux-kernel.2935.n7.nabble.com/ … 96884.html</a><br />Do not apply the old acs patch.<br />Edit: only works on Intel.</p> <p class="postedit"><em>Last edited by beckend (2014-04-09 21:08:06)</em></p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1402445">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1402457" class="blockpost rowodd"> <h2><span><span class="conr">#1519</span> <a href="viewtopic.php?pid=1402457#p1402457">2014-04-09 21:37:12</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=76834">Val532</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2013-11-13</span></dd> <dd><span>Posts: 35</span></dd> <dd class="usercontacts"><span class="email"><a href="misc.php?email=76834">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>nbhs wrote:</cite><blockquote><div><div class="quotebox"><cite>Val532 wrote:</cite><blockquote><div><p>Hi all,</p><p>I have a small probleme, on my VM i want to start OCCT and i got a BSOD &quot;driver_irql_not_less_or_equal&quot; i have not any other information on the BSOD screen.</p><p>I run on qemu 2.0.0-RC1 and kernel 3.14, i have two graphique card AMD HD 6870 (crossfire not enable) on the VM (just for testing).</p><p>On dmesg i have : </p><div class="codebox"><pre><code>[ 8704.000634] kvm_get_msr_common: 82 callbacks suppressed [ 8704.000643] kvm [6821]: vcpu0 unhandled rdmsr: 0xce [ 8704.000686] kvm [6821]: vcpu0 unhandled rdmsr: 0xce [ 8704.004952] kvm [6821]: vcpu0 unhandled rdmsr: 0x637 [ 8704.004976] kvm [6821]: vcpu0 unhandled rdmsr: 0xe8 [ 8704.004989] kvm [6821]: vcpu0 unhandled rdmsr: 0xe7 [ 8704.005013] kvm [6821]: vcpu0 unhandled rdmsr: 0x31 [ 8704.005030] kvm [6821]: vcpu0 unhandled rdmsr: 0x35 [ 8704.005050] kvm [6821]: vcpu0 unhandled rdmsr: 0x39 [ 8704.005095] kvm [6821]: vcpu0 unhandled rdmsr: 0xce [ 8704.005108] kvm [6821]: vcpu0 unhandled rdmsr: 0x194</code></pre></div><p>Any help ? <br />Thanks</p></div></blockquote></div><p>try </p><div class="codebox"><pre><code>echo &quot;options kvm ignore_msrs=1&quot; &gt;&gt; /etc/modprobe.d/kvm.conf</code></pre></div></div></blockquote></div><p>Nop, i test it but nothing change, and i remove one card, so now i have only one GPU on my VM.</p><div class="codebox"><pre><code>[17229.256218] vfio-pci 0000:01:00.0: irq 56 for MSI/MSI-X [17311.585365] kvm [11122]: vcpu0 ignored rdmsr: 0xce [17311.585373] kvm [11122]: vcpu0 ignored rdmsr: 0xce [17311.589590] kvm [11122]: vcpu0 ignored rdmsr: 0x637 [17311.593788] kvm [11122]: vcpu0 ignored rdmsr: 0x637 [17311.593804] kvm [11122]: vcpu0 ignored rdmsr: 0xe8 [17311.598002] kvm [11122]: vcpu0 ignored rdmsr: 0xe8 [17311.598013] kvm [11122]: vcpu0 ignored rdmsr: 0xe7 [17311.602225] kvm [11122]: vcpu0 ignored rdmsr: 0xe7 [17311.602252] kvm [11122]: vcpu0 ignored rdmsr: 0x31 [17311.602257] kvm [11122]: vcpu0 ignored rdmsr: 0x35</code></pre></div> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1402457">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1402460" class="blockpost roweven"> <h2><span><span class="conr">#1520</span> <a href="viewtopic.php?pid=1402460#p1402460">2014-04-09 21:58:29</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=80701">apex8</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2014-03-29</span></dd> <dd><span>Posts: 47</span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <p>Just to get it right:<br />The IOMMU patch is meant to &quot;rearrange&quot; devices in the groups? At least this is what I understood from <a href="http://www.linux-kvm.org/wiki/images/b/b4/2012-forum-VFIO.pdf" rel="nofollow">here</a><br />In my case the USB3 Controller and the sound card are in the same group as a pci bridge and several pci exporess root ports. Would be great if I could change that.</p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1402460">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1402471" class="blockpost rowodd"> <h2><span><span class="conr">#1521</span> <a href="viewtopic.php?pid=1402471#p1402471">2014-04-09 22:12:53</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=70922">nbhs</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd class="postavatar"><img src="https://bbs.archlinux.org/img/avatars/70922.jpg?m=1367773811" width="80" height="80" alt="" /></dd> <dd><span>From: Montevideo, Uruguay</span></dd> <dd><span>Registered: 2013-05-02</span></dd> <dd><span>Posts: 402</span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>Eb wrote:</cite><blockquote><div><div class="quotebox"><cite>Eb wrote:</cite><blockquote><div><div class="quotebox"><cite>aw wrote:</cite><blockquote><div><p>The error message says to make sure <strong>all</strong> of the devices in the group are bound to vfio.&#160; The group, as you reported contains far more than just the secondary function of the device.&#160; The IOMMU group on your system is large because the root port lacks PCIe ACS support.&#160; If you wish to override that, look for the ACS override patch and options to use it (and caveats that enabling it implies).</p></div></blockquote></div><p>Could of sworn I already applied the patch, I&#039;ll look into it when i&#039;m back at my system. Thanks.</p></div></blockquote></div><p>I&#039;ve re-installed the patched linux-mainline package listed on the main page, but I&#039;m still having the same issue of all my graphics devices being in the same IOMMU group. I&#039;m running a Z87 chipset, would that cause any issues? Is there a specific patch I should apply for this chipset? Thanks a ton for the help.</p><p>Edit: </p><p>I&#039;ve also read that this can potentially disable dri, which is something I need. Am I looking at a lost cause here?</p></div></blockquote></div><p>You also need correct cmdline option in your bootloader otherwise the patch does nothing</p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1402471">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1402659" class="blockpost roweven"> <h2><span><span class="conr">#1522</span> <a href="viewtopic.php?pid=1402659#p1402659">2014-04-10 12:35:46</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=80990">Eb</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2014-04-08</span></dd> <dd><span>Posts: 11</span></dd> <dd class="usercontacts"><span class="email"><a href="misc.php?email=80990">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>nbhs wrote:</cite><blockquote><div><p>You also need correct cmdline option in your bootloader otherwise the patch does nothing</p></div></blockquote></div><p>I&#039;m currently using:</p><div class="codebox"><pre><code>intel_iommu=on pcie_acs_override=downstream pci-stub.ids=1002:6810,1002:aab0</code></pre></div><p>Am I missing anything?</p><p>Also, does the linux-mainline package on the first page contain the second version of the patch?</p><div class="quotebox"><cite>beckend wrote:</cite><blockquote><div><p>Try the V2 of the IOMMU patch: <a href="http://linux-kernel.2935.n7.nabble.com/" rel="nofollow">http://linux-kernel.2935.n7.nabble.com/</a> … 96884.html<br />Do not apply the old acs patch.<br />Edit: only works on Intel.</p></div></blockquote></div><p>I&#039;ve tried to apply all three parts of the patch, however I&#039;m getting &quot;patch unexpectedly ends in middle of line&quot; for 2/3 and 3/3. After doing this I realized that the patch may not work if there&#039;s an older version of the patch installed, or the same one is currently installed. Would I be correct or am I making some sort of silly mistake here?</p><p>Edit:</p><p>I&#039;ve failed to mention that I&#039;m fairly new with linux, sorry for any common questions that I may ask.</p> <p class="postedit"><em>Last edited by Eb (2014-04-10 12:37:46)</em></p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1402659">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1402833" class="blockpost rowodd"> <h2><span><span class="conr">#1523</span> <a href="viewtopic.php?pid=1402833#p1402833">2014-04-10 20:24:55</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=80335">beckend</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2014-03-16</span></dd> <dd><span>Posts: 5</span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <p>I believe they are conflicting patch (that was the case for me), skip the &quot;override_for_missing_acs_capabilities.patch&quot; if you plan to use V2 patch, start fresh undo all patches and go from there.</p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1402833">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1402835" class="blockpost roweven"> <h2><span><span class="conr">#1524</span> <a href="viewtopic.php?pid=1402835#p1402835">2014-04-10 20:27:59</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=80830">gneville</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2014-04-02</span></dd> <dd><span>Posts: 27</span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <p>Still not having much luck with vfio vga passthrough on my AMD R9 290 <img src="https://bbs.archlinux.org/img/smilies/sad.png" width="15" height="15" alt="sad" /></p><p>I&#039;ve tried pretty much all the suggestions I&#039;ve seen on here but no matter what I try the guest always crashes after installing video drivers.</p><p>I did swap from Win8 to Win7 and noticed that after installing the video drivers and rebooting when windows boots up it crashes with a BSOD saying</p><p>&quot;PAGE_FAULT_IN_NONPAGED_AREA&quot;</p><p>I&#039;ve tried the following:<br />multiple linux kernels all with the patches rolled in.<br />multiple Qemu versions (1.7.0, 1.7.1, 2.0.0RC0,1 &amp;2) and have applied the vga reset patches<br />Tried both machine types of q35 and i440fx, of which both successfully passthrough the vga card but crash after installing the drivers and rebooting windows<br />Tried just passing through the Video card leaving out the HDMI Audio.<br />Tried installing drivers without installing the Catalyst Control Centre as suggested by some other forums.<br />Tried both AMD drivers and Windows Provided drivers via Windows Updates.<br />Tried using RomFiles </p><p>I&#039;m guessing the problem lies within Qemu somewhere.</p><br /><div class="quotebox"><cite>gneville wrote:</cite><blockquote><div><p>On top of this I have just installed the OP linux-mainline (3.13.6-1-mainline),seabios (1.7.4.r1788.g8abc6a8-1) &amp; qemu (2.0.r31714.g03d5142-1) versions (Just added reset patch and manually compiled (<a href="https://lists.gnu.org/archive/html/qemu-devel/2014-02/msg00767.html)" rel="nofollow">https://lists.gnu.org/archive/html/qemu … 0767.html)</a>)</p><p>and still no change <img src="https://bbs.archlinux.org/img/smilies/sad.png" width="15" height="15" alt="sad" /></p><br /><br /><div class="quotebox"><cite>gneville wrote:</cite><blockquote><div><p>Hi All,</p><p>I&#039;m hoping someone will be able to help me out please. I&#039;ve been trying to get vga passthrough working with qemu and vfio for a few months on and off but having no luck. I&#039;m getting similar problems to users redger &amp; DanaGoyette.</p><p>My hardware: CPU: i7 4770s, MB: Jetway NF9J-Q87 GFX: AMD R9 290</p><p>I used to use Xen 4.3 and had vga passthrough working just passing through the intel hd4600 controller to hosts, but since I got the AMD R9 290 card Xen doesn&#039;t seem to passthrough the card whatsoever, so thought I would try qemu and vfio.</p><p>I&#039;ve tried using different linux versions and qemu versions but not having much luck. I am able to successfully vfio-bind my gfx card and I can start QEMU and get video via the GFX Card HDMI cable, I&#039;m also able to successfully install Windows 8.1. However after installation I&#039;m getting problems with either windows installing the amd drivers or using the catalyst driver installer, the host just reboots.</p><p>My latest setup:</p><p>linux 3.13.7-1 + i915 patch<br />Seabios git 1.7.4-66 (31Mar14)<br />Qemu 2.0.0 RC0 + patched pcibus_reset &amp; assertion (<a href="https://lists.nongnu.org/archive/html/qemu-devel/2014-03/msg05901.html" rel="nofollow">https://lists.nongnu.org/archive/html/q … 05901.html</a> &amp; <a href="https://lists.gnu.org/archive/html/qemu-devel/2014-02/msg00767.html" rel="nofollow">https://lists.gnu.org/archive/html/qemu … 00767.html</a>)</p><p>Before the pcibus_reset patch I kept getting the following messages when the host rebooted while trying to install the drivers:</p><div class="quotebox"><blockquote><div><p>&quot;qemu-system-x86_64 shows: hw/pci/pci.c:250: pcibus_reset: Assertion `bus-&gt;irq_count[\i] == 0&#039; failed.&quot;</p></div></blockquote></div><div class="quotebox"><blockquote><div><p>dmesg shows:&#160; 2805.839608 vfio-pci 0000:01:00.0: irq 46 for MSI/MSI-X</p></div></blockquote></div><br /><p>After applying the pcibust_reset patch the host no longer reboots after installing the drivers however the screen just goes blank so I have to manually kill the host. I do see the following messages:</p><div class="quotebox"><blockquote><div><p>qemu-system-x86_64 shows: ehci warning: guest updated active QH</p></div></blockquote></div><div class="quotebox"><blockquote><div><p>dmesg shows:&#160; 4681.189513 vfio-pci 0000:01:00.0: irq 46 for MSI/MSI-X</p></div></blockquote></div><p>This is my QEMU config:</p><div class="quotebox"><blockquote><div><p>/usr/local/qemu-2-0-0-rc0-patched-pci/bin/qemu-system-x86_64 -name win8 -enable-kvm -M q35 -m 6144&#160; \<br />-cpu Haswell,hv-time,hv_relaxed,hv_vapic,hv_spinlocks=0x1000 \<br />-boot order=dc \<br />-smp 2,sockets=1,cores=2,threads=1 \<br />-bios /root/vfio/bios.bin -vga none \<br />-usb -usbdevice tablet \<br />-spice port=5902,disable-ticketing \<br />-vnc 0.0.0.0:0 \<br />-device ioh3420,bus=pcie.0,addr=1c.0,multifunction=on,port=1,chassis=1,id=root.1 \<br />-device ahci,bus=pcie.0,id=ahci \<br />-net nic \<br />-net tap,ifname=tap0,script=no,downscript=no \<br />-device vfio-pci,host=01:00.0,bus=root.1,addr=00.0,multifunction=on,x-vga=on \<br />-device vfio-pci,host=01:00.1,bus=root.1,addr=00.1 \<br />-device vfio-pci,host=00:14.0,bus=pcie.0 \<br />-drive file=/dev/mapper/vg1-winv1,media=disk,index=1,id=disk,cache=none,if=virtio \<br />-drive file=/dev/mapper/vg1-winv1data,media=disk,index=2,id=diskb,cache=none,if=virtio \<br />-drive file=/home/xen/iso/windows/en-gb_windows_8_1_enterprise_x64_dvd_2971910.iso,boot=on,media=cdrom,index=3,id=isocd&#160; \<br />-device ide-cd,bus=ahci.1,drive=isocd \<br />-drive file=/root/virtio-win-0.1-74.iso,media=cdrom,index=4,id=virtio&#160; \<br />-device ide-cd,bus=ahci.2,drive=virtio</p></div></blockquote></div><p>If I enable &quot;-vga cirrus&quot; and VNC to the host I can install the AMD drivers successfully and after a reboot it shows in device manager the AMD card but with a yellow exclamation and code 43. If I then go back to &quot;-vga none&quot; windows no longer wants to boot and I need up in a boot loop (seabios&gt;windows booting&gt;seabios&gt;windows booting).</p><p>Any ideas please?</p></div></blockquote></div></div></blockquote></div> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1402835">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1402861" class="blockpost rowodd"> <h2><span><span class="conr">#1525</span> <a href="viewtopic.php?pid=1402861#p1402861">2014-04-10 21:35:39</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=80990">Eb</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2014-04-08</span></dd> <dd><span>Posts: 11</span></dd> <dd class="usercontacts"><span class="email"><a href="misc.php?email=80990">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>beckend wrote:</cite><blockquote><div><p>I believe they are conflicting patch (that was the case for me), skip the &quot;override_for_missing_acs_capabilities.patch&quot; if you plan to use V2 patch, start fresh undo all patches and go from there.</p></div></blockquote></div><p>I&#039;ve started fresh from the package on the main page, and have removed &quot;override_for_missing_acs_capabilities.patch&quot; from the pkgbuild and added in all three parts (in seperate files) of the ACS override patch. When I try to makepkg, I&#039;m getting this:</p><div class="codebox"><pre class="vscroll"><code>==&gt; Validating source files with md5sums... linux-3.14.tar.xz ... Passed config ... Passed config.x86_64 ... Passed linux.preset ... Passed change-default-console-loglevel.patch ... Passed 0001-Bluetooth-allocate-static-minor-for-vhci.patch ... Passed 0002-module-allow-multiple-calls-to-MODULE_DEVICE_TABLE-p.patch ... Passed 0003-module-remove-MODULE_GENERIC_TABLE.patch ... Passed 0004-Revert-syscalls.h-use-gcc-alias-instead-of-assembler.patch ... Passed enable_additional_cpu_optimizations_for_gcc.patch.gz ... Passed radeon_load_vbios_from_file.patch ... Passed aw_acs_1.patch ... Passed aw_acs_2.patch ... Passed aw_acs_3.patch ... Passed i915_314.patch ... Passed ==&gt; Extracting sources... -&gt; Extracting linux-3.14.tar.xz with bsdtar -&gt; Extracting enable_additional_cpu_optimizations_for_gcc.patch.gz with gzip ==&gt; Starting prepare()... patching file kernel/printk/printk.c Hunk #1 succeeded at 59 with fuzz 2 (offset 1 line). patching file Documentation/devices.txt patching file drivers/bluetooth/hci_vhci.c patching file include/linux/miscdevice.h patching file include/linux/module.h patching file scripts/mod/file2alias.c patching file include/linux/isapnp.h patching file include/linux/module.h patching file include/linux/compat.h patching file include/linux/syscalls.h patching file drivers/gpu/drm/radeon/radeon_bios.c patching file drivers/pci/pci.c Hunk #1 FAILED at 2180. Hunk #2 FAILED at 2212. 2 out of 2 hunks FAILED -- saving rejects to file drivers/pci/pci.c.rej patching file drivers/pci/quirks.c Hunk #1 succeeded at 3461 with fuzz 2. patching file include/linux/pci.h Hunk #1 succeeded at 1530 with fuzz 1 (offset 20 lines). Hunk #2 succeeded at 1543 with fuzz 2 (offset 20 lines). ==&gt; ERROR: A failure occurred in prepare(). Aborting...</code></pre></div><p>I just <em>know</em> I&#039;m missing something simple here, anyone see what it is? Do I need to edit the patches in some way?</p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1402861">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div class="postlinksb"> <div class="inbox crumbsplus"> <div class="pagepost"> <p class="pagelink conl"><span class="pages-label">Pages: </span><a rel="prev" class="item1" href="viewtopic.php?id=162768&amp;p=60">Previous</a> <a href="viewtopic.php?id=162768">1</a> <span class="spacer">…</span> <a href="viewtopic.php?id=162768&amp;p=59">59</a> <a href="viewtopic.php?id=162768&amp;p=60">60</a> <strong>61</strong> <a href="viewtopic.php?id=162768&amp;p=62">62</a> <a href="viewtopic.php?id=162768&amp;p=63">63</a> <span class="spacer">…</span> <a href="viewtopic.php?id=162768&amp;p=234">234</a> <a rel="next" href="viewtopic.php?id=162768&amp;p=62">Next</a></p> <p class="postlink conr">Topic closed</p> </div> <ul class="crumbs"> <li><a href="index.php">Index</a></li> <li><span>»&#160;</span><a href="viewforum.php?id=48">Topics Going Nowhere</a></li> <li><span>»&#160;</span><strong><a href="viewtopic.php?id=162768">KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</a></strong></li> </ul> <p class="subscribelink clearb"><a href="misc.php?action=subscribe&amp;tid=162768">Subscribe to this topic</a></p> <div class="clearer"></div> </div> </div> </div> <div id="brdfooter" class="block"> <h2><span>Board footer</span></h2> <div class="box"> <div id="brdfooternav" class="inbox"> <div class="conl"> <form id="qjump" method="get" action="viewforum.php"> <div><label><span>Jump to<br /></span> <select name="id" onchange="window.location=('viewforum.php?id='+this.options[this.selectedIndex].value)"> <optgroup label="Technical Issues and Assistance"> <option value="23">Newbie Corner</option> <option value="17">Installation</option> <option value="22">Kernel &amp; Hardware</option> <option value="18">Applications &amp; Desktop Environments</option> <option value="31">Laptop Issues</option> <option value="8">Networking, Server, and Protection</option> <option value="32">Multimedia and Games</option> <option value="50">System Administration</option> <option value="35">Other Architectures</option> </optgroup> <optgroup label="Arch-centric"> <option value="24">Announcements, Package &amp; Security Advisories</option> <option value="1">Arch Discussion</option> <option value="13">Forum &amp; Wiki discussion</option> </optgroup> <optgroup label="Pacman Upgrades, Packaging &amp; AUR"> <option value="44">Pacman &amp; Package Upgrade Issues</option> <option value="49">[testing] Repo Forum</option> <option value="4">Creating &amp; Modifying Packages</option> <option value="38">AUR Issues, Discussion &amp; PKGBUILD Requests</option> </optgroup> <optgroup label="Contributions &amp; Discussion"> <option value="20">GNU/Linux Discussion</option> <option value="27">Community Contributions</option> <option value="33">Programming &amp; Scripting</option> <option value="30">Other Languages</option> <option value="47">Artwork and Screenshots</option> <option value="42">Try This</option> </optgroup> <optgroup label="/dev/null"> <option value="29">Off-Topic</option> <option value="48" selected="selected">Topics Going Nowhere</option> <option value="36">Dustbin</option> </optgroup> </select></label> <input type="submit" value=" Go " accesskey="g" /> </div> </form> </div> <div class="conr"> <p id="feedlinks"><span class="atom"><a href="extern.php?action=feed&amp;tid=162768&amp;type=atom">Atom topic feed</a></span></p> <p id="poweredby">Powered by <a href="http://fluxbb.org/">FluxBB</a></p> </div> <div class="clearer"></div> </div> </div> </div> </div> <div class="end-box"></div> </div> </body> </html>
