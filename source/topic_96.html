<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"> <html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en" dir="ltr"> <head> <meta http-equiv="Content-Type" content="text/html; charset=utf-8" /> <title>KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9 (Page 96) / Topics Going Nowhere / Arch Linux Forums</title> <link rel="stylesheet" type="text/css" href="style/ArchLinux.css" /> <link rel="canonical" href="viewtopic.php?id=162768&amp;p=96" title="Page 96" /> <link rel="prev" href="viewtopic.php?id=162768&amp;p=95" title="Page 95" /> <link rel="next" href="viewtopic.php?id=162768&amp;p=97" title="Page 97" /> <link rel="alternate" type="application/atom+xml" href="extern.php?action=feed&amp;tid=162768&amp;type=atom" title="Atom topic feed" /> <link rel="stylesheet" media="screen" href="style/ArchLinux/arch.css?v=3" /> <link rel="stylesheet" media="screen" href="style/ArchLinux/archnavbar.css?v=2" /> <link rel="shortcut icon" href="style/ArchLinux/favicon.ico" /> </head> <body> <div id="archnavbar" class="anb-forum"> <div id="archnavbarlogo"><h1><a href="http://www.archlinux.org/">Arch Linux</a></h1></div> <div id="archnavbarmenu"> <ul id="archnavbarlist"> <li id="anb-home"><a href="http://www.archlinux.org/">Home</a></li><li id="anb-packages"><a href="http://www.archlinux.org/packages/">Packages</a></li><li id="anb-forums" class="anb-selected"><a href="https://bbs.archlinux.org/">Forums</a></li><li id="anb-wiki"><a href="https://wiki.archlinux.org/">Wiki</a></li><li id="anb-bugs"><a href="https://bugs.archlinux.org/">Bugs</a></li><li id="anb-aur"><a href="https://aur.archlinux.org/">AUR</a></li><li id="anb-download"><a href="http://www.archlinux.org/download/">Download</a></li> </ul> </div> </div> <div id="punviewtopic" class="pun"> <div class="top-box"></div> <div class="punwrap"> <div id="brdheader" class="block"> <div class="box"> <div id="brdmenu" class="inbox"> <ul> <li id="navindex" class="isactive"><a href="index.php">Index</a></li> <li id="navuserlist"><a href="userlist.php">User list</a></li> <li id="navsearch"><a href="search.php">Search</a></li> <li id="navprofile"><a href="profile.php?id=80749">Profile</a></li> <li id="navlogout"><a href="login.php?action=out&amp;id=80749&amp;csrf_token=5c20501ec397bb45ef8ee8c84db232c8d8e421c6">Logout</a></li> </ul> </div> <div id="brdwelcome" class="inbox"> <ul class="conl"> <li><span>Logged in as <strong>SXX</strong></span></li> <li><span>Last visit: 2015-08-16 12:20:09</span></li> </ul> <ul class="conr"> <li><span>Topics: <a href="search.php?action=show_replies" title="Find topics you have posted to.">Posted</a> | <a href="search.php?action=show_new" title="Find topics with new posts since your last visit.">New</a> | <a href="search.php?action=show_recent" title="Find topics with recent posts.">Active</a> | <a href="search.php?action=show_unanswered" title="Find topics with no replies.">Unanswered</a></span></li> </ul> <div class="clearer"></div> </div> </div> </div> <div id="brdmain"> <div class="linkst"> <div class="inbox crumbsplus"> <ul class="crumbs"> <li><a href="index.php">Index</a></li> <li><span>»&#160;</span><a href="viewforum.php?id=48">Topics Going Nowhere</a></li> <li><span>»&#160;</span><strong><a href="viewtopic.php?id=162768">KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</a></strong></li> </ul> <div class="pagepost"> <p class="pagelink conl"><span class="pages-label">Pages: </span><a rel="prev" class="item1" href="viewtopic.php?id=162768&amp;p=95">Previous</a> <a href="viewtopic.php?id=162768">1</a> <span class="spacer">…</span> <a href="viewtopic.php?id=162768&amp;p=94">94</a> <a href="viewtopic.php?id=162768&amp;p=95">95</a> <strong>96</strong> <a href="viewtopic.php?id=162768&amp;p=97">97</a> <a href="viewtopic.php?id=162768&amp;p=98">98</a> <span class="spacer">…</span> <a href="viewtopic.php?id=162768&amp;p=234">234</a> <a rel="next" href="viewtopic.php?id=162768&amp;p=97">Next</a></p> <p class="postlink conr">Topic closed</p> </div> <div class="clearer"></div> </div> </div> <div id="p1439259" class="blockpost rowodd blockpost1"> <h2><span><span class="conr">#2376</span> <a href="viewtopic.php?pid=1439259#p1439259">2014-07-23 22:08:55</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=80387">dwe11er</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2014-03-18</span></dd> <dd><span>Posts: 73</span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>CharlieBra7o wrote:</cite><blockquote><div><div class="quotebox"><cite>kaeptnb wrote:</cite><blockquote><div><p>&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;<br />&#160; &lt;os&gt;&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <br />&#160; &#160; &lt;type arch=&#039;x86_64&#039; machine=&#039;pc-q35-1.5&#039;&gt;hvm&lt;/type&gt;&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;<br />&#160; &#160; ...<br />&#160; &lt;/os&gt;&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;<br />&#160; ...<br />&#160; &lt;devices&gt;&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;<br />&#160; &#160; &lt;emulator&gt;/usr/local/kvm/bin/qemu-system-x86_64&lt;/emulator&gt;&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <br />&#160; &#160; ...<br />&#160; &lt;/devices&gt;<br />&#160; ...<br />&#160; &lt;qemu:commandline&gt;<br />&#160; &#160; &lt;qemu:arg value=&#039;-device&#039;/&gt;<br />&#160; &#160; &lt;qemu:arg value=&#039;ioh3420,bus=pcie.0,addr=1c.0,multifunction=on,port=1,chassis=1,id=root.1&#039;/&gt;<br />&#160; &#160; &lt;qemu:arg value=&#039;-device&#039;/&gt;<br />&#160; &#160; &lt;qemu:arg value=&#039;vfio-pci,host=08:00.0,bus=root.1,addr=00.0,multifunctioIs there n=on,x-vga=on&#039;/&gt;<br />&#160; &#160; &lt;qemu:arg value=&#039;-device&#039;/&gt;<br />&#160; &#160; &lt;qemu:arg value=&#039;vfio-pci,host=08:00.1,bus=root.1,addr=00.1&#039;/&gt;<br />&#160; &#160; ...<br />&#160; &#160; &lt;qemu:arg value=&#039;-bios&#039;/&gt;<br />&#160; &#160; &lt;qemu:arg value=&#039;/usr/src/kvm/seabios-1.7.2-patched/seabios/out/bios.bin&#039;/&gt;<br />&#160; &#160; ...<br />&#160; &lt;/qemu:commandline&gt;</p></div></blockquote></div><p>I tried using these &lt;qemu:*&gt; tags in my virt-manager XML, but no matter if I define a new VM from the XML or edit an existing one, all the qemu tags vanish without an error. This means after I insert them, virsh edit/define, and then reopen the XML file all the qemu tags are gone...<br />I tried virt-manager and libvirt from both official repo and AUR. No difference <img src="https://bbs.archlinux.org/img/smilies/sad.png" width="15" height="15" alt="sad" /><br />Am I missing some setting for qemu integration or why is this happening???</p></div></blockquote></div><div class="codebox"><pre><code>&lt;domain type=&#039;kvm&#039; xmlns:qemu=&#039;http://libvirt.org/schemas/domain/qemu/1.0&#039;&gt;</code></pre></div><p>This is how the first line should look, otherwise it clears all the &lt;qemu:*&gt; stuff.</p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1439259">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1439271" class="blockpost roweven"> <h2><span><span class="conr">#2377</span> <a href="viewtopic.php?pid=1439271#p1439271">2014-07-23 22:50:55</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=79909">CharlieBra7o</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2014-03-01</span></dd> <dd><span>Posts: 20</span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>dwe11er wrote:</cite><blockquote><div><div class="codebox"><pre><code>&lt;domain type=&#039;kvm&#039; xmlns:qemu=&#039;http://libvirt.org/schemas/domain/qemu/1.0&#039;&gt;</code></pre></div><p>This is how the first line should look, otherwise it clears all the &lt;qemu:*&gt; stuff.</p></div></blockquote></div><p>That did the trick <img src="https://bbs.archlinux.org/img/smilies/smile.png" width="15" height="15" alt="smile" /> Thank you!</p> <p class="postedit"><em>Last edited by CharlieBra7o (2014-07-23 22:51:27)</em></p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1439271">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1439440" class="blockpost rowodd"> <h2><span><span class="conr">#2378</span> <a href="viewtopic.php?pid=1439440#p1439440">2014-07-24 15:23:51</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=83741">monchi</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2014-07-21</span></dd> <dd><span>Posts: 9</span></dd> <dd class="usercontacts"><span class="email"><a href="misc.php?email=83741">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>apex8 wrote:</cite><blockquote><div><div class="quotebox"><cite>monchi wrote:</cite><blockquote><div><div class="quotebox"><cite>apex8 wrote:</cite><blockquote><div><p>This worked for me. That flag seems to be &quot;new&quot;, at least for me <img src="https://bbs.archlinux.org/img/smilies/smile.png" width="15" height="15" alt="smile" /> If I remember correctly, the vga arbiter was always on previously.</p></div></blockquote></div><p>no success with my configuration...<br />Any got an idea what to do next?</p></div></blockquote></div><p>Hard to say where to start, but did you check your hardware for compatibility? Theres an linked Gdrive table document here, where you could look up your configuration.</p></div></blockquote></div><p>i could not find the document ...</p><p>But i gave it a try with XenServer 6.2.. GPU passthrough worked out of the box (same hardware). So it should be possible to set up passthrough with KVM either right?</p> <p class="postedit"><em>Last edited by monchi (2014-07-24 15:32:25)</em></p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1439440">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1439608" class="blockpost roweven"> <h2><span><span class="conr">#2379</span> <a href="viewtopic.php?pid=1439608#p1439608">2014-07-24 22:44:14</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=83810">Nickolai</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2014-07-24</span></dd> <dd><span>Posts: 1</span></dd> <dd class="usercontacts"><span class="email"><a href="misc.php?email=83810">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <p>What&#039;s the problem with passing through an Intel VGA card? Is it impassable? I would really like to pass through an Intel card on my ThinkPad X series.</p> <p class="postedit"><em>Last edited by Nickolai (2014-07-24 22:44:32)</em></p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1439608">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1439914" class="blockpost rowodd"> <h2><span><span class="conr">#2380</span> <a href="viewtopic.php?pid=1439914#p1439914">2014-07-25 19:01:48</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=81541">belliash</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2014-04-25</span></dd> <dd><span>Posts: 16</span></dd> <dd class="usercontacts"><span class="email"><a href="mailto:belliash@asiotec.eu.org">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>Nickolai wrote:</cite><blockquote><div><p>What&#039;s the problem with passing through an Intel VGA card? Is it impassable? I would really like to pass through an Intel card on my ThinkPad X series.</p></div></blockquote></div><p>no, its possible. check xengt</p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1439914">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1439918" class="blockpost roweven"> <h2><span><span class="conr">#2381</span> <a href="viewtopic.php?pid=1439918#p1439918">2014-07-25 19:10:46</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=53953">andy123</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2011-11-04</span></dd> <dd><span>Posts: 169</span></dd> <dd class="usercontacts"><span class="email"><a href="misc.php?email=53953">Email</a></span> <span class="website"><a href="http://ajs124.de" rel="nofollow">Website</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>belliash wrote:</cite><blockquote><div><div class="quotebox"><cite>Nickolai wrote:</cite><blockquote><div><p>What&#039;s the problem with passing through an Intel VGA card? Is it impassable? I would really like to pass through an Intel card on my ThinkPad X series.</p></div></blockquote></div><p>no, its possible. check xengt</p></div></blockquote></div><p>Or take a look at <a href="http://smartos.org/" rel="nofollow">SmartOS</a>. While I haven&#039;t used it personally, a friend of mine uses it and is very happy with it.</p> </div> <div class="postsignature postmsg"><hr /><p>i&#039;m sorry for my poor english wirting skills…</p></div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1439918">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1439994" class="blockpost rowodd"> <h2><span><span class="conr">#2382</span> <a href="viewtopic.php?pid=1439994#p1439994">2014-07-26 00:31:37</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=79825">redger</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2014-02-26</span></dd> <dd><span>Posts: 15</span></dd> <dd class="usercontacts"><span class="email"><a href="misc.php?email=79825">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <p>Is anyone using Centos 7 for VGA Passthrough ? Do you have a full patch-set for this (kernel 3.10) ... and if so, could you post the patches ....</p><p>I&#039;d like to use Centos as a host (for stability) - but wondering about KVM patches for VGA passthrough (including performance enhancements)</p><p>Thanks for your help</p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1439994">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1440047" class="blockpost roweven"> <h2><span><span class="conr">#2383</span> <a href="viewtopic.php?pid=1440047#p1440047">2014-07-26 06:39:43</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=81541">belliash</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2014-04-25</span></dd> <dd><span>Posts: 16</span></dd> <dd class="usercontacts"><span class="email"><a href="mailto:belliash@asiotec.eu.org">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>andy123 wrote:</cite><blockquote><div><div class="quotebox"><cite>belliash wrote:</cite><blockquote><div><div class="quotebox"><cite>Nickolai wrote:</cite><blockquote><div><p>What&#039;s the problem with passing through an Intel VGA card? Is it impassable? I would really like to pass through an Intel card on my ThinkPad X series.</p></div></blockquote></div><p>no, its possible. check xengt</p></div></blockquote></div><p>Or take a look at <a href="http://smartos.org/" rel="nofollow">SmartOS</a>. While I haven&#039;t used it personally, a friend of mine uses it and is very happy with it.</p></div></blockquote></div><p>Are you serious? SmartOS = ZFS + DTrace + Zones + KVM<br />KVM doesn&#039;t support mediated GPU passthrough. Only XenGT can do that.</p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1440047">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1440116" class="blockpost rowodd"> <h2><span><span class="conr">#2384</span> <a href="viewtopic.php?pid=1440116#p1440116">2014-07-26 14:14:39</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=53953">andy123</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2011-11-04</span></dd> <dd><span>Posts: 169</span></dd> <dd class="usercontacts"><span class="email"><a href="misc.php?email=53953">Email</a></span> <span class="website"><a href="http://ajs124.de" rel="nofollow">Website</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>belliash wrote:</cite><blockquote><div><div class="quotebox"><cite>andy123 wrote:</cite><blockquote><div><p>Or take a look at <a href="http://smartos.org/" rel="nofollow">SmartOS</a>. While I haven&#039;t used it personally, a friend of mine uses it and is very happy with it.</p></div></blockquote></div><p>Are you serious? SmartOS = ZFS + DTrace + Zones + KVM<br />KVM doesn&#039;t support mediated GPU passthrough. Only XenGT can do that.</p></div></blockquote></div><p>It&#039;s KVM on the OpenIndia (from SunOS/OpenSolaris) kernel and as said I don&#039;t use it, because it only works on Intel CPUs. My friend claimed that it did GPU passthrough with his Intel GPU. I didn&#039;t verify this (and can&#039;t try myself, because I don&#039;t have the hardware), but I trust him enough to at least propose it as a possibility.</p><p>I&#039;m sorry however, if this can&#039;t do passthrough of an Intel GPU.</p> </div> <div class="postsignature postmsg"><hr /><p>i&#039;m sorry for my poor english wirting skills…</p></div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1440116">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1440138" class="blockpost roweven"> <h2><span><span class="conr">#2385</span> <a href="viewtopic.php?pid=1440138#p1440138">2014-07-26 15:34:37</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=66944">shrubuntu</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2012-12-26</span></dd> <dd><span>Posts: 16</span></dd> <dd class="usercontacts"><span class="email"><a href="misc.php?email=66944">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <p>Hi, </p><p>I get </p><div class="codebox"><pre><code> Hunk #1 FAILED at 3292 </code></pre></div><p> when I try to patch the 3.15.6 kernel with the acs patch. </p><p>I use this command </p><div class="codebox"><pre><code> patch -p1 -i ../acs.patch --dry-run </code></pre></div><p>I am running debian jessie. I have gotten kvm and IOMMU to work on arch linux, but I can&#039;t seem to get it on debian. What should I do?</p><br /><p>----EDIT----</p><div class="quotebox"><cite>rg80 wrote:</cite><blockquote><div><div class="quotebox"><cite>blimpi wrote:</cite><blockquote><div><p>The error &quot;patch unexpectedly ends in middle of line&quot; might point to a broken acs.patch file. See this <a href="http://unix.stackexchange.com/questions/1395/what-does-patch-unexpectedly-ends-in-middle-of-line-mean" rel="nofollow">link</a> for some ideas about the cause.</p></div></blockquote></div><p>I think i got it, let me post again the solution found some pages behind.</p><p>If you have any problem applying original acs override patch from Alex Williamson (Hunk #1 FAILED at 3292 in my case) try downloading <a href="http://www.fileswap.com/dl/nBgeX5Twa/" rel="nofollow">this package</a> which contains a new version. </p><p>This one applies correctly on my Debian system with kernel 3.15.3<br />Just built a new kernel image, will test it later and update. <img src="https://bbs.archlinux.org/img/smilies/smile.png" width="15" height="15" alt="smile" /></p><p>Edit: it works! Thanks again to this fantastic thread!</p><div class="codebox"><pre class="vscroll"><code>### Group 0 ### 00:00.0 Host bridge: Intel Corporation Xeon E3-1200 v3 Processor DRAM Controller (rev 06) ### Group 1 ### 00:01.0 PCI bridge: Intel Corporation Xeon E3-1200 v3/4th Gen Core Processor PCI Express x16 Controller (rev 06) ### Group 2 ### 00:01.1 PCI bridge: Intel Corporation Xeon E3-1200 v3/4th Gen Core Processor PCI Express x8 Controller (rev 06) ### Group 3 ### 00:14.0 USB controller: Intel Corporation 8 Series/C220 Series Chipset Family USB xHCI (rev 05) ### Group 4 ### 00:1c.0 PCI bridge: Intel Corporation 8 Series/C220 Series Chipset Family PCI Express Root Port #1 (rev d5) ### Group 5 ### 00:1c.2 PCI bridge: Intel Corporation 8 Series/C220 Series Chipset Family PCI Express Root Port #3 (rev d5) ### Group 6 ### 00:1c.3 PCI bridge: Intel Corporation 8 Series/C220 Series Chipset Family PCI Express Root Port #4 (rev d5) ### Group 7 ### 00:1f.0 ISA bridge: Intel Corporation C222 Series Chipset Family Server Essential SKU LPC Controller (rev 05) 00:1f.2 SATA controller: Intel Corporation 8 Series/C220 Series Chipset Family 6-port SATA Controller 1 [AHCI mode] (rev 05) 00:1f.3 SMBus: Intel Corporation 8 Series/C220 Series Chipset Family SMBus Controller (rev 05) 00:1f.6 Signal processing controller: Intel Corporation 8 Series Chipset Family Thermal Management Controller (rev 05) ### Group 8 ### 01:00.0 VGA compatible controller: NVIDIA Corporation GK104 [GeForce GTX 760] (rev a1) 01:00.1 Audio device: NVIDIA Corporation GK104 HDMI Audio Controller (rev a1) ### Group 9 ### 02:00.0 Serial Attached SCSI controller: LSI Logic / Symbios Logic SAS2308 PCI-Express Fusion-MPT SAS-2 (rev 05) ### Group 10 ### 03:00.0 PCI bridge: ASPEED Technology, Inc. AST1150 PCI-to-PCI Bridge (rev 03) 04:00.0 VGA compatible controller: ASPEED Technology, Inc. ASPEED Graphics Family (rev 30) ### Group 11 ### 05:00.0 Ethernet controller: Intel Corporation I210 Gigabit Network Connection (rev 03) ### Group 12 ### 06:00.0 Ethernet controller: Intel Corporation I210 Gigabit Network Connection (rev 03)</code></pre></div></div></blockquote></div><br /><p>This post solved my issue!</p> <p class="postedit"><em>Last edited by shrubuntu (2014-07-26 15:46:17)</em></p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1440138">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1440171" class="blockpost rowodd"> <h2><span><span class="conr">#2386</span> <a href="viewtopic.php?pid=1440171#p1440171">2014-07-26 17:47:16</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=81541">belliash</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2014-04-25</span></dd> <dd><span>Posts: 16</span></dd> <dd class="usercontacts"><span class="email"><a href="mailto:belliash@asiotec.eu.org">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>andy123 wrote:</cite><blockquote><div><div class="quotebox"><cite>belliash wrote:</cite><blockquote><div><div class="quotebox"><cite>andy123 wrote:</cite><blockquote><div><p>Or take a look at <a href="http://smartos.org/" rel="nofollow">SmartOS</a>. While I haven&#039;t used it personally, a friend of mine uses it and is very happy with it.</p></div></blockquote></div><p>Are you serious? SmartOS = ZFS + DTrace + Zones + KVM<br />KVM doesn&#039;t support mediated GPU passthrough. Only XenGT can do that.</p></div></blockquote></div><p>It&#039;s KVM on the OpenIndia (from SunOS/OpenSolaris) kernel and as said I don&#039;t use it, because it only works on Intel CPUs. My friend claimed that it did GPU passthrough with his Intel GPU. I didn&#039;t verify this (and can&#039;t try myself, because I don&#039;t have the hardware), but I trust him enough to at least propose it as a possibility.</p><p>I&#039;m sorry however, if this can&#039;t do passthrough of an Intel GPU.</p></div></blockquote></div><p>No, it can&#039;t. KVM doesnt support such things.</p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1440171">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1440173" class="blockpost roweven"> <h2><span><span class="conr">#2387</span> <a href="viewtopic.php?pid=1440173#p1440173">2014-07-26 18:02:44</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=83626">DLWood1001</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2014-07-17</span></dd> <dd><span>Posts: 4</span></dd> <dd class="usercontacts"><span class="email"><a href="misc.php?email=83626">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>redger wrote:</cite><blockquote><div><p>Is anyone using Centos 7 for VGA Passthrough ? Do you have a full patch-set for this (kernel 3.10) ... and if so, could you post the patches ....</p><p>I&#039;d like to use Centos as a host (for stability) - but wondering about KVM patches for VGA passthrough (including performance enhancements)</p><p>Thanks for your help</p></div></blockquote></div><p>Hi Redger,</p><p>I am using RHEL7 w/3.15.6 kernel.</p><p>Needed to download the src rpm files for kernel-ml, Seabios, Qemu, IPXE, EDK2-Tools and built from scratch. Note: The spec files were modded lightly to allow for the latest versions of these projects to compile.</p><p>Issues Included:<br /> Kernel, enabled some options in the kernel-config, re-diffed the patches to merge properly. ACS, i915, VGA-ARB, DMA-v4 patches from AW&#039;s patch history on patchwork.<br /> Seabios, out of date and some roms were not packaged correctly.<br /> Qemu, Broken links to IPXE directory.<br /> IPXE, Didn&#039;t inlcude EFI roms.<br /> EDK2-Tools, required by IPXE to build EFI roms.</p><p>Currently, everything is working with VGA passthrough. I have RHEL7 host running both a Win8.1 guest and OS X mavericks guests running simultaneously.</p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1440173">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1440301" class="blockpost rowodd"> <h2><span><span class="conr">#2388</span> <a href="viewtopic.php?pid=1440301#p1440301">2014-07-26 23:15:53</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=79825">redger</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2014-02-26</span></dd> <dd><span>Posts: 15</span></dd> <dd class="usercontacts"><span class="email"><a href="misc.php?email=79825">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <p>thanks @DLWood,<br />sounds like it was a bit tricky <img src="https://bbs.archlinux.org/img/smilies/smile.png" width="15" height="15" alt="smile" /> was it worthwhile ?<br />I have refactored the patches for Ubuntu 3.13 kernel and am running that but considered Centos with &quot;native&quot; kernel in the hope it might be more stable / suitable for 24*7 ue (before I start moving other servers across to VMs)</p><p>did you consider using the &quot;stock&quot; Centos kernel (v3.10) ?</p><p>thanks again for your reply</p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1440301">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1440397" class="blockpost roweven"> <h2><span><span class="conr">#2389</span> <a href="viewtopic.php?pid=1440397#p1440397">2014-07-27 12:38:52</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=83626">DLWood1001</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2014-07-17</span></dd> <dd><span>Posts: 4</span></dd> <dd class="usercontacts"><span class="email"><a href="misc.php?email=83626">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <p>Hi @redger,</p><p>I would say it is worth it for me <img src="https://bbs.archlinux.org/img/smilies/smile.png" width="15" height="15" alt="smile" />, I&#039;ve learned a lot in the process. </p><p>I did consider using the 3.10 kernel, but had to upgrade due to some unrelated hardware limitations that are resolved in latest 3.11+ mainline releases.</p><p>I believe my hardware problem will be resolved in RHEL 7.1, so I may try using the stock RHEL7 kernel after that is released. The stock RHEL7/CentOS7 kernel config doesn&#039;t have CONFIG_VFIO_PCI_VGA enabled, so you would need to maintain your own build either way.</p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1440397">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1440415" class="blockpost rowodd"> <h2><span><span class="conr">#2390</span> <a href="viewtopic.php?pid=1440415#p1440415">2014-07-27 14:31:12</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=79909">CharlieBra7o</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2014-03-01</span></dd> <dd><span>Posts: 20</span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <p>After I booted up my freshly installed Windows 8.1 for the first time it worked for about 60 seconds or so, then the monitor lost its signal. From this moment on the monitor always loses its signal during the Windows loading screen. The VM&#039;s CPU load from this moment on seems to be completely steady using up 1 full thread.</p><p>My guess is that Windows tried to install some crappy GPU/chipset drivers or apply some wrong settings...</p><p>Does anyone have an idea what might be going on there?</p><br /><p>Additional info:<br />- Radeon HD 7950<br />- 3.15.6 from the OP unchanged<br />- qemu-git 2.1.r34391.gf368c33-1 + libvirt 1.2.6-1 from GIT</p> <p class="postedit"><em>Last edited by CharlieBra7o (2014-07-27 14:37:12)</em></p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1440415">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1440422" class="blockpost roweven"> <h2><span><span class="conr">#2391</span> <a href="viewtopic.php?pid=1440422#p1440422">2014-07-27 14:52:19</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=66944">shrubuntu</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2012-12-26</span></dd> <dd><span>Posts: 16</span></dd> <dd class="usercontacts"><span class="email"><a href="misc.php?email=66944">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <p>Alright I have got it mostly working except for a few snags. </p><p>I get an &quot;Code 43&quot; on the nvidia driver within my windows 7 guest and</p><p>I cannot restart the VM once I have shut it down without restarting my computer</p><p>Is there any fix for these?</p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1440422">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1440435" class="blockpost rowodd"> <h2><span><span class="conr">#2392</span> <a href="viewtopic.php?pid=1440435#p1440435">2014-07-27 15:14:15</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=79909">CharlieBra7o</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2014-03-01</span></dd> <dd><span>Posts: 20</span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>shrubuntu wrote:</cite><blockquote><div><p>Alright I have got it mostly working except for a few snags. </p><p>I get an &quot;Code 43&quot; on the nvidia driver within my windows 7 guest and</p><p>I cannot restart the VM once I have shut it down without restarting my computer</p><p>Is there any fix for these?</p></div></blockquote></div><p>@Code 43: read <a href="https://bbs.archlinux.org/viewtopic.php?pid=1426160#p1426160" rel="nofollow">https://bbs.archlinux.org/viewtopic.php … 0#p1426160</a> and following post(s)<br />@Reboot: This issue definitely has been discussed from page 1 on. I think you need the vga reset patch that aw posted a few pages before, but Im not sure...</p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1440435">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1440459" class="blockpost roweven"> <h2><span><span class="conr">#2393</span> <a href="viewtopic.php?pid=1440459#p1440459">2014-07-27 16:21:22</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=79534">zzz3000</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2014-02-16</span></dd> <dd><span>Posts: 12</span></dd> <dd class="usercontacts"><span class="email"><a href="misc.php?email=79534">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <p>hello it works for me with problem</p><p>I get messages </p><p>Jul 27 20:00:01 DeltaS systemd: Starting Session 5 of user root.<br />Jul 27 20:00:01 DeltaS systemd: Started Session 5 of user root.<br />Jul 27 20:01:01 DeltaS systemd: Starting Session 6 of user root.<br />Jul 27 20:01:01 DeltaS systemd: Started Session 6 of user root.<br />Jul 27 20:01:01 DeltaS systemd: Starting Session 7 of user sanek.<br />Jul 27 20:01:01 DeltaS systemd: Started Session 7 of user sanek.<br />Jul 27 20:10:01 DeltaS systemd: Starting Session 8 of user root.<br />Jul 27 20:10:01 DeltaS systemd: Started Session 8 of user root</p><br /><p>And I get BSOD in some minutes</p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1440459">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1440546" class="blockpost rowodd"> <h2><span><span class="conr">#2394</span> <a href="viewtopic.php?pid=1440546#p1440546">2014-07-27 20:43:51</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=75590">aw</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2013-10-04</span></dd> <dd><span>Posts: 921</span></dd> <dd class="usercontacts"><span class="email"><a href="misc.php?email=75590">Email</a></span> <span class="website"><a href="http://vfio.blogspot.com/" rel="nofollow">Website</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>zzz3000 wrote:</cite><blockquote><div><p>hello it works for me with problem</p><p>I get messages </p><p>Jul 27 20:00:01 DeltaS systemd: Starting Session 5 of user root.<br />Jul 27 20:00:01 DeltaS systemd: Started Session 5 of user root.<br />Jul 27 20:01:01 DeltaS systemd: Starting Session 6 of user root.<br />Jul 27 20:01:01 DeltaS systemd: Started Session 6 of user root.<br />Jul 27 20:01:01 DeltaS systemd: Starting Session 7 of user sanek.<br />Jul 27 20:01:01 DeltaS systemd: Started Session 7 of user sanek.<br />Jul 27 20:10:01 DeltaS systemd: Starting Session 8 of user root.<br />Jul 27 20:10:01 DeltaS systemd: Started Session 8 of user root</p><br /><p>And I get BSOD in some minutes</p></div></blockquote></div><p>You don&#039;t really expect that someone can give you useful advice with this tiny bit of information, do you?</p> </div> <div class="postsignature postmsg"><hr /><p><a href="http://vfio.blogspot.com" rel="nofollow">http://vfio.blogspot.com</a><br />Looking for a more open forum to discuss vfio related uses?&#160; Try <a href="https://www.redhat.com/mailman/listinfo/vfio-users" rel="nofollow">https://www.redhat.com/mailman/listinfo/vfio-users</a></p></div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1440546">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1440566" class="blockpost roweven"> <h2><span><span class="conr">#2395</span> <a href="viewtopic.php?pid=1440566#p1440566">2014-07-27 21:44:07</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=66944">shrubuntu</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2012-12-26</span></dd> <dd><span>Posts: 16</span></dd> <dd class="usercontacts"><span class="email"><a href="misc.php?email=66944">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>CharlieBra7o wrote:</cite><blockquote><div><div class="quotebox"><cite>shrubuntu wrote:</cite><blockquote><div><p>Alright I have got it mostly working except for a few snags. </p><p>I get an &quot;Code 43&quot; on the nvidia driver within my windows 7 guest and</p><p>I cannot restart the VM once I have shut it down without restarting my computer</p><p>Is there any fix for these?</p></div></blockquote></div><p>@Code 43: read <a href="https://bbs.archlinux.org/viewtopic.php?pid=1426160#p1426160" rel="nofollow">https://bbs.archlinux.org/viewtopic.php … 0#p1426160</a> and following post(s)<br />@Reboot: This issue definitely has been discussed from page 1 on. I think you need the vga reset patch that aw posted a few pages before, but Im not sure...</p></div></blockquote></div><p>Awesome, reverting to 335 drivers fixed the issue!<br />Everything running smoothly</p><p>My system : </p><p>Debian Jessie with custom 3.15.6 kernel with patches from OP<br />i7 4790k<br />MSI gaming 5 motherboard<br />GTX 580</p><p>@aw what is the status of VGA reset patches?</p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1440566">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1440573" class="blockpost rowodd"> <h2><span><span class="conr">#2396</span> <a href="viewtopic.php?pid=1440573#p1440573">2014-07-27 22:02:57</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=82442">slis</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2014-06-02</span></dd> <dd><span>Posts: 125</span></dd> <dd class="usercontacts"><span class="email"><a href="mailto:xslisx@gmail.com">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <p>Dump gpu bios, use it in your config and u should be able to reset...</p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1440573">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1440575" class="blockpost roweven"> <h2><span><span class="conr">#2397</span> <a href="viewtopic.php?pid=1440575#p1440575">2014-07-27 22:05:20</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=66944">shrubuntu</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2012-12-26</span></dd> <dd><span>Posts: 16</span></dd> <dd class="usercontacts"><span class="email"><a href="misc.php?email=66944">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>slis wrote:</cite><blockquote><div><p>Dump gpu bios, use it in your config and u should be able to reset...</p></div></blockquote></div><p>Interesting, can you describe this a bit more?</p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1440575">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1440614" class="blockpost rowodd"> <h2><span><span class="conr">#2398</span> <a href="viewtopic.php?pid=1440614#p1440614">2014-07-28 00:07:50</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=79991">mv0lnicky</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2014-03-05</span></dd> <dd><span>Posts: 16</span></dd> <dd class="usercontacts"><span class="email"><a href="misc.php?email=79991">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <p>If you are dual booting Windows, just use GPU-Z to dump your GPU BIOS into a file. Then you&#039;ll have VGA reset from QEMU.</p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1440614">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1440745" class="blockpost roweven"> <h2><span><span class="conr">#2399</span> <a href="viewtopic.php?pid=1440745#p1440745">2014-07-28 12:42:29</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=79909">CharlieBra7o</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2014-03-01</span></dd> <dd><span>Posts: 20</span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>CharlieBra7o wrote:</cite><blockquote><div><p>After I booted up my freshly installed Windows 8.1 for the first time it worked for about 60 seconds or so, then the monitor lost its signal. From this moment on the monitor always loses its signal during the Windows loading screen. The VM&#039;s CPU load from this moment on seems to be completely steady using up 1 full thread.</p><p>My guess is that Windows tried to install some crappy GPU/chipset drivers or apply some wrong settings...</p><p>Does anyone have an idea what might be going on there?</p><br /><p>Additional info:<br />- Radeon HD 7950<br />- 3.15.6 from the OP unchanged<br />- qemu-git 2.1.r34391.gf368c33-1 + libvirt 1.2.6-1 from GIT</p></div></blockquote></div><p>Just tried installing Windows 7 and after the installation I spent about 5 minutes clicking around, then shutdown the VM to make an image and started it up again. Now it always freezes during the &quot;Starting Windows&quot; screen and &#039;virsh list&#039; lists the VM as &#039;paused&#039;.<br />dmesg doesn&#039;t show anything peculiar, except maybe</p><div class="codebox"><pre><code>kvm: zapping shadow pages for mmio generation wraparound</code></pre></div><p>Honestly, I have absolutely no clue what to try next...</p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1440745">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1440856" class="blockpost rowodd"> <h2><span><span class="conr">#2400</span> <a href="viewtopic.php?pid=1440856#p1440856">2014-07-28 17:44:17</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=80387">dwe11er</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2014-03-18</span></dd> <dd><span>Posts: 73</span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>CharlieBra7o wrote:</cite><blockquote><div><div class="quotebox"><cite>CharlieBra7o wrote:</cite><blockquote><div><p>After I booted up my freshly installed Windows 8.1 for the first time it worked for about 60 seconds or so, then the monitor lost its signal. From this moment on the monitor always loses its signal during the Windows loading screen. The VM&#039;s CPU load from this moment on seems to be completely steady using up 1 full thread.</p><p>My guess is that Windows tried to install some crappy GPU/chipset drivers or apply some wrong settings...</p><p>Does anyone have an idea what might be going on there?</p><br /><p>Additional info:<br />- Radeon HD 7950<br />- 3.15.6 from the OP unchanged<br />- qemu-git 2.1.r34391.gf368c33-1 + libvirt 1.2.6-1 from GIT</p></div></blockquote></div><p>Just tried installing Windows 7 and after the installation I spent about 5 minutes clicking around, then shutdown the VM to make an image and started it up again. Now it always freezes during the &quot;Starting Windows&quot; screen and &#039;virsh list&#039; lists the VM as &#039;paused&#039;.<br />dmesg doesn&#039;t show anything peculiar, except maybe</p><div class="codebox"><pre><code>kvm: zapping shadow pages for mmio generation wraparound</code></pre></div><p>Honestly, I have absolutely no clue what to try next...</p></div></blockquote></div><p>virsh tells you the reason, why vm was paused. I had similar issue (I/O Error), because of vm&#039;s disks being raw file images on btrfs (and having really low performance).</p> <p class="postedit"><em>Last edited by dwe11er (2014-07-29 08:42:10)</em></p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1440856">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div class="postlinksb"> <div class="inbox crumbsplus"> <div class="pagepost"> <p class="pagelink conl"><span class="pages-label">Pages: </span><a rel="prev" class="item1" href="viewtopic.php?id=162768&amp;p=95">Previous</a> <a href="viewtopic.php?id=162768">1</a> <span class="spacer">…</span> <a href="viewtopic.php?id=162768&amp;p=94">94</a> <a href="viewtopic.php?id=162768&amp;p=95">95</a> <strong>96</strong> <a href="viewtopic.php?id=162768&amp;p=97">97</a> <a href="viewtopic.php?id=162768&amp;p=98">98</a> <span class="spacer">…</span> <a href="viewtopic.php?id=162768&amp;p=234">234</a> <a rel="next" href="viewtopic.php?id=162768&amp;p=97">Next</a></p> <p class="postlink conr">Topic closed</p> </div> <ul class="crumbs"> <li><a href="index.php">Index</a></li> <li><span>»&#160;</span><a href="viewforum.php?id=48">Topics Going Nowhere</a></li> <li><span>»&#160;</span><strong><a href="viewtopic.php?id=162768">KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</a></strong></li> </ul> <p class="subscribelink clearb"><a href="misc.php?action=subscribe&amp;tid=162768">Subscribe to this topic</a></p> <div class="clearer"></div> </div> </div> </div> <div id="brdfooter" class="block"> <h2><span>Board footer</span></h2> <div class="box"> <div id="brdfooternav" class="inbox"> <div class="conl"> <form id="qjump" method="get" action="viewforum.php"> <div><label><span>Jump to<br /></span> <select name="id" onchange="window.location=('viewforum.php?id='+this.options[this.selectedIndex].value)"> <optgroup label="Technical Issues and Assistance"> <option value="23">Newbie Corner</option> <option value="17">Installation</option> <option value="22">Kernel &amp; Hardware</option> <option value="18">Applications &amp; Desktop Environments</option> <option value="31">Laptop Issues</option> <option value="8">Networking, Server, and Protection</option> <option value="32">Multimedia and Games</option> <option value="50">System Administration</option> <option value="35">Other Architectures</option> </optgroup> <optgroup label="Arch-centric"> <option value="24">Announcements, Package &amp; Security Advisories</option> <option value="1">Arch Discussion</option> <option value="13">Forum &amp; Wiki discussion</option> </optgroup> <optgroup label="Pacman Upgrades, Packaging &amp; AUR"> <option value="44">Pacman &amp; Package Upgrade Issues</option> <option value="49">[testing] Repo Forum</option> <option value="4">Creating &amp; Modifying Packages</option> <option value="38">AUR Issues, Discussion &amp; PKGBUILD Requests</option> </optgroup> <optgroup label="Contributions &amp; Discussion"> <option value="20">GNU/Linux Discussion</option> <option value="27">Community Contributions</option> <option value="33">Programming &amp; Scripting</option> <option value="30">Other Languages</option> <option value="47">Artwork and Screenshots</option> <option value="42">Try This</option> </optgroup> <optgroup label="/dev/null"> <option value="29">Off-Topic</option> <option value="48" selected="selected">Topics Going Nowhere</option> <option value="36">Dustbin</option> </optgroup> </select></label> <input type="submit" value=" Go " accesskey="g" /> </div> </form> </div> <div class="conr"> <p id="feedlinks"><span class="atom"><a href="extern.php?action=feed&amp;tid=162768&amp;type=atom">Atom topic feed</a></span></p> <p id="poweredby">Powered by <a href="http://fluxbb.org/">FluxBB</a></p> </div> <div class="clearer"></div> </div> </div> </div> </div> <div class="end-box"></div> </div> </body> </html>
