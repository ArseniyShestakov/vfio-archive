<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"> <html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en" dir="ltr"> <head> <meta http-equiv="Content-Type" content="text/html; charset=utf-8" /> <title>KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9 (Page 172) / Topics Going Nowhere / Arch Linux Forums</title> <link rel="stylesheet" type="text/css" href="style/ArchLinux.css" /> <link rel="canonical" href="viewtopic.php?id=162768&amp;p=172" title="Page 172" /> <link rel="prev" href="viewtopic.php?id=162768&amp;p=171" title="Page 171" /> <link rel="next" href="viewtopic.php?id=162768&amp;p=173" title="Page 173" /> <link rel="alternate" type="application/atom+xml" href="extern.php?action=feed&amp;tid=162768&amp;type=atom" title="Atom topic feed" /> <link rel="stylesheet" media="screen" href="style/ArchLinux/arch.css?v=3" /> <link rel="stylesheet" media="screen" href="style/ArchLinux/archnavbar.css?v=2" /> <link rel="shortcut icon" href="style/ArchLinux/favicon.ico" /> </head> <body> <div id="archnavbar" class="anb-forum"> <div id="archnavbarlogo"><h1><a href="http://www.archlinux.org/">Arch Linux</a></h1></div> <div id="archnavbarmenu"> <ul id="archnavbarlist"> <li id="anb-home"><a href="http://www.archlinux.org/">Home</a></li><li id="anb-packages"><a href="http://www.archlinux.org/packages/">Packages</a></li><li id="anb-forums" class="anb-selected"><a href="https://bbs.archlinux.org/">Forums</a></li><li id="anb-wiki"><a href="https://wiki.archlinux.org/">Wiki</a></li><li id="anb-bugs"><a href="https://bugs.archlinux.org/">Bugs</a></li><li id="anb-aur"><a href="https://aur.archlinux.org/">AUR</a></li><li id="anb-download"><a href="http://www.archlinux.org/download/">Download</a></li> </ul> </div> </div> <div id="punviewtopic" class="pun"> <div class="top-box"></div> <div class="punwrap"> <div id="brdheader" class="block"> <div class="box"> <div id="brdmenu" class="inbox"> <ul> <li id="navindex" class="isactive"><a href="index.php">Index</a></li> <li id="navuserlist"><a href="userlist.php">User list</a></li> <li id="navsearch"><a href="search.php">Search</a></li> <li id="navprofile"><a href="profile.php?id=80749">Profile</a></li> <li id="navlogout"><a href="login.php?action=out&amp;id=80749&amp;csrf_token=5c20501ec397bb45ef8ee8c84db232c8d8e421c6">Logout</a></li> </ul> </div> <div id="brdwelcome" class="inbox"> <ul class="conl"> <li><span>Logged in as <strong>SXX</strong></span></li> <li><span>Last visit: 2015-08-16 12:20:09</span></li> </ul> <ul class="conr"> <li><span>Topics: <a href="search.php?action=show_replies" title="Find topics you have posted to.">Posted</a> | <a href="search.php?action=show_new" title="Find topics with new posts since your last visit.">New</a> | <a href="search.php?action=show_recent" title="Find topics with recent posts.">Active</a> | <a href="search.php?action=show_unanswered" title="Find topics with no replies.">Unanswered</a></span></li> </ul> <div class="clearer"></div> </div> </div> </div> <div id="brdmain"> <div class="linkst"> <div class="inbox crumbsplus"> <ul class="crumbs"> <li><a href="index.php">Index</a></li> <li><span>»&#160;</span><a href="viewforum.php?id=48">Topics Going Nowhere</a></li> <li><span>»&#160;</span><strong><a href="viewtopic.php?id=162768">KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</a></strong></li> </ul> <div class="pagepost"> <p class="pagelink conl"><span class="pages-label">Pages: </span><a rel="prev" class="item1" href="viewtopic.php?id=162768&amp;p=171">Previous</a> <a href="viewtopic.php?id=162768">1</a> <span class="spacer">…</span> <a href="viewtopic.php?id=162768&amp;p=170">170</a> <a href="viewtopic.php?id=162768&amp;p=171">171</a> <strong>172</strong> <a href="viewtopic.php?id=162768&amp;p=173">173</a> <a href="viewtopic.php?id=162768&amp;p=174">174</a> <span class="spacer">…</span> <a href="viewtopic.php?id=162768&amp;p=234">234</a> <a rel="next" href="viewtopic.php?id=162768&amp;p=173">Next</a></p> <p class="postlink conr">Topic closed</p> </div> <div class="clearer"></div> </div> </div> <div id="p1505166" class="blockpost rowodd blockpost1"> <h2><span><span class="conr">#4276</span> <a href="viewtopic.php?pid=1505166#p1505166">2015-02-22 03:07:45</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=74738">instantepiphany</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2013-09-04</span></dd> <dd><span>Posts: 32</span></dd> <dd class="usercontacts"><span class="email"><a href="mailto:jordancran@gmail.com">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <p>I am not using arch currently, but this is the best resource I could find with regards to vga passthrough on QEMU.<br />I have gotten everything working so far, except actual passthrough. When I run my vm, I hear the graphics card that I am passing through spin up like it does on boot, but when I switch to the input from that card, there is no display. What could be causing this?</p><p>Edit: And, in the original guide (which is a few years old now) it says you need seabios - but I cant see any commands that link to it or ask QEMU to use it in the OP, does qemu automatically detect that seabios is installed and use it ?</p> <p class="postedit"><em>Last edited by instantepiphany (2015-02-22 03:09:03)</em></p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1505166">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1505172" class="blockpost roweven"> <h2><span><span class="conr">#4277</span> <a href="viewtopic.php?pid=1505172#p1505172">2015-02-22 03:59:21</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=75590">aw</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2013-10-04</span></dd> <dd><span>Posts: 921</span></dd> <dd class="usercontacts"><span class="email"><a href="misc.php?email=75590">Email</a></span> <span class="website"><a href="http://vfio.blogspot.com/" rel="nofollow">Website</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>Len wrote:</cite><blockquote><div><div class="quotebox"><cite>aw wrote:</cite><blockquote><div><div class="quotebox"><cite>aw wrote:</cite><blockquote><div><p><strong>You should not need to touch /etc/libvirt/qemu.conf</strong></p></div></blockquote></div></div></blockquote></div><p>Without touching user, group:</p></div></blockquote></div><p>Does that mean you only reverted user/group or does it mean that you&#039;re using the referenced qemu.conf as is like I&#039;ve suggested a couple times now?</p><div class="quotebox"><blockquote><div><div class="codebox"><pre><code>$ virsh start Win81 error: Failed to start domain Win81 error: Requested operation is not valid: PCI device 0000:01:00.0 is not assignable # virsh start Win81 error: Failed to start domain Win81 error: internal error: process exited while connecting to monitor: Could not access KVM kernel module: Permission denied failed to initialize KVM: Permission denied</code></pre></div><p>After changing user and group to root, I can use my vm as root, on user still same error.</p></div></blockquote></div><p>Do you have any errors in /var/log/libvirt/qemu/Win81.log?</p> </div> <div class="postsignature postmsg"><hr /><p><a href="http://vfio.blogspot.com" rel="nofollow">http://vfio.blogspot.com</a><br />Looking for a more open forum to discuss vfio related uses?&#160; Try <a href="https://www.redhat.com/mailman/listinfo/vfio-users" rel="nofollow">https://www.redhat.com/mailman/listinfo/vfio-users</a></p></div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1505172">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1505173" class="blockpost rowodd"> <h2><span><span class="conr">#4278</span> <a href="viewtopic.php?pid=1505173#p1505173">2015-02-22 04:02:56</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=75590">aw</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2013-10-04</span></dd> <dd><span>Posts: 921</span></dd> <dd class="usercontacts"><span class="email"><a href="misc.php?email=75590">Email</a></span> <span class="website"><a href="http://vfio.blogspot.com/" rel="nofollow">Website</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>instantepiphany wrote:</cite><blockquote><div><p>I am not using arch currently, but this is the best resource I could find with regards to vga passthrough on QEMU.<br />I have gotten everything working so far, except actual passthrough. When I run my vm, I hear the graphics card that I am passing through spin up like it does on boot, but when I switch to the input from that card, there is no display. What could be causing this?</p></div></blockquote></div><p><a href="http://vfio.blogspot.com/2014/08/vfiovga-faq.html" rel="nofollow">FAQ #3/4</a></p><div class="quotebox"><blockquote><div><p>Edit: And, in the original guide (which is a few years old now) it says you need seabios - but I cant see any commands that link to it or ask QEMU to use it in the OP, does qemu automatically detect that seabios is installed and use it ?</p></div></blockquote></div><p>Don&#039;t bother with a <em>-bios</em> option, those instructions are outdated.</p> </div> <div class="postsignature postmsg"><hr /><p><a href="http://vfio.blogspot.com" rel="nofollow">http://vfio.blogspot.com</a><br />Looking for a more open forum to discuss vfio related uses?&#160; Try <a href="https://www.redhat.com/mailman/listinfo/vfio-users" rel="nofollow">https://www.redhat.com/mailman/listinfo/vfio-users</a></p></div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1505173">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1505174" class="blockpost roweven"> <h2><span><span class="conr">#4279</span> <a href="viewtopic.php?pid=1505174#p1505174">2015-02-22 04:10:25</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=87813">Len</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd class="postavatar"><img src="https://bbs.archlinux.org/img/avatars/87813.png?m=1420509844" width="80" height="80" alt="" /></dd> <dd><span>Registered: 2015-01-06</span></dd> <dd><span>Posts: 23</span></dd> <dd class="usercontacts"><span class="email"><a href="misc.php?email=87813">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>aw wrote:</cite><blockquote><div><p>Does that mean you only reverted user/group or does it mean that you&#039;re using the referenced qemu.conf as is like I&#039;ve suggested a couple times now?</p></div></blockquote></div><p>I have used qemu.conf from you, and changed user, group (only!) to get it working (at least on root).<br />Without set user,group I&#039;m getting error which you can see below.</p><div class="codebox"><pre><code>$ virsh start Win81 error: Failed to start domain Win81 error: Requested operation is not valid: PCI device 0000:01:00.0 is not assignable # virsh start Win81 error: Failed to start domain Win81 error: internal error: process exited while connecting to monitor: Could not access KVM kernel module: Permission denied failed to initialize KVM: Permission denied</code></pre></div><div class="quotebox"><cite>aw wrote:</cite><blockquote><div><p>Do you have any errors in /var/log/libvirt/qemu/Win81.log?</p></div></blockquote></div><br /><p>After setting user, group to &quot;root&quot; in qemu.conf &gt;<br />Starting <strong>virsh start Win81</strong> on...<br />* normal user: (which is giving me PCI device 0000:01:00.0 is not assignable) is <span class="bbu">not producing anything</span> in /var/log/libvirt/qemu/Win81.log.<br />* root user: it&#039;s working, and no errors in log </p><div class="codebox"><pre><code>2015-02-22 05:14:40.522+0000: starting up LC_ALL=C PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin QEMU_AUDIO_DRV=none /usr/bin/qemu-system-x86_64 -name Win81 -S -machine pc-i440fx-2.2,accel=kvm,usb=off -cpu host,kvm=off,pmu=on -drive file=/home/len/win/bios/ovmf_code_x64.bin,if=pflash,format=raw,unit=0,readonly=on -drive file=/var/lib/libvirt/qemu/nvram/Win81_VARS.fd,if=pflash,format=raw,unit=1 -m 6144 -realtime mlock=off -smp 4,sockets=1,cores=4,threads=1 -uuid df602579-a4f2-41b9-bb2f-6e23d65a24bd -nographic -no-user-config -nodefaults -chardev socket,id=charmonitor,path=/var/lib/libvirt/qemu/Win81.monitor,server,nowait -mon chardev=charmonitor,id=monitor,mode=control -rtc base=localtime -no-shutdown -global PIIX4_PM.disable_s3=1 -global PIIX4_PM.disable_s4=1 -boot strict=on -device piix3-usb-uhci,id=usb,bus=pci.0,addr=0x1.0x2 -device lsi,id=scsi0,bus=pci.0,addr=0x3 -drive file=/dev/sdb,if=none,id=drive-virtio-disk0,format=raw,cache=none,aio=native -device virtio-blk-pci,scsi=off,bus=pci.0,addr=0x4,drive=drive-virtio-disk0,id=virtio-disk0,bootindex=1 -drive file=/dev/sdc,if=none,id=drive-virtio-disk1,format=raw,aio=native -device virtio-blk-pci,scsi=off,bus=pci.0,addr=0x5,drive=drive-virtio-disk1,id=virtio-disk1 -drive file=/dev/sdd,if=none,id=drive-virtio-disk2,format=raw,aio=native -device virtio-blk-pci,scsi=off,bus=pci.0,addr=0x6,drive=drive-virtio-disk2,id=virtio-disk2 -netdev tap,fd=21,id=hostnet0,vhost=on,vhostfd=22 -device virtio-net-pci,netdev=hostnet0,id=net0,mac=52:54:00:fc:a7:cd,bus=pci.0,addr=0x2 -device vfio-pci,host=01:00.0,id=hostdev0,bus=pci.0,multifunction=on,addr=0x7 -device vfio-pci,host=01:00.1,id=hostdev1,bus=pci.0,addr=0x7.0x1 -device vfio-pci,host=00:1b.0,id=hostdev2,bus=pci.0,addr=0x9 -device usb-host,hostbus=3,hostaddr=3,id=hostdev3 -device usb-host,hostbus=3,hostaddr=2,id=hostdev4 -device virtio-balloon-pci,id=balloon0,bus=pci.0,addr=0xa -msg timestamp=on Domain id=3 is tainted: high-privileges Domain id=3 is tainted: host-cpu 2015-02-22T05:14:47.464676Z qemu-system-x86_64: libusb_release_interface: -4 [NO_DEVICE] 2015-02-22T05:14:47.464697Z qemu-system-x86_64: libusb_release_interface: -4 [NO_DEVICE]</code></pre></div><p>Only mouse is not working (sometimes)</p><br /><br /><br /><br /><br /><br /><br /><br /><p>____________________________________________</p><p><span class="bbu">There are some performance test (compared bare and kvm), for people who care:</span><br /><strong>PerformanceTest 7.0</strong><br /><a href="http://i.imgur.com/BxA3Ee4.png" rel="nofollow">Info</a><br /><a href="http://i.imgur.com/4BUS01Q.png" rel="nofollow">Summary</a> - 84,8%<br /><a href="http://i.imgur.com/eggbSzj.png" rel="nofollow">CPU</a> - 90,9%<br /><a href="http://i.imgur.com/AfY3NfC.png" rel="nofollow">2D</a> - 79,3%<br /><a href="http://i.imgur.com/0N70aWt.png" rel="nofollow">3D</a> - 84,4%<br /><a href="http://i.imgur.com/MEj7TFC.png" rel="nofollow">Mem</a> - 82,3%<br /><a href="http://i.imgur.com/xcpdtrj.png" rel="nofollow">Disk</a> - 97,3%</p><p><strong>3DMark11</strong><br /><a href="http://i.imgur.com/Dz0Lmks.jpg" rel="nofollow">Test 1</a> - 85.5%<br /><a href="http://i.imgur.com/2GoSaVZ.jpg" rel="nofollow">Test 2</a> - 97.7%<br /><a href="http://i.imgur.com/PNAGlrc.jpg" rel="nofollow">Test 3</a> - 99.5%</p><p><a href="http://wklej.org/id/1643034/" rel="nofollow">My XML</a></p> <p class="postedit"><em>Last edited by Len (2015-02-23 14:55:16)</em></p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1505174">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1505176" class="blockpost rowodd"> <h2><span><span class="conr">#4280</span> <a href="viewtopic.php?pid=1505176#p1505176">2015-02-22 04:20:00</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=75590">aw</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2013-10-04</span></dd> <dd><span>Posts: 921</span></dd> <dd class="usercontacts"><span class="email"><a href="misc.php?email=75590">Email</a></span> <span class="website"><a href="http://vfio.blogspot.com/" rel="nofollow">Website</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>Len wrote:</cite><blockquote><div><div class="quotebox"><cite>aw wrote:</cite><blockquote><div><p>Does that mean you only reverted user/group or does it mean that you&#039;re using the referenced qemu.conf as is like I&#039;ve suggested a couple times now?</p></div></blockquote></div><p>I have used qemu.conf from you, and changed user, group (only!) to get it working (at least on root).<br />Without set user,group I&#039;m getting error which you can see below.</p><div class="codebox"><pre><code>$ virsh start Win81 error: Failed to start domain Win81 error: Requested operation is not valid: PCI device 0000:01:00.0 is not assignable # virsh start Win81 error: Failed to start domain Win81 error: internal error: process exited while connecting to monitor: Could not access KVM kernel module: Permission denied failed to initialize KVM: Permission denied</code></pre></div><div class="quotebox"><cite>aw wrote:</cite><blockquote><div><p>Do you have any errors in /var/log/libvirt/qemu/Win81.log?</p></div></blockquote></div><p>Starting on normal user: <strong>virsh start Win81</strong> (which is giving me PCI device 0000:01:00.0 is not assignable) is <span class="bbu">not producing anything</span> in /var/log/libvirt/qemu/Win81.log.</p></div></blockquote></div><p>The only thing I can find that prints that &quot;not assignable&quot; error in libvirt deals with PCIe ACS testing.&#160; I&#039;m surprised both that libvirt is doing this test when the hostdev driver is set to vfio and also that it&#039;s failing since libvirt&#039;s version of ACS testing is far inferior to vfio in the kernel.&#160; You can try setting relaxed_acs_check=1 in qemu.conf, but I also don&#039;t see why running as root would make a difference for this test.&#160; Perhaps libvirt can&#039;t even scan the PCI capabilities of the devices when not running as root.&#160; What distro are you using?&#160; Something still seems very broken with libvirt.&#160; Have you tried disabling selinux/apparmor?</p> </div> <div class="postsignature postmsg"><hr /><p><a href="http://vfio.blogspot.com" rel="nofollow">http://vfio.blogspot.com</a><br />Looking for a more open forum to discuss vfio related uses?&#160; Try <a href="https://www.redhat.com/mailman/listinfo/vfio-users" rel="nofollow">https://www.redhat.com/mailman/listinfo/vfio-users</a></p></div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1505176">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1505177" class="blockpost roweven"> <h2><span><span class="conr">#4281</span> <a href="viewtopic.php?pid=1505177#p1505177">2015-02-22 04:30:18</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=87813">Len</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd class="postavatar"><img src="https://bbs.archlinux.org/img/avatars/87813.png?m=1420509844" width="80" height="80" alt="" /></dd> <dd><span>Registered: 2015-01-06</span></dd> <dd><span>Posts: 23</span></dd> <dd class="usercontacts"><span class="email"><a href="misc.php?email=87813">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>aw wrote:</cite><blockquote><div><p>The only thing I can find that prints that &quot;not assignable&quot; error in libvirt deals with PCIe ACS testing.&#160; I&#039;m surprised both that libvirt is doing this test when the hostdev driver is set to vfio and also that it&#039;s failing since libvirt&#039;s version of ACS testing is far inferior to vfio in the kernel.&#160; You can try setting relaxed_acs_check=1 in qemu.conf, but I also don&#039;t see why running as root would make a difference for this test.&#160; Perhaps libvirt can&#039;t even scan the PCI capabilities of the devices when not running as root.&#160; What distro are you using?&#160; Something still seems very broken with libvirt.&#160; Have you tried disabling selinux/apparmor?</p></div></blockquote></div><p>I&#039;m using archlinux, with nothing more then kdebase, qemu, libvirt and some other stuff for &#039;how can I get it working&#039;-system.<br />Didn&#039;t installed selinux nor apparmor</p><p>Checked relaxed_acs_check=1, didn&#039;t helped on normal-user, still same. On root, it&#039;s pointless I think, cause vm is working on root, without problems (sometimes mouse, hehe).</p><p>Maybe something wrong with kernel? <a href="http://wklej.org/id/1643036/" rel="nofollow">.config</a></p><p>Okay, thanks for your time, gotta take a sleep.. it&#039;s already 6am here <img src="https://bbs.archlinux.org/img/smilies/hmm.png" width="15" height="15" alt="hmm" /></p> <p class="postedit"><em>Last edited by Len (2015-02-22 16:08:01)</em></p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1505177">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1505338" class="blockpost rowodd"> <h2><span><span class="conr">#4282</span> <a href="viewtopic.php?pid=1505338#p1505338">2015-02-22 19:05:09</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=86812">bpbastos</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2014-11-21</span></dd> <dd><span>Posts: 11</span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <p>Guys,</p><p>I know the main topic here is vga passthrough but this topic is the best resource over the internet when it comes to device passthrough.</p><p>I&#039;m trying to make a tv tuner card (TBS6285) works under guest system without success. I can passthrough it successfully, install the drivers and use it for some time, but after some time it just stop get signal. </p><p>Neither the host or the guest gives me any hint about the problem looking at dmesg, the only thing I have noticed is the interrupt count at /proc/interrupts stops as soon as the problem occurs.</p><p>My setup is the follow:</p><p>Hardware:</p><p>CPU: Intel Xeon E3-1245V3<br />MOBO: Supermicro&#160; X10SAE-O<br />RAM: 16GB ECC<br />VIDEO1: AMD R7 250<br />VIDEO2: NVIDIA Geforce GT 610<br />TV TUNER: TBS 6285</p><p>Software:</p><p>S.O: Arch linux - 3.18.6-1-ARCH (ACS + VGA Arbiter)<br />Qemu 2.2.50<br />Libvirt 1.2.13</p><p>Any guidance will be welcome.</p><p>Thanks</p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1505338">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1505340" class="blockpost roweven"> <h2><span><span class="conr">#4283</span> <a href="viewtopic.php?pid=1505340#p1505340">2015-02-22 19:10:09</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=75590">aw</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2013-10-04</span></dd> <dd><span>Posts: 921</span></dd> <dd class="usercontacts"><span class="email"><a href="misc.php?email=75590">Email</a></span> <span class="website"><a href="http://vfio.blogspot.com/" rel="nofollow">Website</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>bpbastos wrote:</cite><blockquote><div><p>Guys,</p><p>I know the main topic here is vga passthrough but this topic is the best resource over the internet when it comes to device passthrough.</p><p>I&#039;m trying to make a tv tuner card (TBS6285) works under guest system without success. I can passthrough it successfully, install the drivers and use it for some time, but after some time it just stop get signal. </p><p>Neither the host or the guest gives me any hint about the problem looking at dmesg, the only thing I have noticed is the interrupt count at /proc/interrupts stops as soon as the problem occurs.</p></div></blockquote></div><p>Probably broken INTx masking on the tuner card.&#160; You can try using the vfio-pci module option nointxmask=1 to mask at the APIC instead of the device, but it makes life very difficult since you then require an exclusive interrupt line for the device.&#160; You may try adding a quirk for the device to drivers/pci/quirks.c to isolate it to just that device (see fixups using quirk_broken_intx_masking).</p> </div> <div class="postsignature postmsg"><hr /><p><a href="http://vfio.blogspot.com" rel="nofollow">http://vfio.blogspot.com</a><br />Looking for a more open forum to discuss vfio related uses?&#160; Try <a href="https://www.redhat.com/mailman/listinfo/vfio-users" rel="nofollow">https://www.redhat.com/mailman/listinfo/vfio-users</a></p></div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1505340">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1505345" class="blockpost rowodd"> <h2><span><span class="conr">#4284</span> <a href="viewtopic.php?pid=1505345#p1505345">2015-02-22 19:28:25</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=86812">bpbastos</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2014-11-21</span></dd> <dd><span>Posts: 11</span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>aw wrote:</cite><blockquote><div><div class="quotebox"><cite>bpbastos wrote:</cite><blockquote><div><p>Guys,</p><p>I know the main topic here is vga passthrough but this topic is the best resource over the internet when it comes to device passthrough.</p><p>I&#039;m trying to make a tv tuner card (TBS6285) works under guest system without success. I can passthrough it successfully, install the drivers and use it for some time, but after some time it just stop get signal. </p><p>Neither the host or the guest gives me any hint about the problem looking at dmesg, the only thing I have noticed is the interrupt count at /proc/interrupts stops as soon as the problem occurs.</p></div></blockquote></div><p>Probably broken INTx masking on the tuner card.&#160; You can try using the vfio-pci module option nointxmask=1 to mask at the APIC instead of the device, but it makes life very difficult since you then require an exclusive interrupt line for the device.&#160; You may try adding a quirk for the device to drivers/pci/quirks.c to isolate it to just that device (see fixups using quirk_broken_intx_masking).</p></div></blockquote></div><p>This tv tuner card supports msi-x interrupt type and this should give an exclusive interrupt line. Could I use what you have suggest with msi interrupts?</p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1505345">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1505347" class="blockpost roweven"> <h2><span><span class="conr">#4285</span> <a href="viewtopic.php?pid=1505347#p1505347">2015-02-22 19:36:03</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=75590">aw</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2013-10-04</span></dd> <dd><span>Posts: 921</span></dd> <dd class="usercontacts"><span class="email"><a href="misc.php?email=75590">Email</a></span> <span class="website"><a href="http://vfio.blogspot.com/" rel="nofollow">Website</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>bpbastos wrote:</cite><blockquote><div><div class="quotebox"><cite>aw wrote:</cite><blockquote><div><div class="quotebox"><cite>bpbastos wrote:</cite><blockquote><div><p>Guys,</p><p>I know the main topic here is vga passthrough but this topic is the best resource over the internet when it comes to device passthrough.</p><p>I&#039;m trying to make a tv tuner card (TBS6285) works under guest system without success. I can passthrough it successfully, install the drivers and use it for some time, but after some time it just stop get signal. </p><p>Neither the host or the guest gives me any hint about the problem looking at dmesg, the only thing I have noticed is the interrupt count at /proc/interrupts stops as soon as the problem occurs.</p></div></blockquote></div><p>Probably broken INTx masking on the tuner card.&#160; You can try using the vfio-pci module option nointxmask=1 to mask at the APIC instead of the device, but it makes life very difficult since you then require an exclusive interrupt line for the device.&#160; You may try adding a quirk for the device to drivers/pci/quirks.c to isolate it to just that device (see fixups using quirk_broken_intx_masking).</p></div></blockquote></div><p>This tv tuner card supports msi-x interrupt type and this should give an exclusive interrupt line. Could I use what you have suggest with msi interrupts?</p></div></blockquote></div><p>The nointxmask won&#039;t have any effect if MSI-X is actually being used.&#160; Is MSI-X being used by the device when it&#039;s assigned?&#160; (host: grep vfio /proc/interrupts)&#160; If not, the better option would be to try to make it use MSI-X.&#160; If it&#039;s a Windows guest, see <a href="http://vfio.blogspot.com/2014/09/vfio-interrupts-and-how-to-coax-windows.html" rel="nofollow">http://vfio.blogspot.com/2014/09/vfio-i … ndows.html</a>&#160; If it is using MSI-X already, then I&#039;m not sure what to suggest.&#160; We&#039;ve seen cards like Nvidia that actually require a PCI config space write to re-enable MSI and needs a quirk to do so because it writes to a read-only offset.</p> </div> <div class="postsignature postmsg"><hr /><p><a href="http://vfio.blogspot.com" rel="nofollow">http://vfio.blogspot.com</a><br />Looking for a more open forum to discuss vfio related uses?&#160; Try <a href="https://www.redhat.com/mailman/listinfo/vfio-users" rel="nofollow">https://www.redhat.com/mailman/listinfo/vfio-users</a></p></div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1505347">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1505352" class="blockpost rowodd"> <h2><span><span class="conr">#4286</span> <a href="viewtopic.php?pid=1505352#p1505352">2015-02-22 19:57:32</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=86812">bpbastos</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2014-11-21</span></dd> <dd><span>Posts: 11</span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>aw wrote:</cite><blockquote><div><div class="quotebox"><cite>bpbastos wrote:</cite><blockquote><div><div class="quotebox"><cite>aw wrote:</cite><blockquote><div><p>Probably broken INTx masking on the tuner card.&#160; You can try using the vfio-pci module option nointxmask=1 to mask at the APIC instead of the device, but it makes life very difficult since you then require an exclusive interrupt line for the device.&#160; You may try adding a quirk for the device to drivers/pci/quirks.c to isolate it to just that device (see fixups using quirk_broken_intx_masking).</p></div></blockquote></div><p>This tv tuner card supports msi-x interrupt type and this should give an exclusive interrupt line. Could I use what you have suggest with msi interrupts?</p></div></blockquote></div><p>The nointxmask won&#039;t have any effect if MSI-X is actually being used.&#160; Is MSI-X being used by the device when it&#039;s assigned?&#160; (host: grep vfio /proc/interrupts)&#160; If not, the better option would be to try to make it use MSI-X.&#160; If it&#039;s a Windows guest, see <a href="http://vfio.blogspot.com/2014/09/vfio-interrupts-and-how-to-coax-windows.html" rel="nofollow">http://vfio.blogspot.com/2014/09/vfio-i … ndows.html</a>&#160; If it is using MSI-X already, then I&#039;m not sure what to suggest.&#160; We&#039;ve seen cards like Nvidia that actually require a PCI config space write to re-enable MSI and needs a quirk to do so because it writes to a read-only offset.</p></div></blockquote></div><p>It&#039;s a Linux guest (Ubuntu 14.10), this card seems to have a lot of problems with systems where iommu is enabled, see <a href="https://github.com/ljalves/linux_media/issues/66" rel="nofollow">https://github.com/ljalves/linux_media/issues/66</a></p><p>My card is a TBS6285 v21M like the one on the link above and it has the pericom pci bridge which seems to be the root cause of the problems.</p><p>I&#039;ve already tried to passthrough the pericom pci bridge but i think its not possible to passthrough pci bridges.</p><br /><p>When the guest starts, it starts with intx:</p><div class="codebox"><pre class="vscroll"><code>[root@home-server ~]# cat /proc/interrupts CPU0 CPU1 CPU2 CPU3 CPU4 CPU5 CPU6 CPU7 0: 19 0 0 0 0 0 0 0 IR-IO-APIC-edge timer 1: 3 0 0 0 0 0 0 0 IR-IO-APIC-edge i8042 7: 10 0 0 0 0 0 0 0 IR-IO-APIC-edge 8: 0 0 0 0 1 0 0 0 IR-IO-APIC-edge rtc0 9: 0 0 1 0 2 0 0 0 IR-IO-APIC-fasteoi acpi 12: 2 0 1 0 0 0 1 0 IR-IO-APIC-edge i8042 16: 13 7 0 0 2 6 1 0 IR-IO-APIC 16-fasteoi ehci_hcd:usb5 17: 288441 31873 0 0 0 0 0 0 IR-IO-APIC 17-fasteoi vfio-intx(0000:07:00.0) 18: 0 0 0 0 0 0 0 0 IR-IO-APIC 18-fasteoi i801_smbus 23: 28 2 0 0 4 1 0 0 IR-IO-APIC 23-fasteoi ehci_hcd:usb6 24: 0 0 0 0 0 0 0 0 DMAR_MSI-edge dmar0 25: 0 0 0 0 0 0 0 0 DMAR_MSI-edge dmar1 26: 0 0 0 0 0 0 0 0 IR-PCI-MSI-edge PCIe PME 27: 0 0 0 0 0 0 0 0 IR-PCI-MSI-edge PCIe PME 28: 0 0 0 0 0 0 0 0 IR-PCI-MSI-edge PCIe PME, pciehp 29: 0 0 0 0 0 0 0 0 IR-PCI-MSI-edge PCIe PME 30: 0 0 0 0 0 0 0 0 IR-PCI-MSI-edge PCIe PME 31: 0 0 0 0 0 0 0 0 IR-PCI-MSI-edge PCIe PME 32: 0 0 0 0 0 0 0 0 IR-PCI-MSI-edge PCIe PME 35: 40 0 2 1 12 2 2 2 IR-PCI-MSI-edge xhci_hcd 36: 31 2 3 2 13 3 0 1 IR-PCI-MSI-edge xhci_hcd 37: 0 0 0 0 0 0 0 0 IR-PCI-MSI-edge xhci_hcd 38: 0 0 0 0 0 0 0 0 IR-PCI-MSI-edge xhci_hcd 39: 0 0 0 0 0 0 0 0 IR-PCI-MSI-edge xhci_hcd 40: 0 0 0 0 0 0 0 0 IR-PCI-MSI-edge xhci_hcd 41: 0 0 0 0 0 0 0 0 IR-PCI-MSI-edge xhci_hcd 42: 0 0 0 0 0 0 0 0 IR-PCI-MSI-edge xhci_hcd 43: 0 0 0 0 0 0 0 0 IR-PCI-MSI-edge xhci_hcd 44: 80885 118083 83 67 1826 908 382 88 IR-PCI-MSI-edge 0000:00:1f.2 45: 1 0 1 2 4 5 8 3 IR-PCI-MSI-edge mei_me 46: 16896 89344 8 12 263 163 10 19 IR-PCI-MSI-edge eno1 52: 4 0 172 0 20 1 154 3 IR-PCI-MSI-edge snd_hda_intel 53: 1 0 2 0 5 0 0 0 IR-PCI-MSI-edge i915 54: 0 0 39 1 15 0 1 4 IR-PCI-MSI-edge snd_hda_intel NMI: 1 1 0 0 10 3 0 0 Non-maskable interrupts LOC: 25166 45620 3162 3118 77738 45167 1567 1477 Local timer interrupts SPU: 0 0 0 0 0 0 0 0 Spurious interrupts PMI: 1 1 0 0 10 3 0 0 Performance monitoring interrupts IWI: 2 0 0 0 0 0 0 0 IRQ work interrupts RTR: 0 0 0 0 0 0 0 0 APIC ICR read retries RES: 1660 2067 219 179 71690 20139 91 124 Rescheduling interrupts CAL: 988 994 1648 1680 1692 1463 1664 1664 Function call interrupts TLB: 112 85 53 39 658 312 16 33 TLB shootdowns TRM: 0 0 0 0 0 0 0 0 Thermal event interrupts THR: 0 0 0 0 0 0 0 0 Threshold APIC interrupts MCE: 0 0 0 0 0 0 0 0 Machine check exceptions MCP: 6 6 6 6 6 6 6 6 Machine check polls HYP: 0 0 0 0 0 0 0 0 Hypervisor callback interrupts ERR: 10 MIS: 0</code></pre></div><p>Then it changes to msi-x, I&#039;m forcing msi-x interrupts with saa716x_budget int_type=1 in the guest</p><div class="codebox"><pre class="vscroll"><code>[root@home-server ~]# cat /proc/interrupts CPU0 CPU1 CPU2 CPU3 CPU4 CPU5 CPU6 CPU7 0: 19 0 0 0 0 0 0 0 IR-IO-APIC-edge timer 1: 3 0 0 0 0 0 0 0 IR-IO-APIC-edge i8042 7: 10 0 0 0 0 0 0 0 IR-IO-APIC-edge 8: 0 0 0 0 1 0 0 0 IR-IO-APIC-edge rtc0 9: 0 0 1 0 2 0 0 0 IR-IO-APIC-fasteoi acpi 12: 2 0 1 0 0 0 1 0 IR-IO-APIC-edge i8042 16: 13 7 0 0 2 6 1 0 IR-IO-APIC 16-fasteoi ehci_hcd:usb5 17: 288441 31873 0 0 0 0 0 0 IR-IO-APIC 17-fasteoi 18: 0 0 0 0 0 0 0 0 IR-IO-APIC 18-fasteoi i801_smbus 23: 28 2 0 0 4 1 0 0 IR-IO-APIC 23-fasteoi ehci_hcd:usb6 24: 0 0 0 0 0 0 0 0 DMAR_MSI-edge dmar0 25: 0 0 0 0 0 0 0 0 DMAR_MSI-edge dmar1 26: 0 0 0 0 0 0 0 0 IR-PCI-MSI-edge PCIe PME 27: 0 0 0 0 0 0 0 0 IR-PCI-MSI-edge PCIe PME 28: 0 0 0 0 0 0 0 0 IR-PCI-MSI-edge PCIe PME, pciehp 29: 0 0 0 0 0 0 0 0 IR-PCI-MSI-edge PCIe PME 30: 0 0 0 0 0 0 0 0 IR-PCI-MSI-edge PCIe PME 31: 0 0 0 0 0 0 0 0 IR-PCI-MSI-edge PCIe PME 32: 0 0 0 0 0 0 0 0 IR-PCI-MSI-edge PCIe PME 35: 40 0 2 1 12 2 2 2 IR-PCI-MSI-edge xhci_hcd 36: 31 2 3 2 13 3 0 1 IR-PCI-MSI-edge xhci_hcd 37: 0 0 0 0 0 0 0 0 IR-PCI-MSI-edge xhci_hcd 38: 0 0 0 0 0 0 0 0 IR-PCI-MSI-edge xhci_hcd 39: 0 0 0 0 0 0 0 0 IR-PCI-MSI-edge xhci_hcd 40: 0 0 0 0 0 0 0 0 IR-PCI-MSI-edge xhci_hcd 41: 0 0 0 0 0 0 0 0 IR-PCI-MSI-edge xhci_hcd 42: 0 0 0 0 0 0 0 0 IR-PCI-MSI-edge xhci_hcd 43: 0 0 0 0 0 0 0 0 IR-PCI-MSI-edge xhci_hcd 44: 80885 112767 83 67 1826 908 382 88 IR-PCI-MSI-edge 0000:00:1f.2 45: 1 0 1 2 4 5 8 3 IR-PCI-MSI-edge mei_me 46: 16896 88670 8 12 263 163 10 19 IR-PCI-MSI-edge eno1 52: 4 0 172 0 20 1 154 3 IR-PCI-MSI-edge snd_hda_intel 53: 1 0 2 0 5 0 0 0 IR-PCI-MSI-edge i915 54: 0 0 39 1 15 0 1 4 IR-PCI-MSI-edge snd_hda_intel 55: 556 253 0 0 68 25 0 1 IR-PCI-MSI-edge vfio-msi[0](0000:07:00.0) NMI: 1 1 0 0 9 3 0 0 Non-maskable interrupts LOC: 23680 43632 2955 2927 71642 41880 1478 1388 Local timer interrupts SPU: 0 0 0 0 0 0 0 0 Spurious interrupts PMI: 1 1 0 0 9 3 0 0 Performance monitoring interrupts IWI: 2 0 0 0 0 0 0 0 IRQ work interrupts RTR: 0 0 0 0 0 0 0 0 APIC ICR read retries RES: 1647 2052 209 172 68764 19165 88 118 Rescheduling interrupts CAL: 964 968 1622 1654 1666 1461 1640 1640 Function call interrupts TLB: 107 82 46 37 622 305 15 30 TLB shootdowns TRM: 0 0 0 0 0 0 0 0 Thermal event interrupts THR: 0 0 0 0 0 0 0 0 Threshold APIC interrupts MCE: 0 0 0 0 0 0 0 0 Machine check exceptions MCP: 5 5 5 5 5 5 5 5 Machine check polls HYP: 0 0 0 0 0 0 0 0 Hypervisor callback interrupts ERR: 10 MIS: 0</code></pre></div> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1505352">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1505355" class="blockpost roweven"> <h2><span><span class="conr">#4287</span> <a href="viewtopic.php?pid=1505355#p1505355">2015-02-22 20:08:05</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=87813">Len</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd class="postavatar"><img src="https://bbs.archlinux.org/img/avatars/87813.png?m=1420509844" width="80" height="80" alt="" /></dd> <dd><span>Registered: 2015-01-06</span></dd> <dd><span>Posts: 23</span></dd> <dd class="usercontacts"><span class="email"><a href="misc.php?email=87813">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <p>@aw, any more ideas about my problem? I&#039;m kinda stuck.</p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1505355">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1505366" class="blockpost rowodd"> <h2><span><span class="conr">#4288</span> <a href="viewtopic.php?pid=1505366#p1505366">2015-02-22 20:46:51</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=88886">jaeger</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2015-02-16</span></dd> <dd><span>Posts: 9</span></dd> <dd class="usercontacts"><span class="email"><a href="misc.php?email=88886">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <p>On the subject of passthrough, I&#039;ve got everything working pretty well with my windows gaming VM now except for one thing: I&#039;m unable to pass my DualShock 3 controller&#039;s USB connection properly to the VM. In the device manager I see the device but it&#039;s failed with a note saying &quot;Device descriptor request failed&quot;.</p><p>Is anyone passing one of these to a VM? My intent is to use it via bluetooth but need to have it connected via USB first to get the XInputWrapper service working properly.</p> <p class="postedit"><em>Last edited by jaeger (2015-02-22 20:47:10)</em></p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1505366">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1505381" class="blockpost roweven"> <h2><span><span class="conr">#4289</span> <a href="viewtopic.php?pid=1505381#p1505381">2015-02-22 21:28:51</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=75590">aw</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2013-10-04</span></dd> <dd><span>Posts: 921</span></dd> <dd class="usercontacts"><span class="email"><a href="misc.php?email=75590">Email</a></span> <span class="website"><a href="http://vfio.blogspot.com/" rel="nofollow">Website</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>Len wrote:</cite><blockquote><div><p>@aw, any more ideas about my problem? I&#039;m kinda stuck.</p></div></blockquote></div><p>Sorry, I don&#039;t use arch, I have no idea what&#039;s wrong with your libvirt installation.&#160; Maybe others using arch+libvirt have some ideas.</p> </div> <div class="postsignature postmsg"><hr /><p><a href="http://vfio.blogspot.com" rel="nofollow">http://vfio.blogspot.com</a><br />Looking for a more open forum to discuss vfio related uses?&#160; Try <a href="https://www.redhat.com/mailman/listinfo/vfio-users" rel="nofollow">https://www.redhat.com/mailman/listinfo/vfio-users</a></p></div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1505381">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1505391" class="blockpost rowodd"> <h2><span><span class="conr">#4290</span> <a href="viewtopic.php?pid=1505391#p1505391">2015-02-22 22:18:31</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=87813">Len</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd class="postavatar"><img src="https://bbs.archlinux.org/img/avatars/87813.png?m=1420509844" width="80" height="80" alt="" /></dd> <dd><span>Registered: 2015-01-06</span></dd> <dd><span>Posts: 23</span></dd> <dd class="usercontacts"><span class="email"><a href="misc.php?email=87813">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>aw wrote:</cite><blockquote><div><div class="quotebox"><cite>Len wrote:</cite><blockquote><div><p>@aw, any more ideas about my problem? I&#039;m kinda stuck.</p></div></blockquote></div><p>Sorry, I don&#039;t use arch, I have no idea what&#039;s wrong with your libvirt installation.&#160; Maybe others using arch+libvirt have some ideas.</p></div></blockquote></div><p>No problem, at least we are trying, btw what dist are you using?</p><div class="codebox"><pre><code>[len@holo ~]$ /usr/sbin/libvirtd 2015-02-22 23:16:51.294+0000: 6911: info : libvirt version: 1.2.13 2015-02-22 23:16:51.294+0000: 6911: warning : virPCIDeviceConfigOpen:307 : Failed to open config space file &#039;/sys/bus/pci/devices/0000:00:00.0/config&#039;: Permission denied 2015-02-22 23:16:51.294+0000: 6911: warning : virPCIDeviceConfigOpen:307 : Failed to open config space file &#039;/sys/bus/pci/devices/0000:00:01.0/config&#039;: Permission denied 2015-02-22 23:16:51.294+0000: 6911: warning : virPCIDeviceConfigOpen:307 : Failed to open config space file &#039;/sys/bus/pci/devices/0000:00:02.0/config&#039;: Permission denied 2015-02-22 23:16:51.294+0000: 6911: warning : virPCIDeviceConfigOpen:307 : Failed to open config space file &#039;/sys/bus/pci/devices/0000:00:03.0/config&#039;: Permission denied 2015-02-22 23:16:51.294+0000: 6911: warning : virPCIDeviceConfigOpen:307 : Failed to open config space file &#039;/sys/bus/pci/devices/0000:00:14.0/config&#039;: Permission denied 2015-02-22 23:16:51.295+0000: 6911: warning : virPCIDeviceConfigOpen:307 : Failed to open config space file &#039;/sys/bus/pci/devices/0000:00:16.0/config&#039;: Permission denied 2015-02-22 23:16:51.295+0000: 6911: warning : virPCIDeviceConfigOpen:307 : Failed to open config space file &#039;/sys/bus/pci/devices/0000:00:1a.0/config&#039;: Permission denied 2015-02-22 23:16:51.295+0000: 6911: warning : virPCIDeviceConfigOpen:307 : Failed to open config space file &#039;/sys/bus/pci/devices/0000:00:1b.0/config&#039;: Permission denied 2015-02-22 23:16:51.295+0000: 6911: warning : virPCIDeviceConfigOpen:307 : Failed to open config space file &#039;/sys/bus/pci/devices/0000:00:1c.0/config&#039;: Permission denied 2015-02-22 23:16:51.295+0000: 6911: warning : virPCIDeviceConfigOpen:307 : Failed to open config space file &#039;/sys/bus/pci/devices/0000:00:1c.2/config&#039;: Permission denied 2015-02-22 23:16:51.295+0000: 6911: warning : virPCIDeviceConfigOpen:307 : Failed to open config space file &#039;/sys/bus/pci/devices/0000:00:1c.3/config&#039;: Permission denied 2015-02-22 23:16:51.295+0000: 6911: warning : virPCIDeviceConfigOpen:307 : Failed to open config space file &#039;/sys/bus/pci/devices/0000:00:1d.0/config&#039;: Permission denied 2015-02-22 23:16:51.295+0000: 6911: warning : virPCIDeviceConfigOpen:307 : Failed to open config space file &#039;/sys/bus/pci/devices/0000:00:1f.0/config&#039;: Permission denied 2015-02-22 23:16:51.295+0000: 6911: warning : virPCIDeviceConfigOpen:307 : Failed to open config space file &#039;/sys/bus/pci/devices/0000:00:1f.2/config&#039;: Permission denied 2015-02-22 23:16:51.295+0000: 6911: warning : virPCIDeviceConfigOpen:307 : Failed to open config space file &#039;/sys/bus/pci/devices/0000:00:1f.3/config&#039;: Permission denied 2015-02-22 23:16:51.295+0000: 6911: warning : virPCIDeviceConfigOpen:307 : Failed to open config space file &#039;/sys/bus/pci/devices/0000:01:00.0/config&#039;: Permission denied 2015-02-22 23:16:51.295+0000: 6911: warning : virPCIDeviceConfigOpen:307 : Failed to open config space file &#039;/sys/bus/pci/devices/0000:01:00.1/config&#039;: Permission denied 2015-02-22 23:16:51.295+0000: 6911: warning : virPCIDeviceConfigOpen:307 : Failed to open config space file &#039;/sys/bus/pci/devices/0000:03:00.0/config&#039;: Permission denied 2015-02-22 23:16:51.295+0000: 6911: warning : virPCIDeviceConfigOpen:307 : Failed to open config space file &#039;/sys/bus/pci/devices/0000:04:00.0/config&#039;: Permission denied 2015-02-22 23:16:51.295+0000: 6911: warning : virPCIDeviceConfigOpen:307 : Failed to open config space file &#039;/sys/bus/pci/devices/0000:05:00.0/config&#039;: Permission denied 2015-02-22 23:16:51.295+0000: 6911: error : virPCIDeviceIsBehindSwitchLackingACS:2299 : internal error: Failed to find parent device for 0000:01:00.0 2015-02-22 23:16:51.300+0000: 6911: warning : virHostdevReAttachUSBDevices:1431 : Unable to find device 000.000 in list of active USB devices 2015-02-22 23:16:51.300+0000: 6911: warning : virHostdevReAttachUSBDevices:1431 : Unable to find device 000.000 in list of active USB devices</code></pre></div><p>Managed to get this log, while running </p><div class="codebox"><pre><code>virsh start Win81 error: Failed to start domain Win81 error: Requested operation is not valid: PCI device 0000:01:00.0 is not assignable</code></pre></div><p> as normal user</p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1505391">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1505467" class="blockpost roweven"> <h2><span><span class="conr">#4291</span> <a href="viewtopic.php?pid=1505467#p1505467">2015-02-23 07:51:00</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=81112">Krobar</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2014-04-12</span></dd> <dd><span>Posts: 17</span></dd> <dd class="usercontacts"><span class="email"><a href="mailto:rob@ledeng.demon.co.uk">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>bpbastos wrote:</cite><blockquote><div><div class="quotebox"><cite>aw wrote:</cite><blockquote><div><div class="quotebox"><cite>bpbastos wrote:</cite><blockquote><div><p>This tv tuner card supports msi-x interrupt type and this should give an exclusive interrupt line. Could I use what you have suggest with msi interrupts?</p></div></blockquote></div><p>The nointxmask won&#039;t have any effect if MSI-X is actually being used.&#160; Is MSI-X being used by the device when it&#039;s assigned?&#160; (host: grep vfio /proc/interrupts)&#160; If not, the better option would be to try to make it use MSI-X.&#160; If it&#039;s a Windows guest, see <a href="http://vfio.blogspot.com/2014/09/vfio-interrupts-and-how-to-coax-windows.html" rel="nofollow">http://vfio.blogspot.com/2014/09/vfio-i … ndows.html</a>&#160; If it is using MSI-X already, then I&#039;m not sure what to suggest.&#160; We&#039;ve seen cards like Nvidia that actually require a PCI config space write to re-enable MSI and needs a quirk to do so because it writes to a read-only offset.</p></div></blockquote></div><p>It&#039;s a Linux guest (Ubuntu 14.10), this card seems to have a lot of problems with systems where iommu is enabled, see <a href="https://github.com/ljalves/linux_media/issues/66" rel="nofollow">https://github.com/ljalves/linux_media/issues/66</a></p><p>My card is a TBS6285 v21M like the one on the link above and it has the pericom pci bridge which seems to be the root cause of the problems.</p><p>I&#039;ve already tried to passthrough the pericom pci bridge but i think its not possible to passthrough pci bridges.</p><br /><p>When the guest starts, it starts with intx:</p><div class="codebox"><pre class="vscroll"><code>[root@home-server ~]# cat /proc/interrupts CPU0 CPU1 CPU2 CPU3 CPU4 CPU5 CPU6 CPU7 0: 19 0 0 0 0 0 0 0 IR-IO-APIC-edge timer 1: 3 0 0 0 0 0 0 0 IR-IO-APIC-edge i8042 7: 10 0 0 0 0 0 0 0 IR-IO-APIC-edge 8: 0 0 0 0 1 0 0 0 IR-IO-APIC-edge rtc0 9: 0 0 1 0 2 0 0 0 IR-IO-APIC-fasteoi acpi 12: 2 0 1 0 0 0 1 0 IR-IO-APIC-edge i8042 16: 13 7 0 0 2 6 1 0 IR-IO-APIC 16-fasteoi ehci_hcd:usb5 17: 288441 31873 0 0 0 0 0 0 IR-IO-APIC 17-fasteoi vfio-intx(0000:07:00.0) 18: 0 0 0 0 0 0 0 0 IR-IO-APIC 18-fasteoi i801_smbus 23: 28 2 0 0 4 1 0 0 IR-IO-APIC 23-fasteoi ehci_hcd:usb6 24: 0 0 0 0 0 0 0 0 DMAR_MSI-edge dmar0 25: 0 0 0 0 0 0 0 0 DMAR_MSI-edge dmar1 26: 0 0 0 0 0 0 0 0 IR-PCI-MSI-edge PCIe PME 27: 0 0 0 0 0 0 0 0 IR-PCI-MSI-edge PCIe PME 28: 0 0 0 0 0 0 0 0 IR-PCI-MSI-edge PCIe PME, pciehp 29: 0 0 0 0 0 0 0 0 IR-PCI-MSI-edge PCIe PME 30: 0 0 0 0 0 0 0 0 IR-PCI-MSI-edge PCIe PME 31: 0 0 0 0 0 0 0 0 IR-PCI-MSI-edge PCIe PME 32: 0 0 0 0 0 0 0 0 IR-PCI-MSI-edge PCIe PME 35: 40 0 2 1 12 2 2 2 IR-PCI-MSI-edge xhci_hcd 36: 31 2 3 2 13 3 0 1 IR-PCI-MSI-edge xhci_hcd 37: 0 0 0 0 0 0 0 0 IR-PCI-MSI-edge xhci_hcd 38: 0 0 0 0 0 0 0 0 IR-PCI-MSI-edge xhci_hcd 39: 0 0 0 0 0 0 0 0 IR-PCI-MSI-edge xhci_hcd 40: 0 0 0 0 0 0 0 0 IR-PCI-MSI-edge xhci_hcd 41: 0 0 0 0 0 0 0 0 IR-PCI-MSI-edge xhci_hcd 42: 0 0 0 0 0 0 0 0 IR-PCI-MSI-edge xhci_hcd 43: 0 0 0 0 0 0 0 0 IR-PCI-MSI-edge xhci_hcd 44: 80885 118083 83 67 1826 908 382 88 IR-PCI-MSI-edge 0000:00:1f.2 45: 1 0 1 2 4 5 8 3 IR-PCI-MSI-edge mei_me 46: 16896 89344 8 12 263 163 10 19 IR-PCI-MSI-edge eno1 52: 4 0 172 0 20 1 154 3 IR-PCI-MSI-edge snd_hda_intel 53: 1 0 2 0 5 0 0 0 IR-PCI-MSI-edge i915 54: 0 0 39 1 15 0 1 4 IR-PCI-MSI-edge snd_hda_intel NMI: 1 1 0 0 10 3 0 0 Non-maskable interrupts LOC: 25166 45620 3162 3118 77738 45167 1567 1477 Local timer interrupts SPU: 0 0 0 0 0 0 0 0 Spurious interrupts PMI: 1 1 0 0 10 3 0 0 Performance monitoring interrupts IWI: 2 0 0 0 0 0 0 0 IRQ work interrupts RTR: 0 0 0 0 0 0 0 0 APIC ICR read retries RES: 1660 2067 219 179 71690 20139 91 124 Rescheduling interrupts CAL: 988 994 1648 1680 1692 1463 1664 1664 Function call interrupts TLB: 112 85 53 39 658 312 16 33 TLB shootdowns TRM: 0 0 0 0 0 0 0 0 Thermal event interrupts THR: 0 0 0 0 0 0 0 0 Threshold APIC interrupts MCE: 0 0 0 0 0 0 0 0 Machine check exceptions MCP: 6 6 6 6 6 6 6 6 Machine check polls HYP: 0 0 0 0 0 0 0 0 Hypervisor callback interrupts ERR: 10 MIS: 0</code></pre></div><p>Then it changes to msi-x, I&#039;m forcing msi-x interrupts with saa716x_budget int_type=1 in the guest</p><div class="codebox"><pre class="vscroll"><code>[root@home-server ~]# cat /proc/interrupts CPU0 CPU1 CPU2 CPU3 CPU4 CPU5 CPU6 CPU7 0: 19 0 0 0 0 0 0 0 IR-IO-APIC-edge timer 1: 3 0 0 0 0 0 0 0 IR-IO-APIC-edge i8042 7: 10 0 0 0 0 0 0 0 IR-IO-APIC-edge 8: 0 0 0 0 1 0 0 0 IR-IO-APIC-edge rtc0 9: 0 0 1 0 2 0 0 0 IR-IO-APIC-fasteoi acpi 12: 2 0 1 0 0 0 1 0 IR-IO-APIC-edge i8042 16: 13 7 0 0 2 6 1 0 IR-IO-APIC 16-fasteoi ehci_hcd:usb5 17: 288441 31873 0 0 0 0 0 0 IR-IO-APIC 17-fasteoi 18: 0 0 0 0 0 0 0 0 IR-IO-APIC 18-fasteoi i801_smbus 23: 28 2 0 0 4 1 0 0 IR-IO-APIC 23-fasteoi ehci_hcd:usb6 24: 0 0 0 0 0 0 0 0 DMAR_MSI-edge dmar0 25: 0 0 0 0 0 0 0 0 DMAR_MSI-edge dmar1 26: 0 0 0 0 0 0 0 0 IR-PCI-MSI-edge PCIe PME 27: 0 0 0 0 0 0 0 0 IR-PCI-MSI-edge PCIe PME 28: 0 0 0 0 0 0 0 0 IR-PCI-MSI-edge PCIe PME, pciehp 29: 0 0 0 0 0 0 0 0 IR-PCI-MSI-edge PCIe PME 30: 0 0 0 0 0 0 0 0 IR-PCI-MSI-edge PCIe PME 31: 0 0 0 0 0 0 0 0 IR-PCI-MSI-edge PCIe PME 32: 0 0 0 0 0 0 0 0 IR-PCI-MSI-edge PCIe PME 35: 40 0 2 1 12 2 2 2 IR-PCI-MSI-edge xhci_hcd 36: 31 2 3 2 13 3 0 1 IR-PCI-MSI-edge xhci_hcd 37: 0 0 0 0 0 0 0 0 IR-PCI-MSI-edge xhci_hcd 38: 0 0 0 0 0 0 0 0 IR-PCI-MSI-edge xhci_hcd 39: 0 0 0 0 0 0 0 0 IR-PCI-MSI-edge xhci_hcd 40: 0 0 0 0 0 0 0 0 IR-PCI-MSI-edge xhci_hcd 41: 0 0 0 0 0 0 0 0 IR-PCI-MSI-edge xhci_hcd 42: 0 0 0 0 0 0 0 0 IR-PCI-MSI-edge xhci_hcd 43: 0 0 0 0 0 0 0 0 IR-PCI-MSI-edge xhci_hcd 44: 80885 112767 83 67 1826 908 382 88 IR-PCI-MSI-edge 0000:00:1f.2 45: 1 0 1 2 4 5 8 3 IR-PCI-MSI-edge mei_me 46: 16896 88670 8 12 263 163 10 19 IR-PCI-MSI-edge eno1 52: 4 0 172 0 20 1 154 3 IR-PCI-MSI-edge snd_hda_intel 53: 1 0 2 0 5 0 0 0 IR-PCI-MSI-edge i915 54: 0 0 39 1 15 0 1 4 IR-PCI-MSI-edge snd_hda_intel 55: 556 253 0 0 68 25 0 1 IR-PCI-MSI-edge vfio-msi[0](0000:07:00.0) NMI: 1 1 0 0 9 3 0 0 Non-maskable interrupts LOC: 23680 43632 2955 2927 71642 41880 1478 1388 Local timer interrupts SPU: 0 0 0 0 0 0 0 0 Spurious interrupts PMI: 1 1 0 0 9 3 0 0 Performance monitoring interrupts IWI: 2 0 0 0 0 0 0 0 IRQ work interrupts RTR: 0 0 0 0 0 0 0 0 APIC ICR read retries RES: 1647 2052 209 172 68764 19165 88 118 Rescheduling interrupts CAL: 964 968 1622 1654 1666 1461 1640 1640 Function call interrupts TLB: 107 82 46 37 622 305 15 30 TLB shootdowns TRM: 0 0 0 0 0 0 0 0 Thermal event interrupts THR: 0 0 0 0 0 0 0 0 Threshold APIC interrupts MCE: 0 0 0 0 0 0 0 0 Machine check exceptions MCP: 5 5 5 5 5 5 5 5 Machine check polls HYP: 0 0 0 0 0 0 0 0 Hypervisor callback interrupts ERR: 10 MIS: 0</code></pre></div></div></blockquote></div><br /><p>Hi,</p><p>I have a TBS 6985 (Quad Satellite card) and after quite a lot of messing about got it running within a VM using the open source driver. I would get heavy pixellation until I disabled all power management in the bios (Disabling within linux didn&#039;t work as Turbo modes were still used). Driver info and interrupts below:</p><p>modinfo saa716x_budget<br />filename:&#160; &#160; &#160; &#160;/lib/modules/3.2.0-4-amd64/kernel/drivers/media/pci/saa716x/saa716x_budget.ko<br />license:&#160; &#160; &#160; &#160; GPL<br />author:&#160; &#160; &#160; &#160; &#160;Manu Abraham<br />description:&#160; &#160; SAA716x Budget driver<br />alias:&#160; &#160; &#160; &#160; &#160; pci:v00001131d00007160sv000013C2sd00003010bc*sc*i*<br />alias:&#160; &#160; &#160; &#160; &#160; pci:v00001131d00007160sv00006985sd00000002bc*sc*i*<br />alias:&#160; &#160; &#160; &#160; &#160; pci:v00001131d00007160sv00006985sd00000001bc*sc*i*<br />alias:&#160; &#160; &#160; &#160; &#160; pci:v00001131d00007160sv00006984sd00000013bc*sc*i*<br />alias:&#160; &#160; &#160; &#160; &#160; pci:v00001131d00007160sv00006982sd00000002bc*sc*i*<br />alias:&#160; &#160; &#160; &#160; &#160; pci:v00001131d00007160sv00006982sd00000001bc*sc*i*<br />alias:&#160; &#160; &#160; &#160; &#160; pci:v00001131d00007160sv00006925sd00000001bc*sc*i*<br />alias:&#160; &#160; &#160; &#160; &#160; pci:v00001131d00007160sv00006922sd00000001bc*sc*i*<br />alias:&#160; &#160; &#160; &#160; &#160; pci:v00001131d00007160sv00006220sd00000002bc*sc*i*<br />alias:&#160; &#160; &#160; &#160; &#160; pci:v00001131d00007160sv00006285sd00000001bc*sc*i*<br />alias:&#160; &#160; &#160; &#160; &#160; pci:v00001131d00007160sv00006281sd00000001bc*sc*i*<br />alias:&#160; &#160; &#160; &#160; &#160; pci:v00001131d00007160sv00006280sd00000011bc*sc*i*<br />alias:&#160; &#160; &#160; &#160; &#160; pci:v00001131d00007160sv00006284sd00000001bc*sc*i*<br />alias:&#160; &#160; &#160; &#160; &#160; pci:v00001131d00007160sv00001AE4sd00000700bc*sc*i*<br />alias:&#160; &#160; &#160; &#160; &#160; pci:v00001131d00007160sv00001894sd00000110bc*sc*i*<br />alias:&#160; &#160; &#160; &#160; &#160; pci:v00001131d00007160sv00001822sd00000047bc*sc*i*<br />alias:&#160; &#160; &#160; &#160; &#160; pci:v00001131d00007160sv00001822sd00000039bc*sc*i*<br />alias:&#160; &#160; &#160; &#160; &#160; pci:v00001131d00007160sv00001822sd00000044bc*sc*i*<br />depends:&#160; &#160; &#160; &#160; cx24117,saa716x_core,mb86a16,dvb-core,i2c-core,cxd2820r,tas2101<br />vermagic:&#160; &#160; &#160; &#160;3.2.0-4-amd64 SMP mod_unload modversions<br />parm:&#160; &#160; &#160; &#160; &#160; &#160;verbose:verbose startup messages, default is 1 (yes) (int)<br />parm:&#160; &#160; &#160; &#160; &#160; &#160;int_type:force Interrupt Handler type: 0=INT-A, 1=MSI, 2=MSI-X. default INT-A mode (int)</p><br /><p>cat /proc/interrupts<br />&#160; &#160; &#160; &#160; &#160; &#160;CPU0<br />&#160; 0:&#160; &#160; &#160; &#160; &#160;59&#160; &#160;IO-APIC-edge&#160; &#160; &#160; timer<br />&#160; 1:&#160; &#160; &#160; &#160; &#160; 9&#160; &#160;IO-APIC-edge&#160; &#160; &#160; i8042<br />&#160; 2:&#160; &#160; &#160; &#160; &#160; 0&#160; &#160; XT-PIC-XT-PIC&#160; &#160; cascade<br />&#160; 8:&#160; &#160; &#160; &#160; &#160; 0&#160; &#160;IO-APIC-edge&#160; &#160; &#160; rtc0<br /> 11:&#160; &#160; &#160; &#160; &#160; 0&#160; &#160; XT-PIC-XT-PIC&#160; &#160; virtio0<br /> 12:&#160; &#160; &#160; &#160; 142&#160; &#160;IO-APIC-edge&#160; &#160; &#160; i8042<br /> 40:&#160; &#160; &#160; &#160; &#160; 1&#160; &#160;PCI-MSI-edge&#160; &#160; &#160; pciehp<br /> 41:&#160; &#160;27657437&#160; &#160;PCI-MSI-edge&#160; &#160; &#160; eth0-rx-0<br /> 42:&#160; &#160;22435145&#160; &#160;PCI-MSI-edge&#160; &#160; &#160; eth0-tx-0<br /> 43:&#160; &#160; &#160; &#160; &#160;12&#160; &#160;PCI-MSI-edge&#160; &#160; &#160; eth0:mbx<br /> 44:&#160; &#160; &#160; 43260&#160; &#160;PCI-MSI-edge&#160; &#160; &#160; ahci<br /> 45:&#160; 102414501&#160; &#160;PCI-MSI-edge&#160; &#160; &#160; SAA716x Core<br />NMI:&#160; &#160; &#160; &#160; &#160; 0&#160; &#160;Non-maskable interrupts<br />LOC:&#160; &#160;50181720&#160; &#160;Local timer interrupts<br />SPU:&#160; &#160; &#160; &#160; &#160; 0&#160; &#160;Spurious interrupts<br />PMI:&#160; &#160; &#160; &#160; &#160; 0&#160; &#160;Performance monitoring interrupts<br />IWI:&#160; &#160; &#160; &#160; &#160; 0&#160; &#160;IRQ work interrupts<br />RES:&#160; &#160; &#160; &#160; &#160; 0&#160; &#160;Rescheduling interrupts<br />CAL:&#160; &#160; &#160; &#160; &#160; 0&#160; &#160;Function call interrupts<br />TLB:&#160; &#160; &#160; &#160; &#160; 0&#160; &#160;TLB shootdowns<br />TRM:&#160; &#160; &#160; &#160; &#160; 0&#160; &#160;Thermal event interrupts<br />THR:&#160; &#160; &#160; &#160; &#160; 0&#160; &#160;Threshold APIC interrupts<br />MCE:&#160; &#160; &#160; &#160; &#160; 0&#160; &#160;Machine check exceptions<br />MCP:&#160; &#160; &#160; &#160;6555&#160; &#160;Machine check polls<br />ERR:&#160; &#160; &#160; &#160; &#160; 0<br />MIS:&#160; &#160; &#160; &#160; &#160; 0</p><p>VM Kernel:<br /> uname -r<br />3.2.0-4-amd64</p><p>Host Kernel:<br /> uname -r<br />3.18.5-1-ARCH</p><p>VM Config:<br />cat VM/TVHeadend.xml<br />&lt;domain type=&#039;kvm&#039; xmlns:qemu=&#039;http://libvirt.org/schemas/domain/qemu/1.0&#039;&gt;<br />&#160; &lt;name&gt;TVHeadend&lt;/name&gt;<br />&#160; &lt;uuid&gt;f702c5eb-83d4-4b50-b909-8da878e08d37&lt;/uuid&gt;<br />&#160; &lt;memory unit=&#039;KiB&#039;&gt;1036288&lt;/memory&gt;<br />&#160; &lt;currentMemory unit=&#039;KiB&#039;&gt;1036288&lt;/currentMemory&gt;<br />&lt;vcpu placement=&#039;static&#039;&gt;1&lt;/vcpu&gt;<br />&#160; &lt;os&gt;<br />&#160; &#160; &lt;type arch=&#039;x86_64&#039; machine=&#039;q35&#039;&gt;hvm&lt;/type&gt;<br />&#160; &#160; &lt;loader&gt;/usr/share/qemu/bios.bin&lt;/loader&gt;<br />&#160; &#160; &lt;boot dev=&#039;hd&#039;/&gt;<br />&#160; &#160; &lt;bootmenu enable=&#039;yes&#039;/&gt;<br />&#160; &lt;/os&gt;<br />&#160; &lt;features&gt;<br />&#160; &#160; &lt;acpi/&gt;<br />&#160; &lt;/features&gt;<br />&#160; &lt;clock offset=&#039;localtime&#039;/&gt;<br />&#160; &lt;on_poweroff&gt;destroy&lt;/on_poweroff&gt;<br />&#160; &lt;on_reboot&gt;restart&lt;/on_reboot&gt;<br />&#160; &lt;on_crash&gt;destroy&lt;/on_crash&gt;<br />&#160; &lt;devices&gt;<br />&#160; &#160; &lt;emulator&gt;/usr/bin/qemu-system-x86_64&lt;/emulator&gt;<br />&#160; &#160; &lt;disk type=&#039;file&#039; device=&#039;disk&#039;&gt;<br />&#160; &#160; &#160; &lt;driver name=&#039;qemu&#039; type=&#039;raw&#039;/&gt;<br />&#160; &#160; &#160; &lt;source file=&#039;/home/VM/TVHeadend.img&#039;/&gt;<br />&#160; &#160; &#160; &lt;target dev=&#039;sda&#039; bus=&#039;sata&#039;/&gt;<br />&#160; &#160; &lt;/disk&gt;<br />&#160; &#160; &lt;disk type=&#039;file&#039; device=&#039;cdrom&#039;&gt;<br />&#160; &#160; &#160; &lt;driver name=&#039;qemu&#039; type=&#039;raw&#039;/&gt;<br />&#160; &#160; &#160; &lt;source file=&#039;/home/ISO/debian-7.7.0-amd64-netinst.iso&#039;/&gt;<br />&#160; &#160; &#160; &lt;target dev=&#039;sdb&#039; bus=&#039;sata&#039;/&gt;<br />&#160; &#160; &#160; &lt;readonly/&gt;<br />&#160; &#160; &lt;/disk&gt;<br />&#160; &#160; &lt;controller type=&#039;sata&#039; index=&#039;0&#039;&gt;<br />&#160; &#160; &#160; &lt;address type=&#039;pci&#039; domain=&#039;0x0000&#039; bus=&#039;0x00&#039; slot=&#039;0x1f&#039; function=&#039;0x2&#039;/&gt;<br />&#160; &#160; &lt;/controller&gt;<br />&#160; &#160; &lt;controller type=&#039;pci&#039; index=&#039;0&#039; model=&#039;pcie-root&#039;/&gt;<br />&#160; &#160; &lt;controller type=&#039;pci&#039; index=&#039;1&#039; model=&#039;dmi-to-pci-bridge&#039;&gt;<br />&#160; &#160; &#160; &lt;address type=&#039;pci&#039; domain=&#039;0x0000&#039; bus=&#039;0x00&#039; slot=&#039;0x1e&#039; function=&#039;0x0&#039;/&gt;<br />&#160; &#160; &lt;/controller&gt;<br />&#160; &#160; &lt;controller type=&#039;pci&#039; index=&#039;2&#039; model=&#039;pci-bridge&#039;&gt;<br />&#160; &#160; &#160; &lt;address type=&#039;pci&#039; domain=&#039;0x0000&#039; bus=&#039;0x01&#039; slot=&#039;0x01&#039; function=&#039;0x0&#039;/&gt;<br />&#160; &#160; &lt;/controller&gt;<br /> &lt;graphics type=&#039;vnc&#039; port=&#039;5900&#039; /&gt;<br />&#160; &lt;/devices&gt;<br />&#160; &lt;qemu:commandline&gt;<br />&#160; &#160; &lt;qemu:arg value=&#039;-device&#039;/&gt;<br />&#160; &#160; &lt;qemu:arg value=&#039;ioh3420,bus=pcie.0,addr=1c.0,multifunction=on,port=1,chassis=1,id=root.1&#039;/&gt;<br />&#160; &#160; &lt;qemu:arg value=&#039;-device&#039;/&gt;<br />&#160; &#160; &lt;qemu:arg value=&#039;vfio-pci,host=09:11.2&#039;/&gt;<br />&#160; &#160; &lt;qemu:arg value=&#039;-device&#039;/&gt;<br />&#160; &#160; &lt;qemu:arg value=&#039;vfio-pci,host=08:00.0,id=net10&#039;/&gt;<br />&#160; &lt;/qemu:commandline&gt;<br />&lt;/domain&gt;</p> <p class="postedit"><em>Last edited by Krobar (2015-02-23 07:52:27)</em></p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1505467">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1505485" class="blockpost rowodd"> <h2><span><span class="conr">#4292</span> <a href="viewtopic.php?pid=1505485#p1505485">2015-02-23 10:47:24</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=79471">Bronek</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>From: London</span></dd> <dd><span>Registered: 2014-02-14</span></dd> <dd><span>Posts: 90</span></dd> <dd class="usercontacts"><span class="email"><a href="misc.php?email=79471">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>Len wrote:</cite><blockquote><div><div class="quotebox"><cite>aw wrote:</cite><blockquote><div><div class="quotebox"><cite>aw wrote:</cite><blockquote><div><p><strong>You should not need to touch /etc/libvirt/qemu.conf</strong></p></div></blockquote></div></div></blockquote></div><p>Without touching user, group:</p><div class="codebox"><pre><code>$ virsh start Win81 error: Failed to start domain Win81 error: Requested operation is not valid: PCI device 0000:01:00.0 is not assignable # virsh start Win81 error: Failed to start domain Win81 error: internal error: process exited while connecting to monitor: Could not access KVM kernel module: Permission denied failed to initialize KVM: Permission denied</code></pre></div><p>After changing user and group to root, I can use my vm as root, on user still same error.</p><p>Btw, forgot to ask... I have &#039;The drivers for this device are not installed.&#039; on SCSI Controller in Windows 8, all the time...<br />PCI\VEN_1000&amp;DEV_0012&amp;SUBSYS_10000000&amp;REV_00<br />Where can I get this drivers?</p><p>Can I catch you somewhere on IRC, aw?</p></div></blockquote></div><br /><p>Check this <a href="https://bbs.archlinux.org/viewtopic.php?id=69454" rel="nofollow">https://bbs.archlinux.org/viewtopic.php?id=69454</a>, it could be relevant to your permission errors</p> </div> <div class="postsignature postmsg"><hr /><p>Sorry about&#160; &quot;KVM VGA-Passthrough ...&quot; thread <img src="https://bbs.archlinux.org/img/smilies/sad.png" width="15" height="15" alt="sad" /> Anyone interested in continuing this discussion elsewhere, please contact me privately. I might be able to find it a new home.</p></div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1505485">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1505486" class="blockpost roweven"> <h2><span><span class="conr">#4293</span> <a href="viewtopic.php?pid=1505486#p1505486">2015-02-23 10:51:59</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=79471">Bronek</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>From: London</span></dd> <dd><span>Registered: 2014-02-14</span></dd> <dd><span>Posts: 90</span></dd> <dd class="usercontacts"><span class="email"><a href="misc.php?email=79471">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>Krobar wrote:</cite><blockquote><div><p>&#160; &lt;qemu:commandline&gt;<br />&#160; &#160; &lt;qemu:arg value=&#039;-device&#039;/&gt;<br />&#160; &#160; &lt;qemu:arg value=&#039;ioh3420,bus=pcie.0,addr=1c.0,multifunction=on,port=1,chassis=1,id=root.1&#039;/&gt;<br />&#160; &#160; &lt;qemu:arg value=&#039;-device&#039;/&gt;<br />&#160; &#160; &lt;qemu:arg value=&#039;vfio-pci,host=09:11.2&#039;/&gt;<br />&#160; &#160; &lt;qemu:arg value=&#039;-device&#039;/&gt;<br />&#160; &#160; &lt;qemu:arg value=&#039;vfio-pci,host=08:00.0,id=net10&#039;/&gt;<br />&#160; &lt;/qemu:commandline&gt;<br />&lt;/domain&gt;</p></div></blockquote></div><p>Two points:<br />1. every time someone forgets to use <strong>[</strong>code<strong>]</strong> BBCode, God kills a kitten<br />2. do not use &quot;&lt;qemu:arg &quot;, you are only missing libvirt capability to manage devices for you</p> </div> <div class="postsignature postmsg"><hr /><p>Sorry about&#160; &quot;KVM VGA-Passthrough ...&quot; thread <img src="https://bbs.archlinux.org/img/smilies/sad.png" width="15" height="15" alt="sad" /> Anyone interested in continuing this discussion elsewhere, please contact me privately. I might be able to find it a new home.</p></div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1505486">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1505508" class="blockpost rowodd"> <h2><span><span class="conr">#4294</span> <a href="viewtopic.php?pid=1505508#p1505508">2015-02-23 12:46:31</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=86812">bpbastos</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2014-11-21</span></dd> <dd><span>Posts: 11</span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>Krobar wrote:</cite><blockquote><div><div class="quotebox"><cite>bpbastos wrote:</cite><blockquote><div><div class="quotebox"><cite>aw wrote:</cite><blockquote><div><p>The nointxmask won&#039;t have any effect if MSI-X is actually being used.&#160; Is MSI-X being used by the device when it&#039;s assigned?&#160; (host: grep vfio /proc/interrupts)&#160; If not, the better option would be to try to make it use MSI-X.&#160; If it&#039;s a Windows guest, see <a href="http://vfio.blogspot.com/2014/09/vfio-interrupts-and-how-to-coax-windows.html" rel="nofollow">http://vfio.blogspot.com/2014/09/vfio-i … ndows.html</a>&#160; If it is using MSI-X already, then I&#039;m not sure what to suggest.&#160; We&#039;ve seen cards like Nvidia that actually require a PCI config space write to re-enable MSI and needs a quirk to do so because it writes to a read-only offset.</p></div></blockquote></div><p>It&#039;s a Linux guest (Ubuntu 14.10), this card seems to have a lot of problems with systems where iommu is enabled, see <a href="https://github.com/ljalves/linux_media/issues/66" rel="nofollow">https://github.com/ljalves/linux_media/issues/66</a></p><p>My card is a TBS6285 v21M like the one on the link above and it has the pericom pci bridge which seems to be the root cause of the problems.</p><p>I&#039;ve already tried to passthrough the pericom pci bridge but i think its not possible to passthrough pci bridges.</p><br /><p>When the guest starts, it starts with intx:</p><div class="codebox"><pre class="vscroll"><code>[root@home-server ~]# cat /proc/interrupts CPU0 CPU1 CPU2 CPU3 CPU4 CPU5 CPU6 CPU7 0: 19 0 0 0 0 0 0 0 IR-IO-APIC-edge timer 1: 3 0 0 0 0 0 0 0 IR-IO-APIC-edge i8042 7: 10 0 0 0 0 0 0 0 IR-IO-APIC-edge 8: 0 0 0 0 1 0 0 0 IR-IO-APIC-edge rtc0 9: 0 0 1 0 2 0 0 0 IR-IO-APIC-fasteoi acpi 12: 2 0 1 0 0 0 1 0 IR-IO-APIC-edge i8042 16: 13 7 0 0 2 6 1 0 IR-IO-APIC 16-fasteoi ehci_hcd:usb5 17: 288441 31873 0 0 0 0 0 0 IR-IO-APIC 17-fasteoi vfio-intx(0000:07:00.0) 18: 0 0 0 0 0 0 0 0 IR-IO-APIC 18-fasteoi i801_smbus 23: 28 2 0 0 4 1 0 0 IR-IO-APIC 23-fasteoi ehci_hcd:usb6 24: 0 0 0 0 0 0 0 0 DMAR_MSI-edge dmar0 25: 0 0 0 0 0 0 0 0 DMAR_MSI-edge dmar1 26: 0 0 0 0 0 0 0 0 IR-PCI-MSI-edge PCIe PME 27: 0 0 0 0 0 0 0 0 IR-PCI-MSI-edge PCIe PME 28: 0 0 0 0 0 0 0 0 IR-PCI-MSI-edge PCIe PME, pciehp 29: 0 0 0 0 0 0 0 0 IR-PCI-MSI-edge PCIe PME 30: 0 0 0 0 0 0 0 0 IR-PCI-MSI-edge PCIe PME 31: 0 0 0 0 0 0 0 0 IR-PCI-MSI-edge PCIe PME 32: 0 0 0 0 0 0 0 0 IR-PCI-MSI-edge PCIe PME 35: 40 0 2 1 12 2 2 2 IR-PCI-MSI-edge xhci_hcd 36: 31 2 3 2 13 3 0 1 IR-PCI-MSI-edge xhci_hcd 37: 0 0 0 0 0 0 0 0 IR-PCI-MSI-edge xhci_hcd 38: 0 0 0 0 0 0 0 0 IR-PCI-MSI-edge xhci_hcd 39: 0 0 0 0 0 0 0 0 IR-PCI-MSI-edge xhci_hcd 40: 0 0 0 0 0 0 0 0 IR-PCI-MSI-edge xhci_hcd 41: 0 0 0 0 0 0 0 0 IR-PCI-MSI-edge xhci_hcd 42: 0 0 0 0 0 0 0 0 IR-PCI-MSI-edge xhci_hcd 43: 0 0 0 0 0 0 0 0 IR-PCI-MSI-edge xhci_hcd 44: 80885 118083 83 67 1826 908 382 88 IR-PCI-MSI-edge 0000:00:1f.2 45: 1 0 1 2 4 5 8 3 IR-PCI-MSI-edge mei_me 46: 16896 89344 8 12 263 163 10 19 IR-PCI-MSI-edge eno1 52: 4 0 172 0 20 1 154 3 IR-PCI-MSI-edge snd_hda_intel 53: 1 0 2 0 5 0 0 0 IR-PCI-MSI-edge i915 54: 0 0 39 1 15 0 1 4 IR-PCI-MSI-edge snd_hda_intel NMI: 1 1 0 0 10 3 0 0 Non-maskable interrupts LOC: 25166 45620 3162 3118 77738 45167 1567 1477 Local timer interrupts SPU: 0 0 0 0 0 0 0 0 Spurious interrupts PMI: 1 1 0 0 10 3 0 0 Performance monitoring interrupts IWI: 2 0 0 0 0 0 0 0 IRQ work interrupts RTR: 0 0 0 0 0 0 0 0 APIC ICR read retries RES: 1660 2067 219 179 71690 20139 91 124 Rescheduling interrupts CAL: 988 994 1648 1680 1692 1463 1664 1664 Function call interrupts TLB: 112 85 53 39 658 312 16 33 TLB shootdowns TRM: 0 0 0 0 0 0 0 0 Thermal event interrupts THR: 0 0 0 0 0 0 0 0 Threshold APIC interrupts MCE: 0 0 0 0 0 0 0 0 Machine check exceptions MCP: 6 6 6 6 6 6 6 6 Machine check polls HYP: 0 0 0 0 0 0 0 0 Hypervisor callback interrupts ERR: 10 MIS: 0</code></pre></div><p>Then it changes to msi-x, I&#039;m forcing msi-x interrupts with saa716x_budget int_type=1 in the guest</p><div class="codebox"><pre class="vscroll"><code>[root@home-server ~]# cat /proc/interrupts CPU0 CPU1 CPU2 CPU3 CPU4 CPU5 CPU6 CPU7 0: 19 0 0 0 0 0 0 0 IR-IO-APIC-edge timer 1: 3 0 0 0 0 0 0 0 IR-IO-APIC-edge i8042 7: 10 0 0 0 0 0 0 0 IR-IO-APIC-edge 8: 0 0 0 0 1 0 0 0 IR-IO-APIC-edge rtc0 9: 0 0 1 0 2 0 0 0 IR-IO-APIC-fasteoi acpi 12: 2 0 1 0 0 0 1 0 IR-IO-APIC-edge i8042 16: 13 7 0 0 2 6 1 0 IR-IO-APIC 16-fasteoi ehci_hcd:usb5 17: 288441 31873 0 0 0 0 0 0 IR-IO-APIC 17-fasteoi 18: 0 0 0 0 0 0 0 0 IR-IO-APIC 18-fasteoi i801_smbus 23: 28 2 0 0 4 1 0 0 IR-IO-APIC 23-fasteoi ehci_hcd:usb6 24: 0 0 0 0 0 0 0 0 DMAR_MSI-edge dmar0 25: 0 0 0 0 0 0 0 0 DMAR_MSI-edge dmar1 26: 0 0 0 0 0 0 0 0 IR-PCI-MSI-edge PCIe PME 27: 0 0 0 0 0 0 0 0 IR-PCI-MSI-edge PCIe PME 28: 0 0 0 0 0 0 0 0 IR-PCI-MSI-edge PCIe PME, pciehp 29: 0 0 0 0 0 0 0 0 IR-PCI-MSI-edge PCIe PME 30: 0 0 0 0 0 0 0 0 IR-PCI-MSI-edge PCIe PME 31: 0 0 0 0 0 0 0 0 IR-PCI-MSI-edge PCIe PME 32: 0 0 0 0 0 0 0 0 IR-PCI-MSI-edge PCIe PME 35: 40 0 2 1 12 2 2 2 IR-PCI-MSI-edge xhci_hcd 36: 31 2 3 2 13 3 0 1 IR-PCI-MSI-edge xhci_hcd 37: 0 0 0 0 0 0 0 0 IR-PCI-MSI-edge xhci_hcd 38: 0 0 0 0 0 0 0 0 IR-PCI-MSI-edge xhci_hcd 39: 0 0 0 0 0 0 0 0 IR-PCI-MSI-edge xhci_hcd 40: 0 0 0 0 0 0 0 0 IR-PCI-MSI-edge xhci_hcd 41: 0 0 0 0 0 0 0 0 IR-PCI-MSI-edge xhci_hcd 42: 0 0 0 0 0 0 0 0 IR-PCI-MSI-edge xhci_hcd 43: 0 0 0 0 0 0 0 0 IR-PCI-MSI-edge xhci_hcd 44: 80885 112767 83 67 1826 908 382 88 IR-PCI-MSI-edge 0000:00:1f.2 45: 1 0 1 2 4 5 8 3 IR-PCI-MSI-edge mei_me 46: 16896 88670 8 12 263 163 10 19 IR-PCI-MSI-edge eno1 52: 4 0 172 0 20 1 154 3 IR-PCI-MSI-edge snd_hda_intel 53: 1 0 2 0 5 0 0 0 IR-PCI-MSI-edge i915 54: 0 0 39 1 15 0 1 4 IR-PCI-MSI-edge snd_hda_intel 55: 556 253 0 0 68 25 0 1 IR-PCI-MSI-edge vfio-msi[0](0000:07:00.0) NMI: 1 1 0 0 9 3 0 0 Non-maskable interrupts LOC: 23680 43632 2955 2927 71642 41880 1478 1388 Local timer interrupts SPU: 0 0 0 0 0 0 0 0 Spurious interrupts PMI: 1 1 0 0 9 3 0 0 Performance monitoring interrupts IWI: 2 0 0 0 0 0 0 0 IRQ work interrupts RTR: 0 0 0 0 0 0 0 0 APIC ICR read retries RES: 1647 2052 209 172 68764 19165 88 118 Rescheduling interrupts CAL: 964 968 1622 1654 1666 1461 1640 1640 Function call interrupts TLB: 107 82 46 37 622 305 15 30 TLB shootdowns TRM: 0 0 0 0 0 0 0 0 Thermal event interrupts THR: 0 0 0 0 0 0 0 0 Threshold APIC interrupts MCE: 0 0 0 0 0 0 0 0 Machine check exceptions MCP: 5 5 5 5 5 5 5 5 Machine check polls HYP: 0 0 0 0 0 0 0 0 Hypervisor callback interrupts ERR: 10 MIS: 0</code></pre></div></div></blockquote></div><br /><p>Hi,</p><p>I have a TBS 6985 (Quad Satellite card) and after quite a lot of messing about got it running within a VM using the open source driver. I would get heavy pixellation until I disabled all power management in the bios (Disabling within linux didn&#039;t work as Turbo modes were still used). Driver info and interrupts below:</p></div></blockquote></div><p>Thanks @Krobar.</p><p>I&#039;ve tried to disable power management settings like you suggested but unfortunately it didn&#039;t solve my problem.</p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1505508">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1505535" class="blockpost roweven"> <h2><span><span class="conr">#4295</span> <a href="viewtopic.php?pid=1505535#p1505535">2015-02-23 14:57:43</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=85314">Duelist</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2014-09-22</span></dd> <dd><span>Posts: 358</span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>deniv wrote:</cite><blockquote><div><div class="quotebox"><cite>Duelist wrote:</cite><blockquote><div><p><a href="http://www.insanelymac.com/forum/topic/299614-asus-eah6450-video-bios-uefi-gop-upgrade-and-gop-uefi-binary-in-efi-for-many-ati-cards/" rel="nofollow">http://www.insanelymac.com/forum/topic/ … ati-cards/</a><br />Based on this thread, i&#039;ve created my own, handmade ROM from legacy HD7750&#039;s ROM and HD6450&#039;s GOP EFI part.<br />And it boots with OVMF. Creepy stuff.</p><p>UPD: Win7 installer froze after boot logo animation, win8 goes fine.</p><p>UPD2: Driver install went well. Benchmarking time!<br />If you want my ROM - I can send it.</p></div></blockquote></div><p>Thanks a lot for this message! I&#039;ve managed to make my own rom. Since I liked the latest vbios for my 7750, which is a bit overclocked compared to the original, I decided to replace only the buggy GOP part. And it even works! I can boot systemrescuecd in pure EFI mode. Using DRI freezes the VM, though (not that I care at this moment).<br />P.S. Installing Windows on UEFI is such a pain. :x</p></div></blockquote></div><p>Forget all that crap you have with filesystems.<br />Check out how it&#039;s really done:</p><div class="codebox"><pre><code>-device ahci \ -device virtio-scsi-pci \ -device scsi-cd,drive=install \ -device ide-cd,bus=ide.1,drive=virtiocd \ -drive file=/mnt/hdd/qemu/windows8.iso,id=install,if=none \ -drive file=/mnt/hdd/qemu/virtio.iso,id=virtiocd,if=none \</code></pre></div><p>I don&#039;t recall which(ahci or virtio-scsi-pci) controller controls the scsi-cd, but since we don&#039;t need supa-dupa-high-performance and we need this to run the install cd only once - try adding both, qemu will sort it out for you.<br />Connecting disks that way works, but you must use windows <strong>8</strong> system, because win7 fails to work with GOP, halting in another dead loop somewhere. I might do some additional testing with gigabyte GT610 uefi-compliant card and windows7 much later, just for fun.<br />Please note that i am specifically using <strong>-M pc and not Q35.</strong></p><p>Regarding the ROM stuff - the AMD GOP is <span class="bbu">almost universal</span>. It&#039;s just some revision of it that is broken. As you can see, using the older part from HD6450 actually helps. So you may use ANY BIOS for your HD7XXX card, especially if you want to tinker with voltages, power limits and clocks and stuff.<br />But beware - to do any actual <span class="bbs">harm</span> tweaking to your GPU you <strong>must</strong> use windows, since VBE7 is written only for windows, atiwinflash is only for windows and various other stuff is only for windows. I have windowns 7 system installed on bare metal somewhere on the hard drive just for my own comfort.</p><p>Right now i have windowns 8 installed and directx9-11 and opengl works fine showing almost zero performance drawbacks, HOWEVER seems like there&#039;s still some issues left, as i&#039;m getting half the framerate in some old and buggy(it has bugs under windows too) games like rfactor.</p> </div> <div class="postsignature postmsg"><hr /><p><span class="bbs">The forum rules prohibit requesting support for distributions other than arch.</span><br /><a href="https://bbs.archlinux.org/viewtopic.php?pid=1551460#p1551460" rel="nofollow">I gave up.</a><a href="https://bbs.archlinux.org/viewtopic.php?id=162768" rel="nofollow"> It was too late.</a><br /><a href="http://pastebin.com/B3fL84bq" rel="nofollow">What I was trying to do</a>.<br /><a href="http://vfio.blogspot.com/" rel="nofollow">The reference about VFIO and KVM VGA passthrough.</a></p></div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1505535">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1505598" class="blockpost rowodd"> <h2><span><span class="conr">#4296</span> <a href="viewtopic.php?pid=1505598#p1505598">2015-02-23 18:04:08</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=87813">Len</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd class="postavatar"><img src="https://bbs.archlinux.org/img/avatars/87813.png?m=1420509844" width="80" height="80" alt="" /></dd> <dd><span>Registered: 2015-01-06</span></dd> <dd><span>Posts: 23</span></dd> <dd class="usercontacts"><span class="email"><a href="misc.php?email=87813">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <p><strong>@nbhs</strong></p><p>Add info on first page, might help some people...</p><p><strong>How can I run virtual machine on normal user using libvirt:</strong><br />- start libvirtd process on root user (systemd)<br />- path to bios files have to be executable, readable<br />- /etc/libvirt/libvirtd.conf (this one is working for me)</p><div class="codebox"><pre><code>unix_sock_group = &quot;libvirt&quot; unix_sock_ro_perms = &quot;0777&quot; unix_sock_rw_perms = &quot;0770&quot; unix_sock_dir = &quot;/var/run/libvirt&quot; auth_unix_ro = &quot;none&quot; auth_unix_rw = &quot;none&quot;</code></pre></div><p>- /etc/libvirt/qemu.conf<br />in my case is blank.<br />- starting vm on normal user: <span class="bbu">virsh -c qemu:///system start ...</span></p><p>If it was somewhere in this thread, I must missed it.<br />Thanks aw &amp; laine for help!</p> <p class="postedit"><em>Last edited by Len (2015-02-23 18:06:25)</em></p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1505598">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1505696" class="blockpost roweven"> <h2><span><span class="conr">#4297</span> <a href="viewtopic.php?pid=1505696#p1505696">2015-02-24 01:17:08</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=75968">deniv</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2013-10-16</span></dd> <dd><span>Posts: 27</span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>Duelist wrote:</cite><blockquote><div><p>[Forget all that crap you have with filesystems.<br />Check out how it&#039;s really done:</p></div></blockquote></div><p>I was going to say I&#039;d already tried that, but decided to give it another chance. Guess what? By pure luck I found a working combination: my fat32 partition mounted as scsi-disk AND my udf iso mounted as scsi-cdrom. Only when I connected both disks, installation started. Just to remind what goes wrong in other setups: the fat32 partition alone won&#039;t launch because of the &quot;no mapping&quot; error; the udf iso is simply not supported by ovmf (yet). There are patches that add UDF support on ovmf&#039;s ml.</p><p>Anyway, now I have Windows 8.1 and I&#039;m a happy panda. I&#039;ve just run the Unigine Valley benchmark. It works. Pure EFI. I haven&#039;t noticed any issues. On the contrary, this setup somehow feels snappier than my Win7 VM.</p><p>Meanwhile I noticed that the standard video card driver (i.e. the driver used by qxl) in Win8 supports fancy effects like transparency. It isn&#039;t the case in Win7. Also, I can have both qxl and the passed through GPU work together. Each device gets its own screen. Nice!</p><p>P.S. Don&#039;t know why, but a clean install of Win8 takes two times less space than a clean install of Win7 (with updates).</p><div class="codebox"><pre><code>LV VG Attr LSize Pool Origin Data% win7-clean vg0 Vwi-a-tz-- 50.00g thin-pool1 33.44 win81-clean vg0 Vwi-a-tz-- 50.00g thin-pool1 win81 15.89</code></pre></div> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1505696">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1505732" class="blockpost rowodd"> <h2><span><span class="conr">#4298</span> <a href="viewtopic.php?pid=1505732#p1505732">2015-02-24 05:27:55</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=74738">instantepiphany</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2013-09-04</span></dd> <dd><span>Posts: 32</span></dd> <dd class="usercontacts"><span class="email"><a href="mailto:jordancran@gmail.com">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>aw wrote:</cite><blockquote><div><div class="quotebox"><cite>instantepiphany wrote:</cite><blockquote><div><p>I am not using arch currently, but this is the best resource I could find with regards to vga passthrough on QEMU.<br />I have gotten everything working so far, except actual passthrough. When I run my vm, I hear the graphics card that I am passing through spin up like it does on boot, but when I switch to the input from that card, there is no display. What could be causing this?</p></div></blockquote></div><p><a href="http://vfio.blogspot.com/2014/08/vfiovga-faq.html" rel="nofollow">FAQ #3/4</a></p><div class="quotebox"><blockquote><div><p>Edit: And, in the original guide (which is a few years old now) it says you need seabios - but I cant see any commands that link to it or ask QEMU to use it in the OP, does qemu automatically detect that seabios is installed and use it ?</p></div></blockquote></div><p>Don&#039;t bother with a <em>-bios</em> option, those instructions are outdated.</p></div></blockquote></div><p>Thanks, I thought it might be outdated.</p><p>Looks like the &quot;other&quot; vga arbiter patch is for me, as I am using 2 amd cards rather than intel IGP + dedicated card, and my host graphics don&#039;t get corrupted. I haven&#039;t applied a patch to the kernel before (though I have applied patches to other code), is there any thing I need be aware of in terms of kernel version? I am currently using 3.18.5, will the patch break anything with my kernel?</p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1505732">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1505748" class="blockpost roweven"> <h2><span><span class="conr">#4299</span> <a href="viewtopic.php?pid=1505748#p1505748">2015-02-24 06:56:16</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=88564">hotfunction</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2015-02-05</span></dd> <dd><span>Posts: 10</span></dd> <dd class="usercontacts"><span class="email"><a href="misc.php?email=88564">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>hotfunction wrote:</cite><blockquote><div><div class="quotebox"><blockquote><div><p>If 440fx and -nographic don&#039;t help and you&#039;re looking at the right output from the GPU, I&#039;d next be suspicious of the ROM file.&#160; It looks like one from techpowerup.&#160; Does it actually match your card?&#160; Can you dump the ROM from your card instead?&#160; Do you even need a dump of the ROM?</p></div></blockquote></div><p>hi sir aw.. i tried downloading various ROMs from other sites too, but none of them seems to get me working, they still gave me black screen output on the sscreen... and it seemed to be hard to find nvidia&#039;s ROM corresponding on that... so is it okay if i change into another GPU card? will it help me to work?</p><div class="quotebox"><blockquote><div><p>That black window is the sdl graphics head for the VM which appears because you haven&#039;t used the -nographic option.&#160; The GPU output should be on a monitor connected to the assigned GPU.&#160; I&#039;d also recommend, like I almost always do, using 440fx rather than q35 for the VM.&#160; It looks like you&#039;re using a Linux guest, but afaik, the nvidia driver does not have an issue with PCIe topology in Linux (until you get to lots of GPUs and that may already be fixed too).</p></div></blockquote></div><p>and also about this part... i actually still confused, after some reading and stuff, i redone the steps from nbhs&#039;s page one, after making the single script and others.. i still see the black qemu command line window when adding -vga none... and also without a rom setting, i also tried rombar=0 option and -nographic still didnt give me output.. can you give me further explanation on this.. ?? i am very confused about the black qemu command line, and how does people use -vga none without -nographics to go straight to the VMS without the black qemu command line?</p><p>Edit : i tried adding -curses instead of -nographics, and its still giving me blank output, which i can type &quot;quit&quot; and i can go back to the qemu, which is that i am guessing that is still the black qemu command line output again.. removing that -vga none boots -curses to the VM.. so is the black qemu command line from the -vga none output is showing because of my GPU rom incorrect? or am i missing something..?</p></div></blockquote></div><p>on this case, i tried to extract the ROM of my own GTX560Ti GPU, and i used it to launch my VMs, as the same that using -nographic and -vga none gives no output, any help on this anyone? <img src="https://bbs.archlinux.org/img/smilies/sad.png" width="15" height="15" alt="sad" /></p><p>also i tried to put the romfile= option in the q35 machine ( becuase 440fx didn&#039;t work for me ) and i put my extracted rom from my GPU to the path, it still give me a same result instead.. -vga none still give me qemu command line monitor, adding -vga none and -nographics shows no output, and also if i remove -vga none and qemu command in q35 script, i can boot inside the VM, but it looks like the GPU is not utilized properly.. it shows in lspci in the linux, but the GPU passthrough didn&#039;t work, as i test opening youtube and it lags, and also tried unigine heaven benchmark and it still wont work, glx errors.. and also when i boot into windows 8, and adding kvm=off after -cpu argument, it won&#039;t let me boot in, soon after i log in into my account, its having an error_exception which keep restarts...</p><p>can someone help me on this.. i&#039;ve been stuck here for 2 months and i am hoping this to work <img src="https://bbs.archlinux.org/img/smilies/sad.png" width="15" height="15" alt="sad" /></p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1505748">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1505758" class="blockpost rowodd"> <h2><span><span class="conr">#4300</span> <a href="viewtopic.php?pid=1505758#p1505758">2015-02-24 08:33:14</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=88848">mutiny</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2015-02-15</span></dd> <dd><span>Posts: 13</span></dd> <dd class="usercontacts"><span class="email"><a href="misc.php?email=88848">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <p>I am having a terrible time getting audio working in a Windows 8.1 VM with qemu... <br />PCI passthrough is working perfectly with Radeon GPU, motherboard&#039;s 2nd ethernet port, and motherboard&#039;s 2nd SATA controller being passed to the VM. The last piece I need is working audio! <img src="https://bbs.archlinux.org/img/smilies/smile.png" width="15" height="15" alt="smile" /></p><p>To try to enable sound (with pulseaudio used on host), I am doing qemu.sh:</p><div class="codebox"><pre><code>export QEMU_AUDIO_DRV=pa exec qemu-system-x86_64 \ -enable-kvm \ ...... \ -soundhw hda</code></pre></div><p>,</p><p>and the VM fails to launch, with dmesg showing:</p><div class="codebox"><pre class="vscroll"><code>[79307.989184] kvm [22292]: vcpu0 unhandled rdmsr: 0xce [79307.993410] kvm [22292]: vcpu0 unhandled rdmsr: 0x637 [79307.993418] kvm [22292]: vcpu0 unhandled rdmsr: 0xe8 [79307.993422] kvm [22292]: vcpu0 unhandled rdmsr: 0xe7 [79307.993426] kvm [22292]: vcpu0 unhandled rdmsr: 0x31 [79307.993430] kvm [22292]: vcpu0 unhandled rdmsr: 0x35 [79307.993434] kvm [22292]: vcpu0 unhandled rdmsr: 0x39 [79307.993448] kvm [22292]: vcpu0 unhandled rdmsr: 0xce [79307.993451] kvm [22292]: vcpu0 unhandled rdmsr: 0x194 [79307.993454] kvm [22292]: vcpu0 unhandled rdmsr: 0x19a [79313.196146] kvm_get_msr_common: 170 callbacks suppressed [79313.196149] kvm [22292]: vcpu0 unhandled rdmsr: 0x150 [79313.196156] kvm [22292]: vcpu0 unhandled rdmsr: 0x150 [79313.196158] kvm [22292]: vcpu0 unhandled rdmsr: 0x150 [79313.196161] kvm [22292]: vcpu0 unhandled rdmsr: 0x150 [79313.205095] kvm [22292]: vcpu3 unhandled rdmsr: 0x150 [79313.205102] kvm [22292]: vcpu3 unhandled rdmsr: 0x150 [79313.205105] kvm [22292]: vcpu3 unhandled rdmsr: 0x150 [79313.205107] kvm [22292]: vcpu3 unhandled rdmsr: 0x150 [79313.214116] kvm [22292]: vcpu1 unhandled rdmsr: 0x150 [79313.214123] kvm [22292]: vcpu1 unhandled rdmsr: 0x150 [79318.241747] kvm_get_msr_common: 70 callbacks suppressed ... ... ... [79950.317052] vfio-pci 0000:02:00.1: Refused to change power state, currently in D3 [79950.317119] vfio_pci_disable: Failed to reset device 0000:02:00.1 (-22) [79950.328050] vfio-pci 0000:02:00.1: Refused to change power state, currently in D3 [84325.855696] vfio-pci 0000:02:00.0: enabling device (0400 -&gt; 0403) [84325.876928] vfio_ecap_init: 0000:02:00.0 hiding ecap 0x19@0x270 [84325.876931] vfio_ecap_init: 0000:02:00.0 hiding ecap 0x1b@0x2d0 [84325.878188] vfio-pci 0000:02:00.1: enabling device (0400 -&gt; 0402) [84325.900537] vfio-pci 0000:04:00.0: enabling device (0400 -&gt; 0403) [84326.906061] vfio-pci 0000:07:00.0: enabling device (0400 -&gt; 0403) [84330.202221] kvm: zapping shadow pages for mmio generation wraparound [84338.019479] intel_iommu_map: iommu width (39) is not sufficient for the mapped address (c1f400001000)</code></pre></div><p>Any insight into what I am experience? Thanks!</p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1505758">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div class="postlinksb"> <div class="inbox crumbsplus"> <div class="pagepost"> <p class="pagelink conl"><span class="pages-label">Pages: </span><a rel="prev" class="item1" href="viewtopic.php?id=162768&amp;p=171">Previous</a> <a href="viewtopic.php?id=162768">1</a> <span class="spacer">…</span> <a href="viewtopic.php?id=162768&amp;p=170">170</a> <a href="viewtopic.php?id=162768&amp;p=171">171</a> <strong>172</strong> <a href="viewtopic.php?id=162768&amp;p=173">173</a> <a href="viewtopic.php?id=162768&amp;p=174">174</a> <span class="spacer">…</span> <a href="viewtopic.php?id=162768&amp;p=234">234</a> <a rel="next" href="viewtopic.php?id=162768&amp;p=173">Next</a></p> <p class="postlink conr">Topic closed</p> </div> <ul class="crumbs"> <li><a href="index.php">Index</a></li> <li><span>»&#160;</span><a href="viewforum.php?id=48">Topics Going Nowhere</a></li> <li><span>»&#160;</span><strong><a href="viewtopic.php?id=162768">KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</a></strong></li> </ul> <p class="subscribelink clearb"><a href="misc.php?action=subscribe&amp;tid=162768">Subscribe to this topic</a></p> <div class="clearer"></div> </div> </div> </div> <div id="brdfooter" class="block"> <h2><span>Board footer</span></h2> <div class="box"> <div id="brdfooternav" class="inbox"> <div class="conl"> <form id="qjump" method="get" action="viewforum.php"> <div><label><span>Jump to<br /></span> <select name="id" onchange="window.location=('viewforum.php?id='+this.options[this.selectedIndex].value)"> <optgroup label="Technical Issues and Assistance"> <option value="23">Newbie Corner</option> <option value="17">Installation</option> <option value="22">Kernel &amp; Hardware</option> <option value="18">Applications &amp; Desktop Environments</option> <option value="31">Laptop Issues</option> <option value="8">Networking, Server, and Protection</option> <option value="32">Multimedia and Games</option> <option value="50">System Administration</option> <option value="35">Other Architectures</option> </optgroup> <optgroup label="Arch-centric"> <option value="24">Announcements, Package &amp; Security Advisories</option> <option value="1">Arch Discussion</option> <option value="13">Forum &amp; Wiki discussion</option> </optgroup> <optgroup label="Pacman Upgrades, Packaging &amp; AUR"> <option value="44">Pacman &amp; Package Upgrade Issues</option> <option value="49">[testing] Repo Forum</option> <option value="4">Creating &amp; Modifying Packages</option> <option value="38">AUR Issues, Discussion &amp; PKGBUILD Requests</option> </optgroup> <optgroup label="Contributions &amp; Discussion"> <option value="20">GNU/Linux Discussion</option> <option value="27">Community Contributions</option> <option value="33">Programming &amp; Scripting</option> <option value="30">Other Languages</option> <option value="47">Artwork and Screenshots</option> <option value="42">Try This</option> </optgroup> <optgroup label="/dev/null"> <option value="29">Off-Topic</option> <option value="48" selected="selected">Topics Going Nowhere</option> <option value="36">Dustbin</option> </optgroup> </select></label> <input type="submit" value=" Go " accesskey="g" /> </div> </form> </div> <div class="conr"> <p id="feedlinks"><span class="atom"><a href="extern.php?action=feed&amp;tid=162768&amp;type=atom">Atom topic feed</a></span></p> <p id="poweredby">Powered by <a href="http://fluxbb.org/">FluxBB</a></p> </div> <div class="clearer"></div> </div> </div> </div> </div> <div class="end-box"></div> </div> </body> </html>
