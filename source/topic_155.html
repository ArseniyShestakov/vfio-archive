<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"> <html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en" dir="ltr"> <head> <meta http-equiv="Content-Type" content="text/html; charset=utf-8" /> <title>KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9 (Page 155) / Topics Going Nowhere / Arch Linux Forums</title> <link rel="stylesheet" type="text/css" href="style/ArchLinux.css" /> <link rel="canonical" href="viewtopic.php?id=162768&amp;p=155" title="Page 155" /> <link rel="prev" href="viewtopic.php?id=162768&amp;p=154" title="Page 154" /> <link rel="next" href="viewtopic.php?id=162768&amp;p=156" title="Page 156" /> <link rel="alternate" type="application/atom+xml" href="extern.php?action=feed&amp;tid=162768&amp;type=atom" title="Atom topic feed" /> <link rel="stylesheet" media="screen" href="style/ArchLinux/arch.css?v=3" /> <link rel="stylesheet" media="screen" href="style/ArchLinux/archnavbar.css?v=2" /> <link rel="shortcut icon" href="style/ArchLinux/favicon.ico" /> </head> <body> <div id="archnavbar" class="anb-forum"> <div id="archnavbarlogo"><h1><a href="http://www.archlinux.org/">Arch Linux</a></h1></div> <div id="archnavbarmenu"> <ul id="archnavbarlist"> <li id="anb-home"><a href="http://www.archlinux.org/">Home</a></li><li id="anb-packages"><a href="http://www.archlinux.org/packages/">Packages</a></li><li id="anb-forums" class="anb-selected"><a href="https://bbs.archlinux.org/">Forums</a></li><li id="anb-wiki"><a href="https://wiki.archlinux.org/">Wiki</a></li><li id="anb-bugs"><a href="https://bugs.archlinux.org/">Bugs</a></li><li id="anb-aur"><a href="https://aur.archlinux.org/">AUR</a></li><li id="anb-download"><a href="http://www.archlinux.org/download/">Download</a></li> </ul> </div> </div> <div id="punviewtopic" class="pun"> <div class="top-box"></div> <div class="punwrap"> <div id="brdheader" class="block"> <div class="box"> <div id="brdmenu" class="inbox"> <ul> <li id="navindex" class="isactive"><a href="index.php">Index</a></li> <li id="navuserlist"><a href="userlist.php">User list</a></li> <li id="navsearch"><a href="search.php">Search</a></li> <li id="navprofile"><a href="profile.php?id=80749">Profile</a></li> <li id="navlogout"><a href="login.php?action=out&amp;id=80749&amp;csrf_token=5c20501ec397bb45ef8ee8c84db232c8d8e421c6">Logout</a></li> </ul> </div> <div id="brdwelcome" class="inbox"> <ul class="conl"> <li><span>Logged in as <strong>SXX</strong></span></li> <li><span>Last visit: 2015-08-16 12:20:09</span></li> </ul> <ul class="conr"> <li><span>Topics: <a href="search.php?action=show_replies" title="Find topics you have posted to.">Posted</a> | <a href="search.php?action=show_new" title="Find topics with new posts since your last visit.">New</a> | <a href="search.php?action=show_recent" title="Find topics with recent posts.">Active</a> | <a href="search.php?action=show_unanswered" title="Find topics with no replies.">Unanswered</a></span></li> </ul> <div class="clearer"></div> </div> </div> </div> <div id="brdmain"> <div class="linkst"> <div class="inbox crumbsplus"> <ul class="crumbs"> <li><a href="index.php">Index</a></li> <li><span>»&#160;</span><a href="viewforum.php?id=48">Topics Going Nowhere</a></li> <li><span>»&#160;</span><strong><a href="viewtopic.php?id=162768">KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</a></strong></li> </ul> <div class="pagepost"> <p class="pagelink conl"><span class="pages-label">Pages: </span><a rel="prev" class="item1" href="viewtopic.php?id=162768&amp;p=154">Previous</a> <a href="viewtopic.php?id=162768">1</a> <span class="spacer">…</span> <a href="viewtopic.php?id=162768&amp;p=153">153</a> <a href="viewtopic.php?id=162768&amp;p=154">154</a> <strong>155</strong> <a href="viewtopic.php?id=162768&amp;p=156">156</a> <a href="viewtopic.php?id=162768&amp;p=157">157</a> <span class="spacer">…</span> <a href="viewtopic.php?id=162768&amp;p=234">234</a> <a rel="next" href="viewtopic.php?id=162768&amp;p=156">Next</a></p> <p class="postlink conr">Topic closed</p> </div> <div class="clearer"></div> </div> </div> <div id="p1492788" class="blockpost rowodd blockpost1"> <h2><span><span class="conr">#3851</span> <a href="viewtopic.php?pid=1492788#p1492788">2015-01-13 22:24:52</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=79471">Bronek</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>From: London</span></dd> <dd><span>Registered: 2014-02-14</span></dd> <dd><span>Posts: 90</span></dd> <dd class="usercontacts"><span class="email"><a href="misc.php?email=79471">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>walkindude wrote:</cite><blockquote><div><p>@Bronek</p><p>Tried with rom which I got from running Atiflash and also some roms from techPowerUp. Every time: black screen after Seabios and boot device choosing.</p><p>It&#039;s like I&#039;m missing something stupid or something big, dunno</p></div></blockquote></div><p>Sorry, I&#039;m out of ideas. Perhaps aw will be able to help. Also, which versions of software are your running? Did you try using ROM from your own card?</p> </div> <div class="postsignature postmsg"><hr /><p>Sorry about&#160; &quot;KVM VGA-Passthrough ...&quot; thread <img src="https://bbs.archlinux.org/img/smilies/sad.png" width="15" height="15" alt="sad" /> Anyone interested in continuing this discussion elsewhere, please contact me privately. I might be able to find it a new home.</p></div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1492788">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1492791" class="blockpost roweven"> <h2><span><span class="conr">#3852</span> <a href="viewtopic.php?pid=1492791#p1492791">2015-01-13 22:25:14</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=87990">Nanori</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2015-01-13</span></dd> <dd><span>Posts: 2</span></dd> <dd class="usercontacts"><span class="email"><a href="misc.php?email=87990">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>aw wrote:</cite><blockquote><div><p>/me beats head on desk... </p><p>If you&#039;re using Intel host graphics and VGA mode for the device, you need the i915 patch.&#160; If it didn&#039;t work for you, it&#039;s probably because you didn&#039;t enable it via the kernel commandline.</p></div></blockquote></div><p>Even if I use this patch (and specify the i915.enable_hd_vgaarb=1 in command line), the Nvidia card doesn&#039;t send any signal to the screen. Without this patch, the ATI card work perfectly. For each test I make, I try the tow kernels (3.17 not patched and 3.18 patched) to optimize the chance of success</p><div class="quotebox"><cite>aw wrote:</cite><blockquote><div><p>Most of your current kernel options are unnecessary.</p></div></blockquote></div><p>Yes, but I&#039;ve try them while reading some other topics about VGA Passthrough (nothing ventured, nothing gained <img src="https://bbs.archlinux.org/img/smilies/big_smile.png" width="15" height="15" alt="big_smile" /> ). Remove those unnecessary options from cmdline doen&#039;t solved the issue</p><div class="quotebox"><cite>aw wrote:</cite><blockquote><div><p>And... since you have a Windows guest, don&#039;t use q35!</p><p>Better yet, use Windows8+ and OVMF.</p><p>Doesn&#039;t seem like you&#039;ve been following the thread very carefully...</p></div></blockquote></div><p>At this time, I&#039;m trying to have a Windows 7 guest (preferably without using an UEFI bios). Moreover, the &quot;windowsDisk&quot; I use dosen&#039;t contain any data (no OS). So I should be able to see the bios on my screen when I boot my VM but it isn&#039;t the case.<br />Does a 440fx is realy better ?</p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1492791">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1492801" class="blockpost rowodd"> <h2><span><span class="conr">#3853</span> <a href="viewtopic.php?pid=1492801#p1492801">2015-01-13 22:55:23</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=57829">walkindude</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2012-03-04</span></dd> <dd><span>Posts: 27</span></dd> <dd class="usercontacts"><span class="email"><a href="mailto:lunarstrainut@gmail.com">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <p>@Bronek</p><p>Kernel: <a href="https://aur.archlinux.org/packages/linux-uksm-ck/" rel="nofollow">https://aur.archlinux.org/packages/linux-uksm-ck/</a></p><div class="quotebox"><blockquote><div><p>walkindude@Desktop&gt; uname -a&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;~<br />Linux Desktop 3.18.2-1-uksm-ck #1 SMP PREEMPT Wed Jan 14 01:23:45 MSK 2015 x86_64 GNU/Linux</p></div></blockquote></div><p>Also patched it with ACS patch</p><p>Host video driver (radeonsi):</p><div class="quotebox"><blockquote><div><p>walkindude@Desktop&gt; glxinfo | grep version&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;~<br />server glx version string: 1.4<br />client glx version string: 1.4<br />GLX version: 1.4<br />OpenGL core profile version string: 3.3 (Core Profile) Mesa 10.5.0-devel (git-0e6f0ee)<br />OpenGL core profile shading language version string: 3.30<br />OpenGL version string: 3.0 Mesa 10.5.0-devel (git-0e6f0ee)<br />OpenGL shading language version string: 1.30<br />OpenGL ES profile version string: OpenGL ES 3.0 Mesa 10.5.0-devel (git-0e6f0ee)<br />OpenGL ES profile shading language version string: OpenGL ES GLSL ES 3.0</p></div></blockquote></div><div class="quotebox"><blockquote><div><p>walkindude@Desktop&gt; qemu-x86_64 -version&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;~<br />qemu-x86_64 version 2.2.50, Copyright (c) 2003-2008 Fabrice Bellard</p></div></blockquote></div><div class="quotebox"><blockquote><div><p>walkindude@Desktop&gt; libvirtd -v&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;<br />2015-01-13 22:40:53.819+0000: 9697: info : libvirt version: 1.2.1</p></div></blockquote></div><p>Yes, I&#039;d booted from FreeDos, and backed up ROM (by ATIflash utility) of my own card - same result.</p><p>What I see on desired screen is<br /><a href="http://rghost.net/60334498.view" rel="nofollow">http://rghost.net/60334498.view</a></p><p>Whatever option I choose -&gt; dark screen.</p><p>Could it be because of (one string for one launch)?</p><div class="quotebox"><blockquote><div><p>[&#160; 140.296537] kvm: zapping shadow pages for mmio generation wraparound<br />[ 1134.175319] kvm: zapping shadow pages for mmio generation wraparound</p></div></blockquote></div> <p class="postedit"><em>Last edited by walkindude (2015-01-13 23:25:51)</em></p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1492801">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1492807" class="blockpost roweven"> <h2><span><span class="conr">#3854</span> <a href="viewtopic.php?pid=1492807#p1492807">2015-01-13 23:32:39</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=57829">walkindude</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2012-03-04</span></dd> <dd><span>Posts: 27</span></dd> <dd class="usercontacts"><span class="email"><a href="mailto:lunarstrainut@gmail.com">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>Nanori wrote:</cite><blockquote><div><p>So I should be able to see the bios on my screen when I boot my VM but it isn&#039;t the case.</p></div></blockquote></div><p>Maybe you should set </p><div class="quotebox"><blockquote><div><p>-boot menu=on,splash-time=60000,strict=on</p></div></blockquote></div><p>or some other preferable time [1...65535] ?</p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1492807">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1492808" class="blockpost rowodd"> <h2><span><span class="conr">#3855</span> <a href="viewtopic.php?pid=1492808#p1492808">2015-01-13 23:43:59</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=84278">Wimma77</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2014-08-12</span></dd> <dd><span>Posts: 15</span></dd> <dd class="usercontacts"><span class="email"><a href="misc.php?email=84278">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <p>Has anyone tried the Win10 preview with passthrough?<br />I assume it&#039;s a bit early, but I&#039;m waiting for it as I have no 8.1 license and failed with Win7 &amp; nvidia.</p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1492808">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1492810" class="blockpost roweven"> <h2><span><span class="conr">#3856</span> <a href="viewtopic.php?pid=1492810#p1492810">2015-01-13 23:50:01</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=57829">walkindude</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2012-03-04</span></dd> <dd><span>Posts: 27</span></dd> <dd class="usercontacts"><span class="email"><a href="mailto:lunarstrainut@gmail.com">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <p>@Wimma77<br />I&#039;m trying to do it the right way (build 9888), read my messages <img src="https://bbs.archlinux.org/img/smilies/wink.png" width="15" height="15" alt="wink" /><br />But for now, I cannot go further than selecting the boot device.<br />Previously I&#039;d installed it successfully but with VNC and Cirrus, and it gave me a lot of VIDEO_TDR_FAILURE after I installed Catalyst.</p> <p class="postedit"><em>Last edited by walkindude (2015-01-13 23:56:56)</em></p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1492810">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1492814" class="blockpost rowodd"> <h2><span><span class="conr">#3857</span> <a href="viewtopic.php?pid=1492814#p1492814">2015-01-14 00:11:15</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=84278">Wimma77</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2014-08-12</span></dd> <dd><span>Posts: 15</span></dd> <dd class="usercontacts"><span class="email"><a href="misc.php?email=84278">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <p>@walkindude<br />Yeah, trying to keep up with progress, but been a while. I did have success with a HD7770 (way back around page 80/90 days), but struggled with my GTX750ti so gave it a break. Hoping that it get a little easier as things mature. Want to try OVMF, and have looked through aw&#039;s blog, but I don&#039;t have Win8 so can&#039;t try yet.<br />Also my server is in full use at home, so don&#039;t have the play time I used to, so need to be confident before I start messing around again.<br />Think I need another test box ...</p> <p class="postedit"><em>Last edited by Wimma77 (2015-01-14 00:11:44)</em></p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1492814">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1492836" class="blockpost roweven"> <h2><span><span class="conr">#3858</span> <a href="viewtopic.php?pid=1492836#p1492836">2015-01-14 02:39:07</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=51042">dam5h</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2011-08-04</span></dd> <dd><span>Posts: 21</span></dd> <dd class="usercontacts"><span class="email"><a href="misc.php?email=51042">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <p>Would this be possible with a haswell laptop with only the integrated graphics?&#160; It would be okay that once the guest boots and takes control of the GPU you could no longer access the host until you shut down the guest.</p><p>Thanks.</p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1492836">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1492837" class="blockpost rowodd"> <h2><span><span class="conr">#3859</span> <a href="viewtopic.php?pid=1492837#p1492837">2015-01-14 02:40:25</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=75590">aw</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2013-10-04</span></dd> <dd><span>Posts: 921</span></dd> <dd class="usercontacts"><span class="email"><a href="misc.php?email=75590">Email</a></span> <span class="website"><a href="http://vfio.blogspot.com/" rel="nofollow">Website</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>dam5h wrote:</cite><blockquote><div><p>Would this be possible with a haswell laptop with only the integrated graphics?&#160; It would be okay that once the guest boots and takes control of the GPU you could no longer access the host until you shut down the guest.</p><p>Thanks.</p></div></blockquote></div><p>No</p> </div> <div class="postsignature postmsg"><hr /><p><a href="http://vfio.blogspot.com" rel="nofollow">http://vfio.blogspot.com</a><br />Looking for a more open forum to discuss vfio related uses?&#160; Try <a href="https://www.redhat.com/mailman/listinfo/vfio-users" rel="nofollow">https://www.redhat.com/mailman/listinfo/vfio-users</a></p></div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1492837">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1492851" class="blockpost roweven"> <h2><span><span class="conr">#3860</span> <a href="viewtopic.php?pid=1492851#p1492851">2015-01-14 05:19:50</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=79899">winie</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2014-03-01</span></dd> <dd><span>Posts: 17</span></dd> <dd class="usercontacts"><span class="email"><a href="mailto:alireza4051@yahoo.com">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>dam5h wrote:</cite><blockquote><div><p>Would this be possible with a haswell laptop with only the integrated graphics?&#160; It would be okay that once the guest boots and takes control of the GPU you could no longer access the host until you shut down the guest.</p><p>Thanks.</p></div></blockquote></div><p>use xengt:<br /><a href="https://github.com/01org/XenGT-Preview-kernel" rel="nofollow">https://github.com/01org/XenGT-Preview-kernel</a><br />it does the gpu equivalent&#160; of vt-x for the cpu and uses the integrated graphics for host and guest at the same time <img src="https://bbs.archlinux.org/img/smilies/smile.png" width="15" height="15" alt="smile" /></p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1492851">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1492857" class="blockpost rowodd"> <h2><span><span class="conr">#3861</span> <a href="viewtopic.php?pid=1492857#p1492857">2015-01-14 06:41:00</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=82442">slis</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2014-06-02</span></dd> <dd><span>Posts: 125</span></dd> <dd class="usercontacts"><span class="email"><a href="mailto:xslisx@gmail.com">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <p>or maybe kvmGT? did anyone try it?</p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1492857">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1492873" class="blockpost roweven"> <h2><span><span class="conr">#3862</span> <a href="viewtopic.php?pid=1492873#p1492873">2015-01-14 09:11:21</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=79471">Bronek</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>From: London</span></dd> <dd><span>Registered: 2014-02-14</span></dd> <dd><span>Posts: 90</span></dd> <dd class="usercontacts"><span class="email"><a href="misc.php?email=79471">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>walkindude wrote:</cite><blockquote><div><p>@Bronek<br />Host video driver (radeonsi):</p><div class="quotebox"><blockquote><div><p>walkindude@Desktop&gt; glxinfo | grep version&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;~<br />server glx version string: 1.4<br />client glx version string: 1.4<br />GLX version: 1.4<br />OpenGL core profile version string: 3.3 (Core Profile) Mesa 10.5.0-devel (git-0e6f0ee)<br />OpenGL core profile shading language version string: 3.30<br />OpenGL version string: 3.0 Mesa 10.5.0-devel (git-0e6f0ee)<br />OpenGL shading language version string: 1.30<br />OpenGL ES profile version string: OpenGL ES 3.0 Mesa 10.5.0-devel (git-0e6f0ee)<br />OpenGL ES profile shading language version string: OpenGL ES GLSL ES 3.0</p></div></blockquote></div></div></blockquote></div><br /><p>OK so you have versions of everything recent enough. How many GPUs have you got? Are you sure that the one you want passed through is not being claimed by radeon driver? I have blacklisted radeon on my machine, and it&#039;s being run headless. You can use lspci -vnn -s 03:00.0 for this, you may also need to check /proc/iomem&#160; as suggested by aw on page 130 of this thread.</p><p>EDIT: also, capabilities of driver loaded in host are totally irrelevant for passthrough. The whole idea of VGA passthrough is to make the card&#160; <strong>unavailable</strong> for the host and available for the guest <strong>instead</strong>. Not some part of the card, but all of it, starting from emulated PCI channel. The only thing that hosts own drivers need to be able to do, is to sod off. Some drivers are not very good in this and will actually claim the card you want to passthrough, just because it has recognized chip type. It might be that the module you have loaded in the host is this kind of a driver.</p> <p class="postedit"><em>Last edited by Bronek (2015-01-14 09:19:08)</em></p> </div> <div class="postsignature postmsg"><hr /><p>Sorry about&#160; &quot;KVM VGA-Passthrough ...&quot; thread <img src="https://bbs.archlinux.org/img/smilies/sad.png" width="15" height="15" alt="sad" /> Anyone interested in continuing this discussion elsewhere, please contact me privately. I might be able to find it a new home.</p></div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1492873">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1492876" class="blockpost rowodd"> <h2><span><span class="conr">#3863</span> <a href="viewtopic.php?pid=1492876#p1492876">2015-01-14 09:39:29</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=79471">Bronek</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>From: London</span></dd> <dd><span>Registered: 2014-02-14</span></dd> <dd><span>Posts: 90</span></dd> <dd class="usercontacts"><span class="email"><a href="misc.php?email=79471">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <p>@walkindude, actually you reminded me I wanted to ask <strong>aw</strong> something : which video modules are known to cause trouble/ignore VGA arbitration? Assuming guest OS is not EFI compatible (i.e. OVMF is not available) and recent kernel is being used on host. I think the following options are normally available : vga16fb , vesafb , radeon/nouveau, radeonfb/nvidiafb (i915 is not an option for reasons you explained often enough, but what about intelfb?). Some users may run fbcon on top of it, or run a non-free driver instead of regular kernel module.</p><p>Also from reading <a href="http://vfio.blogspot.co.uk/2014/08/whats-deal-with-vga-arbitration.html" rel="nofollow">http://vfio.blogspot.co.uk/2014/08/what … ation.html</a> I understand that Xorg does not play (at all) with VGA arbitration, but it not does not imply that <strong>another</strong> GPU cannot be passed through, does it?</p> <p class="postedit"><em>Last edited by Bronek (2015-01-14 10:35:04)</em></p> </div> <div class="postsignature postmsg"><hr /><p>Sorry about&#160; &quot;KVM VGA-Passthrough ...&quot; thread <img src="https://bbs.archlinux.org/img/smilies/sad.png" width="15" height="15" alt="sad" /> Anyone interested in continuing this discussion elsewhere, please contact me privately. I might be able to find it a new home.</p></div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1492876">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1492906" class="blockpost roweven"> <h2><span><span class="conr">#3864</span> <a href="viewtopic.php?pid=1492906#p1492906">2015-01-14 12:12:52</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=34610">Myranti</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2010-03-04</span></dd> <dd><span>Posts: 19</span></dd> <dd class="usercontacts"><span class="email"><a href="misc.php?email=34610">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <p>After reading a number of the posts here about hugepages I figured I&#039;d give it a shot and have set it up. I&#039;m not sure if there&#039;s much of a performance improvement, but I haven&#039;t really tested it yet.</p><p>I also took the time to finally remove the need for the vfio-bind script since I was still binding a network adapter because I had been too lazy to fix my network config files, which was adding all en* interfaces to my bridge and causing the network on the host not to start. The less messing around with extra scripts that I can do, the better.</p><p>I have to say that I&#039;m pretty happy to have everything working well, taking me from 2 separate computers (1 for linux, 1 for windows gaming) down to 1.</p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1492906">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1492917" class="blockpost rowodd"> <h2><span><span class="conr">#3865</span> <a href="viewtopic.php?pid=1492917#p1492917">2015-01-14 13:05:55</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=79471">Bronek</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>From: London</span></dd> <dd><span>Registered: 2014-02-14</span></dd> <dd><span>Posts: 90</span></dd> <dd class="usercontacts"><span class="email"><a href="misc.php?email=79471">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <p>@walkindude , one more thing, show us the result of </p><div class="codebox"><pre><code>$ dmesg | grep -E &quot;0000:03:00|radeon|stub|vfio&quot;</code></pre></div> <p class="postedit"><em>Last edited by Bronek (2015-01-14 13:20:07)</em></p> </div> <div class="postsignature postmsg"><hr /><p>Sorry about&#160; &quot;KVM VGA-Passthrough ...&quot; thread <img src="https://bbs.archlinux.org/img/smilies/sad.png" width="15" height="15" alt="sad" /> Anyone interested in continuing this discussion elsewhere, please contact me privately. I might be able to find it a new home.</p></div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1492917">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1492964" class="blockpost roweven"> <h2><span><span class="conr">#3866</span> <a href="viewtopic.php?pid=1492964#p1492964">2015-01-14 16:57:20</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=57829">walkindude</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2012-03-04</span></dd> <dd><span>Posts: 27</span></dd> <dd class="usercontacts"><span class="email"><a href="mailto:lunarstrainut@gmail.com">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <p>@Bronek</p><div class="quotebox"><blockquote><div><p>walkindude@Desktop&gt; sudo dmesg | grep -E &quot;0000:03:00|radeon|stub|vfio&quot;&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;~<br />[&#160; &#160; 0.000000] Command line: BOOT_IMAGE=/boot/vmlinuz-linux-uksm-ck root=UUID=7d535c2f-90b6-4f8d-b39f-ff79dd6dfedf rw root=/dev/mapper/lvmVolume-lvmRoot discard rw iommu=pt iommu=1 ivrs_ioapic[9]=00:14.0 ivrs_ioapic[10]=00:00.1 amd_iommu_dump=1 pci-stub.ids=1002:6739,1002:aa88 pcie_acs_override=downstream<br />[&#160; &#160; 0.000000] Kernel command line: BOOT_IMAGE=/boot/vmlinuz-linux-uksm-ck root=UUID=7d535c2f-90b6-4f8d-b39f-ff79dd6dfedf rw root=/dev/mapper/lvmVolume-lvmRoot discard rw iommu=pt iommu=1 ivrs_ioapic[9]=00:14.0 ivrs_ioapic[10]=00:00.1 amd_iommu_dump=1 pci-stub.ids=1002:6739,1002:aa88 pcie_acs_override=downstream<br />[&#160; &#160; 0.502020] pci 0000:03:00.0: [1002:6739] type 00 class 0x030000<br />[&#160; &#160; 0.502040] pci 0000:03:00.0: reg 0x10: [mem 0xc0000000-0xcfffffff 64bit pref]<br />[&#160; &#160; 0.502053] pci 0000:03:00.0: reg 0x18: [mem 0xfe820000-0xfe83ffff 64bit]<br />[&#160; &#160; 0.502061] pci 0000:03:00.0: reg 0x20: [io&#160; 0xc000-0xc0ff]<br />[&#160; &#160; 0.502075] pci 0000:03:00.0: reg 0x30: [mem 0xfe800000-0xfe81ffff pref]<br />[&#160; &#160; 0.502160] pci 0000:03:00.0: supports D1 D2<br />[&#160; &#160; 0.502224] pci 0000:03:00.1: [1002:aa88] type 00 class 0x040300<br />[&#160; &#160; 0.502243] pci 0000:03:00.1: reg 0x10: [mem 0xfe840000-0xfe843fff 64bit]<br />[&#160; &#160; 0.502330] pci 0000:03:00.1: supports D1 D2<br />[&#160; &#160; 0.505789] vgaarb: device added: PCI:0000:03:00.0,decodes=io+mem,owns=none,locks=none<br />[&#160; &#160; 0.505792] vgaarb: bridge control possible 0000:03:00.0<br />[&#160; &#160; 0.512441] pci 0000:03:00.0: can&#039;t claim BAR 0 [mem 0xc0000000-0xcfffffff 64bit pref]: no compatible bridge window<br />[&#160; &#160; 0.528611] pci 0000:03:00.0: BAR 0: no space for [mem size 0x10000000 64bit pref]<br />[&#160; &#160; 0.528614] pci 0000:03:00.0: BAR 0: trying firmware assignment [mem size 0x10000000 64bit pref]<br />[&#160; &#160; 0.528616] pci 0000:03:00.0: BAR 0: assigned [mem 0xc0000000-0xcfffffff 64bit pref]<br />[&#160; &#160; 3.000492] pci-stub: add 1002:6739 sub=FFFFFFFF:FFFFFFFF cls=00000000/00000000<br />[&#160; &#160; 3.000505] pci-stub 0000:03:00.0: claimed by stub<br />[&#160; &#160; 3.000511] pci-stub: add 1002:AA88 sub=FFFFFFFF:FFFFFFFF cls=00000000/00000000<br />[&#160; &#160; 3.000526] pci-stub 0000:03:00.1: claimed by stub<br />[&#160; &#160; 4.984586] [drm] radeon kernel modesetting enabled.<br />[&#160; &#160; 4.984674] fb: switching to radeondrmfb from EFI VGA<br />[&#160; &#160; 4.989974] radeon 0000:01:00.0: Invalid ROM contents<br />[&#160; &#160; 4.990438] radeon 0000:01:00.0: VRAM: 2048M 0x0000000000000000 - 0x000000007FFFFFFF (2048M used)<br />[&#160; &#160; 4.990441] radeon 0000:01:00.0: GTT: 1024M 0x0000000080000000 - 0x00000000BFFFFFFF<br />[&#160; &#160; 4.990648] [drm] radeon: 2048M of VRAM memory ready<br />[&#160; &#160; 4.990650] [drm] radeon: 1024M of GTT memory ready.<br />[&#160; &#160; 5.011140] [drm] radeon: dpm initialized<br />[&#160; &#160; 5.023619] radeon 0000:01:00.0: WB enabled<br />[&#160; &#160; 5.023623] radeon 0000:01:00.0: fence driver on ring 0 use gpu addr 0x0000000080000c00 and cpu addr 0xffff880001cdfc00<br />[&#160; &#160; 5.023625] radeon 0000:01:00.0: fence driver on ring 1 use gpu addr 0x0000000080000c04 and cpu addr 0xffff880001cdfc04<br />[&#160; &#160; 5.023628] radeon 0000:01:00.0: fence driver on ring 2 use gpu addr 0x0000000080000c08 and cpu addr 0xffff880001cdfc08<br />[&#160; &#160; 5.023630] radeon 0000:01:00.0: fence driver on ring 3 use gpu addr 0x0000000080000c0c and cpu addr 0xffff880001cdfc0c<br />[&#160; &#160; 5.023633] radeon 0000:01:00.0: fence driver on ring 4 use gpu addr 0x0000000080000c10 and cpu addr 0xffff880001cdfc10<br />[&#160; &#160; 5.024698] radeon 0000:01:00.0: fence driver on ring 5 use gpu addr 0x0000000000075a18 and cpu addr 0xffffc90011135a18<br />[&#160; &#160; 5.024704] radeon 0000:01:00.0: radeon: MSI limited to 32-bit<br />[&#160; &#160; 5.024742] radeon 0000:01:00.0: irq 30 for MSI/MSI-X<br />[&#160; &#160; 5.024756] radeon 0000:01:00.0: radeon: using MSI.<br />[&#160; &#160; 5.024789] [drm] radeon: irq initialized.<br />[&#160; &#160; 6.162222] fbcon: radeondrmfb (fb0) is primary device<br />[&#160; &#160; 6.208766] radeon 0000:01:00.0: fb0: radeondrmfb frame buffer device<br />[&#160; &#160; 6.208768] radeon 0000:01:00.0: registered panic notifier<br />[&#160; &#160; 6.216932] [drm] Initialized radeon 2.40.0 20080528 for 0000:01:00.0 on minor 0<br />[&#160; 523.806082] vfio-pci 0000:03:00.0: enabling device (0000 -&gt; 0003)<br />[&#160; 523.879271] vfio-pci 0000:03:00.1: enabling device (0000 -&gt; 0002)</p></div></blockquote></div><div class="quotebox"><blockquote><div><p>walkindude@Desktop&gt; sudo lspci -vnn -s 03:00.0&#160; <br />03:00.0 VGA compatible controller [0300]: Advanced Micro Devices, Inc. [AMD/ATI] Barts PRO [Radeon HD 6850] [1002:6739] (prog-if 00 [VGA controller])<br />&#160; &#160; Subsystem: PC Partner Limited / Sapphire Technology Device [174b:e174]<br />&#160; &#160; Flags: fast devsel, IRQ 16<br />&#160; &#160; Memory at c0000000 (64-bit, prefetchable) [disabled] [size=256M]<br />&#160; &#160; Memory at fe820000 (64-bit, non-prefetchable) [disabled] [size=128K]<br />&#160; &#160; I/O ports at c000 [disabled] [size=256]<br />&#160; &#160; Expansion ROM at fe800000 [disabled] [size=128K]<br />&#160; &#160; Capabilities: [50] Power Management version 3<br />&#160; &#160; Capabilities: [58] Express Legacy Endpoint, MSI 00<br />&#160; &#160; Capabilities: [a0] MSI: Enable- Count=1/1 Maskable- 64bit+<br />&#160; &#160; Capabilities: [100] Vendor Specific Information: ID=0001 Rev=1 Len=010 &lt;?&gt;<br />&#160; &#160; Capabilities: [150] Advanced Error Reporting<br />&#160; &#160; &#160; &#160; Kernel driver in use: pci-stub<br />&#160; &#160; Kernel modules: radeon</p></div></blockquote></div><div class="quotebox"><blockquote><div><p>walkindude@Desktop&gt; cat /proc/iomem&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; ~<br />00000000-00000fff : reserved<br />00001000-0009ffff : System RAM<br />000a0000-000bffff : PCI Bus 0000:00<br />000c0000-000dffff : PCI Bus 0000:00<br />&#160; 000c0000-000cffff : Video ROM<br />000f0000-000fffff : System ROM<br />00100000-bda58fff : System RAM<br />&#160; 03000000-0345329d : Kernel code<br />&#160; 0345329e-038e57ff : Kernel data<br />&#160; 03a0a000-03b7afff : Kernel bss<br />bda59000-bdaa9fff : ACPI Non-volatile Storage<br />bdaaa000-bdab2fff : ACPI Tables<br />bdab3000-bdab3fff : ACPI Non-volatile Storage<br />bdab4000-bdad8fff : reserved<br />bdad9000-bdae9fff : ACPI Non-volatile Storage<br />bdaea000-bdaebfff : reserved<br />bdaec000-bdafcfff : reserved<br />bdafd000-bdafdfff : reserved<br />bdafe000-bdafefff : reserved<br />bdaff000-bdb00fff : ACPI Non-volatile Storage<br />bdb01000-bdb01fff : reserved<br />bdb02000-bdb02fff : reserved<br />bdb03000-bdb09fff : reserved<br />bdb0a000-bdb0ffff : ACPI Non-volatile Storage<br />bdb10000-bdb1cfff : reserved<br />bdb1d000-bdb5efff : reserved<br />bdb5f000-bdb6efff : reserved<br />bdb6f000-bdb71fff : reserved<br />bdb72000-bdd74fff : ACPI Non-volatile Storage<br />bdd75000-bdefffff : System RAM<br />bdf00000-bfffffff : RAM buffer<br />c0000000-cfffffff : 0000:03:00.0<br />d0000000-ffffffff : PCI Bus 0000:00<br />&#160; d0000000-dfffffff : PCI Bus 0000:01<br />&#160; &#160; d0000000-dfffffff : 0000:01:00.0<br />&#160; e0000000-efffffff : PCI MMCONFIG 0000 [bus 00-ff]<br />&#160; &#160; e0000000-efffffff : pnp 00:00<br />&#160; f8000000-fbffffff : reserved<br />&#160; fe800000-fe8fffff : PCI Bus 0000:03<br />&#160; &#160; fe800000-fe81ffff : 0000:03:00.0<br />&#160; &#160; fe820000-fe83ffff : 0000:03:00.0<br />&#160; &#160; fe840000-fe843fff : 0000:03:00.1<br />&#160; fe900000-fe9fffff : PCI Bus 0000:02<br />&#160; &#160; fe900000-fe91ffff : 0000:02:06.0<br />&#160; &#160; fe920000-fe9200ff : 0000:02:06.0<br />&#160; &#160; &#160; fe920000-fe9200ff : r8169<br />&#160; fea00000-feafffff : PCI Bus 0000:01<br />&#160; &#160; fea00000-fea3ffff : 0000:01:00.0<br />&#160; &#160; fea40000-fea5ffff : 0000:01:00.0<br />&#160; &#160; fea60000-fea63fff : 0000:01:00.1<br />&#160; &#160; &#160; fea60000-fea63fff : ICH HD audio<br />&#160; feb00000-feb000ff : 0000:00:16.2<br />&#160; &#160; feb00000-feb000ff : ehci_hcd<br />&#160; feb01000-feb01fff : 0000:00:16.0<br />&#160; &#160; feb01000-feb01fff : ohci_hcd<br />&#160; feb02000-feb02fff : 0000:00:14.5<br />&#160; &#160; feb02000-feb02fff : ohci_hcd<br />&#160; feb03000-feb030ff : 0000:00:13.2<br />&#160; &#160; feb03000-feb030ff : ehci_hcd<br />&#160; feb04000-feb04fff : 0000:00:13.0<br />&#160; &#160; feb04000-feb04fff : ohci_hcd<br />&#160; feb05000-feb050ff : 0000:00:12.2<br />&#160; &#160; feb05000-feb050ff : ehci_hcd<br />&#160; feb06000-feb06fff : 0000:00:12.0<br />&#160; &#160; feb06000-feb06fff : ohci_hcd<br />&#160; feb07000-feb073ff : 0000:00:11.0<br />&#160; &#160; feb07000-feb073ff : ahci<br />&#160; feb20000-feb23fff : amd_iommu<br />&#160; fec00000-fec00fff : reserved<br />&#160; &#160; fec00000-fec003ff : IOAPIC 0<br />&#160; fec10000-fec10fff : reserved<br />&#160; &#160; fec10000-fec10fff : pnp 00:01<br />&#160; fec20000-fec20fff : reserved<br />&#160; &#160; fec20000-fec203ff : IOAPIC 1<br />&#160; fed00000-fed00fff : reserved<br />&#160; &#160; fed00000-fed003ff : HPET 0<br />&#160; &#160; &#160; fed00000-fed003ff : PNP0103:00<br />&#160; fed61000-fed70fff : reserved<br />&#160; &#160; fed61000-fed70fff : pnp 00:01<br />&#160; fed80000-fed8ffff : reserved<br />&#160; &#160; fed80000-fed8ffff : pnp 00:01<br />&#160; &#160; &#160; fed80b00-fed80b07 : SB800 TCO<br />&#160; fee00000-fee00fff : Local APIC<br />&#160; &#160; fee00000-fee00fff : pnp 00:01<br />&#160; fef00000-ffffffff : reserved<br />&#160; &#160; ffc00000-ffffffff : pnp 00:01<br />100001000-23effffff : System RAM<br />23f000000-23fffffff : RAM buffer</p></div></blockquote></div><p>Two GPUs:<br />HD6850<br />R9 270</p><p>Mobo:<br />M5A97 Pro</p><p>Processor:<br />Amd FX-8320</p> <p class="postedit"><em>Last edited by walkindude (2015-01-14 17:00:25)</em></p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1492964">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1493028" class="blockpost rowodd"> <h2><span><span class="conr">#3867</span> <a href="viewtopic.php?pid=1493028#p1493028">2015-01-14 20:23:44</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=85963">Rommy</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2014-10-17</span></dd> <dd><span>Posts: 22</span></dd> <dd class="usercontacts"><span class="email"><a href="misc.php?email=85963">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <p>Since qemu 2.2.0-1 I get the following error:<br />qemu-system-x86_64: -device ide-hd,bus=ide.0,drive=disk: Property &#039;ide-hd.drive&#039; can&#039;t take value &#039;disk&#039;, it&#039;s in use</p><p>Is there a workaround?</p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1493028">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1493036" class="blockpost roweven"> <h2><span><span class="conr">#3868</span> <a href="viewtopic.php?pid=1493036#p1493036">2015-01-14 20:35:30</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=75590">aw</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2013-10-04</span></dd> <dd><span>Posts: 921</span></dd> <dd class="usercontacts"><span class="email"><a href="misc.php?email=75590">Email</a></span> <span class="website"><a href="http://vfio.blogspot.com/" rel="nofollow">Website</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>Rommy wrote:</cite><blockquote><div><p>Since qemu 2.2.0-1 I get the following error:<br />qemu-system-x86_64: -device ide-hd,bus=ide.0,drive=disk: Property &#039;ide-hd.drive&#039; can&#039;t take value &#039;disk&#039;, it&#039;s in use</p><p>Is there a workaround?</p></div></blockquote></div><p>Don&#039;t name your drive &quot;disk&quot;?</p> </div> <div class="postsignature postmsg"><hr /><p><a href="http://vfio.blogspot.com" rel="nofollow">http://vfio.blogspot.com</a><br />Looking for a more open forum to discuss vfio related uses?&#160; Try <a href="https://www.redhat.com/mailman/listinfo/vfio-users" rel="nofollow">https://www.redhat.com/mailman/listinfo/vfio-users</a></p></div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1493036">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1493041" class="blockpost rowodd"> <h2><span><span class="conr">#3869</span> <a href="viewtopic.php?pid=1493041#p1493041">2015-01-14 20:46:01</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=85963">Rommy</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2014-10-17</span></dd> <dd><span>Posts: 22</span></dd> <dd class="usercontacts"><span class="email"><a href="misc.php?email=85963">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <p>I tried diska, before posting.<br />Now I tried &#039;win&#039;, same errors.</p><p>Edit:<br />My full command is:</p><div class="codebox"><pre><code>qemu-system-x86_64 -enable-kvm -M q35 -m 4096 -cpu host,kvm=off -smp 3,sockets=1,cores=3,threads=1 -bios /usr/share/qemu/bios.bin -vga none -device ioh3420,bus=pcie.0,addr=1c.0,multifunction=on,port=1,chassis=1,id=root.1 -device vfio-pci,host=01:00.0,bus=root.1,addr=00.0,multifunction=on,x-vga=on,romfile=/home/rommy/vms/win8/GF100.rom -device vfio-pci,host=01:00.1,bus=root.1,addr=00.1 -usb -usbdevice host:0079:0006 -usbdevice host:062a:0252 -usbdevice host:04f3:0103 -drive file=/home/rommy/vms/win8/win8_vga_rw.qcow2,id=win,format=qcow2 -device ide-hd,bus=ide.0,drive=win -nographic</code></pre></div> <p class="postedit"><em>Last edited by Rommy (2015-01-14 20:48:38)</em></p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1493041">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1493042" class="blockpost roweven"> <h2><span><span class="conr">#3870</span> <a href="viewtopic.php?pid=1493042#p1493042">2015-01-14 20:47:45</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=75590">aw</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2013-10-04</span></dd> <dd><span>Posts: 921</span></dd> <dd class="usercontacts"><span class="email"><a href="misc.php?email=75590">Email</a></span> <span class="website"><a href="http://vfio.blogspot.com/" rel="nofollow">Website</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>Rommy wrote:</cite><blockquote><div><p>I tried diska, before posting.<br />Now I tried &#039;win&#039;, same errors.</p></div></blockquote></div><p>That&#039;s the only guess I&#039;m going to give without the rest of your command line.</p> </div> <div class="postsignature postmsg"><hr /><p><a href="http://vfio.blogspot.com" rel="nofollow">http://vfio.blogspot.com</a><br />Looking for a more open forum to discuss vfio related uses?&#160; Try <a href="https://www.redhat.com/mailman/listinfo/vfio-users" rel="nofollow">https://www.redhat.com/mailman/listinfo/vfio-users</a></p></div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1493042">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1493043" class="blockpost rowodd"> <h2><span><span class="conr">#3871</span> <a href="viewtopic.php?pid=1493043#p1493043">2015-01-14 20:49:08</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=85963">Rommy</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2014-10-17</span></dd> <dd><span>Posts: 22</span></dd> <dd class="usercontacts"><span class="email"><a href="misc.php?email=85963">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <p>Sorry, I edited it. See above</p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1493043">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1493044" class="blockpost roweven"> <h2><span><span class="conr">#3872</span> <a href="viewtopic.php?pid=1493044#p1493044">2015-01-14 20:50:35</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=70922">nbhs</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd class="postavatar"><img src="https://bbs.archlinux.org/img/avatars/70922.jpg?m=1367773811" width="80" height="80" alt="" /></dd> <dd><span>From: Montevideo, Uruguay</span></dd> <dd><span>Registered: 2013-05-02</span></dd> <dd><span>Posts: 402</span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>Rommy wrote:</cite><blockquote><div><p>I tried diska, before posting.<br />Now I tried &#039;win&#039;, same errors.</p><p>Edit:<br />My full command is:</p><div class="codebox"><pre><code>qemu-system-x86_64 -enable-kvm -M q35 -m 4096 -cpu host,kvm=off -smp 3,sockets=1,cores=3,threads=1 -bios /usr/share/qemu/bios.bin -vga none -device ioh3420,bus=pcie.0,addr=1c.0,multifunction=on,port=1,chassis=1,id=root.1 -device vfio-pci,host=01:00.0,bus=root.1,addr=00.0,multifunction=on,x-vga=on,romfile=/home/rommy/vms/win8/GF100.rom -device vfio-pci,host=01:00.1,bus=root.1,addr=00.1 -usb -usbdevice host:0079:0006 -usbdevice host:062a:0252 -usbdevice host:04f3:0103 -drive file=/home/rommy/vms/win8/win8_vga_rw.qcow2,id=win,format=qcow2 -device ide-hd,bus=ide.0,drive=win -nographic</code></pre></div></div></blockquote></div><p>add &quot;if=none&quot;</p><div class="codebox"><pre><code>...,drive=win,if=none</code></pre></div><p>qemu 2.2 should support -cdrom -hda, etc using the q35 chipset</p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1493044">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1493045" class="blockpost rowodd"> <h2><span><span class="conr">#3873</span> <a href="viewtopic.php?pid=1493045#p1493045">2015-01-14 20:57:23</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=85963">Rommy</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2014-10-17</span></dd> <dd><span>Posts: 22</span></dd> <dd class="usercontacts"><span class="email"><a href="misc.php?email=85963">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="codebox"><pre><code>qemu-system-x86_64 -enable-kvm -M q35 -m 4096 -cpu host,kvm=off -smp 3,sockets=1,cores=3,threads=1 -bios /usr/share/qemu/bios.bin -vga none -device ioh3420,bus=pcie.0,addr=1c.0,multifunction=on,port=1,chassis=1,id=root.1 -device vfio-pci,host=01:00.0,bus=root.1,addr=00.0,multifunction=on,x-vga=on,romfile=/home/rommy/vms/win8/GF100.rom -device vfio-pci,host=01:00.1,bus=root.1,addr=00.1 -usb -usbdevice host:0079:0006 -usbdevice host:062a:0252 -usbdevice host:04f3:0103 -drive file=/home/rommy/vms/win8/win8_vga_rw.qcow2,id=win,format=qcow2 -device ide-hd,bus=ide.0,drive=win,if=none -nographic</code></pre></div><p>Error:</p><div class="codebox"><pre><code>qemu-system-x86_64: -device ide-hd,bus=ide.0,drive=win,if=none: Property &#039;ide-hd.drive&#039; can&#039;t take value &#039;win&#039;, it&#039;s in use</code></pre></div> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1493045">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1493048" class="blockpost roweven"> <h2><span><span class="conr">#3874</span> <a href="viewtopic.php?pid=1493048#p1493048">2015-01-14 21:01:41</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=70922">nbhs</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd class="postavatar"><img src="https://bbs.archlinux.org/img/avatars/70922.jpg?m=1367773811" width="80" height="80" alt="" /></dd> <dd><span>From: Montevideo, Uruguay</span></dd> <dd><span>Registered: 2013-05-02</span></dd> <dd><span>Posts: 402</span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>Rommy wrote:</cite><blockquote><div><div class="codebox"><pre><code>qemu-system-x86_64 -enable-kvm -M q35 -m 4096 -cpu host,kvm=off -smp 3,sockets=1,cores=3,threads=1 -bios /usr/share/qemu/bios.bin -vga none -device ioh3420,bus=pcie.0,addr=1c.0,multifunction=on,port=1,chassis=1,id=root.1 -device vfio-pci,host=01:00.0,bus=root.1,addr=00.0,multifunction=on,x-vga=on,romfile=/home/rommy/vms/win8/GF100.rom -device vfio-pci,host=01:00.1,bus=root.1,addr=00.1 -usb -usbdevice host:0079:0006 -usbdevice host:062a:0252 -usbdevice host:04f3:0103 -drive file=/home/rommy/vms/win8/win8_vga_rw.qcow2,id=win,format=qcow2 -device ide-hd,bus=ide.0,drive=win,if=none -nographic</code></pre></div><p>Error:</p><div class="codebox"><pre><code>qemu-system-x86_64: -device ide-hd,bus=ide.0,drive=win,if=none: Property &#039;ide-hd.drive&#039; can&#039;t take value &#039;win&#039;, it&#039;s in use</code></pre></div></div></blockquote></div><p>Yeah sorry it should be like this:</p><div class="codebox"><pre><code>... -drive file=/home/rommy/vms/win8/win8_vga_rw.qcow2,id=win,format=qcow2,if=none -device ide-hd,bus=ide.0,drive=win ...</code></pre></div><p>EDITED</p> <p class="postedit"><em>Last edited by nbhs (2015-01-14 21:03:41)</em></p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1493048">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1493049" class="blockpost rowodd"> <h2><span><span class="conr">#3875</span> <a href="viewtopic.php?pid=1493049#p1493049">2015-01-14 21:03:44</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=75590">aw</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2013-10-04</span></dd> <dd><span>Posts: 921</span></dd> <dd class="usercontacts"><span class="email"><a href="misc.php?email=75590">Email</a></span> <span class="website"><a href="http://vfio.blogspot.com/" rel="nofollow">Website</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <p>I think if=none goes on the <em>-drive</em> option...</p> </div> <div class="postsignature postmsg"><hr /><p><a href="http://vfio.blogspot.com" rel="nofollow">http://vfio.blogspot.com</a><br />Looking for a more open forum to discuss vfio related uses?&#160; Try <a href="https://www.redhat.com/mailman/listinfo/vfio-users" rel="nofollow">https://www.redhat.com/mailman/listinfo/vfio-users</a></p></div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1493049">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div class="postlinksb"> <div class="inbox crumbsplus"> <div class="pagepost"> <p class="pagelink conl"><span class="pages-label">Pages: </span><a rel="prev" class="item1" href="viewtopic.php?id=162768&amp;p=154">Previous</a> <a href="viewtopic.php?id=162768">1</a> <span class="spacer">…</span> <a href="viewtopic.php?id=162768&amp;p=153">153</a> <a href="viewtopic.php?id=162768&amp;p=154">154</a> <strong>155</strong> <a href="viewtopic.php?id=162768&amp;p=156">156</a> <a href="viewtopic.php?id=162768&amp;p=157">157</a> <span class="spacer">…</span> <a href="viewtopic.php?id=162768&amp;p=234">234</a> <a rel="next" href="viewtopic.php?id=162768&amp;p=156">Next</a></p> <p class="postlink conr">Topic closed</p> </div> <ul class="crumbs"> <li><a href="index.php">Index</a></li> <li><span>»&#160;</span><a href="viewforum.php?id=48">Topics Going Nowhere</a></li> <li><span>»&#160;</span><strong><a href="viewtopic.php?id=162768">KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</a></strong></li> </ul> <p class="subscribelink clearb"><a href="misc.php?action=subscribe&amp;tid=162768">Subscribe to this topic</a></p> <div class="clearer"></div> </div> </div> </div> <div id="brdfooter" class="block"> <h2><span>Board footer</span></h2> <div class="box"> <div id="brdfooternav" class="inbox"> <div class="conl"> <form id="qjump" method="get" action="viewforum.php"> <div><label><span>Jump to<br /></span> <select name="id" onchange="window.location=('viewforum.php?id='+this.options[this.selectedIndex].value)"> <optgroup label="Technical Issues and Assistance"> <option value="23">Newbie Corner</option> <option value="17">Installation</option> <option value="22">Kernel &amp; Hardware</option> <option value="18">Applications &amp; Desktop Environments</option> <option value="31">Laptop Issues</option> <option value="8">Networking, Server, and Protection</option> <option value="32">Multimedia and Games</option> <option value="50">System Administration</option> <option value="35">Other Architectures</option> </optgroup> <optgroup label="Arch-centric"> <option value="24">Announcements, Package &amp; Security Advisories</option> <option value="1">Arch Discussion</option> <option value="13">Forum &amp; Wiki discussion</option> </optgroup> <optgroup label="Pacman Upgrades, Packaging &amp; AUR"> <option value="44">Pacman &amp; Package Upgrade Issues</option> <option value="49">[testing] Repo Forum</option> <option value="4">Creating &amp; Modifying Packages</option> <option value="38">AUR Issues, Discussion &amp; PKGBUILD Requests</option> </optgroup> <optgroup label="Contributions &amp; Discussion"> <option value="20">GNU/Linux Discussion</option> <option value="27">Community Contributions</option> <option value="33">Programming &amp; Scripting</option> <option value="30">Other Languages</option> <option value="47">Artwork and Screenshots</option> <option value="42">Try This</option> </optgroup> <optgroup label="/dev/null"> <option value="29">Off-Topic</option> <option value="48" selected="selected">Topics Going Nowhere</option> <option value="36">Dustbin</option> </optgroup> </select></label> <input type="submit" value=" Go " accesskey="g" /> </div> </form> </div> <div class="conr"> <p id="feedlinks"><span class="atom"><a href="extern.php?action=feed&amp;tid=162768&amp;type=atom">Atom topic feed</a></span></p> <p id="poweredby">Powered by <a href="http://fluxbb.org/">FluxBB</a></p> </div> <div class="clearer"></div> </div> </div> </div> </div> <div class="end-box"></div> </div> </body> </html>
