<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"> <html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en" dir="ltr"> <head> <meta http-equiv="Content-Type" content="text/html; charset=utf-8" /> <title>KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9 (Page 231) / Topics Going Nowhere / Arch Linux Forums</title> <link rel="stylesheet" type="text/css" href="style/ArchLinux.css" /> <link rel="canonical" href="viewtopic.php?id=162768&amp;p=231" title="Page 231" /> <link rel="prev" href="viewtopic.php?id=162768&amp;p=230" title="Page 230" /> <link rel="next" href="viewtopic.php?id=162768&amp;p=232" title="Page 232" /> <link rel="alternate" type="application/atom+xml" href="extern.php?action=feed&amp;tid=162768&amp;type=atom" title="Atom topic feed" /> <link rel="stylesheet" media="screen" href="style/ArchLinux/arch.css?v=3" /> <link rel="stylesheet" media="screen" href="style/ArchLinux/archnavbar.css?v=2" /> <link rel="shortcut icon" href="style/ArchLinux/favicon.ico" /> </head> <body> <div id="archnavbar" class="anb-forum"> <div id="archnavbarlogo"><h1><a href="http://www.archlinux.org/">Arch Linux</a></h1></div> <div id="archnavbarmenu"> <ul id="archnavbarlist"> <li id="anb-home"><a href="http://www.archlinux.org/">Home</a></li><li id="anb-packages"><a href="http://www.archlinux.org/packages/">Packages</a></li><li id="anb-forums" class="anb-selected"><a href="https://bbs.archlinux.org/">Forums</a></li><li id="anb-wiki"><a href="https://wiki.archlinux.org/">Wiki</a></li><li id="anb-bugs"><a href="https://bugs.archlinux.org/">Bugs</a></li><li id="anb-aur"><a href="https://aur.archlinux.org/">AUR</a></li><li id="anb-download"><a href="http://www.archlinux.org/download/">Download</a></li> </ul> </div> </div> <div id="punviewtopic" class="pun"> <div class="top-box"></div> <div class="punwrap"> <div id="brdheader" class="block"> <div class="box"> <div id="brdmenu" class="inbox"> <ul> <li id="navindex" class="isactive"><a href="index.php">Index</a></li> <li id="navuserlist"><a href="userlist.php">User list</a></li> <li id="navsearch"><a href="search.php">Search</a></li> <li id="navprofile"><a href="profile.php?id=80749">Profile</a></li> <li id="navlogout"><a href="login.php?action=out&amp;id=80749&amp;csrf_token=5c20501ec397bb45ef8ee8c84db232c8d8e421c6">Logout</a></li> </ul> </div> <div id="brdwelcome" class="inbox"> <ul class="conl"> <li><span>Logged in as <strong>SXX</strong></span></li> <li><span>Last visit: 2015-08-16 12:20:09</span></li> </ul> <ul class="conr"> <li><span>Topics: <a href="search.php?action=show_replies" title="Find topics you have posted to.">Posted</a> | <a href="search.php?action=show_new" title="Find topics with new posts since your last visit.">New</a> | <a href="search.php?action=show_recent" title="Find topics with recent posts.">Active</a> | <a href="search.php?action=show_unanswered" title="Find topics with no replies.">Unanswered</a></span></li> </ul> <div class="clearer"></div> </div> </div> </div> <div id="brdmain"> <div class="linkst"> <div class="inbox crumbsplus"> <ul class="crumbs"> <li><a href="index.php">Index</a></li> <li><span>»&#160;</span><a href="viewforum.php?id=48">Topics Going Nowhere</a></li> <li><span>»&#160;</span><strong><a href="viewtopic.php?id=162768">KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</a></strong></li> </ul> <div class="pagepost"> <p class="pagelink conl"><span class="pages-label">Pages: </span><a rel="prev" class="item1" href="viewtopic.php?id=162768&amp;p=230">Previous</a> <a href="viewtopic.php?id=162768">1</a> <span class="spacer">…</span> <a href="viewtopic.php?id=162768&amp;p=229">229</a> <a href="viewtopic.php?id=162768&amp;p=230">230</a> <strong>231</strong> <a href="viewtopic.php?id=162768&amp;p=232">232</a> <a href="viewtopic.php?id=162768&amp;p=233">233</a> <a href="viewtopic.php?id=162768&amp;p=234">234</a> <a rel="next" href="viewtopic.php?id=162768&amp;p=232">Next</a></p> <p class="postlink conr">Topic closed</p> </div> <div class="clearer"></div> </div> </div> <div id="p1548382" class="blockpost rowodd blockpost1"> <h2><span><span class="conr">#5751</span> <a href="viewtopic.php?pid=1548382#p1548382">2015-07-28 04:39:39</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=84998">jack_boss</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2014-09-09</span></dd> <dd><span>Posts: 6</span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>fld wrote:</cite><blockquote><div><div class="quotebox"><cite>jack_boss wrote:</cite><blockquote><div><div class="quotebox"><blockquote><div><p>I think that on some Intel chipsets, the kernel maps all your physical USB ports behind the Intel xHCI USB controller by default and leaves the EHCI ones unused. <a href="http://lxr.free-electrons.com/source/drivers/usb/host/pci-quirks.c#L850" rel="nofollow">http://lxr.free-electrons.com/source/dr … rks.c#L850</a>. I worked around it by manually changing the Port Routing Mask Register to map physical ports behind the EHCI controllers. The register can simply be changed on the fly.</p></div></blockquote></div><p>Might be worth a try, if I just knew how to do it... first google attempt didn&#039;t really help either.</p></div></blockquote></div><p>You want to access the port routing register in the xhci controllers pci config space. Personally I ended up using &quot;setpci -s 00:14.0 0xd0.W=2037&quot; in my /etc/rc.local file on the Intel 8 Series PCH. Intel has pretty decent documentation available for the chipsets.</p></div></blockquote></div><p>I understand your helping, but I don&#039;t seem to know what I&#039;m looking for. The manpage for setpci didn&#039;t help either.<br />I dont know where to get the folloing missing credentials.</p><div class="codebox"><pre><code>-s [[[[&lt;domain&gt;]:]&lt;bus&gt;]:][&lt;slot&gt;][.[&lt;func&gt;]]</code></pre></div><p>If this is the controller in question which I dont want xHCI to handle:</p><div class="codebox"><pre><code>00:1d.0 USB controller: Intel Corporation 9 Series Chipset Family USB EHCI Controller #1</code></pre></div><p>00 is the domain<br />1d is the bus<br />0 is slut<br />function ?</p><p>Motherboard: Z97 Extreme4</p> <p class="postedit"><em>Last edited by jack_boss (2015-07-28 04:41:15)</em></p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1548382">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1548395" class="blockpost roweven"> <h2><span><span class="conr">#5752</span> <a href="viewtopic.php?pid=1548395#p1548395">2015-07-28 07:08:20</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=88848">mutiny</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2015-02-15</span></dd> <dd><span>Posts: 13</span></dd> <dd class="usercontacts"><span class="email"><a href="misc.php?email=88848">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <p>Should normal PCI devices be able to be passed through just like PCI-express devices? I have a motherboard with 2 PCI slots behind a PCIe-to-PCI bridge, and am interested in passing through a PCI audio card (non PCIe) to a Windows 8.1 guest. On attempt of booting the guest with the PCI card passed, I get a BSOD with &quot;DRIVER_IRQL_NOT_LESS_OR_EQUAL (vioscsi.sys), and with the card removed from startup command, the guest boots up completely fine with other PCIe devices passed through. Perhaps my setup or command is not sane?</p><div class="codebox"><pre><code>exec qemu-system-x86_64 \ -machine type=pc,accel=kvm,kernel_irqchip=on \ -cpu host,hv_time,hv_relaxed,hv_vapic,hv_spinlocks=0x1fff \ -smp cores=2,threads=1,sockets=1 \ -m 4G \ -device vfio-pci,host=01:00.0,multifunction=on,romfile=XFX7870EFI.rom \ -device vfio-pci,host=01:00.1,multifunction=on \ -device vfio-pci,host=03:00.0 \ -device vfio-pci,host=05:00.0 \ -device vfio-pci,host=06:00.0 \ -device virtio-scsi-pci,id=scsi \ -device scsi-block,drive=winhdd \ -name Windows8.1 \ -drive file=OVMF_CODE.fd,if=pflash,format=raw,readonly \ -drive file=OVMF_VARS_win8.fd,if=pflash,format=raw \ -drive file=/dev/sdc,format=raw,if=none,cache=none,id=winhdd \ -display none \ -vga none \ -net none \ -serial none \ -parallel none \ -enable-kvm \ -daemonize \ -rtc base=localtime \ -nodefaults</code></pre></div><br /><p>If &quot;-device vfio-pci,host=05:00.0 \&quot; is removed from the command, guest boots successfully.</p><p>lspci:</p><div class="codebox"><pre><code>00:00.0 Host bridge: Intel Corporation 4th Gen Core Processor DRAM Controller (rev 06) 00:01.0 PCI bridge: Intel Corporation Xeon E3-1200 v3/4th Gen Core Processor PCI Express x16 Controller (rev 06) 00:02.0 VGA compatible controller: Intel Corporation Xeon E3-1200 v3/4th Gen Core Processor Integrated Graphics Controller (rev 06) 00:03.0 Audio device: Intel Corporation Xeon E3-1200 v3/4th Gen Core Processor HD Audio Controller (rev 06) 00:14.0 USB controller: Intel Corporation 9 Series Chipset Family USB xHCI Controller 00:16.0 Communication controller: Intel Corporation 9 Series Chipset Family ME Interface #1 00:19.0 Ethernet controller: Intel Corporation Ethernet Connection I217-V 00:1a.0 USB controller: Intel Corporation 9 Series Chipset Family USB EHCI Controller #2 00:1b.0 Audio device: Intel Corporation 9 Series Chipset Family HD Audio Controller 00:1c.0 PCI bridge: Intel Corporation 9 Series Chipset Family PCI Express Root Port 1 (rev d0) 00:1c.2 PCI bridge: Intel Corporation 9 Series Chipset Family PCI Express Root Port 3 (rev d0) 00:1c.3 PCI bridge: Intel Corporation 82801 PCI Bridge (rev d0) 00:1c.4 PCI bridge: Intel Corporation 9 Series Chipset Family PCI Express Root Port 5 (rev d0) 00:1c.6 PCI bridge: Intel Corporation 9 Series Chipset Family PCI Express Root Port 7 (rev d0) 00:1d.0 USB controller: Intel Corporation 9 Series Chipset Family USB EHCI Controller #1 00:1f.0 ISA bridge: Intel Corporation 9 Series Chipset Family Z97 LPC Controller 00:1f.2 SATA controller: Intel Corporation 9 Series Chipset Family SATA Controller [AHCI Mode] 00:1f.3 SMBus: Intel Corporation 9 Series Chipset Family SMBus Controller 01:00.0 VGA compatible controller: Advanced Micro Devices, Inc. [AMD/ATI] Pitcairn XT [Radeon HD 7870 GHz Edition] 01:00.1 Audio device: Advanced Micro Devices, Inc. [AMD/ATI] Cape Verde/Pitcairn HDMI Audio [Radeon HD 7700/7800 Series] 03:00.0 Ethernet controller: Qualcomm Atheros Killer E220x Gigabit Ethernet Controller (rev 10) 04:00.0 PCI bridge: Intel Corporation 82801 PCI Bridge (rev 41) 05:00.0 Multimedia audio controller: C-Media Electronics Inc CMI8738/CMI8768 PCI Audio (rev 10) 06:00.0 USB controller: Renesas Technology Corp. uPD720201 USB 3.0 Host Controller (rev 03) 07:00.0 SATA controller: Marvell Technology Group Ltd. 88SE9172 SATA 6Gb/s Controller (rev 12)</code></pre></div><p>Thanks for any help!</p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1548395">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1548417" class="blockpost rowodd"> <h2><span><span class="conr">#5753</span> <a href="viewtopic.php?pid=1548417#p1548417">2015-07-28 11:15:06</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=85314">Duelist</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2014-09-22</span></dd> <dd><span>Posts: 358</span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>jack_boss wrote:</cite><blockquote><div><p>If this is the controller in question which I dont want xHCI to handle:</p><div class="codebox"><pre><code>00:1d.0 USB controller: Intel Corporation 9 Series Chipset Family USB EHCI Controller #1</code></pre></div><p>00 is the domain<br />1d is the bus<br />0 is slut<br />function ?</p><p>Motherboard: Z97 Extreme4</p></div></blockquote></div><p>...</p><div class="codebox"><pre><code>[user@crossfire ~]$ ls /sys/bus/pci/devices/ 0000:00:00.0 0000:00:11.0 0000:00:13.2 0000:00:14.4 0000:00:16.0 0000:00:18.2 0000:01:00.0 0000:03:05.0 0000:06:00.0 0000:00:00.2 0000:00:12.0 0000:00:14.0 0000:00:15.0 0000:00:16.2 0000:00:18.3 0000:01:00.1 0000:04:00.0 0000:00:02.0 0000:00:12.2 0000:00:14.2 0000:00:15.1 0000:00:18.0 0000:00:18.4 0000:02:00.0 0000:04:00.1 0000:00:04.0 0000:00:13.0 0000:00:14.3 0000:00:15.2 0000:00:18.1 0000:00:18.5 0000:02:00.1 0000:05:00.0</code></pre></div><p>Where:</p><div class="codebox"><pre><code>0000: 01: 00. 1 DOMAIN:BUS:DEVICE.FUNCTION</code></pre></div><p>As you are on the localhost, it&#039;s fine to assume that domain is always 0000, so this is optional, and you can specify only BDF combo without the domain.<br /><a href="https://lwn.net/images/pdf/LDD3/ch12.pdf" rel="nofollow">Details.</a> I haven&#039;t observed a large enough system to implement this.</p><div class="quotebox"><cite>mutiny wrote:</cite><blockquote><div><p>Should normal PCI devices be able to be passed through just like PCI-express devices? I have a motherboard with 2 PCI slots behind a PCIe-to-PCI bridge, and am interested in passing through a PCI audio card (non PCIe) to a Windows 8.1 guest. On attempt of booting the guest with the PCI card passed, I get a BSOD with &quot;DRIVER_IRQL_NOT_LESS_OR_EQUAL (vioscsi.sys), and with the card removed from startup command, the guest boots up completely fine with other PCIe devices passed through. Perhaps my setup or command is not sane?</p></div></blockquote></div><p>The main requirement for a device to be passed through is to have a valid IOMMU group. Period.<br />If there&#039;s a device you want in the same group with the devices you want to leave for the host - you&#039;ll have to p-t the whole group with all it&#039;s devices.<br /><strong>OR</strong><br />use old, legacy, deprecated, xen <strong>pci-assign</strong>.<br />It works as vfio for regular PCI devices, and also doesn&#039;t require iommu groups to be valid. In fact, that&#039;s the only way i got my third GPU passed-through.</p><p>The problem you have usually happens when there&#039;s a malfunctioning windows driver. So the device is passed-through fine(check dmesg for errors btw), it&#039;s the drivers(or the windows kernel) who&#039;s glitching. As you can guess by the error message, check virtio-scsi driver(update it maybe?) and also check for the right IRQLs set for the sound card you&#039;ve p-t&#039;d. They really like interrupts.</p><p>I am passing my embedded on the motherboard</p><div class="codebox"><pre><code>00:14.2 Audio device: Advanced Micro Devices, Inc. [AMD] FCH Azalia Controller (rev 01)</code></pre></div><p>via pci-assign and i haven&#039;t observed any problems so far.</p><p>And what&#039;s that &quot;kernel_irqchip=on&quot; you have there? You sure you need it and you know how it works?</p><p>P.S.<br />Does anyone know what the hell is that book i&#039;ve linked under &quot;details&quot;?..</p> <p class="postedit"><em>Last edited by Duelist (2015-07-28 11:44:54)</em></p> </div> <div class="postsignature postmsg"><hr /><p><span class="bbs">The forum rules prohibit requesting support for distributions other than arch.</span><br /><a href="https://bbs.archlinux.org/viewtopic.php?pid=1551460#p1551460" rel="nofollow">I gave up.</a><a href="https://bbs.archlinux.org/viewtopic.php?id=162768" rel="nofollow"> It was too late.</a><br /><a href="http://pastebin.com/B3fL84bq" rel="nofollow">What I was trying to do</a>.<br /><a href="http://vfio.blogspot.com/" rel="nofollow">The reference about VFIO and KVM VGA passthrough.</a></p></div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1548417">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1548446" class="blockpost roweven"> <h2><span><span class="conr">#5754</span> <a href="viewtopic.php?pid=1548446#p1548446">2015-07-28 13:02:24</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=75590">aw</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2013-10-04</span></dd> <dd><span>Posts: 921</span></dd> <dd class="usercontacts"><span class="email"><a href="misc.php?email=75590">Email</a></span> <span class="website"><a href="http://vfio.blogspot.com/" rel="nofollow">Website</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <p>@mutiny</p><p>Conventional PCI devices often don&#039;t support or have broken support for interrupt masking.&#160; You can try using the vfio-pci module option nointxmask=1 to mask it at the APIC rather than the device, but this imposes the requirement that the device uses an exclusive interrupt.&#160; If you find the interrupt shared with other drivers, you&#039;ll need to unbind those conflicting devices from host drivers.&#160; If you have multiple conventional PCI devices behind the same PCIe-to-PCI bridge, the IOMMU cannot distinguish between them and therefore they are necessarily grouped together.&#160; The deprecated pci-assign driver (which has nothing to do with xen) will allow assigning such device separately, but it&#039;s much, much worse than ignoring the lack of isolation between PCIe devices and not recommended imho.</p> </div> <div class="postsignature postmsg"><hr /><p><a href="http://vfio.blogspot.com" rel="nofollow">http://vfio.blogspot.com</a><br />Looking for a more open forum to discuss vfio related uses?&#160; Try <a href="https://www.redhat.com/mailman/listinfo/vfio-users" rel="nofollow">https://www.redhat.com/mailman/listinfo/vfio-users</a></p></div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1548446">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1548461" class="blockpost rowodd"> <h2><span><span class="conr">#5755</span> <a href="viewtopic.php?pid=1548461#p1548461">2015-07-28 14:15:28</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=78620">mostlyharmless</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2014-01-16</span></dd> <dd><span>Posts: 50</span></dd> <dd class="usercontacts"><span class="email"><a href="misc.php?email=78620">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <p>The details book <a href="http://free-electrons.com/doc/books/ldd3.pdf" rel="nofollow">http://free-electrons.com/doc/books/ldd3.pdf</a></p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1548461">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1548525" class="blockpost roweven"> <h2><span><span class="conr">#5756</span> <a href="viewtopic.php?pid=1548525#p1548525">2015-07-28 18:27:15</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=64876">Nazfellun</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd class="postavatar"><img src="https://bbs.archlinux.org/img/avatars/64876.png?m=1352449839" width="80" height="80" alt="" /></dd> <dd><span>Registered: 2012-10-22</span></dd> <dd><span>Posts: 19</span></dd> <dd class="usercontacts"><span class="email"><a href="misc.php?email=64876">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>Nazfellun wrote:</cite><blockquote><div><p>Well, I ended up flashing the updated vbios from gigabyte, which has a valid UEFI rom signature. This worked fine and still runs as normal in my seabios setup on the same system, but I get the same issue as before when trying to install catalyst -- it gets up to installing the driver proper, the system momentarily freezes up and then reboots during installing the actual driver. I do get (low-resolution) output on the physical card up until the VM freezes and reboots.</p><p>I&#039;ve pasted my vm config <a href="http://sprunge.us/aPiB?xml" rel="nofollow">here</a>. Is there anything I might be missing on the host side of the setup for ovmf to work?</p></div></blockquote></div><p>Update: I&#039;ve managed to get OVMF to work for my setup. For some reason, I had to remove a few settings from both my &#039;features&#039; and &#039;clock&#039; elements (see below) to get through driver installation, but I was able to add them back in afterwards with no apparent issues resulting. Not certain specifically which were causing the issue, and currently not too interested in trying more installations to confirm which it was.</p><p>Stuff removed from &lt;features&gt;:</p><div class="codebox"><pre><code> &lt;apic/&gt; &lt;pae/&gt;</code></pre></div><p>Stuff removed from &lt;clock&gt;:</p><div class="codebox"><pre><code> &lt;timer name=&#039;rtc&#039; tickpolicy=&#039;catchup&#039;/&gt; &lt;timer name=&#039;pit&#039; tickpolicy=&#039;delay&#039;/&gt; &lt;timer name=&#039;hpet&#039; present=&#039;no&#039;/&gt;</code></pre></div><p>On another note, I also setup another vm using the same configuration but running Windows 10. This also worked, but there are multiple issues with the graphics there (strange output problems when going fullscreen, performance issues, other stuff). Given it works fine on Windows 8 and the Windows 10 drivers for my card are currently only a preview, it may very well just be a driver issue.</p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1548525">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1548538" class="blockpost rowodd"> <h2><span><span class="conr">#5757</span> <a href="viewtopic.php?pid=1548538#p1548538">2015-07-28 19:33:06</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=85314">Duelist</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2014-09-22</span></dd> <dd><span>Posts: 358</span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>Nazfellun wrote:</cite><blockquote><div><p>Stuff removed from &lt;features&gt;:</p><div class="codebox"><pre><code> &lt;apic/&gt; &lt;pae/&gt;</code></pre></div></div></blockquote></div><p>I bet on PAE. I hardly find a need for it on a x86_<strong>64</strong> system.</p> </div> <div class="postsignature postmsg"><hr /><p><span class="bbs">The forum rules prohibit requesting support for distributions other than arch.</span><br /><a href="https://bbs.archlinux.org/viewtopic.php?pid=1551460#p1551460" rel="nofollow">I gave up.</a><a href="https://bbs.archlinux.org/viewtopic.php?id=162768" rel="nofollow"> It was too late.</a><br /><a href="http://pastebin.com/B3fL84bq" rel="nofollow">What I was trying to do</a>.<br /><a href="http://vfio.blogspot.com/" rel="nofollow">The reference about VFIO and KVM VGA passthrough.</a></p></div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1548538">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1548566" class="blockpost roweven"> <h2><span><span class="conr">#5758</span> <a href="viewtopic.php?pid=1548566#p1548566">2015-07-28 20:50:49</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=64876">Nazfellun</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd class="postavatar"><img src="https://bbs.archlinux.org/img/avatars/64876.png?m=1352449839" width="80" height="80" alt="" /></dd> <dd><span>Registered: 2012-10-22</span></dd> <dd><span>Posts: 19</span></dd> <dd class="usercontacts"><span class="email"><a href="misc.php?email=64876">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>Duelist wrote:</cite><blockquote><div><div class="quotebox"><cite>Nazfellun wrote:</cite><blockquote><div><p>Stuff removed from &lt;features&gt;:</p><div class="codebox"><pre><code> &lt;apic/&gt; &lt;pae/&gt;</code></pre></div></div></blockquote></div><p>I bet on PAE. I hardly find a need for it on a x86_<strong>64</strong> system.</p></div></blockquote></div><p>Probably. It was only there in the first place as libvirt adds it to my new VMs by default.</p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1548566">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1548576" class="blockpost rowodd"> <h2><span><span class="conr">#5759</span> <a href="viewtopic.php?pid=1548576#p1548576">2015-07-28 22:14:50</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=85314">Duelist</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2014-09-22</span></dd> <dd><span>Posts: 358</span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <p>Dumb question of the day:<br />Is there a tool in EDK2 which does the opposite of what EfiRom does? I mean, decompresses the EFI device driver from the ROM? I&#039;ve found only a EFI shell program source.</p> </div> <div class="postsignature postmsg"><hr /><p><span class="bbs">The forum rules prohibit requesting support for distributions other than arch.</span><br /><a href="https://bbs.archlinux.org/viewtopic.php?pid=1551460#p1551460" rel="nofollow">I gave up.</a><a href="https://bbs.archlinux.org/viewtopic.php?id=162768" rel="nofollow"> It was too late.</a><br /><a href="http://pastebin.com/B3fL84bq" rel="nofollow">What I was trying to do</a>.<br /><a href="http://vfio.blogspot.com/" rel="nofollow">The reference about VFIO and KVM VGA passthrough.</a></p></div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1548576">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1548780" class="blockpost roweven"> <h2><span><span class="conr">#5760</span> <a href="viewtopic.php?pid=1548780#p1548780">2015-07-29 15:28:23</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=86302">4kGamer</a></strong></dt> <dd class="usertitle"><strong>Banned</strong></dd> <dd><span>Registered: 2014-10-29</span></dd> <dd><span>Posts: 82</span></dd> <dd class="usercontacts"><span class="email"><a href="mailto:oktayaslantas@gmx.de">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <p>hi, I also have a question: when I use <strong>OpenHardwareMonitor</strong> in my guest Windows 8.1 the <strong>Clocks</strong> section is empty. What can I do? Is that also the case for you guys?</p><p>here is a picture of what it looks like: </p><br /><p><a href="http://i.imgur.com/6rJMV7X.jpg" rel="nofollow">http://i.imgur.com/6rJMV7X.jpg</a></p><p><em>moderator edit [ewaller] Converted image tags for <a href="https://wiki.archlinux.org/index.php/Forum_etiquette#Pasting_pictures_and_code" rel="nofollow">over sized image</a> to url link.</em></p> <p class="postedit"><em>Last edited by ewaller (2015-07-29 15:47:52)</em></p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1548780">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1548842" class="blockpost rowodd"> <h2><span><span class="conr">#5761</span> <a href="viewtopic.php?pid=1548842#p1548842">2015-07-29 19:34:30</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=89552">lersek</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2015-03-15</span></dd> <dd><span>Posts: 34</span></dd> <dd class="usercontacts"><span class="email"><a href="misc.php?email=89552">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>Duelist wrote:</cite><blockquote><div><p>Is there a legitimate way of attaching an ISA debug console to a libvirt domain(VM)? I tried to pass the regular options as qemu:commandline, but it says that there&#039;s no such option...<br />Googling that problem leads me to my own messages about that debug feature.</p></div></blockquote></div><p>I&#039;m sure you did the right thing -- almost. The bit that you probably missed is that the &quot;commandline&quot; and &quot;arg&quot; elements come from a different XML namespace than the rest of the elements in the domain XML. (They are defined by an XML Schema that targets the &quot;<a href="http://libvirt.org/schemas/domain/qemu/1.0" rel="nofollow">http://libvirt.org/schemas/domain/qemu/1.0</a>&quot; namespace -- BTW do not click this link, it&#039;s just a string.)</p><p>Therefore, you have to declare that XML namespace with a namespace prefix, and qualify the &quot;commandline&quot; and &quot;arg&quot; elements with this namespace prefix. This namespace / prefix association can occur in any element that (recursively) contains these elements; or, even, you could just set the default namespace with attributes of the &quot;arg&quot; and &quot;commandline&quot; elements themselves (but that would take a lot more typing). See:</p><p><a href="https://en.wikipedia.org/wiki/XML_namespace#Namespace_declaration" rel="nofollow">https://en.wikipedia.org/wiki/XML_names … eclaration</a></p><p>In practice though, the namespace is usually declared in the root element of the XML document.</p><p>Anyway, enough of the abstract discussion, here&#039;s what you need:</p><div class="codebox"><pre><code>&lt;domain type=&#039;kvm&#039; xmlns:qemu=&#039;http://libvirt.org/schemas/domain/qemu/1.0&#039;&gt; ... stuff ... &lt;qemu:commandline&gt; &lt;qemu:arg value=&#039;-global&#039;/&gt; &lt;qemu:arg value=&#039;isa-debugcon.iobase=0x402&#039;/&gt; &lt;qemu:arg value=&#039;-debugcon&#039;/&gt; &lt;qemu:arg value=&#039;file:/tmp/GUEST_NAME.log&#039;/&gt; &lt;/qemu:commandline&gt; &lt;/domain&gt;</code></pre></div><p>In the above, </p><div class="codebox"><pre><code>qemu</code></pre></div><p> is the <em>namespace prefix</em> being declared, </p><div class="codebox"><pre><code>http://libvirt.org/schemas/domain/qemu/1.0</code></pre></div><p> is the <em>namespace URI</em> being mapped to the </p><div class="codebox"><pre><code>qemu</code></pre></div><p> namespace prefix, and </p><div class="codebox"><pre><code>qemu:commandline</code></pre></div><p> and </p><div class="codebox"><pre><code>qemu:arg</code></pre></div><p> are the elements that you need.</p><p>(The &quot;qemu&quot; prefix is incidental, it could be replaced with any other prefix; the point is that the same prefix must be used in the namespace declaration and later for qualifying &quot;commandline&quot; and &quot;arg&quot;. The &quot;qemu&quot; prefix is just a &quot;mediator&quot;; what matters is that &quot;commandline&quot; and &quot;arg&quot; come from the namespace &quot;<a href="http://libvirt.org/schemas/domain/qemu/1.0" rel="nofollow">http://libvirt.org/schemas/domain/qemu/1.0</a>&quot;.)</p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1548842">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1548843" class="blockpost roweven"> <h2><span><span class="conr">#5762</span> <a href="viewtopic.php?pid=1548843#p1548843">2015-07-29 19:38:14</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=85314">Duelist</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2014-09-22</span></dd> <dd><span>Posts: 358</span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>4kGamer wrote:</cite><blockquote><div><p>hi, I also have a question: when I use <strong>OpenHardwareMonitor</strong> in my guest Windows 8.1 the <strong>Clocks</strong> section is empty. What can I do? Is that also the case for you guys?</p><p>here is a picture of what it looks like: </p><br /><p><a href="http://i.imgur.com/6rJMV7X.jpg" rel="nofollow">http://i.imgur.com/6rJMV7X.jpg</a></p><p><em>moderator edit [ewaller] Converted image tags for <a href="https://wiki.archlinux.org/index.php/Forum_etiquette#Pasting_pictures_and_code" rel="nofollow">over sized image</a> to url link.</em></p></div></blockquote></div><p>It is almost impossible.<br />The data OpenHWMon shows you is from either PCI Config Space of some processor functions(00:18.3 for amd for example) or SMBus.<br />You can&#039;t p-t that processor functions since that&#039;d most likely would break the host system, and you can&#039;t organise an SMBus access for the VM.<br />Moreover, why would you want to provide some low-level access to the hardware? What&#039;s the point of running a VM then?</p><p>If you want to overclock - do it either linux-way or run native windows to get stable settings.</p> </div> <div class="postsignature postmsg"><hr /><p><span class="bbs">The forum rules prohibit requesting support for distributions other than arch.</span><br /><a href="https://bbs.archlinux.org/viewtopic.php?pid=1551460#p1551460" rel="nofollow">I gave up.</a><a href="https://bbs.archlinux.org/viewtopic.php?id=162768" rel="nofollow"> It was too late.</a><br /><a href="http://pastebin.com/B3fL84bq" rel="nofollow">What I was trying to do</a>.<br /><a href="http://vfio.blogspot.com/" rel="nofollow">The reference about VFIO and KVM VGA passthrough.</a></p></div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1548843">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1548857" class="blockpost rowodd"> <h2><span><span class="conr">#5763</span> <a href="viewtopic.php?pid=1548857#p1548857">2015-07-29 20:14:24</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=86302">4kGamer</a></strong></dt> <dd class="usertitle"><strong>Banned</strong></dd> <dd><span>Registered: 2014-10-29</span></dd> <dd><span>Posts: 82</span></dd> <dd class="usercontacts"><span class="email"><a href="mailto:oktayaslantas@gmx.de">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <p>all I want is that my front screen of my Chassis (LEET) shows me the temperature and Mhz of the CPU. For monitoring purposes. Nothing else. I didn&#039;t think it is this complicated. But I have to find a way, this is annoying, because it is the first thing you see when you look at my HTPC case.</p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1548857">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1548858" class="blockpost roweven"> <h2><span><span class="conr">#5764</span> <a href="viewtopic.php?pid=1548858#p1548858">2015-07-29 20:16:04</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=75590">aw</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2013-10-04</span></dd> <dd><span>Posts: 921</span></dd> <dd class="usercontacts"><span class="email"><a href="misc.php?email=75590">Email</a></span> <span class="website"><a href="http://vfio.blogspot.com/" rel="nofollow">Website</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>4kGamer wrote:</cite><blockquote><div><p>all I want is that my front screen of my Chassis (LEET) shows me the temperature and Mhz of the CPU. For monitoring purposes. Nothing else. I didn&#039;t think it is this complicated. But I have to find a way, this is annoying, because it is the first thing you see when you look at my HTPC case.</p></div></blockquote></div><p>This is not a good candidate to be driven from inside the VM.&#160; It&#039;s exceptionally complicated.</p> </div> <div class="postsignature postmsg"><hr /><p><a href="http://vfio.blogspot.com" rel="nofollow">http://vfio.blogspot.com</a><br />Looking for a more open forum to discuss vfio related uses?&#160; Try <a href="https://www.redhat.com/mailman/listinfo/vfio-users" rel="nofollow">https://www.redhat.com/mailman/listinfo/vfio-users</a></p></div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1548858">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1548860" class="blockpost rowodd"> <h2><span><span class="conr">#5765</span> <a href="viewtopic.php?pid=1548860#p1548860">2015-07-29 20:20:31</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=85314">Duelist</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2014-09-22</span></dd> <dd><span>Posts: 358</span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>4kGamer wrote:</cite><blockquote><div><p>all I want is that my front screen of my Chassis (LEET) shows me the temperature and Mhz of the CPU. For monitoring purposes. Nothing else. I didn&#039;t think it is this complicated. But I have to find a way, this is annoying, because it is the first thing you see when you look at my HTPC case.</p></div></blockquote></div><p>Drive it from the host system. Your VM and host system share the same CPU...<br />Oh, you want a device driver for your screen and it isn&#039;t in the kernel yet? <a href="http://free-electrons.com/doc/books/ldd3.pdf" rel="nofollow">Well...</a></p> </div> <div class="postsignature postmsg"><hr /><p><span class="bbs">The forum rules prohibit requesting support for distributions other than arch.</span><br /><a href="https://bbs.archlinux.org/viewtopic.php?pid=1551460#p1551460" rel="nofollow">I gave up.</a><a href="https://bbs.archlinux.org/viewtopic.php?id=162768" rel="nofollow"> It was too late.</a><br /><a href="http://pastebin.com/B3fL84bq" rel="nofollow">What I was trying to do</a>.<br /><a href="http://vfio.blogspot.com/" rel="nofollow">The reference about VFIO and KVM VGA passthrough.</a></p></div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1548860">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1548861" class="blockpost roweven"> <h2><span><span class="conr">#5766</span> <a href="viewtopic.php?pid=1548861#p1548861">2015-07-29 20:23:55</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=86302">4kGamer</a></strong></dt> <dd class="usertitle"><strong>Banned</strong></dd> <dd><span>Registered: 2014-10-29</span></dd> <dd><span>Posts: 82</span></dd> <dd class="usercontacts"><span class="email"><a href="mailto:oktayaslantas@gmx.de">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <p>ok thanks guys for the clarification. I wish there&#039;d be a way. At least I know I can&#039;t do anything about it and that every one of you have the same problem.</p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1548861">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1548862" class="blockpost rowodd"> <h2><span><span class="conr">#5767</span> <a href="viewtopic.php?pid=1548862#p1548862">2015-07-29 20:26:24</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=86302">4kGamer</a></strong></dt> <dd class="usertitle"><strong>Banned</strong></dd> <dd><span>Registered: 2014-10-29</span></dd> <dd><span>Posts: 82</span></dd> <dd class="usercontacts"><span class="email"><a href="mailto:oktayaslantas@gmx.de">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>Duelist wrote:</cite><blockquote><div><div class="quotebox"><cite>4kGamer wrote:</cite><blockquote><div><p>all I want is that my front screen of my Chassis (LEET) shows me the temperature and Mhz of the CPU. For monitoring purposes. Nothing else. I didn&#039;t think it is this complicated. But I have to find a way, this is annoying, because it is the first thing you see when you look at my HTPC case.</p></div></blockquote></div><p>Drive it from the host system. Your VM and host system share the same CPU...<br />Oh, you want a device driver for your screen and it isn&#039;t in the kernel yet? <a href="http://free-electrons.com/doc/books/ldd3.pdf" rel="nofollow">Well...</a></p></div></blockquote></div><p>How can I do it from the host system???</p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1548862">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1548874" class="blockpost roweven"> <h2><span><span class="conr">#5768</span> <a href="viewtopic.php?pid=1548874#p1548874">2015-07-29 21:13:31</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=85314">Duelist</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2014-09-22</span></dd> <dd><span>Posts: 358</span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>4kGamer wrote:</cite><blockquote><div><div class="quotebox"><cite>Duelist wrote:</cite><blockquote><div><div class="quotebox"><cite>4kGamer wrote:</cite><blockquote><div><p>all I want is that my front screen of my Chassis (LEET) shows me the temperature and Mhz of the CPU. For monitoring purposes. Nothing else. I didn&#039;t think it is this complicated. But I have to find a way, this is annoying, because it is the first thing you see when you look at my HTPC case.</p></div></blockquote></div><p>Drive it from the host system. Your VM and host system share the same CPU...<br />Oh, you want a device driver for your screen and it isn&#039;t in the kernel yet? <a href="http://free-electrons.com/doc/books/ldd3.pdf" rel="nofollow">Well...</a></p></div></blockquote></div><p>How can I do it from the host system???</p></div></blockquote></div><p>Depends on the display.<br />Even though it&#039;s beyond the scope of this thread, i&#039;ll try to help:<br />How does it work under windows? Is the screen plugged into USB?&#160; Or maybe it&#039;s some other connection?<br />How does it look like? Can you link some photos maybe?</p><p>UPD:<br /><a href="http://ishankarve.blogspot.com/2010/10/configuring-soundgraph-fingervu-706-on.html" rel="nofollow">http://ishankarve.blogspot.com/2010/10/ … 06-on.html</a><br />Futher googling shows that it is possible and should be rather simple. Have fun.</p> <p class="postedit"><em>Last edited by Duelist (2015-07-29 21:19:43)</em></p> </div> <div class="postsignature postmsg"><hr /><p><span class="bbs">The forum rules prohibit requesting support for distributions other than arch.</span><br /><a href="https://bbs.archlinux.org/viewtopic.php?pid=1551460#p1551460" rel="nofollow">I gave up.</a><a href="https://bbs.archlinux.org/viewtopic.php?id=162768" rel="nofollow"> It was too late.</a><br /><a href="http://pastebin.com/B3fL84bq" rel="nofollow">What I was trying to do</a>.<br /><a href="http://vfio.blogspot.com/" rel="nofollow">The reference about VFIO and KVM VGA passthrough.</a></p></div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1548874">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1548878" class="blockpost rowodd"> <h2><span><span class="conr">#5769</span> <a href="viewtopic.php?pid=1548878#p1548878">2015-07-29 21:24:05</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=75590">aw</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2013-10-04</span></dd> <dd><span>Posts: 921</span></dd> <dd class="usercontacts"><span class="email"><a href="misc.php?email=75590">Email</a></span> <span class="website"><a href="http://vfio.blogspot.com/" rel="nofollow">Website</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <p>It seems like it&#039;s just a USB screen, but detaching it from the VM, which I assume is running HTPC software, would remove some functionality.&#160; I&#039;d probably go the route of a plugin for the software that can monitor a remote system and a daemon in the host that provides data.&#160; Anyway, this is all totally unrelated to this thread and should be moved elsewhere.</p> </div> <div class="postsignature postmsg"><hr /><p><a href="http://vfio.blogspot.com" rel="nofollow">http://vfio.blogspot.com</a><br />Looking for a more open forum to discuss vfio related uses?&#160; Try <a href="https://www.redhat.com/mailman/listinfo/vfio-users" rel="nofollow">https://www.redhat.com/mailman/listinfo/vfio-users</a></p></div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1548878">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1549035" class="blockpost roweven"> <h2><span><span class="conr">#5770</span> <a href="viewtopic.php?pid=1549035#p1549035">2015-07-30 15:19:02</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=86302">4kGamer</a></strong></dt> <dd class="usertitle"><strong>Banned</strong></dd> <dd><span>Registered: 2014-10-29</span></dd> <dd><span>Posts: 82</span></dd> <dd class="usercontacts"><span class="email"><a href="mailto:oktayaslantas@gmx.de">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <p>yes, it is connected through internal usb. I will open up a new thread, just here a picture of what it currently looks like:<br /><a href="http://i.imgur.com/tRdqxAT.jpg" rel="nofollow">http://i.imgur.com/tRdqxAT.jpg</a></p><p>and this is how it should look: <a href="http://www.steigerdynamics.com/products-leet-chassis-engineering" rel="nofollow">http://www.steigerdynamics.com/products … ngineering</a></p><p>I will try the linked tutorial, but I can see myself failing at it. </p><p>thanks anyways!</p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1549035">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1549083" class="blockpost rowodd"> <h2><span><span class="conr">#5771</span> <a href="viewtopic.php?pid=1549083#p1549083">2015-07-30 18:54:43</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=92900">fabrizziop</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2015-07-30</span></dd> <dd><span>Posts: 1</span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <p>I have an FX-8350 + GA990FXA-UD3, with 270x as passthrough GPU and 5770 as linux GPU. I want to upgrade my 270x to something faster. Does the r9 290/390 or the r9 285/380 work correctly, without reset issues?. Thanks.</p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1549083">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1549112" class="blockpost roweven"> <h2><span><span class="conr">#5772</span> <a href="viewtopic.php?pid=1549112#p1549112">2015-07-30 20:42:19</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=92904">Kartoffel</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2015-07-30</span></dd> <dd><span>Posts: 3</span></dd> <dd class="usercontacts"><span class="email"><a href="mailto:johncarmack@openmailbox.org">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <p>Hi, I have a question regarding audio in QEMU.</p><p>When I run my script while I&#039;m using KDE5 I get no audio issues. </p><div class="codebox"><pre><code>sudo QEMU_AUDIO_DRV=alsa QEMU_ALSA_DAC_BUFFER_SIZE=512 QEMU_ALSA_DAC_PERIOD_SIZE=170 qemu-system-x86_64 -enable-kvm -m 8G -cpu host,kvm=off \ -nographic \ -smp 4,sockets=1,cores=4,threads=1 \ -mem-path /dev/hugepages \ -device vfio-pci,host=01:00.0,x-vga=on -device vfio-pci,host=01:00.1 \ -vga none \ -soundhw hda \ -device virtio-scsi-pci,id=scsi \ -drive file=/dev/sdb,id=disk,format=raw,if=none -device scsi-hd,drive=disk \ -net nic -net bridge,br=br0 \ -device vfio-pci,host=00:1d.0</code></pre></div><p>When I run it while using a window manager such as awesome I get this error and subsequently a lot of crackling in Windows 7 x64:</p><div class="codebox"><pre><code>ALSA lib pcm_dmix.c:1024:(snd_pcm_dmix_open) unable to open slave alsa: Could not initialize DAC alsa: Failed to open `default&#039;: alsa: Reason: Device or resource busy ALSA lib pcm_dmix.c:1024:(snd_pcm_dmix_open) unable to open slave alsa: Could not initialize DACalsa: Failed to open `default&#039;: alsa: Reason: Device or resource busy audio: Failed to create voice `dac&#039;</code></pre></div><p>What could be the cause of this?<br />Any help is greatly appreciated.</p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1549112">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1549135" class="blockpost rowodd"> <h2><span><span class="conr">#5773</span> <a href="viewtopic.php?pid=1549135#p1549135">2015-07-30 21:49:48</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=85314">Duelist</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2014-09-22</span></dd> <dd><span>Posts: 358</span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>Kartoffel wrote:</cite><blockquote><div><p>Hi, I have a question regarding audio in QEMU.</p><p>When I run my script while I&#039;m using KDE5 I get no audio issues. </p><div class="codebox"><pre><code>sudo QEMU_AUDIO_DRV=alsa QEMU_ALSA_DAC_BUFFER_SIZE=512 QEMU_ALSA_DAC_PERIOD_SIZE=170 qemu-system-x86_64 -enable-kvm -m 8G -cpu ...snip..</code></pre></div><p>..cut..<br />What could be the cause of this?<br />Any help is greatly appreciated.</p></div></blockquote></div><p>The lack of pulse audio, maybe?(AFAIR, it works on top of alsa) Or a different user running alsa?</p><div class="quotebox"><cite>fabrizziop wrote:</cite><blockquote><div><p>I have an FX-8350 + GA990FXA-UD3, with 270x as passthrough GPU and 5770 as linux GPU. I want to upgrade my 270x to something faster. Does the r9 290/390 or the r9 285/380 work correctly, without reset issues?. Thanks.</p></div></blockquote></div><p><a href="https://docs.google.com/spreadsheets/d/1LnGpTrXalwGVNy0PWJDURhyxa3sgqkGXmvNCIvIMenk/edit#gid=0" rel="nofollow">The list.</a></p><p>AFAIR:<br />1. Nobody tested AMD 3XX-series GPUs yet.<br />2. The reset issues were resolved by some kernel patch, which went upstream some months ago.</p><p>I&#039;d go with the 390 or 380 or whatever which has HBM. The first serious technology advancement since GCN.</p> </div> <div class="postsignature postmsg"><hr /><p><span class="bbs">The forum rules prohibit requesting support for distributions other than arch.</span><br /><a href="https://bbs.archlinux.org/viewtopic.php?pid=1551460#p1551460" rel="nofollow">I gave up.</a><a href="https://bbs.archlinux.org/viewtopic.php?id=162768" rel="nofollow"> It was too late.</a><br /><a href="http://pastebin.com/B3fL84bq" rel="nofollow">What I was trying to do</a>.<br /><a href="http://vfio.blogspot.com/" rel="nofollow">The reference about VFIO and KVM VGA passthrough.</a></p></div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1549135">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1549147" class="blockpost roweven"> <h2><span><span class="conr">#5774</span> <a href="viewtopic.php?pid=1549147#p1549147">2015-07-30 22:46:50</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=92904">Kartoffel</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2015-07-30</span></dd> <dd><span>Posts: 3</span></dd> <dd class="usercontacts"><span class="email"><a href="mailto:johncarmack@openmailbox.org">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>Duelist wrote:</cite><blockquote><div><p>The lack of pulse audio, maybe?(AFAIR, it works on top of alsa) Or a different user running alsa?</p></div></blockquote></div><p>Thanks for your help.<br />Running pulseaudio within awesome no longer displays the previous error, but now there&#039;s a new one.</p><div class="codebox"><pre><code>alsa: Requested buffer size 512 was rejected, using 1881 alsa: Requested period size 170 was rejected, using 940</code></pre></div><p>Again, this is something that does not happen within KDE5.<br />Thanks again.</p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1549147">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1549187" class="blockpost rowodd"> <h2><span><span class="conr">#5775</span> <a href="viewtopic.php?pid=1549187#p1549187">2015-07-31 01:03:42</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=85314">Duelist</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2014-09-22</span></dd> <dd><span>Posts: 358</span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>Kartoffel wrote:</cite><blockquote><div><div class="quotebox"><cite>Duelist wrote:</cite><blockquote><div><p>The lack of pulse audio, maybe?(AFAIR, it works on top of alsa) Or a different user running alsa?</p></div></blockquote></div><p>Thanks for your help.<br />Running pulseaudio within awesome no longer displays the previous error, but now there&#039;s a new one.</p><div class="codebox"><pre><code>alsa: Requested buffer size 512 was rejected, using 1881 alsa: Requested period size 170 was rejected, using 940</code></pre></div><p>Again, this is something that does not happen within KDE5.<br />Thanks again.</p></div></blockquote></div><p>Does it work that way? If so - ignore that lines. You can get rid of those lines by deleting</p><div class="codebox"><pre><code>QEMU_ALSA_DAC_BUFFER_SIZE=512 QEMU_ALSA_DAC_PERIOD_SIZE=170</code></pre></div><p>And if you don&#039;t care much about using pulse audio or not - you can and should adapt QEMU to use it:</p><div class="codebox"><pre><code>QEMU_PA_SAMPLES=128 QEMU_AUDIO_DRV=pa</code></pre></div><br /><p>P.S.<br />I feel sad about advising people to use pulse audio, it&#039;s too complex and over-abstract for me and my uses.</p> <p class="postedit"><em>Last edited by Duelist (2015-07-31 01:03:59)</em></p> </div> <div class="postsignature postmsg"><hr /><p><span class="bbs">The forum rules prohibit requesting support for distributions other than arch.</span><br /><a href="https://bbs.archlinux.org/viewtopic.php?pid=1551460#p1551460" rel="nofollow">I gave up.</a><a href="https://bbs.archlinux.org/viewtopic.php?id=162768" rel="nofollow"> It was too late.</a><br /><a href="http://pastebin.com/B3fL84bq" rel="nofollow">What I was trying to do</a>.<br /><a href="http://vfio.blogspot.com/" rel="nofollow">The reference about VFIO and KVM VGA passthrough.</a></p></div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1549187">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div class="postlinksb"> <div class="inbox crumbsplus"> <div class="pagepost"> <p class="pagelink conl"><span class="pages-label">Pages: </span><a rel="prev" class="item1" href="viewtopic.php?id=162768&amp;p=230">Previous</a> <a href="viewtopic.php?id=162768">1</a> <span class="spacer">…</span> <a href="viewtopic.php?id=162768&amp;p=229">229</a> <a href="viewtopic.php?id=162768&amp;p=230">230</a> <strong>231</strong> <a href="viewtopic.php?id=162768&amp;p=232">232</a> <a href="viewtopic.php?id=162768&amp;p=233">233</a> <a href="viewtopic.php?id=162768&amp;p=234">234</a> <a rel="next" href="viewtopic.php?id=162768&amp;p=232">Next</a></p> <p class="postlink conr">Topic closed</p> </div> <ul class="crumbs"> <li><a href="index.php">Index</a></li> <li><span>»&#160;</span><a href="viewforum.php?id=48">Topics Going Nowhere</a></li> <li><span>»&#160;</span><strong><a href="viewtopic.php?id=162768">KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</a></strong></li> </ul> <p class="subscribelink clearb"><a href="misc.php?action=subscribe&amp;tid=162768">Subscribe to this topic</a></p> <div class="clearer"></div> </div> </div> </div> <div id="brdfooter" class="block"> <h2><span>Board footer</span></h2> <div class="box"> <div id="brdfooternav" class="inbox"> <div class="conl"> <form id="qjump" method="get" action="viewforum.php"> <div><label><span>Jump to<br /></span> <select name="id" onchange="window.location=('viewforum.php?id='+this.options[this.selectedIndex].value)"> <optgroup label="Technical Issues and Assistance"> <option value="23">Newbie Corner</option> <option value="17">Installation</option> <option value="22">Kernel &amp; Hardware</option> <option value="18">Applications &amp; Desktop Environments</option> <option value="31">Laptop Issues</option> <option value="8">Networking, Server, and Protection</option> <option value="32">Multimedia and Games</option> <option value="50">System Administration</option> <option value="35">Other Architectures</option> </optgroup> <optgroup label="Arch-centric"> <option value="24">Announcements, Package &amp; Security Advisories</option> <option value="1">Arch Discussion</option> <option value="13">Forum &amp; Wiki discussion</option> </optgroup> <optgroup label="Pacman Upgrades, Packaging &amp; AUR"> <option value="44">Pacman &amp; Package Upgrade Issues</option> <option value="49">[testing] Repo Forum</option> <option value="4">Creating &amp; Modifying Packages</option> <option value="38">AUR Issues, Discussion &amp; PKGBUILD Requests</option> </optgroup> <optgroup label="Contributions &amp; Discussion"> <option value="20">GNU/Linux Discussion</option> <option value="27">Community Contributions</option> <option value="33">Programming &amp; Scripting</option> <option value="30">Other Languages</option> <option value="47">Artwork and Screenshots</option> <option value="42">Try This</option> </optgroup> <optgroup label="/dev/null"> <option value="29">Off-Topic</option> <option value="48" selected="selected">Topics Going Nowhere</option> <option value="36">Dustbin</option> </optgroup> </select></label> <input type="submit" value=" Go " accesskey="g" /> </div> </form> </div> <div class="conr"> <p id="feedlinks"><span class="atom"><a href="extern.php?action=feed&amp;tid=162768&amp;type=atom">Atom topic feed</a></span></p> <p id="poweredby">Powered by <a href="http://fluxbb.org/">FluxBB</a></p> </div> <div class="clearer"></div> </div> </div> </div> </div> <div class="end-box"></div> </div> </body> </html>
