<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"> <html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en" dir="ltr"> <head> <meta http-equiv="Content-Type" content="text/html; charset=utf-8" /> <title>KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9 (Page 40) / Topics Going Nowhere / Arch Linux Forums</title> <link rel="stylesheet" type="text/css" href="style/ArchLinux.css" /> <link rel="canonical" href="viewtopic.php?id=162768&amp;p=40" title="Page 40" /> <link rel="prev" href="viewtopic.php?id=162768&amp;p=39" title="Page 39" /> <link rel="next" href="viewtopic.php?id=162768&amp;p=41" title="Page 41" /> <link rel="alternate" type="application/atom+xml" href="extern.php?action=feed&amp;tid=162768&amp;type=atom" title="Atom topic feed" /> <link rel="stylesheet" media="screen" href="style/ArchLinux/arch.css?v=3" /> <link rel="stylesheet" media="screen" href="style/ArchLinux/archnavbar.css?v=2" /> <link rel="shortcut icon" href="style/ArchLinux/favicon.ico" /> </head> <body> <div id="archnavbar" class="anb-forum"> <div id="archnavbarlogo"><h1><a href="http://www.archlinux.org/">Arch Linux</a></h1></div> <div id="archnavbarmenu"> <ul id="archnavbarlist"> <li id="anb-home"><a href="http://www.archlinux.org/">Home</a></li><li id="anb-packages"><a href="http://www.archlinux.org/packages/">Packages</a></li><li id="anb-forums" class="anb-selected"><a href="https://bbs.archlinux.org/">Forums</a></li><li id="anb-wiki"><a href="https://wiki.archlinux.org/">Wiki</a></li><li id="anb-bugs"><a href="https://bugs.archlinux.org/">Bugs</a></li><li id="anb-aur"><a href="https://aur.archlinux.org/">AUR</a></li><li id="anb-download"><a href="http://www.archlinux.org/download/">Download</a></li> </ul> </div> </div> <div id="punviewtopic" class="pun"> <div class="top-box"></div> <div class="punwrap"> <div id="brdheader" class="block"> <div class="box"> <div id="brdmenu" class="inbox"> <ul> <li id="navindex" class="isactive"><a href="index.php">Index</a></li> <li id="navuserlist"><a href="userlist.php">User list</a></li> <li id="navsearch"><a href="search.php">Search</a></li> <li id="navprofile"><a href="profile.php?id=80749">Profile</a></li> <li id="navlogout"><a href="login.php?action=out&amp;id=80749&amp;csrf_token=5c20501ec397bb45ef8ee8c84db232c8d8e421c6">Logout</a></li> </ul> </div> <div id="brdwelcome" class="inbox"> <ul class="conl"> <li><span>Logged in as <strong>SXX</strong></span></li> <li><span>Last visit: 2015-08-16 12:20:09</span></li> </ul> <ul class="conr"> <li><span>Topics: <a href="search.php?action=show_replies" title="Find topics you have posted to.">Posted</a> | <a href="search.php?action=show_new" title="Find topics with new posts since your last visit.">New</a> | <a href="search.php?action=show_recent" title="Find topics with recent posts.">Active</a> | <a href="search.php?action=show_unanswered" title="Find topics with no replies.">Unanswered</a></span></li> </ul> <div class="clearer"></div> </div> </div> </div> <div id="brdmain"> <div class="linkst"> <div class="inbox crumbsplus"> <ul class="crumbs"> <li><a href="index.php">Index</a></li> <li><span>»&#160;</span><a href="viewforum.php?id=48">Topics Going Nowhere</a></li> <li><span>»&#160;</span><strong><a href="viewtopic.php?id=162768">KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</a></strong></li> </ul> <div class="pagepost"> <p class="pagelink conl"><span class="pages-label">Pages: </span><a rel="prev" class="item1" href="viewtopic.php?id=162768&amp;p=39">Previous</a> <a href="viewtopic.php?id=162768">1</a> <span class="spacer">…</span> <a href="viewtopic.php?id=162768&amp;p=38">38</a> <a href="viewtopic.php?id=162768&amp;p=39">39</a> <strong>40</strong> <a href="viewtopic.php?id=162768&amp;p=41">41</a> <a href="viewtopic.php?id=162768&amp;p=42">42</a> <span class="spacer">…</span> <a href="viewtopic.php?id=162768&amp;p=234">234</a> <a rel="next" href="viewtopic.php?id=162768&amp;p=41">Next</a></p> <p class="postlink conr">Topic closed</p> </div> <div class="clearer"></div> </div> </div> <div id="p1367487" class="blockpost rowodd blockpost1"> <h2><span><span class="conr">#976</span> <a href="viewtopic.php?pid=1367487#p1367487">2014-01-05 14:27:32</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=75590">aw</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2013-10-04</span></dd> <dd><span>Posts: 921</span></dd> <dd class="usercontacts"><span class="email"><a href="misc.php?email=75590">Email</a></span> <span class="website"><a href="http://vfio.blogspot.com/" rel="nofollow">Website</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>DanaGoyette wrote:</cite><blockquote><div><div class="quotebox"><cite>Val532 wrote:</cite><blockquote><div><p>I can&#039;t use the Intel Sata with vfio because of ACS, ACS patch does not work for Intel Sata [00:1f.2]...</p></div></blockquote></div><p>If you haven&#039;t already done so, try passing through the other devices in that group, such as:<br />&#160; &#160; 00:1f.0 ISA bridge [0601]: Intel Corporation C226 Series Chipset Family Server Advanced SKU LPC Controller [8086:8c56] (rev 05)<br />&#160; &#160; 00:1f.2 SATA controller [0106]: Intel Corporation 8 Series/C220 Series Chipset Family 6-port SATA Controller 1 [AHCI mode] [8086:8c02] (rev 05)<br />&#160; &#160; 00:1f.3 SMBus [0c05]: Intel Corporation 8 Series/C220 Series Chipset Family SMBus Controller [8086:8c22] (rev 05)<br />&#160; &#160; 00:1f.6 Signal processing controller [1180]: Intel Corporation 8 Series Chipset Family Thermal Management Controller [8086:8c24] (rev 05)</p></div></blockquote></div><p>Does it really seem like a good idea to pass these other devices through to a guest?&#160; I hope not.</p><div class="quotebox"><blockquote><div><p>Alternately, these devices should be overridable via &#039;multifunction&#039;, or better, via device ID (in my case, it&#039;s id:8086:8c02).</p><br /><div class="quotebox"><cite>sbd wrote:</cite><blockquote><div><p>Probably because you have the Cirrus VGA card as the primary. That&#039;s being treated as the primary monitor, so all the desktop content is showing up there and not on the Radeon.</p></div></blockquote></div><p>I actually used Narrator to get the virtual machine&#039;s desktop to appear only on the ATI card, and not at all on the Cirrus.&#160; The ATI desktop was alive and &quot;functional&quot;, but totally black.</p><p>I&#039;ve rebuilt Qemu from git, and now it seems to be defaulting to pci-assign instead of VFIO.&#160; This works fine, aside from needing the &quot;eject&quot; workaround (which kicks the GPU into high-speed-fan mode).<br />In fact, now I&#039;m thinking this may have something to do with that black desktop -- perhaps the black desktop is a result of NOT ejecting.<br />Time for more experimenting...</p><p>EDIT: <br />Okay, I tried switching back to vfio.&#160; No dice:<br />genirq: Flags mismatch irq 16. 00000000 (vfio-intx(0000:01:00.0)) vs. 00000080 (ehci_hcd:usb1)</p><p>Adding the EHCI controller (#2, oddly enough, not #1 as &#039;usb1&#039; would seem to imply), seems to perhaps fix this.</p><p>If I add my sound card to the mix:<br />genirq: Flags mismatch irq 17. 00000000 (vfio-intx(0000:07:04.0)) vs. 00000000 (vfio-intx(0000:01:00.1))</p><p>How the heck is &#039;00000000&#039; a mismatch with &#039;00000000&#039;?</p></div></blockquote></div><p>Because neither of them include IRQF_SHARED and therefore require exclusive access to the interrupt line.&#160; This means that neither devices supports PCI2.3 INTx disable.&#160; You can generally fix this, but lose access to the conflicting device, by detaching the device from the host driver.</p> <p class="postedit"><em>Last edited by aw (2014-01-05 15:29:05)</em></p> </div> <div class="postsignature postmsg"><hr /><p><a href="http://vfio.blogspot.com" rel="nofollow">http://vfio.blogspot.com</a><br />Looking for a more open forum to discuss vfio related uses?&#160; Try <a href="https://www.redhat.com/mailman/listinfo/vfio-users" rel="nofollow">https://www.redhat.com/mailman/listinfo/vfio-users</a></p></div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1367487">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1367488" class="blockpost roweven"> <h2><span><span class="conr">#977</span> <a href="viewtopic.php?pid=1367488#p1367488">2014-01-05 14:30:19</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=75590">aw</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2013-10-04</span></dd> <dd><span>Posts: 921</span></dd> <dd class="usercontacts"><span class="email"><a href="misc.php?email=75590">Email</a></span> <span class="website"><a href="http://vfio.blogspot.com/" rel="nofollow">Website</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>cataphract wrote:</cite><blockquote><div><p>I tried this with Linux 3.12.6-1-ARCH, qemu 1.7.0-1 and seabios 1.7.3.1-2 without success.</p></div></blockquote></div><p>That&#039;s not very surprising if your kernel doesn&#039;t include the i915 fixes and neither kernel nor qemu include the coherency fixes included by the kvm-vfio device.</p> </div> <div class="postsignature postmsg"><hr /><p><a href="http://vfio.blogspot.com" rel="nofollow">http://vfio.blogspot.com</a><br />Looking for a more open forum to discuss vfio related uses?&#160; Try <a href="https://www.redhat.com/mailman/listinfo/vfio-users" rel="nofollow">https://www.redhat.com/mailman/listinfo/vfio-users</a></p></div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1367488">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1367495" class="blockpost rowodd"> <h2><span><span class="conr">#978</span> <a href="viewtopic.php?pid=1367495#p1367495">2014-01-05 14:41:22</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=75590">aw</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2013-10-04</span></dd> <dd><span>Posts: 921</span></dd> <dd class="usercontacts"><span class="email"><a href="misc.php?email=75590">Email</a></span> <span class="website"><a href="http://vfio.blogspot.com/" rel="nofollow">Website</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>Val532 wrote:</cite><blockquote><div><p>Hi all,</p><p>I have some new information and I do not know who to share.</p><p>The probleme i found for pci passthougr of sata AsMedia 1062 : </p><div class="codebox"><pre><code>[ 404.206866] dmar: DRHD: handling fault status reg 2 [ 404.206870] dmar: DMAR:[DMA Write] Request device [07:00.0] fault addr 2affdf000 [ 404.206870] DMAR:[fault reason 05] PTE Write access is not set [ 404.206877] dmar: DRHD: handling fault status reg 2 [ 404.206879] dmar: DMAR:[DMA Read] Request device [07:00.0] fault addr 2affda000 [ 404.206879] DMAR:[fault reason 06] PTE Read access is not set</code></pre></div><p>Is the same for Intel Z87 sata.</p><p>I can&#039;t use the Intel Sata with vfio because of ACS, ACS patch does not work for Intel Sata [00:1f.2] and when i use with pci_stub it&#039;s work only one time, when the VM reboot i have this error :</p><div class="codebox"><pre><code>[ 1801.280862] dmar: DRHD: handling fault status reg 2 [ 1801.280866] dmar: DMAR:[DMA Read] Request device [00:1f.2] fault addr 2affdd000 [ 1801.280866] DMAR:[fault reason 06] PTE Read access is not set</code></pre></div><p>Where i can report this error in the hope of any boby correct this ?</p><p>Thanks.</p></div></blockquote></div><p>You can run &#039;info mtree&#039; from the qemu monitor to check whether those fault addresses are actually something that should be mapped to the device.&#160; There&#039;s a reasonable chance that the device just does a stray DMA access, in which case it&#039;s broken.&#160; If it only works once and the device does not support a standard reset then it needs a device-specific reset.&#160; You might be able to figure out how to do that by looking through the datasheet for the device.&#160; There&#039;s no guarantee that such a mechanism exists though.&#160; The other question is whether it&#039;s really worthwhile to assign the SATA device.&#160; I&#039;d guess that you&#039;re not going to get a massive performance increase by assigning it versus using virtio-block with a raw partition, disk or lvm volume.</p> </div> <div class="postsignature postmsg"><hr /><p><a href="http://vfio.blogspot.com" rel="nofollow">http://vfio.blogspot.com</a><br />Looking for a more open forum to discuss vfio related uses?&#160; Try <a href="https://www.redhat.com/mailman/listinfo/vfio-users" rel="nofollow">https://www.redhat.com/mailman/listinfo/vfio-users</a></p></div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1367495">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1367497" class="blockpost roweven"> <h2><span><span class="conr">#979</span> <a href="viewtopic.php?pid=1367497#p1367497">2014-01-05 14:47:53</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=75590">aw</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2013-10-04</span></dd> <dd><span>Posts: 921</span></dd> <dd class="usercontacts"><span class="email"><a href="misc.php?email=75590">Email</a></span> <span class="website"><a href="http://vfio.blogspot.com/" rel="nofollow">Website</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>BulliteShot wrote:</cite><blockquote><div><p>Has anyone got any working packages for pci-stub only? q35 performance is pretty poor for memory demanding games.</p></div></blockquote></div><p>pci-stub is a kernel module that does nothing but sit on a device to prevent other drivers from claiming it.&#160; q35 is a qemu chipset model.&#160; I think you&#039;re asking if anyone has this working with the qemu 440fx chipset model, which can still use vfio-pci.&#160; It&#039;s possible, try it an see.&#160; q35 is more similar in architecture to today&#039;s PCs, so it&#039;s more like how drivers expect to see the hardware.</p> </div> <div class="postsignature postmsg"><hr /><p><a href="http://vfio.blogspot.com" rel="nofollow">http://vfio.blogspot.com</a><br />Looking for a more open forum to discuss vfio related uses?&#160; Try <a href="https://www.redhat.com/mailman/listinfo/vfio-users" rel="nofollow">https://www.redhat.com/mailman/listinfo/vfio-users</a></p></div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1367497">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1367499" class="blockpost rowodd"> <h2><span><span class="conr">#980</span> <a href="viewtopic.php?pid=1367499#p1367499">2014-01-05 14:56:08</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=75590">aw</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2013-10-04</span></dd> <dd><span>Posts: 921</span></dd> <dd class="usercontacts"><span class="email"><a href="misc.php?email=75590">Email</a></span> <span class="website"><a href="http://vfio.blogspot.com/" rel="nofollow">Website</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>Flyser wrote:</cite><blockquote><div><p>Now I can fine-tune my setup. Have you found a good solution to save power while the VM is shut down or not in use? I am running this on my 24/7 home server and having the nvidia card running without any power management permanently consumes about 20 Watts, which amounts to over 50€ electricity cost per year in my country.</p></div></blockquote></div><p>We could think about making vfio-pci put devices into the D3 power state when not opened by a userspace driver like qemu, but I worry that it might cause more problems than it solves and there&#039;s also a good chance that it won&#039;t make a desktop graphics card consume any less power.&#160; You can use setpci to experiment whether D3 actually saves you any power.</p> </div> <div class="postsignature postmsg"><hr /><p><a href="http://vfio.blogspot.com" rel="nofollow">http://vfio.blogspot.com</a><br />Looking for a more open forum to discuss vfio related uses?&#160; Try <a href="https://www.redhat.com/mailman/listinfo/vfio-users" rel="nofollow">https://www.redhat.com/mailman/listinfo/vfio-users</a></p></div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1367499">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1367502" class="blockpost roweven"> <h2><span><span class="conr">#981</span> <a href="viewtopic.php?pid=1367502#p1367502">2014-01-05 15:03:41</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=75590">aw</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2013-10-04</span></dd> <dd><span>Posts: 921</span></dd> <dd class="usercontacts"><span class="email"><a href="misc.php?email=75590">Email</a></span> <span class="website"><a href="http://vfio.blogspot.com/" rel="nofollow">Website</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>syllopsium wrote:</cite><blockquote><div><p>The motherboard has a built in Matrox G200e, I&#039;m hoping to pass this through to a different VM as it&#039;s a horribly slow chip. It appears in the same iommu group as the southbridge x4 PCIe slot (the only slot where a graphics card won&#039;t be slowed down to x1 speed by the 3210 chipset on this motherboard). This is why I&#039;ve applied the ACS patch.</p></div></blockquote></div><p>FWIW, nvidia/amd require several quirks in qemu to make things work.&#160; Nobody has done these for matrox and I don&#039;t have anything with matrox graphics.&#160; Besides that, what&#039;s the point of attaching a matrox card to a guest?&#160; It seems like the headache of assigning it is not worth the incremental improvement versus emulated graphics.&#160; Assignment makes sense for high end GPUs, but I&#039;m not sure I&#039;m interested in maintaining code for assigning random 2d-only VGA devices.</p> </div> <div class="postsignature postmsg"><hr /><p><a href="http://vfio.blogspot.com" rel="nofollow">http://vfio.blogspot.com</a><br />Looking for a more open forum to discuss vfio related uses?&#160; Try <a href="https://www.redhat.com/mailman/listinfo/vfio-users" rel="nofollow">https://www.redhat.com/mailman/listinfo/vfio-users</a></p></div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1367502">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1367506" class="blockpost rowodd"> <h2><span><span class="conr">#982</span> <a href="viewtopic.php?pid=1367506#p1367506">2014-01-05 15:05:58</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=75590">aw</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2013-10-04</span></dd> <dd><span>Posts: 921</span></dd> <dd class="usercontacts"><span class="email"><a href="misc.php?email=75590">Email</a></span> <span class="website"><a href="http://vfio.blogspot.com/" rel="nofollow">Website</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>pascal257 wrote:</cite><blockquote><div><p>Edit: And another question: I&#039;d like to run a media center through the integrated graphics. Is that feasible? Can I pci-stub the integrated graphics from Arch and run it to a VM or are there any known problems?</p></div></blockquote></div><p>There are numerous problem with assigning IGD.&#160; Please don&#039;t try it unless you plan to contribute to development.</p> </div> <div class="postsignature postmsg"><hr /><p><a href="http://vfio.blogspot.com" rel="nofollow">http://vfio.blogspot.com</a><br />Looking for a more open forum to discuss vfio related uses?&#160; Try <a href="https://www.redhat.com/mailman/listinfo/vfio-users" rel="nofollow">https://www.redhat.com/mailman/listinfo/vfio-users</a></p></div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1367506">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1367574" class="blockpost roweven"> <h2><span><span class="conr">#983</span> <a href="viewtopic.php?pid=1367574#p1367574">2014-01-05 17:52:43</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=73864">cataphract</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2013-08-06</span></dd> <dd><span>Posts: 13</span></dd> <dd class="usercontacts"><span class="email"><a href="misc.php?email=73864">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>aw wrote:</cite><blockquote><div><div class="quotebox"><cite>cataphract wrote:</cite><blockquote><div><p>I tried this with Linux 3.12.6-1-ARCH, qemu 1.7.0-1 and seabios 1.7.3.1-2 without success.</p></div></blockquote></div><p>That&#039;s not very surprising if your kernel doesn&#039;t include the i915 fixes and neither kernel nor qemu include the coherency fixes included by the kvm-vfio device.</p></div></blockquote></div><p>OK, I tried with the linux package in the first post (I&#039;d tried before but I couldn&#039;t boot it and gave up -- turns out I was loading the wrong initramfs), qemu-git and seabios-git and I was able to get the windows installer displayed on the 6950.</p><p>There were some issues with qemu though. First it wouldn&#039;t build (error in /usr/include/sys/xattr.h; it seems XATTR_CREATE was already defined when this was included) and then I&#039;d get this error:</p><div class="codebox"><pre><code>WARNING: failed to find q35-acpi-dsdt.aml</code></pre></div><p>I solved this by copying the file into /usr/share/qemu.</p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1367574">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1367595" class="blockpost rowodd"> <h2><span><span class="conr">#984</span> <a href="viewtopic.php?pid=1367595#p1367595">2014-01-05 18:44:03</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=76834">Val532</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2013-11-13</span></dd> <dd><span>Posts: 35</span></dd> <dd class="usercontacts"><span class="email"><a href="misc.php?email=76834">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>aw wrote:</cite><blockquote><div><p>You can run &#039;info mtree&#039; from the qemu monitor to check whether those fault addresses are actually something that should be mapped to the device.&#160; There&#039;s a reasonable chance that the device just does a stray DMA access, in which case it&#039;s broken.&#160; If it only works once and the device does not support a standard reset then it needs a device-specific reset.&#160; You might be able to figure out how to do that by looking through the datasheet for the device.&#160; There&#039;s no guarantee that such a mechanism exists though.&#160; The other question is whether it&#039;s really worthwhile to assign the SATA device.&#160; I&#039;d guess that you&#039;re not going to get a massive performance increase by assigning it versus using virtio-block with a raw partition, disk or lvm volume.</p></div></blockquote></div><p>I don&#039;t know how use &quot;info mtree&quot; and when ^^.</p><p>multifonction for acs overdrive does not work for intel sata, and yes is not a good idea to pass the entry bloc to the VM, and the real probleme, is it work with pci_stub (but only once) and not with vfio-pci (vfio-pci say the group is not blah blah).</p><p>And why use sata controler instead of virtio-scsi it&#039;s because i use a SSD ^^. And i don&#039;t know if the trim fuction work trough the virtio.</p><br /><p>But it&#039;s funy to see the error is the same on Intel chipset, for Intel Sata or AsMedia, do anybody can test with a AMD motherboard ?</p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1367595">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1367674" class="blockpost roweven"> <h2><span><span class="conr">#985</span> <a href="viewtopic.php?pid=1367674#p1367674">2014-01-05 21:09:21</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=78217">DanaGoyette</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2014-01-03</span></dd> <dd><span>Posts: 46</span></dd> <dd class="usercontacts"><span class="email"><a href="mailto:danagoyette@gmail.com">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>aw wrote:</cite><blockquote><div><div class="quotebox"><cite>DanaGoyette wrote:</cite><blockquote><div><p>If I add my sound card to the mix:<br />genirq: Flags mismatch irq 17. 00000000 (vfio-intx(0000:07:04.0)) vs. 00000000 (vfio-intx(0000:01:00.1))</p><p>How the heck is &#039;00000000&#039; a mismatch with &#039;00000000&#039;?</p></div></blockquote></div><p>Because neither of them include IRQF_SHARED and therefore require exclusive access to the interrupt line.&#160; This means that neither devices supports PCI2.3 INTx disable.&#160; You can generally fix this, but lose access to the conflicting device, by detaching the device from the host driver.</p></div></blockquote></div><p>Hmm, perhaps that message could use some tweaking.<br /><span class="bbs">Also, both devices function when both are attached to the host, and I&#039;m passing both to the SAME virtual machine!</span><br />CORRECTION: If snd-virtuoso and radeon are both loaded, then the system hard-locks when trying to start X.&#160; <br />With just &#039;radeon&#039; loaded, no lockup occurs.&#160; Maybe that&#039;s precisely the problem -- the shared interrupt!&#160; I wonder why the kernel doesn&#039;t warn about this...</p><p>I&#039;m trying to pass through (to the same VM) the following, at the moment:</p><div class="codebox"><pre><code>01:00.0 VGA compatible controller [0300]: Advanced Micro Devices, Inc. [AMD/ATI] Juniper PRO [Radeon HD 5750] [1002:68be] 01:00.1 Audio device [0403]: Advanced Micro Devices, Inc. [AMD/ATI] Juniper HDMI Audio [Radeon HD 5700 Series] [1002:aa58] -- if I remove this, the mismatch instead cites 01:00.0. 07:04.0 Multimedia audio controller [0401]: C-Media Electronics Inc CMI8788 [Oxygen HD Audio] [13f6:8788] -- this lies under 06:00.0 PCI bridge [0604]: PLX Technology, Inc. PEX8112 x1 Lane PCI Express-to-PCI Bridge [10b5:8112] (rev aa) 09:00.0 USB controller [0c03]: Renesas Technology Corp. uPD720201 USB 3.0 Host Controller [1912:0014] (rev 03) 0c:00.0 Ethernet controller [0200]: Intel Corporation I210 Gigabit Network Connection [8086:1533] (rev 03)</code></pre></div><p>I can see several ways to work around this, but none seems ideal:<br />* Use KVM built-in audio: only stereo; I&#039;d like 5.1 surround.<br />* Pass the onboard Realtek to the VM, and keep the Xonar sound card for the host: last time I tried that, the Realtek produced horribly broken audio.<br />* Move to second CPU slot: steals 8 lanes from primary GPU, despite only actually needing 1 lane.&#160; Also leaves only 4 lanes for a possible second GPU.<br />* Try another x1 slot: the x1 slot below second CPU slot conflicts with the Serial-over-LAN port, which I am definitely using; the x1 slot below the first GPU slot, I&#039;d need a ribbon riser to try, due to dual-slot video card.<br />* Get a different sound card and/or GPU:&#160; I can&#039;t tell before purchase which ones will likely work, and the same issues about slots will apply.<br />* Use a USB sound card?&#160; I tried with the Xonar sound card either unbound or physically removed, and now the Renesas USB controller reports the same &quot;00000000&quot; conflict.<br />* Try the X10SAE motherboard I also have: would lose the Thunderbolt port, but more importantly, it has this bug: <a href="https://bugzilla.kernel.org/show_bug.cgi?id=44881" rel="nofollow">https://bugzilla.kernel.org/show_bug.cgi?id=44881</a></p> <p class="postedit"><em>Last edited by DanaGoyette (2014-01-05 22:39:57)</em></p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1367674">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1367711" class="blockpost rowodd"> <h2><span><span class="conr">#986</span> <a href="viewtopic.php?pid=1367711#p1367711">2014-01-05 23:32:19</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=75590">aw</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2013-10-04</span></dd> <dd><span>Posts: 921</span></dd> <dd class="usercontacts"><span class="email"><a href="misc.php?email=75590">Email</a></span> <span class="website"><a href="http://vfio.blogspot.com/" rel="nofollow">Website</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>DanaGoyette wrote:</cite><blockquote><div><p>* Try the X10SAE motherboard I also have: would lose the Thunderbolt port, but more importantly, it has this bug: <a href="https://bugzilla.kernel.org/show_bug.cgi?id=44881" rel="nofollow">https://bugzilla.kernel.org/show_bug.cgi?id=44881</a></p></div></blockquote></div><p>This is due to the asmedia PCIe-to-PCI bridge, it fails to expose a PCIe capability in direct violation of the PCIe spec.&#160; It&#039;s not a trivial problem to solve, which is why it&#039;s been around so long.&#160; Personally, I just avoid anything with an asmedia bridge.</p> </div> <div class="postsignature postmsg"><hr /><p><a href="http://vfio.blogspot.com" rel="nofollow">http://vfio.blogspot.com</a><br />Looking for a more open forum to discuss vfio related uses?&#160; Try <a href="https://www.redhat.com/mailman/listinfo/vfio-users" rel="nofollow">https://www.redhat.com/mailman/listinfo/vfio-users</a></p></div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1367711">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1367721" class="blockpost roweven"> <h2><span><span class="conr">#987</span> <a href="viewtopic.php?pid=1367721#p1367721">2014-01-06 00:04:32</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=78217">DanaGoyette</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2014-01-03</span></dd> <dd><span>Posts: 46</span></dd> <dd class="usercontacts"><span class="email"><a href="mailto:danagoyette@gmail.com">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>aw wrote:</cite><blockquote><div><div class="quotebox"><cite>DanaGoyette wrote:</cite><blockquote><div><p>* Try the X10SAE motherboard I also have: would lose the Thunderbolt port, but more importantly, it has this bug: <a href="https://bugzilla.kernel.org/show_bug.cgi?id=44881" rel="nofollow">https://bugzilla.kernel.org/show_bug.cgi?id=44881</a></p></div></blockquote></div><p>This is due to the asmedia PCIe-to-PCI bridge, it fails to expose a PCIe capability in direct violation of the PCIe spec.&#160; It&#039;s not a trivial problem to solve, which is why it&#039;s been around so long.&#160; Personally, I just avoid anything with an asmedia bridge.</p></div></blockquote></div><p>That makes it sound like a PCI-PCI bridge sitting directly on a PCIe bus -- so yeah, that&#039;s broken.</p><p>Incidentally, the markings on the chip closest to the PCI slots are:<br />IDT ©<br />89HMPEB38<br />3ZBEMG<br />ZB1242CH</p><p>CH09493MX TWP BU</p> <p class="postedit"><em>Last edited by DanaGoyette (2014-01-06 00:11:57)</em></p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1367721">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1367733" class="blockpost rowodd"> <h2><span><span class="conr">#988</span> <a href="viewtopic.php?pid=1367733#p1367733">2014-01-06 00:30:18</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=78217">DanaGoyette</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2014-01-03</span></dd> <dd><span>Posts: 46</span></dd> <dd class="usercontacts"><span class="email"><a href="mailto:danagoyette@gmail.com">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <p>I&#039;ve gone back and re-tested a bunch of the slots.&#160; With pci-assign, I can use the video card in the top x16 and the sound card in the middle x16, just fine.&#160; With vfio, even that configuration fails due to interrupt flag conflicts.&#160; I can add or remove the firewire controller and the ethernet controller, and I&#039;ll get varying collisions between the devices I noted above, and sometimes with the Intel chipset KT (serial-over-lan) or SMBUS controller.&#160; <br />I&#039;m going to try re-adding all those assignments with the sound card in the bottom slot, using pci-assign again.</p><p>EDIT: Okay, with sound card back in an x1 slot, and the Ethernet controller included in the VM, I get a kernel oops.&#160; Without ethernet controller, I&#039;m noticing that the &quot;genirq&quot; message mentions IRQs that aren&#039;t actually shared in lspci.&#160; For example, genirq will mention the hdmi audio and the C-Media card as conflicting on IRQ 17 -- yet, lspci -nnvv mentions only the C-Media card as using IRQ 17.</p><p>EDIT #2:&#160; With sound card in x1 slot, VM boots if I don&#039;t bother forwarding HDMI audio, even when including the ethernet controller.&#160; Again, this is still with pci-assign, not vfio.</p><p>It looks like vfio is protecting me from certain conflicts -- but unfortunately, all that protection must be somewhat over-zealous.</p><p>Also, in case you&#039;re wondering why I&#039;m passing the USB controller through, it&#039;s because the USB passthrough in Qemu wasn&#039;t working for me when I tried it.&#160; Devices stayed attached to the host, not the guest.</p> <p class="postedit"><em>Last edited by DanaGoyette (2014-01-06 00:59:48)</em></p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1367733">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1368441" class="blockpost roweven"> <h2><span><span class="conr">#989</span> <a href="viewtopic.php?pid=1368441#p1368441">2014-01-07 18:03:22</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=78331">MichaelLong</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2014-01-06</span></dd> <dd><span>Posts: 3</span></dd> <dd class="usercontacts"><span class="email"><a href="misc.php?email=78331">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <p>Hi everyone,<br />thx a lot for this great thread, it helped me a lot. So I&#039;d like to report another success story on the following hardware and software:</p><p><span class="bbu">Hardware</span><br />Mainboard: <a href="http://www.intel.com/content/www/us/en/motherboards/desktop-motherboards/desktop-board-dp67bg.html" rel="nofollow"> Intel DP67BG</a><br />CPU: Intel i7-2600<br />GPU0 (host): PowerColor Go! Green HD5450 512MB PCIEx1<br />GPU1 (guest): Gainward GeForce GTX 560 Ti 2048MB<br />RAM: 8 GB</p><p><span class="bbu">Software</span><br />Kernel: 3.13-rc7<br />QEMU: qemu-git</p><p><span class="bbu">What works:</span><br />Using the AMD PCIe x1 card makes it convenient to avoid any ACS patches at the moment. For my tests I&#039;m using a clone of my native Windows 7 gaming installation so it is quite easy to make comparisons. The VM runs without any general problems so far. I ran several benchmarks like Cinebench R15, 3DMark (2013), Unigine Heaven 4.0, PassMark. Performance ranges from about 85% (Cinemax) to even 99% (Unigine Heaven) compared to the native installation. </p><p><span class="bbu">What does not work:</span><br />I can run the QEMU instance only once between a power cycle of the host system. Rebooting the VM is not a problem but shutting it down and starting it later results in:</p><p>vfio-pci 0000:01:00.0: Invalid ROM contents</p><p>Supplying a VBIOS to QEMU makes the message go away but does not change the result. QEMU hangs. This might not be any news at all but I&#039;m not aware of the current state.</p><p><span class="bbu">What is a problem:</span><br />My only remaining issue right now is a quite specific one. Running the benchmarks or even running Crysis 2 Maximum Edition were possible without any noticeable problems but as soon as I start Battlefield 3 or Battlefield 4 the VMs starts behaving very very sluggish. Mouse cursor moves choppy, task manager is updating slowly and&#160; the performance is completely off.<br />BF3 shows around 30-40 FPS were it should 90-120, BF4 is even worse: 7-12 FPS no matter what configuration (normally around 70-90 FPS). <br />Sometimes I get a BSOF BUGCODE_USB_DRIVER, never seen before.</p><p>I didn&#039;t find any benchmark to reproduce this behavior yet. </p><p>So any advice to that matter is much appreciated.</p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1368441">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1368635" class="blockpost rowodd"> <h2><span><span class="conr">#990</span> <a href="viewtopic.php?pid=1368635#p1368635">2014-01-08 11:23:40</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=77960">xani</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2013-12-24</span></dd> <dd><span>Posts: 6</span></dd> <dd class="usercontacts"><span class="email"><a href="misc.php?email=77960">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>TripleSpeeder wrote:</cite><blockquote><div><p>@xani: Do you know exactly the root cause of the memory leak and how you fixed it in your kernel? Or are you unsure on the exact reason? It would be awesome if we get this fixed also in the main kernel sources :-) Or are you already in contact with kernel devs about this topic?</p></div></blockquote></div><p>I didn&#039;t contact upstream, I thought about it but there&#039;s too much on my head right now. It would be great if you could report it.</p><p>Here&#039;s what I found:</p><div class="quotebox"><cite>xani wrote:</cite><blockquote><div><p>EDIT:<br />Further investigation showed that this problem can lie within gcc itself. <a href="http://www.linux-magazine.com/Issues/2014/158/Kernel-News" rel="nofollow">Here&#039;s</a> link that can give you explanation. I will report on my findings asap.</p></div></blockquote></div><p>In short, Linus wanted to use some better asm goto instructions. It was implemented in commit </p><div class="codebox"><pre><code>0c44c2d0f459c</code></pre></div><p>But it was causing problems and they discovered that problem lies in gcc. It compiled new code in wrong way.<br />The patches for gcc will be released with 4.9, I think. Anyway, Ingo Molnar repaired problem they had with a hack in commit </p><div class="codebox"><pre><code>88f182dd77</code></pre></div><p>This commit is not fixing mem leak issue. I read in article that is in my qoute, that problem folks had upstream was repaired by disabling ASM_GOTO, so I did the same and problem disappeared. Patch that I included in latest version is very simple. <a href="http://www.fileswap.com/dl/WcyVmJgPwt/" rel="nofollow">Mem leak patch</a>.</p><p>I found out that ASM_GOTO is a cause of the problem by bisecting kernel.</p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1368635">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1368636" class="blockpost roweven"> <h2><span><span class="conr">#991</span> <a href="viewtopic.php?pid=1368636#p1368636">2014-01-08 11:26:01</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=77960">xani</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2013-12-24</span></dd> <dd><span>Posts: 6</span></dd> <dd class="usercontacts"><span class="email"><a href="misc.php?email=77960">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>BulliteShot wrote:</cite><blockquote><div><p>Edit: Nevermind. I can&#039;t re-produce the problem.</p><p>With that patched kernel to stop the memory leak I can confirm it works unless I use hugetlbfs. Using hugetlbfs causes the memory leak again.</p></div></blockquote></div><p>I&#039;m not using hugetlbfs. After my exams maybe I&#039;ll test it, so it will be mid February.</p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1368636">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1368921" class="blockpost rowodd"> <h2><span><span class="conr">#992</span> <a href="viewtopic.php?pid=1368921#p1368921">2014-01-09 05:14:24</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=77789">syllopsium</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2013-12-18</span></dd> <dd><span>Posts: 4</span></dd> <dd class="usercontacts"><span class="email"><a href="misc.php?email=77789">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>aw wrote:</cite><blockquote><div><div class="quotebox"><cite>syllopsium wrote:</cite><blockquote><div><p>The motherboard has a built in Matrox G200e, I&#039;m hoping to pass this through to a different VM as it&#039;s a horribly slow chip. It appears in the same iommu group as the southbridge x4 PCIe slot (the only slot where a graphics card won&#039;t be slowed down to x1 speed by the 3210 chipset on this motherboard). This is why I&#039;ve applied the ACS patch.</p></div></blockquote></div><p>FWIW, nvidia/amd require several quirks in qemu to make things work.&#160; Nobody has done these for matrox and I don&#039;t have anything with matrox graphics.&#160; Besides that, what&#039;s the point of attaching a matrox card to a guest?&#160; It seems like the headache of assigning it is not worth the incremental improvement versus emulated graphics.&#160; Assignment makes sense for high end GPUs, but I&#039;m not sure I&#039;m interested in maintaining code for assigning random 2d-only VGA devices.</p></div></blockquote></div><p>Point. Although it&#039;s currently a moot one because a) I&#039;m stupid and forgot to turn rombar back to one - it works when correctly configured, at least in VGA mode. b) QEMU now fails with an emulation failure on the creaky old OS I&#039;m trying to run, but that&#039;s not a vfio problem.. Thanks for all the help anyway <img src="https://bbs.archlinux.org/img/smilies/smile.png" width="15" height="15" alt="smile" /></p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1368921">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1368976" class="blockpost roweven"> <h2><span><span class="conr">#993</span> <a href="viewtopic.php?pid=1368976#p1368976">2014-01-09 10:58:10</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=77628">mbirkis</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2013-12-12</span></dd> <dd><span>Posts: 13</span></dd> <dd class="usercontacts"><span class="email"><a href="misc.php?email=77628">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <p>Hi! great stuff. This has inspired me to try this on my own. I had to buy a new cpu/motherboard as i didn&#039;t have the virtualization stuff needed in my old Intel 2600K.</p><p>My setup (once parts get delivered) will be:<br />AMD FX8350<br />Gigabyte GA-990XA-UD3, Socket-AM3+<br />8GB ram<br />Nvidia GTX 570 (host)<br />Nvidia GTX580 (passed through)</p><p>I will be using the kernel/qemu/seabios from OP.</p><p>Results will be posted, if anyone have any starter tips feel free to let me know.</p><div class="quotebox"><cite>nbhs wrote:</cite><blockquote><div><p>ISSUES:<br />Using NVIDIA proprietary drivers on the host requires a patch: see <a href="http://www.mail-archive.com/qemu-devel@" rel="nofollow">http://www.mail-archive.com/qemu-devel@</a> … 74066.html, patch (posted by andy123):&#160; <a href="http://bpaste.net/show/109185/" rel="nofollow">http://bpaste.net/show/109185/</a></p></div></blockquote></div><p>One question is that i have been testing qemu on my old hardware just to get a feel of it (without passthrough) and i noticed that my Nvidia driver works without patching on the Host even with kvm modules inserted. Is this because i am not passing anything through yet or is the patch obsolete?</p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1368976">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1369006" class="blockpost rowodd"> <h2><span><span class="conr">#994</span> <a href="viewtopic.php?pid=1369006#p1369006">2014-01-09 13:45:36</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=53953">andy123</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2011-11-04</span></dd> <dd><span>Posts: 169</span></dd> <dd class="usercontacts"><span class="email"><a href="misc.php?email=53953">Email</a></span> <span class="website"><a href="http://ajs124.de" rel="nofollow">Website</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>mbirkis wrote:</cite><blockquote><div><p>[…]</p><div class="quotebox"><cite>nbhs wrote:</cite><blockquote><div><p>ISSUES:<br />Using NVIDIA proprietary drivers on the host requires a patch: see <a href="http://www.mail-archive.com/qemu-devel@" rel="nofollow">http://www.mail-archive.com/qemu-devel@</a> … 74066.html, patch (posted by andy123):&#160; <a href="http://bpaste.net/show/109185/" rel="nofollow">http://bpaste.net/show/109185/</a></p></div></blockquote></div><p>One question is that i have been testing qemu on my old hardware just to get a feel of it (without passthrough) and i noticed that my Nvidia driver works without patching on the Host even with kvm modules inserted. Is this because i am not passing anything through yet or is the patch obsolete?</p></div></blockquote></div><p>The patch is to fix some problems with passthough (something about the vga arbiter?) and I think I&#039;m still using it.</p> </div> <div class="postsignature postmsg"><hr /><p>i&#039;m sorry for my poor english wirting skills…</p></div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1369006">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1369044" class="blockpost roweven"> <h2><span><span class="conr">#995</span> <a href="viewtopic.php?pid=1369044#p1369044">2014-01-09 15:58:09</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=73114">noctavian</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2013-07-11</span></dd> <dd><span>Posts: 9</span></dd> <dd class="usercontacts"><span class="email"><a href="misc.php?email=73114">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <p>Thanks everybody for this great thread, I managed to get VGA passthrough working.</p><p>Motherboard: AsRock H67M-GE<br />CPU: Intel i7-2600<br />Host GPU: Intel HD 2500 (this is a headless machine, X isn&#039;t installed)<br />Guest GPU: AMD HD6770</p><p>I used the kernel, qemu and seabios PKBUILDs from the first post on a fresh Arch install and everything seems to be working just fine.</p><p>I created a Windows 7 VM and a Xubuntu VM, installed the drivers (the Windows Catalyst installer crashes a lot) for the card and run Uningine without any problems in either VM. I can also shutdown/restart/switch between the two VMs at will, awesome!</p> </div> <div class="postsignature postmsg"><hr /><p><a href="https://docs.google.com/spreadsheet/ccc?key=0Aryg5nO-kBebdFozaW9tUWdVd2VHM0lvck95TUlpMlE&amp;usp=drive_web#gid=0" rel="nofollow">VGA-Passthrough configs</a></p></div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1369044">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1369189" class="blockpost rowodd"> <h2><span><span class="conr">#996</span> <a href="viewtopic.php?pid=1369189#p1369189">2014-01-09 22:22:47</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=78416">beardedchimp</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2014-01-09</span></dd> <dd><span>Posts: 2</span></dd> <dd class="usercontacts"><span class="email"><a href="misc.php?email=78416">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <p>I&#039;ve been running KVM for a few months now all thanks to this thread so thanks for that.</p><p>My setup is:<br />archlinux host<br />Windows 8.1 Guest<br />Gigabyte 990FXA-UD3<br />Radeon X700 PRO for host. I didn&#039;t even know what card is was until I looked it up for this post, all I knew was that it was ati and old.<br />gtx 760 for guest.<br />amd 8350fx, 6 cores for guest, 2 for host<br />16GB ram, 8GB guest, 8GB host<br />I pass through a 200GB hard drive through /dev/sda<br />I also passthrough a few usb ports</p><p>So far it&#039;s been working well, I love having full access to arch while I mess about playing games but I have run into issues with what I can run on the guest.</p><p>For some reason only some games will start. Other games (such as CS:GO) start launcing from steam but crash with no error message.</p><p>Games that do work are:<br />Counter Strike Source<br />Borderlands 2<br />Just Cause 2<br />Bad company 2<br />F1 2012</p><p>Games that don&#039;t work:<br />CS:GO<br />Shogun 2<br />Tomb Raider (the new one)<br />Civ 5<br />A load of others but can&#039;t remember which</p><br /><p>The games all crash in the same way, no error message and no error log file generated. I&#039;ve tried launching them in various ways with no success.</p><p>Because I run the guest from /dev/sda, I can also boot windows directly instead of through KVM. I was really surpised that this work actually but it&#039;s fine. When windows is booted directly all the games run, no hint of crashing.</p><p>I&#039;ve had this setup working since August and I was hoping by now updates to linux/kvm/windows would have sorted this issue but it&#039;s still there and I&#039;m no closer to working out why.</p><p>Has anyone experianced anything similar or know what might be causing it?</p><p>Here&#039;s the script I&#039;ve cobled together from this thread, please let me know if I&#039;ve done anything stupid.</p><div class="codebox"><pre class="vscroll"><code>#!/bin/sh CPU_CORE_NR=$(cat /proc/cpuinfo | egrep &quot;core id|physical id&quot; | tr -d &quot;\n&quot; | sed s/physical/\\nphysical/g | grep -v ^$ | sort | uniq | wc -l) CPUSET=/sys/fs/cgroup/cpuset QEMU=/usr/bin/qemu-system-x86_64 USE_CPUSET=true VCPUS=&quot;6&quot; #must be &gt; 0 &lt; cpu core number CONFIG=&quot;-M q35 -enable-kvm&quot; MEM=&quot;8192&quot; MEM_PATH=&quot;&quot; CPU=&quot;host&quot; BIOS=&quot;/usr/share/qemu/bios.bin&quot; #NET=&quot;-netdev bridge,br=br0,id=hostnet0 -device virtio-net-pci,netdev=hostnet0,id=net0&quot; #NET=&quot;-net nic -net bridge,br=br0&quot; NET=&quot;&quot; SND=true SND_DRIVER_OPTS=&quot;QEMU_AUDIO_DRV=pa QEMU_PA_SAMPLES=128&quot; USB_DEVICES=&quot;&quot; PCI_DEVICES=&quot;00:16.0 00:16.2&quot; GPU=&quot;04:00.0&quot; GPU_SND=&quot;04:00.1&quot; ROM=&quot;/var/lib/vm/GTX760.rom&quot; VBIOS=&quot;&quot; HDD=&quot;/dev/sda&quot; EXTRA_ARGS=&quot;-boot menu=on -monitor stdio&quot; if [ -n &quot;$GPU&quot; ]; then CONFIG+=&quot; -vga none -nographic&quot; DEV+=&quot; -device ioh3420,bus=pcie.0,addr=1c.0,multifunction=on,port=1,chassis=1,id=root.1&quot; if [ -n &quot;$VBIOS&quot; ]; then DEV+=&quot; -device vfio-pci,host=$GPU,x-vga=on,rombar=0,romfile=$VBIOS,addr=0.0,multifunction=on,bus=root.1,romfile=$ROM&quot; else DEV+=&quot; -device vfio-pci,host=$GPU,x-vga=on,addr=0.0,multifunction=on,bus=root.1&quot; fi if [ -n &quot;$GPU_SND&quot; ]; then DEV+=&quot; -device vfio-pci,host=$GPU_SND,addr=0.1,bus=root.1&quot; fi fi if [ -n &quot;$PCI_DEVICES&quot; ]; then for d in $PCI_DEVICES; do DEV+=&quot; -device vfio-pci,host=$d,bus=pcie.0&quot; done fi if [ -n &quot;$HDD&quot; ] || [ -n &quot;$CDROM&quot; ]; then DEV+=&quot; -device ahci,bus=pcie.0,id=ahci&quot; if [ -n &quot;$HDD&quot; ]; then STORAGE+=&quot; -drive file=$HDD,if=virtio,cache=none&quot; fi if [ -n &quot;$CDROM&quot; ]; then isonum=1 for d in $CDROM; do isonum=$[$isonum +1] STORAGE+=&quot; -drive file=$d,id=isocd$isonum -device ide-cd,bus=ahci.$isonum,drive=isocd$isonum&quot; #STORAGE+=&quot; -drive file=$CDROM,id=isocd$isonum -device ide-cd,bus=ahci.1,drive=isocd$isonum&quot; done fi fi if $SND ; then SND=&quot;-device ich9-intel-hda,bus=pcie.0,addr=1b.0,id=sound0 -device hda-duplex,cad=0&quot; #SND=&quot;-device ich9-intel-hda,bus=pcie.0,addr=1b.0,id=sound0 -device hda-duplex,id=sound0-codec0,bus=sound0.0,cad=0 -soundhw ac97&quot; #SND=&quot;-soundhw ac97&quot; export $SND_DRIVER_OPTS else SND=&quot;&quot; fi if [ -n &quot;$CPU&quot; ]; then CPU=&quot;-cpu $CPU -smp $VCPUS,sockets=1,cores=$VCPUS,threads=1&quot; else CPU=&quot;-smp $VCPUS,sockets=1,cores=$VCPUS,threads=1&quot; fi if [ -n &quot;$BIOS&quot; ]; then BIOS=&quot; -bios $BIOS&quot; fi if [ -n &quot;$MEM&quot; ]; then MEM=&quot;-m $MEM&quot; if [ -n &quot;$MEM_PATH&quot; ]; then MEM+=&quot; -mem-path $MEM_PATH&quot; fi else if [ -n &quot;$MEM_PATH&quot; ]; then MEM+=&quot; -mem-path $MEM_PATH&quot; fi fi if [ -n &quot;$USB_DEVICES&quot; ]; then for u in $USB_DEVICES; do USB_DEV+=&quot; -usbdevice $u&quot; done fi if [ $USE_CPUSET ]; then if [ ! -d $CPUSET/system ]; then mkdir $CPUSET/system fi if [ ! -d $CPUSET/qemu ]; then mkdir $CPUSET/qemu fi echo $((CPU_CORE_NR-VCPUS))-$((CPU_CORE_NR-1)) &gt; $CPUSET/qemu/cpuset.cpus echo 1 &gt; $CPUSET/qemu/cpuset.cpu_exclusive echo 0 &gt; $CPUSET/qemu/cpuset.mems echo 0-$((CPU_CORE_NR-VCPUS-1))&gt; $CPUSET/system/cpuset.cpus echo 1 &gt; $CPUSET/system/cpuset.cpu_exclusive echo 0 &gt; $CPUSET/system/cpuset.mems for t in `cat $CPUSET/tasks`; do echo $t &gt; $CPUSET/system/tasks done &gt; /dev/null 2&gt;&amp;1 fi set -m #netctl start bridge QEMU_PA_SAMPLES=128 QEMU_AUDIO_DRV=pa $QEMU $CONFIG $BIOS $CPU $MEM $DEV $USB_DEV $SND $NET $STORAGE $EXTRA_ARGS &amp; #$QEMU $CONFIG $BIOS $CPU $MEM $DEV $USB_DEV $SND $STORAGE $EXTRA_ARGS &amp; PID=$! if [ $USE_CPUSET ]; then ( while ( (kill -s 0 $PID &gt; /dev/null 2&gt;&amp;1) ); do if [ &quot;$(grep Threads /proc/$PID/status | awk &#039;{print $2}&#039; )&quot; -ge &quot;$((VCPUS+1))&quot; &gt; /dev/null 2&gt;&amp;1 ]; then i=$((CPU_CORE_NR-VCPUS)) for t in `ls /proc/$PID/task/`; do if [ $i -ne $((CPU_CORE_NR)) ]; then if [ $t -ne $PID ];then echo $t &gt; $CPUSET/qemu/tasks taskset -pc $i $t; let i++ fi fi done break fi done ) &amp; fg %1 wait for t in `cat $CPUSET/system/tasks`; do echo $t &gt; $CPUSET/tasks done &gt; /dev/null 2&gt;&amp;1 rmdir $CPUSET/system rmdir $CPUSET/qemu fi echo &quot;All Done!&quot;</code></pre></div> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1369189">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1369335" class="blockpost roweven"> <h2><span><span class="conr">#997</span> <a href="viewtopic.php?pid=1369335#p1369335">2014-01-10 13:15:20</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=78180">pascal257</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2014-01-02</span></dd> <dd><span>Posts: 3</span></dd> <dd class="usercontacts"><span class="email"><a href="mailto:p@pkne.de">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><blockquote><div><p>Because I run the guest from /dev/sda, I can also boot windows directly instead of through KVM. I was really surpised that this work actually but it&#039;s fine. When windows is booted directly all the games run, no hint of crashing.</p><p>I&#039;ve had this setup working since August and I was hoping by now updates to linux/kvm/windows would have sorted this issue but it&#039;s still there and I&#039;m no closer to working out why.</p></div></blockquote></div><p>I&#039;d try a fresh virtualisation-only installation. I suspect some driver issues or something related to that. I had no issues so far playing games.</p><p>But I haven&#039;t tried Civ 5 yet, I&#039;ll check that tonight. Also I am running Windows 7 instead of 8.</p> <p class="postedit"><em>Last edited by pascal257 (2014-01-10 13:16:37)</em></p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1369335">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1369372" class="blockpost rowodd"> <h2><span><span class="conr">#998</span> <a href="viewtopic.php?pid=1369372#p1369372">2014-01-10 15:46:44</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=53953">andy123</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2011-11-04</span></dd> <dd><span>Posts: 169</span></dd> <dd class="usercontacts"><span class="email"><a href="misc.php?email=53953">Email</a></span> <span class="website"><a href="http://ajs124.de" rel="nofollow">Website</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>pascal257 wrote:</cite><blockquote><div><p>[…] I haven&#039;t tried Civ 5 yet, I&#039;ll check that tonight. Also I am running Windows 7 instead of 8.</p></div></blockquote></div><p>I&#039;ve played countless hours (&gt;100) of Civ 5 on my setup, most likely even in different windows versions. My VM started out with windows 7 and was upgraded to 8 and 8.1 from there, iirc.</p> </div> <div class="postsignature postmsg"><hr /><p>i&#039;m sorry for my poor english wirting skills…</p></div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1369372">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1369549" class="blockpost roweven"> <h2><span><span class="conr">#999</span> <a href="viewtopic.php?pid=1369549#p1369549">2014-01-11 00:19:59</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=78416">beardedchimp</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2014-01-09</span></dd> <dd><span>Posts: 2</span></dd> <dd class="usercontacts"><span class="email"><a href="misc.php?email=78416">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>pascal257 wrote:</cite><blockquote><div><div class="quotebox"><blockquote><div><p>Because I run the guest from /dev/sda, I can also boot windows directly instead of through KVM. I was really surpised that this work actually but it&#039;s fine. When windows is booted directly all the games run, no hint of crashing.</p><p>I&#039;ve had this setup working since August and I was hoping by now updates to linux/kvm/windows would have sorted this issue but it&#039;s still there and I&#039;m no closer to working out why.</p></div></blockquote></div><p>I&#039;d try a fresh virtualisation-only installation. I suspect some driver issues or something related to that. I had no issues so far playing games.</p><p>But I haven&#039;t tried Civ 5 yet, I&#039;ll check that tonight. Also I am running Windows 7 instead of 8.</p></div></blockquote></div><p>I actually ran windows 7 first, then switched to windows 8 to see if it would fix the problem and didn&#039;t.</p><p>I&#039;ve also upgraded the video drivers etc. multiple times with no effect so I don&#039;t know what drivers could be causing it.</p><p>Ahh, I might actually be wrong about Civ 5 being broken as I just checked and this win8 vm doesn&#039;t even have it installed. I&#039;m going to work out a more complete list of what doesn&#039;t work.</p><p>Since I&#039;ve already installed the VM twice with the same results I&#039;m not confident about installing it again but I&#039;ll try any suggestions.</p><p>Cheers</p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1369549">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1369555" class="blockpost rowodd"> <h2><span><span class="conr">#1000</span> <a href="viewtopic.php?pid=1369555#p1369555">2014-01-11 00:40:59</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=72881">alexis_evo</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2013-07-04</span></dd> <dd><span>Posts: 33</span></dd> <dd class="usercontacts"><span class="email"><a href="misc.php?email=72881">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <p>Just ordered an FX-8350 with an ASUS M5A97 R2.0. Has anyone managed to get this working on this motherboard? </p><p>Also, has anyone figured out a way around the issue with catalyst initializing both GPUs if they are the exact same model? I have 2x HD 6870, both from XFX, exact same model, that I would like to use (one in windows guest, one on arch host). I don&#039;t mind buying a new nvidia GPU for the host, but it may be a couple months until I can do that.</p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1369555">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div class="postlinksb"> <div class="inbox crumbsplus"> <div class="pagepost"> <p class="pagelink conl"><span class="pages-label">Pages: </span><a rel="prev" class="item1" href="viewtopic.php?id=162768&amp;p=39">Previous</a> <a href="viewtopic.php?id=162768">1</a> <span class="spacer">…</span> <a href="viewtopic.php?id=162768&amp;p=38">38</a> <a href="viewtopic.php?id=162768&amp;p=39">39</a> <strong>40</strong> <a href="viewtopic.php?id=162768&amp;p=41">41</a> <a href="viewtopic.php?id=162768&amp;p=42">42</a> <span class="spacer">…</span> <a href="viewtopic.php?id=162768&amp;p=234">234</a> <a rel="next" href="viewtopic.php?id=162768&amp;p=41">Next</a></p> <p class="postlink conr">Topic closed</p> </div> <ul class="crumbs"> <li><a href="index.php">Index</a></li> <li><span>»&#160;</span><a href="viewforum.php?id=48">Topics Going Nowhere</a></li> <li><span>»&#160;</span><strong><a href="viewtopic.php?id=162768">KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</a></strong></li> </ul> <p class="subscribelink clearb"><a href="misc.php?action=subscribe&amp;tid=162768">Subscribe to this topic</a></p> <div class="clearer"></div> </div> </div> </div> <div id="brdfooter" class="block"> <h2><span>Board footer</span></h2> <div class="box"> <div id="brdfooternav" class="inbox"> <div class="conl"> <form id="qjump" method="get" action="viewforum.php"> <div><label><span>Jump to<br /></span> <select name="id" onchange="window.location=('viewforum.php?id='+this.options[this.selectedIndex].value)"> <optgroup label="Technical Issues and Assistance"> <option value="23">Newbie Corner</option> <option value="17">Installation</option> <option value="22">Kernel &amp; Hardware</option> <option value="18">Applications &amp; Desktop Environments</option> <option value="31">Laptop Issues</option> <option value="8">Networking, Server, and Protection</option> <option value="32">Multimedia and Games</option> <option value="50">System Administration</option> <option value="35">Other Architectures</option> </optgroup> <optgroup label="Arch-centric"> <option value="24">Announcements, Package &amp; Security Advisories</option> <option value="1">Arch Discussion</option> <option value="13">Forum &amp; Wiki discussion</option> </optgroup> <optgroup label="Pacman Upgrades, Packaging &amp; AUR"> <option value="44">Pacman &amp; Package Upgrade Issues</option> <option value="49">[testing] Repo Forum</option> <option value="4">Creating &amp; Modifying Packages</option> <option value="38">AUR Issues, Discussion &amp; PKGBUILD Requests</option> </optgroup> <optgroup label="Contributions &amp; Discussion"> <option value="20">GNU/Linux Discussion</option> <option value="27">Community Contributions</option> <option value="33">Programming &amp; Scripting</option> <option value="30">Other Languages</option> <option value="47">Artwork and Screenshots</option> <option value="42">Try This</option> </optgroup> <optgroup label="/dev/null"> <option value="29">Off-Topic</option> <option value="48" selected="selected">Topics Going Nowhere</option> <option value="36">Dustbin</option> </optgroup> </select></label> <input type="submit" value=" Go " accesskey="g" /> </div> </form> </div> <div class="conr"> <p id="feedlinks"><span class="atom"><a href="extern.php?action=feed&amp;tid=162768&amp;type=atom">Atom topic feed</a></span></p> <p id="poweredby">Powered by <a href="http://fluxbb.org/">FluxBB</a></p> </div> <div class="clearer"></div> </div> </div> </div> </div> <div class="end-box"></div> </div> </body> </html>
