<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"> <html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en" dir="ltr"> <head> <meta http-equiv="Content-Type" content="text/html; charset=utf-8" /> <title>KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9 (Page 29) / Topics Going Nowhere / Arch Linux Forums</title> <link rel="stylesheet" type="text/css" href="style/ArchLinux.css" /> <link rel="canonical" href="viewtopic.php?id=162768&amp;p=29" title="Page 29" /> <link rel="prev" href="viewtopic.php?id=162768&amp;p=28" title="Page 28" /> <link rel="next" href="viewtopic.php?id=162768&amp;p=30" title="Page 30" /> <link rel="alternate" type="application/atom+xml" href="extern.php?action=feed&amp;tid=162768&amp;type=atom" title="Atom topic feed" /> <link rel="stylesheet" media="screen" href="style/ArchLinux/arch.css?v=3" /> <link rel="stylesheet" media="screen" href="style/ArchLinux/archnavbar.css?v=2" /> <link rel="shortcut icon" href="style/ArchLinux/favicon.ico" /> </head> <body> <div id="archnavbar" class="anb-forum"> <div id="archnavbarlogo"><h1><a href="http://www.archlinux.org/">Arch Linux</a></h1></div> <div id="archnavbarmenu"> <ul id="archnavbarlist"> <li id="anb-home"><a href="http://www.archlinux.org/">Home</a></li><li id="anb-packages"><a href="http://www.archlinux.org/packages/">Packages</a></li><li id="anb-forums" class="anb-selected"><a href="https://bbs.archlinux.org/">Forums</a></li><li id="anb-wiki"><a href="https://wiki.archlinux.org/">Wiki</a></li><li id="anb-bugs"><a href="https://bugs.archlinux.org/">Bugs</a></li><li id="anb-aur"><a href="https://aur.archlinux.org/">AUR</a></li><li id="anb-download"><a href="http://www.archlinux.org/download/">Download</a></li> </ul> </div> </div> <div id="punviewtopic" class="pun"> <div class="top-box"></div> <div class="punwrap"> <div id="brdheader" class="block"> <div class="box"> <div id="brdmenu" class="inbox"> <ul> <li id="navindex" class="isactive"><a href="index.php">Index</a></li> <li id="navuserlist"><a href="userlist.php">User list</a></li> <li id="navsearch"><a href="search.php">Search</a></li> <li id="navprofile"><a href="profile.php?id=80749">Profile</a></li> <li id="navlogout"><a href="login.php?action=out&amp;id=80749&amp;csrf_token=5c20501ec397bb45ef8ee8c84db232c8d8e421c6">Logout</a></li> </ul> </div> <div id="brdwelcome" class="inbox"> <ul class="conl"> <li><span>Logged in as <strong>SXX</strong></span></li> <li><span>Last visit: 2015-08-16 12:20:09</span></li> </ul> <ul class="conr"> <li><span>Topics: <a href="search.php?action=show_replies" title="Find topics you have posted to.">Posted</a> | <a href="search.php?action=show_new" title="Find topics with new posts since your last visit.">New</a> | <a href="search.php?action=show_recent" title="Find topics with recent posts.">Active</a> | <a href="search.php?action=show_unanswered" title="Find topics with no replies.">Unanswered</a></span></li> </ul> <div class="clearer"></div> </div> </div> </div> <div id="brdmain"> <div class="linkst"> <div class="inbox crumbsplus"> <ul class="crumbs"> <li><a href="index.php">Index</a></li> <li><span>»&#160;</span><a href="viewforum.php?id=48">Topics Going Nowhere</a></li> <li><span>»&#160;</span><strong><a href="viewtopic.php?id=162768">KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</a></strong></li> </ul> <div class="pagepost"> <p class="pagelink conl"><span class="pages-label">Pages: </span><a rel="prev" class="item1" href="viewtopic.php?id=162768&amp;p=28">Previous</a> <a href="viewtopic.php?id=162768">1</a> <span class="spacer">…</span> <a href="viewtopic.php?id=162768&amp;p=27">27</a> <a href="viewtopic.php?id=162768&amp;p=28">28</a> <strong>29</strong> <a href="viewtopic.php?id=162768&amp;p=30">30</a> <a href="viewtopic.php?id=162768&amp;p=31">31</a> <span class="spacer">…</span> <a href="viewtopic.php?id=162768&amp;p=234">234</a> <a rel="next" href="viewtopic.php?id=162768&amp;p=30">Next</a></p> <p class="postlink conr">Topic closed</p> </div> <div class="clearer"></div> </div> </div> <div id="p1347719" class="blockpost rowodd blockpost1"> <h2><span><span class="conr">#701</span> <a href="viewtopic.php?pid=1347719#p1347719">2013-11-09 18:05:21</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=72338">empie</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>From: The Netherlands</span></dd> <dd><span>Registered: 2013-06-15</span></dd> <dd><span>Posts: 9</span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <p>Try using &quot;-cpu qemu64&quot; in stead of &quot;-cpu host&quot;. That solved my issues.</p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1347719">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1347723" class="blockpost roweven"> <h2><span><span class="conr">#702</span> <a href="viewtopic.php?pid=1347723#p1347723">2013-11-09 18:18:29</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=76719">cmorrow</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2013-11-09</span></dd> <dd><span>Posts: 2</span></dd> <dd class="usercontacts"><span class="email"><a href="misc.php?email=76719">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <p>Changing the -cpu option worked.&#160; Thanks!</p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1347723">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1348292" class="blockpost rowodd"> <h2><span><span class="conr">#703</span> <a href="viewtopic.php?pid=1348292#p1348292">2013-11-11 03:03:06</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=76766">mafferri</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2013-11-11</span></dd> <dd><span>Posts: 7</span></dd> <dd class="usercontacts"><span class="email"><a href="misc.php?email=76766">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>kaeptnb wrote:</cite><blockquote><div><p>Hi,</p><p>thanks for this thread! Using this setup for a couple of years under XEN - but with KVM and VFIO its easier and - the most important part - more stable (with xen the Guest-Reboot was not always successful - with KVM it is!).</p><p>Anyways i converted most of the manual qemu options into libvirt-xml - main reason was that libvirt handles vCPU pinning and i couln&#039;t find a way to do it manually.<br />Another positive effect is Host Startup/Shutdown handling due to the libvirt init script - they stop/start your Guest on Host startup/shutdown.</p><div class="codebox"><pre class="vscroll"><code>&lt;domain type=&#039;kvm&#039; id=&#039;26&#039; xmlns:qemu=&#039;http://libvirt.org/schemas/domain/qemu/1.0&#039;&gt; &lt;name&gt;windows7&lt;/name&gt; &lt;uuid&gt;xxxxxxx-xxxxx-xxxxx-xxxx-xxxxxxxxx&lt;/uuid&gt; &lt;memory unit=&#039;KiB&#039;&gt;8388608&lt;/memory&gt; &lt;currentMemory unit=&#039;KiB&#039;&gt;8388608&lt;/currentMemory&gt; &lt;memoryBacking&gt; &lt;nosharepages/&gt; &lt;locked/&gt; &lt;/memoryBacking&gt; &lt;vcpu placement=&#039;static&#039;&gt;4&lt;/vcpu&gt; &lt;cputune&gt; &lt;vcpupin vcpu=&#039;0&#039; cpuset=&#039;2&#039;/&gt; &lt;vcpupin vcpu=&#039;1&#039; cpuset=&#039;6&#039;/&gt; &lt;vcpupin vcpu=&#039;2&#039; cpuset=&#039;3&#039;/&gt; &lt;vcpupin vcpu=&#039;3&#039; cpuset=&#039;7&#039;/&gt; &lt;emulatorpin cpuset=&#039;0-1,4-5&#039;/&gt; &lt;/cputune&gt; &lt;resource&gt; &lt;partition&gt;/machine&lt;/partition&gt; &lt;/resource&gt; &lt;os&gt; &lt;type arch=&#039;x86_64&#039; machine=&#039;pc-q35-1.5&#039;&gt;hvm&lt;/type&gt; &lt;boot dev=&#039;hd&#039;/&gt; &lt;smbios mode=&#039;host&#039;/&gt; &lt;/os&gt; &lt;cpu mode=&#039;host-passthrough&#039;&gt; &lt;topology sockets=&#039;1&#039; cores=&#039;2&#039; threads=&#039;2&#039;/&gt; &lt;/cpu&gt; &lt;clock offset=&#039;localtime&#039;/&gt; &lt;on_poweroff&gt;destroy&lt;/on_poweroff&gt; &lt;on_reboot&gt;restart&lt;/on_reboot&gt; &lt;on_crash&gt;destroy&lt;/on_crash&gt; &lt;devices&gt; &lt;emulator&gt;/usr/local/kvm/bin/qemu-system-x86_64&lt;/emulator&gt; &lt;disk type=&#039;block&#039; device=&#039;disk&#039;&gt; &lt;driver name=&#039;qemu&#039; type=&#039;raw&#039; cache=&#039;none&#039; discard=&#039;unmap&#039;/&gt; &lt;source dev=&#039;/dev/ssd/win7system&#039;/&gt; &lt;target dev=&#039;vda&#039; bus=&#039;virtio&#039;/&gt; &lt;alias name=&#039;virtio-disk0&#039;/&gt; &lt;address type=&#039;pci&#039; domain=&#039;0x0000&#039; bus=&#039;0x02&#039; slot=&#039;0x03&#039; function=&#039;0x0&#039;/&gt; &lt;/disk&gt; &lt;disk type=&#039;block&#039; device=&#039;disk&#039;&gt; &lt;driver name=&#039;qemu&#039; type=&#039;raw&#039; cache=&#039;none&#039; discard=&#039;unmap&#039;/&gt; &lt;source dev=&#039;/dev/mapper/win7games_cached&#039;/&gt; &lt;target dev=&#039;vdb&#039; bus=&#039;virtio&#039;/&gt; &lt;alias name=&#039;virtio-disk1&#039;/&gt; &lt;address type=&#039;pci&#039; domain=&#039;0x0000&#039; bus=&#039;0x02&#039; slot=&#039;0x04&#039; function=&#039;0x0&#039;/&gt; &lt;/disk&gt; &lt;controller type=&#039;sata&#039; index=&#039;0&#039;&gt; &lt;alias name=&#039;sata0&#039;/&gt; &lt;address type=&#039;pci&#039; domain=&#039;0x0000&#039; bus=&#039;0x00&#039; slot=&#039;0x1f&#039; function=&#039;0x2&#039;/&gt; &lt;/controller&gt; &lt;controller type=&#039;pci&#039; index=&#039;0&#039; model=&#039;pcie-root&#039;&gt; &lt;alias name=&#039;pcie.0&#039;/&gt; &lt;/controller&gt; &lt;controller type=&#039;pci&#039; index=&#039;1&#039; model=&#039;dmi-to-pci-bridge&#039;&gt; &lt;alias name=&#039;pci.1&#039;/&gt; &lt;address type=&#039;pci&#039; domain=&#039;0x0000&#039; bus=&#039;0x00&#039; slot=&#039;0x02&#039; function=&#039;0x0&#039;/&gt; &lt;/controller&gt; &lt;controller type=&#039;pci&#039; index=&#039;2&#039; model=&#039;pci-bridge&#039;&gt; &lt;alias name=&#039;pci.2&#039;/&gt; &lt;address type=&#039;pci&#039; domain=&#039;0x0000&#039; bus=&#039;0x01&#039; slot=&#039;0x01&#039; function=&#039;0x0&#039;/&gt; &lt;/controller&gt; &lt;controller type=&#039;usb&#039; index=&#039;0&#039; model=&#039;none&#039;&gt; &lt;alias name=&#039;usb0&#039;/&gt; &lt;address type=&#039;pci&#039; domain=&#039;0x0000&#039; bus=&#039;0x02&#039; slot=&#039;0x01&#039; function=&#039;0x0&#039;/&gt; &lt;/controller&gt; &lt;interface type=&#039;bridge&#039;&gt; &lt;mac address=&#039;00:xx:xx:xx:xx:xx&#039;/&gt; &lt;source bridge=&#039;br0&#039;/&gt; &lt;target dev=&#039;vnet0&#039;/&gt; &lt;model type=&#039;virtio&#039;/&gt; &lt;alias name=&#039;net0&#039;/&gt; &lt;rom bar=&#039;off&#039;/&gt; &lt;address type=&#039;pci&#039; domain=&#039;0x0000&#039; bus=&#039;0x02&#039; slot=&#039;0x02&#039; function=&#039;0x0&#039;/&gt; &lt;/interface&gt; &lt;memballoon model=&#039;none&#039;&gt; &lt;alias name=&#039;balloon0&#039;/&gt; &lt;/memballoon&gt; &lt;/devices&gt; &lt;seclabel type=&#039;none&#039;/&gt; &lt;qemu:commandline&gt; &lt;qemu:arg value=&#039;-device&#039;/&gt; &lt;qemu:arg value=&#039;ioh3420,bus=pcie.0,addr=1c.0,multifunction=on,port=1,chassis=1,id=root.1&#039;/&gt; &lt;qemu:arg value=&#039;-device&#039;/&gt; &lt;qemu:arg value=&#039;vfio-pci,host=08:00.0,bus=root.1,addr=00.0,multifunction=on,x-vga=on&#039;/&gt; &lt;qemu:arg value=&#039;-device&#039;/&gt; &lt;qemu:arg value=&#039;vfio-pci,host=08:00.1,bus=root.1,addr=00.1&#039;/&gt; &lt;qemu:arg value=&#039;-device&#039;/&gt; &lt;qemu:arg value=&#039;vfio-pci,host=00:1d.0,bus=pcie.0&#039;/&gt; &lt;qemu:arg value=&#039;-device&#039;/&gt; &lt;qemu:arg value=&#039;vfio-pci,host=00:1d.1,bus=pcie.0&#039;/&gt; &lt;qemu:arg value=&#039;-device&#039;/&gt; &lt;qemu:arg value=&#039;vfio-pci,host=00:1d.2,bus=pcie.0&#039;/&gt; &lt;qemu:arg value=&#039;-device&#039;/&gt; &lt;qemu:arg value=&#039;vfio-pci,host=00:1d.7,bus=pcie.0&#039;/&gt; &lt;qemu:arg value=&#039;-bios&#039;/&gt; &lt;qemu:arg value=&#039;/usr/src/kvm/seabios-1.7.2-patched/seabios/out/bios.bin&#039;/&gt; &lt;qemu:env name=&#039;DISPLAY&#039; value=&#039;:0&#039;/&gt; &lt;qemu:env name=&#039;QEMU_PA_SAMPLES&#039; value=&#039;128&#039;/&gt; &lt;qemu:env name=&#039;QEMU_AUDIO_DRV&#039; value=&#039;pa&#039;/&gt; &lt;/qemu:commandline&gt; &lt;/domain&gt;</code></pre></div><p>Adapt UUID and MAC adress - and of course your PCI-IDs...</p><p>Greetings<br />K.</p></div></blockquote></div><p>Thank&#160; <br />I forgot&#160; (alias name=) -.-&#039; <br />But thanks to all of you to be able to do what I wanted to do 15 years ago<br />I would like to give my contribution to the cpu AMD FX, are able to work well with the double of the processes with respect to the number of cores<br />I have a fx 4100 will dedicate 3 cores for the guest but they will setup with hyper-treading<br />How distro I&#039;m using gentoo</p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1348292">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1348583" class="blockpost roweven"> <h2><span><span class="conr">#704</span> <a href="viewtopic.php?pid=1348583#p1348583">2013-11-11 22:09:13</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=75590">aw</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2013-10-04</span></dd> <dd><span>Posts: 921</span></dd> <dd class="usercontacts"><span class="email"><a href="misc.php?email=75590">Email</a></span> <span class="website"><a href="http://vfio.blogspot.com/" rel="nofollow">Website</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>aw wrote:</cite><blockquote><div><p>Testing a Linux guest w/ a GTX660, I can confirm that things go bad when using the NV_RegEnableMSI=1 option.&#160; This worked fine for me with a Quadro card.&#160; I see a single interrupt and the monitor goes out of sync and never comes back after OS bootup.&#160; I&#039;ll try to find some time to dig into it.&#160; I also note that the audio driver specifically checks for nvidia devices and blacklists MSI on snd-hda-intel, so at some point nvidia hasn&#039;t played nicely with Linux MSI support.&#160; Perhaps there&#039;s a reason why the Linux nvidia driver defaults to INTx as well.</p></div></blockquote></div><p>Good news/bad news...</p><p>Good news: I figured out the problem and posted a patch that solves it on my GTX660: <a href="http://lists.nongnu.org/archive/html/qemu-devel/2013-11/msg01390.html" rel="nofollow">http://lists.nongnu.org/archive/html/qe … 01390.html</a></p><p>Bad news: This means that for every MSI interrupt, the Nvidia driver does a write to MMIO space at an offset that QEMU needs to trap in order to &quot;virtualize&quot; the device.&#160; That may negate any performance benefit of MSI vs INTx.&#160; As noted in the patch we might be able to use an ioeventfd to make handling more asynchronous, but the overhead is probably still more than INTx, which we can handle without exiting to QEMU userspace.</p> </div> <div class="postsignature postmsg"><hr /><p><a href="http://vfio.blogspot.com" rel="nofollow">http://vfio.blogspot.com</a><br />Looking for a more open forum to discuss vfio related uses?&#160; Try <a href="https://www.redhat.com/mailman/listinfo/vfio-users" rel="nofollow">https://www.redhat.com/mailman/listinfo/vfio-users</a></p></div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1348583">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1348635" class="blockpost rowodd"> <h2><span><span class="conr">#705</span> <a href="viewtopic.php?pid=1348635#p1348635">2013-11-12 01:33:29</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=76766">mafferri</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2013-11-11</span></dd> <dd><span>Posts: 7</span></dd> <dd class="usercontacts"><span class="email"><a href="misc.php?email=76766">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>teekay wrote:</cite><blockquote><div><div class="quotebox"><cite>kaeptnb wrote:</cite><blockquote><div><p>oh i overread the main part: you can sucessfully run qemu as a user manually!<br />that never worked for me, when i startet qemu as a user i got the same or similar messages like you.</p></div></blockquote></div><p>Yup, that works fine. It just required to chown the /dev/vfio devices and the hugetlbfs area.</p><p>Having it in libvirt would be cosmetic. I have some LXC containers managed with libvirt, so this would put everything in a unique interface. But libvirt causes me a headache, no idea where it takes the RLIMIT_MEMLOCK value from. It seems to ignore limits.conf</p></div></blockquote></div><p>I have the same problem , and change the user and group in the root on /etc/libvirt/qemu.conf and libvirtd.conf work fine no output the error -.-&#039;<br />the same problem occurs even if you launch qemu with &quot;sudo-u user qemu ......&quot;</p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1348635">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1348647" class="blockpost roweven"> <h2><span><span class="conr">#706</span> <a href="viewtopic.php?pid=1348647#p1348647">2013-11-12 02:18:52</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=76576">a123</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2013-11-05</span></dd> <dd><span>Posts: 2</span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <p>Hi all, I can passthrough my VGA to VM successfully using both pci-assign and vfio-pci. What&#039;s the difference between these two methods?</p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1348647">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1348651" class="blockpost rowodd"> <h2><span><span class="conr">#707</span> <a href="viewtopic.php?pid=1348651#p1348651">2013-11-12 02:30:23</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=75590">aw</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2013-10-04</span></dd> <dd><span>Posts: 921</span></dd> <dd class="usercontacts"><span class="email"><a href="misc.php?email=75590">Email</a></span> <span class="website"><a href="http://vfio.blogspot.com/" rel="nofollow">Website</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>a123 wrote:</cite><blockquote><div><p>Hi all, I can passthrough my VGA to VM successfully using both pci-assign and vfio-pci. What&#039;s the difference between these two methods?</p></div></blockquote></div><p>pci-assign is effectively deprecated upstream.&#160; It has a poor device ownership model, it&#039;s a patchwork of security issues, it relies on userspace to protect the kernel against peer-to-peer isolation, and kvm would really like to get away from being a device driver and managing the iommu.&#160; vfio-pci is meant to replace it.&#160; Additionally, pci-assign doesn&#039;t actually have VGA support.&#160; You can only use it to assign a graphics card as a secondary device to the VM.&#160; If you can do this, great.&#160; It avoids a number of issues with VGA.&#160; vfio-pci should work equally well with that model, but also supports use as a primary VGA device with the x-vga=on option, which seems to enable quite a few more cards.</p> </div> <div class="postsignature postmsg"><hr /><p><a href="http://vfio.blogspot.com" rel="nofollow">http://vfio.blogspot.com</a><br />Looking for a more open forum to discuss vfio related uses?&#160; Try <a href="https://www.redhat.com/mailman/listinfo/vfio-users" rel="nofollow">https://www.redhat.com/mailman/listinfo/vfio-users</a></p></div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1348651">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1348659" class="blockpost roweven"> <h2><span><span class="conr">#708</span> <a href="viewtopic.php?pid=1348659#p1348659">2013-11-12 03:00:00</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=76576">a123</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2013-11-05</span></dd> <dd><span>Posts: 2</span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>aw wrote:</cite><blockquote><div><div class="quotebox"><cite>a123 wrote:</cite><blockquote><div><p>Hi all, I can passthrough my VGA to VM successfully using both pci-assign and vfio-pci. What&#039;s the difference between these two methods?</p></div></blockquote></div><p>pci-assign is effectively deprecated upstream.&#160; It has a poor device ownership model, it&#039;s a patchwork of security issues, it relies on userspace to protect the kernel against peer-to-peer isolation, and kvm would really like to get away from being a device driver and managing the iommu.&#160; vfio-pci is meant to replace it.&#160; Additionally, pci-assign doesn&#039;t actually have VGA support.&#160; You can only use it to assign a graphics card as a secondary device to the VM.&#160; If you can do this, great.&#160; It avoids a number of issues with VGA.&#160; vfio-pci should work equally well with that model, but also supports use as a primary VGA device with the x-vga=on option, which seems to enable quite a few more cards.</p></div></blockquote></div><p>Does VGA passthrough and GPU passthrough mean the same thing?&#160; Is there a way to show the display of video output by SDL or VNC without connectting a physical monitor to the passthroughed vga card?</p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1348659">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1348661" class="blockpost rowodd"> <h2><span><span class="conr">#709</span> <a href="viewtopic.php?pid=1348661#p1348661">2013-11-12 03:08:08</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=75590">aw</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2013-10-04</span></dd> <dd><span>Posts: 921</span></dd> <dd class="usercontacts"><span class="email"><a href="misc.php?email=75590">Email</a></span> <span class="website"><a href="http://vfio.blogspot.com/" rel="nofollow">Website</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>a123 wrote:</cite><blockquote><div><div class="quotebox"><cite>aw wrote:</cite><blockquote><div><div class="quotebox"><cite>a123 wrote:</cite><blockquote><div><p>Hi all, I can passthrough my VGA to VM successfully using both pci-assign and vfio-pci. What&#039;s the difference between these two methods?</p></div></blockquote></div><p>pci-assign is effectively deprecated upstream.&#160; It has a poor device ownership model, it&#039;s a patchwork of security issues, it relies on userspace to protect the kernel against peer-to-peer isolation, and kvm would really like to get away from being a device driver and managing the iommu.&#160; vfio-pci is meant to replace it.&#160; Additionally, pci-assign doesn&#039;t actually have VGA support.&#160; You can only use it to assign a graphics card as a secondary device to the VM.&#160; If you can do this, great.&#160; It avoids a number of issues with VGA.&#160; vfio-pci should work equally well with that model, but also supports use as a primary VGA device with the x-vga=on option, which seems to enable quite a few more cards.</p></div></blockquote></div><p>Does VGA passthrough and GPU passthrough mean the same thing?&#160; Is there a way to show the display of video output by SDL or VNC without connectting a physical monitor to the passthroughed vga card?</p></div></blockquote></div><p>To me, VGA passthrough means you&#039;re actually making use of VGA, which means it&#039;s the primary VM display including VM BIOS output.&#160; GPU passthrough is without VGA, which mostly means a secondary VM display.&#160; GPU passthrough might be a primary display in a legacy-free environment (UEFI).&#160; VNC is only available using an in-band server (one running in the VM).&#160; Out-of-band SDL/VNC is only for emulated graphics.</p> </div> <div class="postsignature postmsg"><hr /><p><a href="http://vfio.blogspot.com" rel="nofollow">http://vfio.blogspot.com</a><br />Looking for a more open forum to discuss vfio related uses?&#160; Try <a href="https://www.redhat.com/mailman/listinfo/vfio-users" rel="nofollow">https://www.redhat.com/mailman/listinfo/vfio-users</a></p></div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1348661">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1348766" class="blockpost roweven"> <h2><span><span class="conr">#710</span> <a href="viewtopic.php?pid=1348766#p1348766">2013-11-12 10:41:33</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=76794">ilya80</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2013-11-12</span></dd> <dd><span>Posts: 34</span></dd> <dd class="usercontacts"><span class="email"><a href="misc.php?email=76794">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <p>Hi everyone!</p><p>I`m yet another guy extremely interested in passing through my GPU to get rid of dual-boot once &amp; for all. Thanks a lot for working on this, the effort is very much appreciated.</p><p>Can someone please confirm that using the instructions provided in the first post should be enough to pass through a NVidia GTX 680 card? Previously for Xen this was possible only after hardmodding the card into &quot;Multi-OS capable&quot; GRID K2 or Quadro K5000 card.</p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1348766">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1348814" class="blockpost rowodd"> <h2><span><span class="conr">#711</span> <a href="viewtopic.php?pid=1348814#p1348814">2013-11-12 14:38:09</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=75590">aw</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2013-10-04</span></dd> <dd><span>Posts: 921</span></dd> <dd class="usercontacts"><span class="email"><a href="misc.php?email=75590">Email</a></span> <span class="website"><a href="http://vfio.blogspot.com/" rel="nofollow">Website</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>ilya80 wrote:</cite><blockquote><div><p>Hi everyone!</p><p>I`m yet another guy extremely interested in passing through my GPU to get rid of dual-boot once &amp; for all. Thanks a lot for working on this, the effort is very much appreciated.</p><p>Can someone please confirm that using the instructions provided in the first post should be enough to pass through a NVidia GTX 680 card? Previously for Xen this was possible only after hardmodding the card into &quot;Multi-OS capable&quot; GRID K2 or Quadro K5000 card.</p></div></blockquote></div><p>It works with a GTX660 for me.&#160; Depending on whether your primary host graphics is Intel, you may need to patch the host kernel for i915 VGA arbiter fixes.&#160; Also if on an Intel system you&#039;ll need to patch QEMU to disable NoSnoop on the device.&#160; I have a plan for solving the latter problem more permanently, but it won&#039;t come until v3.13 and QEMU 1.8.&#160; The VGA arbiter problem is going to take longer.</p> </div> <div class="postsignature postmsg"><hr /><p><a href="http://vfio.blogspot.com" rel="nofollow">http://vfio.blogspot.com</a><br />Looking for a more open forum to discuss vfio related uses?&#160; Try <a href="https://www.redhat.com/mailman/listinfo/vfio-users" rel="nofollow">https://www.redhat.com/mailman/listinfo/vfio-users</a></p></div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1348814">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1348819" class="blockpost roweven"> <h2><span><span class="conr">#712</span> <a href="viewtopic.php?pid=1348819#p1348819">2013-11-12 14:45:38</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=76794">ilya80</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2013-11-12</span></dd> <dd><span>Posts: 34</span></dd> <dd class="usercontacts"><span class="email"><a href="misc.php?email=76794">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>aw wrote:</cite><blockquote><div><p>It works with a GTX660 for me.&#160; Depending on whether your primary host graphics is Intel, you may need to patch the host kernel for i915 VGA arbiter fixes.&#160; Also if on an Intel system you&#039;ll need to patch QEMU to disable NoSnoop on the device.&#160; I have a plan for solving the latter problem more permanently, but it won&#039;t come until v3.13 and QEMU 1.8.&#160; The VGA arbiter problem is going to take longer.</p></div></blockquote></div><p>Thanks for reply, this gives me hope! I may get away without putting soldering iron to my GTX 680. Also KVM has a stronger appeal to me, I`ve used it in the past. I`m running Debian, but I don&#039;t see that as a show stopper; I`m also fine with patching the kernel and QEMU ( running with Intel HD 2500 as primary GPU ). I`ll definitely give it a shot.</p> <p class="postedit"><em>Last edited by ilya80 (2013-11-12 14:56:37)</em></p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1348819">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1348932" class="blockpost rowodd"> <h2><span><span class="conr">#713</span> <a href="viewtopic.php?pid=1348932#p1348932">2013-11-12 19:14:05</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=73712">cmdr</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2013-08-01</span></dd> <dd><span>Posts: 8</span></dd> <dd class="usercontacts"><span class="email"><a href="misc.php?email=73712">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <p>After some months and after getting a new GPU I wanted to try this again. This time I am using a AMD 7750 for the host and a NVIDIA GTX 470 for the guest.<br />When I tried to install windows 7 in my guest I got bsod showing &quot;page fault in nonpaged area&quot; but I solved that by changing &quot;-cpu host&quot; to &quot;-cpu qemu64&quot; (I think I only get bsod when I set memory higher than 1024 *confused*).<br />After lots of reboots I finally got what I wanted... <img src="https://bbs.archlinux.org/img/smilies/big_smile.png" width="15" height="15" alt="big_smile" /></p><p>Thank you very much!</p><p><span class="postimg"><img src="http://abload.de/img/vmofdeath50sam.png" alt="vmofdeath50sam.png" /></span></p><p>For the record:<br />I only installed the packages from the first post (qemu-git, linux-mainline, seabios) then added pci-id&#039;s to grub and blacklisted nouveau.</p><ul><li><p>Xeon E3-1230v2</p></li><li><p>ASRock Fatal1ty Z77 professional</p></li><li><p>ATI Radeon 7750 (Host)</p></li><li><p>NVIDIA GTX-470 (Guest)</p></li></ul><div class="codebox"><pre><code># cat /proc/cmdline BOOT_IMAGE=/vmlinuz-linux-mainline root=/dev/mapper/main-root rw cryptdevice=/dev/sda2:main lang=de locale=de_DE.UTF-8 quiet intel_iommu=on pcie_acs_override=downstream pci-stub.ids=1002:68f9,1002:aa68</code></pre></div><div class="codebox"><pre><code>qemu-system-x86_64 -enable-kvm -M q35 -m 4096 -cpu qemu64 -smp 4,sockets=1,cores=4,threads=1 \ -bios /usr/share/qemu/bios.bin \ -vga none \ -device ioh3420,bus=pcie.0,addr=1c.0,multifunction=on,port=1,chassis=1,id=root.1 \ -device vfio-pci,host=02:00.0,bus=root.1,addr=00.0,multifunction=on,x-vga=on \ -device vfio-pci,host=02:00.1,bus=root.1,addr=00.1 \ -device ahci,bus=pcie.0,id=ahci \ -drive file=/home/zh32/MyMachines/windows2.img,id=disk,format=raw \ -device ide-hd,bus=ahci.0,drive=disk \ -drive file=/home/zh32/Images/bie764129g.iso,id=isocd \ -device ide-cd,bus=ahci.1,drive=isocd \ -boot menu=on \ -usb -usbdevice host:04f3:0210 -usbdevice host:05ac:1006 -usbdevice host:05ac:0221</code></pre></div> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1348932">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1348934" class="blockpost roweven"> <h2><span><span class="conr">#714</span> <a href="viewtopic.php?pid=1348934#p1348934">2013-11-12 19:24:30</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=70922">nbhs</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd class="postavatar"><img src="https://bbs.archlinux.org/img/avatars/70922.jpg?m=1367773811" width="80" height="80" alt="" /></dd> <dd><span>From: Montevideo, Uruguay</span></dd> <dd><span>Registered: 2013-05-02</span></dd> <dd><span>Posts: 402</span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>cmdr wrote:</cite><blockquote><div><p>After some months and after getting a new GPU I wanted to try this again. This time I am using a AMD 7750 for the host and a NVIDIA GTX 470 for the guest.<br />When I tried to install windows 7 in my guest I got bsod showing &quot;page fault in nonpaged area&quot; but I solved that by changing &quot;-cpu host&quot; to &quot;-cpu qemu64&quot; (I think I only get bsod when I set memory higher than 1024 *confused*).<br />After lots of reboots I finally got what I wanted... <img src="https://bbs.archlinux.org/img/smilies/big_smile.png" width="15" height="15" alt="big_smile" /></p><p>Thank you very much!</p></div></blockquote></div><p>Congrats, have you tried using -cpu SandyBridge ?</p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1348934">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1348985" class="blockpost rowodd"> <h2><span><span class="conr">#715</span> <a href="viewtopic.php?pid=1348985#p1348985">2013-11-12 21:39:20</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=65027">blacky</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2012-10-26</span></dd> <dd><span>Posts: 10</span></dd> <dd class="usercontacts"><span class="email"><a href="misc.php?email=65027">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <p>Hi!</p><p>I’m currently stuck at the first qemu-run where I’m supposed to see the SeaBIOS-Output on my third screen (plugged into the dedicated graphics card). Actually it flickers every time I execute</p><div class="codebox"><pre><code>qemu-system-x86_64 -enable-kvm -M q35 -m 1024 -cpu host -smp 6,sockets=1,cores=6,threads=1 -bios /usr/share/qemu/bios.bin -vga none -device ioh3420,bus=pcie.0,addr=1c.0,multifunction=on,port=1,chassis=1,id=root.1 -device vfio-pci,host=02:00.0,bus=root.1,addr=00.0,multifunction=on,x-vga=on -device vfio-pci,host=02:00.1,bus=root.1,addr=00.1</code></pre></div><p>which means, I guess, that the device is successfully reset. The third display is in standby when booting the host but actually stays on after I first executed qemu. Also the main screen on the IGP (but not the secondary) shows artifacts when starting qemu but I can get rid of them by changing to tty2 and back to X. There are no error messages whatsoever, qemu runs until I kill it. I also tried to use a ROM file for the VGA bios but that didn’t change anything. </p><p>My setup:</p><p>ASRock Z87 Extreme6<br />Core i4771<br />HD4850</p><p>The HD4850 is for testing only since I’m waiting for R9 290X with a reasonable custom cooling system.</p><p>dmesg (relevant info only):</p><div class="codebox"><pre><code>255:[ 0.000000] Kernel command line: BOOT_IMAGE=/vmlinuz-linux-mainline root=/dev/mapper/-root rw cryptdevice=UUID=:_crypt intel_iommu=on pci-stub.ids=1002:9442,1002:aa30 256:[ 0.000000] Intel-IOMMU: enabled 315:[ 0.058278] dmar: IOMMU 0: reg_base_addr fed90000 ver 1:0 cap c0000020660462 ecap f0101a 317:[ 0.058282] dmar: IOMMU 1: reg_base_addr fed91000 ver 1:0 cap d2008020660462 ecap f010da 320:[ 0.058347] IOAPIC id 2 under DRHD base 0xfed91000 IOMMU 1 614:[ 0.667449] IOMMU 0 0xfed90000: using Queued invalidation 615:[ 0.667450] IOMMU 1 0xfed91000: using Queued invalidation 616:[ 0.667451] IOMMU: Setting RMRR: 617:[ 0.667459] IOMMU: Setting identity map for device 0000:00:02.0 [0xbf800000 - 0xcf9fffff] 621:[ 0.668724] IOMMU: Prepare 0-16MiB unity mapping for LPC 685:[ 0.696931] pci-stub: add 1002:9442 sub=FFFFFFFF:FFFFFFFF cls=00000000/00000000 686:[ 0.696936] pci-stub 0000:02:00.0: claimed by stub 687:[ 0.696940] pci-stub: add 1002:AA30 sub=FFFFFFFF:FFFFFFFF cls=00000000/00000000 688:[ 0.696943] pci-stub 0000:02:00.1: claimed by stub 1125: [ 3436.413121] vfio-pci 0000:02:00.0: enabling device (0000 -&gt; 0003)</code></pre></div><p>/sys/</p><div class="codebox"><pre class="vscroll"><code>$&gt; ls /sys/kernel/iommu_groups/1/devices lrwxrwxrwx 1 root root 0 12. Nov 21:01 0000:00:01.0 -&gt; ../../../../devices/pci0000:00/0000:00:01.0 lrwxrwxrwx 1 root root 0 12. Nov 21:01 0000:00:01.1 -&gt; ../../../../devices/pci0000:00/0000:00:01.1 lrwxrwxrwx 1 root root 0 12. Nov 21:01 0000:02:00.0 -&gt; ../../../../devices/pci0000:00/0000:00:01.1/0000:02:00.0 lrwxrwxrwx 1 root root 0 12. Nov 21:01 0000:02:00.1 -&gt; ../../../../devices/pci0000:00/0000:00:01.1/0000:02:00.1 $&gt; ls /sys/devices/pci0000:00/0000:00:01.1/0000:02:00.0 /sys/devices/pci0000:00/0000:00:01.1/0000:02:00.0: lrwxrwxrwx 1 root root 0 12. Nov 20:23 driver -&gt; ../../../../bus/pci/drivers/vfio-pci lrwxrwxrwx 1 root root 0 12. Nov 21:01 iommu_group -&gt; ../../../../kernel/iommu_groups/1 […] /sys/devices/pci0000:00/0000:00:01.1/0000:02:00.1: lrwxrwxrwx 1 root root 0 12. Nov 20:26 driver -&gt; ../../../../bus/pci/drivers/vfio-pci lrwxrwxrwx 1 root root 0 12. Nov 21:01 iommu_group -&gt; ../../../../kernel/iommu_groups/1 […] $&gt; ls /sys/bus/pci/drivers/vfio-pci/ lrwxrwxrwx 1 root root 0 12. Nov 23:04 0000:02:00.0 -&gt; ../../../../devices/pci0000:00/0000:00:01.1/0000:02:00.0 lrwxrwxrwx 1 root root 0 12. Nov 23:04 0000:02:00.1 -&gt; ../../../../devices/pci0000:00/0000:00:01.1/0000:02:00.1 --w------- 1 root root 4,0K 12. Nov 23:04 bind lrwxrwxrwx 1 root root 0 12. Nov 23:04 module -&gt; ../../../../module/vfio_pci --w------- 1 root root 4,0K 12. Nov 20:04 new_id --w------- 1 root root 4,0K 12. Nov 23:04 remove_id --w------- 1 root root 4,0K 12. Nov 20:04 uevent --w------- 1 root root 4,0K 12. Nov 23:04 unbind</code></pre></div><p>lspci -v</p><div class="codebox"><pre><code>02:00.0 VGA compatible controller: Advanced Micro Devices, Inc. [AMD/ATI] RV770 [Radeon HD 4850] (prog-if 00 [VGA controller]) Subsystem: Advanced Micro Devices, Inc. [AMD/ATI] MSI Radeon HD 4850 512MB GDDR3 Flags: fast devsel, IRQ 17 Memory at e0000000 (64-bit, prefetchable) [size=256M] Memory at f0020000 (64-bit, non-prefetchable) [size=64K] I/O ports at e000 [size=256] Expansion ROM at f0000000 [disabled] [size=128K] Capabilities: [50] Power Management version 3 Capabilities: [58] Express Legacy Endpoint, MSI 00 Capabilities: [a0] MSI: Enable- Count=1/1 Maskable- 64bit+ Capabilities: [100] Vendor Specific Information: ID=0001 Rev=1 Len=010 &lt;?&gt; Kernel driver in use: vfio-pci Kernel modules: radeon 02:00.1 Audio device: Advanced Micro Devices, Inc. [AMD/ATI] RV770 HDMI Audio [Radeon HD 4850/4870] Subsystem: Advanced Micro Devices, Inc. [AMD/ATI] RV770 HDMI Audio [Radeon HD 4850/4870] Flags: bus master, fast devsel, latency 0, IRQ 18 Memory at f0030000 (64-bit, non-prefetchable) [size=16K] Capabilities: [50] Power Management version 3 Capabilities: [58] Express Legacy Endpoint, MSI 00 Capabilities: [a0] MSI: Enable- Count=1/1 Maskable- 64bit+ Capabilities: [100] Vendor Specific Information: ID=0001 Rev=1 Len=010 &lt;?&gt; Kernel driver in use: vfio-pci Kernel modules: snd_hda_intel</code></pre></div><p>Unfortunately I cannot use another card since at least the first two PCIe-Ports are in the same iommu group. </p><p>I used linux-mainline (AUR), qemu-git (AUR) and seabios (from the first post). </p><p>Now I’m a bit stuck because I don’t see any error messages I could relate to this.</p><p>The following seems to be more of an (unrelated) IGP problem.</p><div class="codebox"><pre><code>kernel: [drm:ring_stuck] *ERROR* Kicking stuck wait on blitter ring kernel: [drm] no progress on blitter ring kernel: [drm:i915_set_reset_status] *ERROR* blitter ring hung flushing bo (0x8aa000 ctx 0) at 0xfac kernel: [drm] stuck on render ring kernel: [drm:i915_set_reset_status] *ERROR* render ring hung inside bo (0xa309000 ctx 1) at 0xa3092d4 kernel: [drm:ring_stuck] *ERROR* Kicking stuck wait on blitter ring</code></pre></div><p>Can you probably give me a hint where to look?</p> <p class="postedit"><em>Last edited by blacky (2013-11-12 22:09:47)</em></p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1348985">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1348995" class="blockpost roweven"> <h2><span><span class="conr">#716</span> <a href="viewtopic.php?pid=1348995#p1348995">2013-11-12 22:16:54</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=70922">nbhs</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd class="postavatar"><img src="https://bbs.archlinux.org/img/avatars/70922.jpg?m=1367773811" width="80" height="80" alt="" /></dd> <dd><span>From: Montevideo, Uruguay</span></dd> <dd><span>Registered: 2013-05-02</span></dd> <dd><span>Posts: 402</span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>blacky wrote:</cite><blockquote><div><p>Can you probably give me a hint where to look?</p></div></blockquote></div><p>Use the packages i provided instead of the AUR ones</p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1348995">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1348996" class="blockpost rowodd"> <h2><span><span class="conr">#717</span> <a href="viewtopic.php?pid=1348996#p1348996">2013-11-12 22:17:55</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=76794">ilya80</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2013-11-12</span></dd> <dd><span>Posts: 34</span></dd> <dd class="usercontacts"><span class="email"><a href="misc.php?email=76794">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>blacky wrote:</cite><blockquote><div><p>Hi!</p><p>I’m currently stuck at the first qemu-run where I’m supposed to see the SeaBIOS-Output on my third screen (plugged into the dedicated graphics card). Actually it flickers every time I execute</p><p>......</p><p>Can you probably give me a hint where to look?</p></div></blockquote></div><p>Hi!</p><p>I guess your problems should be solved with the advice AW gave me:</p><p>&quot;Depending on whether your primary host graphics is Intel, you may need to patch the host kernel for i915 VGA arbiter fixes. Also if on an Intel system you&#039;ll need to patch QEMU to disable NoSnoop on the device&quot;</p><p>Links to the mentioned patches are in the updated first post of the topic. Do you have those patches already adopted?</p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1348996">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1348999" class="blockpost roweven"> <h2><span><span class="conr">#718</span> <a href="viewtopic.php?pid=1348999#p1348999">2013-11-12 22:20:20</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=65027">blacky</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2012-10-26</span></dd> <dd><span>Posts: 10</span></dd> <dd class="usercontacts"><span class="email"><a href="misc.php?email=65027">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>nbhs wrote:</cite><blockquote><div><p>Use the packages i provided instead of the AUR ones</p></div></blockquote></div><p>I thought that those were o.k. too since you linked them</p><div class="quotebox"><cite>nbhs wrote:</cite><blockquote><div><p>qemu-git.tar.gz (includes NoSnoop patch) OR qemu-git from AUR<br />seabios.tar.gz (1.7.3.2)<br />linux-mainline.tar.gz (3.12.0 includes acs override patch and i915 fixes) OR&#160; linux-mainline from AUR</p></div></blockquote></div><p>But of course I’ll follow your advise, thanks!</p><p>@ilya80: Oh, ok, didn’t catch that.</p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1348999">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1349001" class="blockpost rowodd"> <h2><span><span class="conr">#719</span> <a href="viewtopic.php?pid=1349001#p1349001">2013-11-12 22:28:25</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=75590">aw</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2013-10-04</span></dd> <dd><span>Posts: 921</span></dd> <dd class="usercontacts"><span class="email"><a href="misc.php?email=75590">Email</a></span> <span class="website"><a href="http://vfio.blogspot.com/" rel="nofollow">Website</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>blacky wrote:</cite><blockquote><div><p>[snip] Also the main screen on the IGP (but not the secondary) shows artifacts when starting qemu but I can get rid of them by changing to tty2 and back to X.</p></div></blockquote></div><p>sounds like lack of i915 VGA arbiter patch</p><div class="quotebox"><cite>blacky wrote:</cite><blockquote><div><p>[snip]<br />The following seems to be more of an (unrelated) IGP problem.</p><div class="codebox"><pre><code>kernel: [drm:ring_stuck] *ERROR* Kicking stuck wait on blitter ring kernel: [drm] no progress on blitter ring kernel: [drm:i915_set_reset_status] *ERROR* blitter ring hung flushing bo (0x8aa000 ctx 0) at 0xfac kernel: [drm] stuck on render ring kernel: [drm:i915_set_reset_status] *ERROR* render ring hung inside bo (0xa309000 ctx 1) at 0xa3092d4 kernel: [drm:ring_stuck] *ERROR* Kicking stuck wait on blitter ring</code></pre></div><p>Can you probably give me a hint where to look?</p></div></blockquote></div><p>very related.&#160; As others noted, mainline doesn&#039;t work for this yet.</p> </div> <div class="postsignature postmsg"><hr /><p><a href="http://vfio.blogspot.com" rel="nofollow">http://vfio.blogspot.com</a><br />Looking for a more open forum to discuss vfio related uses?&#160; Try <a href="https://www.redhat.com/mailman/listinfo/vfio-users" rel="nofollow">https://www.redhat.com/mailman/listinfo/vfio-users</a></p></div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1349001">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1349040" class="blockpost roweven"> <h2><span><span class="conr">#720</span> <a href="viewtopic.php?pid=1349040#p1349040">2013-11-13 00:33:44</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=73712">cmdr</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2013-08-01</span></dd> <dd><span>Posts: 8</span></dd> <dd class="usercontacts"><span class="email"><a href="misc.php?email=73712">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>nbhs wrote:</cite><blockquote><div><p>-snip-</p><p>Congrats, have you tried using -cpu SandyBridge ?</p></div></blockquote></div><p>Yes, I just reinstalled the machine using &#039;-cpu SandyBridge&#039; and with a own sata-controller. Works fine.</p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1349040">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1349221" class="blockpost rowodd"> <h2><span><span class="conr">#721</span> <a href="viewtopic.php?pid=1349221#p1349221">2013-11-13 19:10:41</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=76766">mafferri</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2013-11-11</span></dd> <dd><span>Posts: 7</span></dd> <dd class="usercontacts"><span class="email"><a href="misc.php?email=76766">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>nbhs wrote:</cite><blockquote><div><p><strong>Binding a device to vfio-pci</strong></p><p>Assuming the kernel, qemu and seabios are built and working, lets bind some devices.<br />You can use this script to make life easier:</p><div class="codebox"><pre><code>#!/bin/bash modprobe vfio-pci for dev in &quot;$@&quot;; do vendor=$(cat /sys/bus/pci/devices/$dev/vendor) device=$(cat /sys/bus/pci/devices/$dev/device) if [ -e /sys/bus/pci/devices/$dev/driver ]; then echo $dev &gt; /sys/bus/pci/devices/$dev/driver/unbind fi echo $vendor $device &gt; /sys/bus/pci/drivers/vfio-pci/new_id done</code></pre></div><p>Save it as /usr/bin/vfio-bind</p><div class="codebox"><pre><code>chmod 755 /usr/bin/vfio-bind</code></pre></div><p>Bind the GPU:</p><div class="codebox"><pre><code>vfio-bind 0000:07:00.0 0000:07:00.1</code></pre></div><br /><p>cat /etc/vfio-pci.cfg</p><div class="codebox"><pre><code>DEVICES=&quot;0000:00:11.0 0000:04:00.0 0000:05:00.0 0000:06:00.0 0000:07:00.0 000:07:00.1&quot;</code></pre></div><p>GL!</p></div></blockquote></div><br /><p>quoto this because I wish I could do the reverse, for when I shutdown the vm<br />because if I restart the vm I have very bad performance<br />I have to reboot the host because everything works well</p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1349221">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1349223" class="blockpost roweven"> <h2><span><span class="conr">#722</span> <a href="viewtopic.php?pid=1349223#p1349223">2013-11-13 19:24:21</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=75590">aw</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2013-10-04</span></dd> <dd><span>Posts: 921</span></dd> <dd class="usercontacts"><span class="email"><a href="misc.php?email=75590">Email</a></span> <span class="website"><a href="http://vfio.blogspot.com/" rel="nofollow">Website</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>mafferri wrote:</cite><blockquote><div><p>quoto this because I wish I could do the reverse, for when I shutdown the vm<br />because if I restart the vm I have very bad performance<br />I have to reboot the host because everything works well</p></div></blockquote></div><p>You can do the reverse.&#160; Here are the scripts I use:</p><p>vfio-group &lt;group #&gt;:</p><div class="codebox"><pre class="vscroll"><code>#!/bin/sh if [ ! -e /sys/kernel/iommu_groups/$1 ]; then echo &quot;IOMMU group $1 not found&quot; exit 1 fi if [ ! -e /sys/bus/pci/drivers/vfio-pci ]; then sudo modprobe vfio-pci fi for i in $(ls /sys/kernel/iommu_groups/$1/devices/); do if [ -e /sys/kernel/iommu_groups/$1/devices/$i/driver ]; then if [ &quot;$(basename $(readlink -f \ /sys/kernel/iommu_groups/$1/devices/$i/driver))&quot; != \ &quot;pcieport&quot; ]; then echo $i | sudo tee \ /sys/kernel/iommu_groups/$1/devices/$i/driver/unbind fi fi done for i in $(ls /sys/kernel/iommu_groups/$1/devices/); do if [ ! -e /sys/kernel/iommu_groups/$1/devices/$i/driver ]; then VEN=$(cat /sys/kernel/iommu_groups/$1/devices/$i/vendor) DEV=$(cat /sys/kernel/iommu_groups/$1/devices/$i/device) echo $VEN $DEV | sudo tee \ /sys/bus/pci/drivers/vfio-pci/new_id fi done</code></pre></div><p>vfio-ungroup &lt;group #&gt;</p><div class="codebox"><pre><code>#!/bin/sh if [ ! -e /sys/kernel/iommu_groups/$1 ]; then echo &quot;IOMMU group $1 not found&quot; exit 1 fi for i in $(ls /sys/kernel/iommu_groups/$1/devices/); do VEN=$(cat /sys/kernel/iommu_groups/$1/devices/$i/vendor) DEV=$(cat /sys/kernel/iommu_groups/$1/devices/$i/device) echo $VEN $DEV | sudo tee \ /sys/bus/pci/drivers/vfio-pci/remove_id echo $i | sudo tee \ /sys/kernel/iommu_groups/$1/devices/$i/driver/unbind done for i in $(ls /sys/kernel/iommu_groups/$1/devices/); do echo $i | sudo tee /sys/bus/pci/drivers_probe done</code></pre></div><p>lsgroup</p><div class="codebox"><pre><code>#!/bin/sh BASE=&quot;/sys/kernel/iommu_groups&quot; for i in $(find $BASE -maxdepth 1 -mindepth 1 -type d); do GROUP=$(basename $i) echo &quot;### Group $GROUP ###&quot; for j in $(find $i/devices -type l); do DEV=$(basename $j) echo -n &quot; &quot; lspci -s $DEV done done</code></pre></div><p>I&#039;m not sure how this is going to help your performance though, it&#039;s pretty random whether re-loading the host driver is going to resolve anything that the guest driver can&#039;t.&#160; For graphics devices, if you&#039;re using kernel+qemu that support bus reset, that should provide something nearly as good as a host reboot.</p> </div> <div class="postsignature postmsg"><hr /><p><a href="http://vfio.blogspot.com" rel="nofollow">http://vfio.blogspot.com</a><br />Looking for a more open forum to discuss vfio related uses?&#160; Try <a href="https://www.redhat.com/mailman/listinfo/vfio-users" rel="nofollow">https://www.redhat.com/mailman/listinfo/vfio-users</a></p></div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1349223">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1349250" class="blockpost rowodd"> <h2><span><span class="conr">#723</span> <a href="viewtopic.php?pid=1349250#p1349250">2013-11-13 20:59:37</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=76834">Val532</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2013-11-13</span></dd> <dd><span>Posts: 35</span></dd> <dd class="usercontacts"><span class="email"><a href="misc.php?email=76834">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <p>Hi</p><p>First i Thank you for the tutorial.</p><p>I&#039;m able to use two or three VM with reel GPU.</p><p>But i have a problem i want to use Virt Manager to start, stop, wake or add new USB passthroug but i&#039;m not able to do that because of the difrence between qemu args and virt manager xml config.</p><p>Does any body have more luck with that ?</p><p>I&#039;m on Ubuntu 13.10 with 3.12 kernel (with patch) qemu master (with patch).</p><p>Thanks</p><p>PS: I&#039;m french</p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1349250">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1349252" class="blockpost roweven"> <h2><span><span class="conr">#724</span> <a href="viewtopic.php?pid=1349252#p1349252">2013-11-13 21:02:41</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=70922">nbhs</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd class="postavatar"><img src="https://bbs.archlinux.org/img/avatars/70922.jpg?m=1367773811" width="80" height="80" alt="" /></dd> <dd><span>From: Montevideo, Uruguay</span></dd> <dd><span>Registered: 2013-05-02</span></dd> <dd><span>Posts: 402</span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <div class="quotebox"><cite>Val532 wrote:</cite><blockquote><div><p>Hi</p><p>First i Thank you for the tutorial.</p><p>I&#039;m able to use two or three VM with reel GPU.</p><p>But i have a problem i want to use Virt Manager to start, stop, wake or add new USB passthroug but i&#039;m not able to do that because of the difrence between qemu args and virt manager xml config.</p><p>Does any body have more luck with that ?</p><p>I&#039;m on Ubuntu 13.10 with 3.12 kernel (with patch) qemu master (with patch).</p><p>Thanks</p><p>PS: I&#039;m french</p></div></blockquote></div><p>See this post by kaeptnb: <a href="https://bbs.archlinux.org/viewtopic.php?pid=1343400#p1343400" rel="nofollow">https://bbs.archlinux.org/viewtopic.php … 0#p1343400</a></p><p>Would you mind posting your hardware specs?</p> <p class="postedit"><em>Last edited by nbhs (2013-11-13 21:08:44)</em></p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1349252">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div id="p1349258" class="blockpost rowodd"> <h2><span><span class="conr">#725</span> <a href="viewtopic.php?pid=1349258#p1349258">2013-11-13 21:30:10</a></span></h2> <div class="box"> <div class="inbox"> <div class="postbody"> <div class="postleft"> <dl> <dt><strong><a href="profile.php?id=76834">Val532</a></strong></dt> <dd class="usertitle"><strong>Member</strong></dd> <dd><span>Registered: 2013-11-13</span></dd> <dd><span>Posts: 35</span></dd> <dd class="usercontacts"><span class="email"><a href="misc.php?email=76834">Email</a></span></dd> </dl> </div> <div class="postright"> <h3>Re: KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</h3> <div class="postmsg"> <p>So i made some test with this methode but no luck. Virt Manager say to me a lot of difrente error.<br />Sometime AppArmor error, sometime connection reset by peer.</p><p>My Hardware is:</p><p>Corei5 4670S so HD4600 for the host<br />24Go ram (3*8Go)<br />Asrock Z87 Extrem 6<br />AMD HD7770 for the first VM<br />AMD HD5570 for the second VM<br />AMD HD5570 fot the third Vm</p><p>All of the graphic card work.</p><p>For the moment i&#039;ve only Windows 7 on the first VM, the seconde and third come later.</p> </div> </div> </div> </div> <div class="inbox"> <div class="postfoot clearb"> <div class="postfootleft"><p><span>Offline</span></p></div> <div class="postfootright"> <ul> <li class="postreport"><span><a href="misc.php?report=1349258">Report</a></span></li> </ul> </div> </div> </div> </div> </div> <div class="postlinksb"> <div class="inbox crumbsplus"> <div class="pagepost"> <p class="pagelink conl"><span class="pages-label">Pages: </span><a rel="prev" class="item1" href="viewtopic.php?id=162768&amp;p=28">Previous</a> <a href="viewtopic.php?id=162768">1</a> <span class="spacer">…</span> <a href="viewtopic.php?id=162768&amp;p=27">27</a> <a href="viewtopic.php?id=162768&amp;p=28">28</a> <strong>29</strong> <a href="viewtopic.php?id=162768&amp;p=30">30</a> <a href="viewtopic.php?id=162768&amp;p=31">31</a> <span class="spacer">…</span> <a href="viewtopic.php?id=162768&amp;p=234">234</a> <a rel="next" href="viewtopic.php?id=162768&amp;p=30">Next</a></p> <p class="postlink conr">Topic closed</p> </div> <ul class="crumbs"> <li><a href="index.php">Index</a></li> <li><span>»&#160;</span><a href="viewforum.php?id=48">Topics Going Nowhere</a></li> <li><span>»&#160;</span><strong><a href="viewtopic.php?id=162768">KVM VGA-Passthrough using the new vfio-vga support in kernel =&gt;3.9</a></strong></li> </ul> <p class="subscribelink clearb"><a href="misc.php?action=subscribe&amp;tid=162768">Subscribe to this topic</a></p> <div class="clearer"></div> </div> </div> </div> <div id="brdfooter" class="block"> <h2><span>Board footer</span></h2> <div class="box"> <div id="brdfooternav" class="inbox"> <div class="conl"> <form id="qjump" method="get" action="viewforum.php"> <div><label><span>Jump to<br /></span> <select name="id" onchange="window.location=('viewforum.php?id='+this.options[this.selectedIndex].value)"> <optgroup label="Technical Issues and Assistance"> <option value="23">Newbie Corner</option> <option value="17">Installation</option> <option value="22">Kernel &amp; Hardware</option> <option value="18">Applications &amp; Desktop Environments</option> <option value="31">Laptop Issues</option> <option value="8">Networking, Server, and Protection</option> <option value="32">Multimedia and Games</option> <option value="50">System Administration</option> <option value="35">Other Architectures</option> </optgroup> <optgroup label="Arch-centric"> <option value="24">Announcements, Package &amp; Security Advisories</option> <option value="1">Arch Discussion</option> <option value="13">Forum &amp; Wiki discussion</option> </optgroup> <optgroup label="Pacman Upgrades, Packaging &amp; AUR"> <option value="44">Pacman &amp; Package Upgrade Issues</option> <option value="49">[testing] Repo Forum</option> <option value="4">Creating &amp; Modifying Packages</option> <option value="38">AUR Issues, Discussion &amp; PKGBUILD Requests</option> </optgroup> <optgroup label="Contributions &amp; Discussion"> <option value="20">GNU/Linux Discussion</option> <option value="27">Community Contributions</option> <option value="33">Programming &amp; Scripting</option> <option value="30">Other Languages</option> <option value="47">Artwork and Screenshots</option> <option value="42">Try This</option> </optgroup> <optgroup label="/dev/null"> <option value="29">Off-Topic</option> <option value="48" selected="selected">Topics Going Nowhere</option> <option value="36">Dustbin</option> </optgroup> </select></label> <input type="submit" value=" Go " accesskey="g" /> </div> </form> </div> <div class="conr"> <p id="feedlinks"><span class="atom"><a href="extern.php?action=feed&amp;tid=162768&amp;type=atom">Atom topic feed</a></span></p> <p id="poweredby">Powered by <a href="http://fluxbb.org/">FluxBB</a></p> </div> <div class="clearer"></div> </div> </div> </div> </div> <div class="end-box"></div> </div> </body> </html>
